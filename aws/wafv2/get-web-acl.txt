GET-WEB-ACL()                                                    GET-WEB-ACL()



NAME
       get-web-acl -

DESCRIPTION
       Retrieves the specified  WebACL .

       See also: AWS API Documentation

       See 'aws help' for descriptions of global parameters.

SYNOPSIS
            get-web-acl
          --name <value>
          --scope <value>
          --id <value>
          [--cli-input-json <value>]
          [--generate-cli-skeleton <value>]

OPTIONS
       --name (string)
          The name of the web ACL. You cannot change the name of a web ACL af-
          ter you create it.

       --scope (string)
          Specifies whether this is for an Amazon CloudFront  distribution  or
          for  a regional application. A regional application can be an Appli-
          cation Load Balancer (ALB), an Amazon API Gateway REST  API,  or  an
          AppSync GraphQL API.

          To  work  with  CloudFront, you must also specify the Region US East
          (N. Virginia) as follows:

          o CLI - Specify the  Region  when  you  use  the  CloudFront  scope:
            --scope=CLOUDFRONT --region=us-east-1 .

          o API and SDKs - For all calls, use the Region endpoint us-east-1.

          Possible values:

          o CLOUDFRONT

          o REGIONAL

       --id (string)
          The  unique  identifier  for the web ACL. This ID is returned in the
          responses to create and list commands. You provide it to  operations
          like update and delete.

       --cli-input-json  (string) Performs service operation based on the JSON
       string provided. The JSON string follows the format provided by  --gen-
       erate-cli-skeleton.  If  other  arguments  are  provided on the command
       line, the CLI values will override the JSON-provided values. It is  not
       possible to pass arbitrary binary values using a JSON-provided value as
       the string will be taken literally.

       --generate-cli-skeleton (string) Prints a  JSON  skeleton  to  standard
       output without sending an API request. If provided with no value or the
       value input, prints a sample input JSON that can be used as an argument
       for  --cli-input-json.  If provided with the value output, it validates
       the command inputs and returns a sample output JSON for that command.

       See 'aws help' for descriptions of global parameters.

EXAMPLES
       To retrieve a web ACL

       The following get-web-acl retrieves the  web  ACL  with  the  specified
       name, scope, and ID. You can get the ID for a web ACL from the commands
       create-web-acl and list-web-acls.

          aws wafv2 get-web-acl \
              --name test01 \
              --scope REGIONAL \
              --id a1b2c3d4-5678-90ab-cdef-EXAMPLE11111

       Output:

          {
              "WebACL":{
                  "Capacity":3,
                  "Description":"",
                  "Rules":[
                      {
                          "Priority":1,
                          "Action":{
                              "Block":{

                              }
                          },
                          "VisibilityConfig":{
                             "SampledRequestsEnabled":true,
                              "CloudWatchMetricsEnabled":true,
                              "MetricName":"testrule01"
                          },
                          "Name":"testrule01",
                          "Statement":{
                              "AndStatement":{
                                  "Statements":[
                                      {
                                          "ByteMatchStatement":{
                                              "PositionalConstraint":"EXACTLY",
                                              "TextTransformations":[
                                                  {
                                                      "Priority":0,
                                                      "Type":"NONE"
                                                  }
                                              ],
                                              "SearchString":"dGVzdHN0cmluZw==",
                                              "FieldToMatch":{
                                                  "UriPath":{

                                                  }
                                              }
                                          }
                                      },
                                      {
                                          "SizeConstraintStatement":{
                                              "ComparisonOperator":"EQ",
                                              "TextTransformations":[
                                                  {
                                                      "Priority":0,
                                                      "Type":"NONE"
                                                  }
                                              ],
                                              "FieldToMatch":{
                                                  "QueryString":{

                                                  }
                                              },
                                              "Size":0
                                          }
                                      }
                                  ]
                              }
                          }
                      }
                  ],
                  "VisibilityConfig":{
                      "SampledRequestsEnabled":true,
                      "CloudWatchMetricsEnabled":true,
                      "MetricName":"test01"
                  },
                  "DefaultAction":{
                      "Allow":{

                      }
                  },
                  "Id":"a1b2c3d4-5678-90ab-cdef-EXAMPLE11111",
                  "ARN":"arn:aws:wafv2:us-west-2:123456789012:regional/webacl/test01/a1b2c3d4-5678-90ab-cdef-EXAMPLE11111",
                  "Name":"test01"
              },
              "LockToken":"e3db7e2c-d58b-4ee6-8346-6aec5511c6fb"
          }

       For more information, see Managing and Using a Web Access Control  List
       (Web ACL) in the AWS WAF, AWS Firewall Manager, and AWS Shield Advanced
       Developer Guide.

OUTPUT
       WebACL -> (structure)
          The web ACL specification. You can modify the settings in  this  web
          ACL and use it to update this web ACL or create a new one.

          Name -> (string)
              The name of the web ACL. You cannot change the name of a web ACL
              after you create it.

          Id -> (string)
              A unique identifier for the WebACL . This ID is returned in  the
              responses  to  create  and  list commands. You use this ID to do
              things like get, update, and delete a WebACL .

          ARN -> (string)
              The Amazon Resource Name (ARN) of the web ACL that you  want  to
              associate with the resource.

          DefaultAction -> (structure)
              The  action to perform if none of the Rules contained in the We-
              bACL match.

              Block -> (structure)
                 Specifies that WAF should block requests by default.

                 CustomResponse -> (structure)
                     Defines a custom response for the web request.

                     For information about customizing web  requests  and  re-
                     sponses,  see  Customizing  web requests and responses in
                     WAF in the WAF Developer Guide .

                     ResponseCode -> (integer)
                        The HTTP status code to return to the client.

                        For a list of status codes that you can  use  in  your
                        custom  reqponses, see Supported status codes for cus-
                        tom response in the WAF Developer Guide .

                     CustomResponseBodyKey -> (string)
                        References the response body that you want WAF to  re-
                        turn  to the web request client. You can define a cus-
                        tom response for a rule action or a  default  web  ACL
                        action that is set to block. To do this, you first de-
                        fine the response body key and value in the  CustomRe-
                        sponseBodies  setting  for  the   WebACL or  RuleGroup
                        where you want to use it. Then, in the rule action  or
                        web ACL default action BlockAction setting, you refer-
                        ence the response body using this key.

                     ResponseHeaders -> (list)
                        The HTTP headers to use  in  the  response.  Duplicate
                        header names are not allowed.

                        For information about the limits on count and size for
                        custom request and response settings, see  WAF  quotas
                        in the WAF Developer Guide .

                        (structure)
                            A  custom  header  for custom request and response
                            handling. This  is  used  in   CustomResponse  and
                            CustomRequestHandling .

                            Name -> (string)
                               The name of the custom header.

                               For  custom  request header insertion, when WAF
                               inserts the header into the  request,  it  pre-
                               fixes  this  name x-amzn-waf- , to avoid confu-
                               sion with the headers that are already  in  the
                               request.  For example, for the header name sam-
                               ple , WAF inserts the header  x-amzn-waf-sample
                               .

                            Value -> (string)
                               The value of the custom header.

              Allow -> (structure)
                 Specifies that WAF should allow requests by default.

                 CustomRequestHandling -> (structure)
                     Defines custom handling for the web request.

                     For  information  about  customizing web requests and re-
                     sponses, see Customizing web requests  and  responses  in
                     WAF in the WAF Developer Guide .

                     InsertHeaders -> (list)
                        The HTTP headers to insert into the request. Duplicate
                        header names are not allowed.

                        For information about the limits on count and size for
                        custom  request  and response settings, see WAF quotas
                        in the WAF Developer Guide .

                        (structure)
                            A custom header for custom  request  and  response
                            handling.  This  is  used  in   CustomResponse and
                            CustomRequestHandling .

                            Name -> (string)
                               The name of the custom header.

                               For custom request header insertion,  when  WAF
                               inserts  the  header  into the request, it pre-
                               fixes this name x-amzn-waf- , to  avoid  confu-
                               sion  with  the headers that are already in the
                               request. For example, for the header name  sam-
                               ple  , WAF inserts the header x-amzn-waf-sample
                               .

                            Value -> (string)
                               The value of the custom header.

          Description -> (string)
              A description of the web ACL that helps with identification.

          Rules -> (list)
              The  Rule statements used to identify the web requests that  you
              want to allow, block, or count. Each rule includes one top-level
              statement that WAF uses to identify matching web  requests,  and
              parameters that govern how WAF handles them.

              (structure)
                 A  single  rule, which you can use in a  WebACL or  RuleGroup
                 to identify web requests that you want to  allow,  block,  or
                 count.  Each  rule includes one top-level  Statement that WAF
                 uses to identify matching web requests, and  parameters  that
                 govern how WAF handles them.

                 Name -> (string)
                     The name of the rule. You can't change the name of a Rule
                     after you create it.

                 Priority -> (integer)
                     If you define more than one Rule in a WebACL , WAF evalu-
                     ates each request against the Rules in order based on the
                     value of Priority . WAF processes rules with lower prior-
                     ity  first.  The priorities don't need to be consecutive,
                     but they must all be different.

                 Statement -> (structure)
                     The WAF processing statement for the  rule,  for  example
                     ByteMatchStatement or  SizeConstraintStatement .

                     ByteMatchStatement -> (structure)
                        A  rule  statement  that defines a string match search
                        for WAF to apply  to  web  requests.  The  byte  match
                        statement  provides the bytes to search for, the loca-
                        tion in requests that you  want  WAF  to  search,  and
                        other  settings. The bytes to search for are typically
                        a string that corresponds with  ASCII  characters.  In
                        the  WAF console and the developer guide, this is ref-
                        ered to as a string match statement.

                        SearchString -> (blob)
                            A string value that you want WAF  to  search  for.
                            WAF searches only in the part of web requests that
                            you designate for inspection  in   FieldToMatch  .
                            The maximum length of the value is 50 bytes.

                            Valid  values  depend  on  the  component that you
                            specify for inspection in FieldToMatch :

                            o Method : The HTTP method that you  want  WAF  to
                              search for. This indicates the type of operation
                              specified in the request.

                            o UriPath : The value that you want WAF to  search
                              for   in   the   URI  path,  for  example,  /im-
                              ages/daily-ad.jpg .

                            If SearchString includes alphabetic characters A-Z
                            and a-z, note that the value is case sensitive.
                               If you're using the WAF API

                            Specify a base64-encoded version of the value. The
                            maximum length of the value before you  base64-en-
                            code it is 50 bytes.

                            For  example,  suppose the value of Type is HEADER
                            and the value of Data is User-Agent . If you  want
                            to search the User-Agent header for the value Bad-
                            Bot  ,  you  base64-encode   BadBot   using   MIME
                            base64-encoding  and  include the resulting value,
                            QmFkQm90 , in the value of SearchString .
                               If you're using the CLI or one  of  the  Amazon
                               Web Services SDKs

                            The value that you want WAF to search for. The SDK
                            automatically base64 encodes the value.

                        FieldToMatch -> (structure)
                            The part of a web request that you want WAF to in-
                            spect. For more information, see  FieldToMatch .

                            SingleHeader -> (structure)
                               Inspect  a  single  header. Provide the name of
                               the header to inspect, for example,  User-Agent
                               or Referer . This setting isn't case sensitive.

                               Example   JSON:   "SingleHeader":   {   "Name":
                               "haystack" }

                               Name -> (string)
                                   The name of the query header to inspect.

                            SingleQueryArgument -> (structure)
                               Inspect a single query  argument.  Provide  the
                               name  of the query argument to inspect, such as
                               UserName or SalesRegion . The name can be up to
                               30 characters long and isn't case sensitive.

                               This  is  used only to indicate the web request
                               component for WAF to inspect,  in  the   Field-
                               ToMatch specification.

                               Example  JSON: "SingleQueryArgument": { "Name":
                               "myArgument" }

                               Name -> (string)
                                   The name of the query argument to inspect.

                            AllQueryArguments -> (structure)
                               Inspect all query arguments.

                            UriPath -> (structure)
                               Inspect the request URI path. This is the  part
                               of  a  web  request that identifies a resource,
                               for example, /images/daily-ad.jpg .

                            QueryString -> (structure)
                               Inspect the query string. This is the part of a
                               URL that appears after a ? character, if any.

                            Body -> (structure)
                               Inspect the request body as plain text. The re-
                               quest  body  immediately  follows  the  request
                               headers.  This  is  the  part of a request that
                               contains any additional data that you  want  to
                               send  to  your  web  server as the HTTP request
                               body, such as data from a form.

                               Note that only the first 8 KB (8192  bytes)  of
                               the  request  body are forwarded to WAF for in-
                               spection by the underlying host service. If you
                               don't  need  to inspect more than 8 KB, you can
                               guarantee that you don't allow additional bytes
                               in  by  combining a statement that inspects the
                               body of the web request,  such  as   ByteMatch-
                               Statement or  RegexPatternSetReferenceStatement
                               , with a  SizeConstraintStatement that enforces
                               an  8 KB size limit on the body of the request.
                               WAF doesn't support inspecting the entire  con-
                               tents of web requests whose bodies exceed the 8
                               KB limit.

                            Method -> (structure)
                               Inspect the HTTP method. The  method  indicates
                               the  type of operation that the request is ask-
                               ing the origin to perform.

                            JsonBody -> (structure)
                               Inspect the request body as JSON.  The  request
                               body  immediately  follows the request headers.
                               This is the part of a request that contains any
                               additional  data  that you want to send to your
                               web server as the HTTP request  body,  such  as
                               data from a form.

                               Note  that  only the first 8 KB (8192 bytes) of
                               the request body are forwarded to WAF  for  in-
                               spection by the underlying host service. If you
                               don't need to inspect more than 8 KB,  you  can
                               guarantee that you don't allow additional bytes
                               in by combining a statement that  inspects  the
                               body  of  the  web request, such as  ByteMatch-
                               Statement or  RegexPatternSetReferenceStatement
                               , with a  SizeConstraintStatement that enforces
                               an 8 KB size limit on the body of the  request.
                               WAF  doesn't support inspecting the entire con-
                               tents of web requests whose bodies exceed the 8
                               KB limit.

                               MatchPattern -> (structure)
                                   The  patterns to look for in the JSON body.
                                   WAF inspects the results of  these  pattern
                                   matches  against the rule inspection crite-
                                   ria.

                                   All -> (structure)
                                      Match all  of  the  elements.  See  also
                                      MatchScope in  JsonBody .

                                      You  must specify either this setting or
                                      the IncludedPaths setting, but not both.

                                   IncludedPaths -> (list)
                                      Match only the specified include  paths.
                                      See also MatchScope in  JsonBody .

                                      Provide  the  include  paths  using JSON
                                      Pointer syntax. For example,  "Included-
                                      Paths": ["/dogs/0/name", "/dogs/1/name"]
                                      . For information about this syntax, see
                                      the   Internet  Engineering  Task  Force
                                      (IETF) documentation  JavaScript  Object
                                      Notation (JSON) Pointer .

                                      You  must specify either this setting or
                                      the All setting, but not both.

                                      NOTE:
                                          Don't use this option to include all
                                          paths. Instead, use the All setting.

                                      (string)

                               MatchScope -> (string)
                                   The  parts of the JSON to match against us-
                                   ing the MatchPattern . If you specify All ,
                                   WAF matches against keys and values.

                               InvalidFallbackBehavior -> (string)
                                   What  WAF  should  do  if  it fails to com-
                                   pletely parse the JSON  body.  The  options
                                   are the following:

                                   o EVALUATE_AS_STRING  - Inspect the body as
                                     plain text. WAF applies the  text  trans-
                                     formations  and  inspection criteria that
                                     you defined for the  JSON  inspection  to
                                     the body text string.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                                   If you  don't  provide  this  setting,  WAF
                                   parses and evaluates the content only up to
                                   the first parsing failure that  it  encoun-
                                   ters.

                                   WAF  does its best to parse the entire JSON
                                   body, but might be forced to stop for  rea-
                                   sons  such as invalid characters, duplicate
                                   keys, truncation,  and  any  content  whose
                                   root node isn't an object or an array.

                                   WAF  parses the JSON in the following exam-
                                   ples as two valid key, value pairs:

                                   o Missing                            comma:
                                     {"key1":"value1""key2":"value2"}

                                   o Missing                            colon:
                                     {"key1":"value1","key2""value2"}

                                   o Extra                             colons:
                                     {"key1"::"value1","key2""value2"}

                        TextTransformations -> (list)
                            Text transformations eliminate some of the unusual
                            formatting that attackers use in web  requests  in
                            an  effort to bypass detection. If you specify one
                            or more transformations in a rule  statement,  WAF
                            performs all transformations on the content of the
                            request component  identified  by  FieldToMatch  ,
                            starting  from the lowest priority setting, before
                            inspecting the content for a match.

                            (structure)
                               Text transformations eliminate some of the  un-
                               usual  formatting that attackers use in web re-
                               quests in an effort to bypass detection.

                               Priority -> (integer)
                                   Sets the relative processing order for mul-
                                   tiple  transformations that are defined for
                                   a rule statement. WAF processes all  trans-
                                   formations,  from  lowest priority to high-
                                   est, before inspecting the transformed con-
                                   tent.  The priorities don't need to be con-
                                   secutive, but they must all be different.

                               Type -> (string)
                                   You can specify the  following  transforma-
                                   tion types:
                                      BASE64_DECODE - Decode a Base64 -encoded
                                      string.

                                      BASE64_DECODE_EXT - Decode a Base64 -en-
                                      coded string, but use a forgiving imple-
                                      mentation that ignores  characters  that
                                      aren't valid.

                                      CMD_LINE - Command-line transformations.
                                      These are helpful in reducing effective-
                                      ness  of attackers who inject an operat-
                                      ing system command-line command and  use
                                      unusual  formatting  to disguise some or
                                      all of the command.

                                   o Delete the following characters: \ " ' ^

                                   o Delete spaces before the following  char-
                                     acters: / (

                                   o Replace  the  following characters with a
                                     space: , ;

                                   o Replace multiple spaces with one space

                                   o Convert uppercase letters (A-Z) to lower-
                                     case (a-z)
                                      COMPRESS_WHITE_SPACE   -  Replace  these
                                      characters with a space character (deci-
                                      mal 32):

                                   o \f , formfeed, decimal 12

                                   o \t , tab, decimal 9

                                   o \n , newline, decimal 10

                                   o \r , carriage return, decimal 13

                                   o \v , vertical tab, decimal 11

                                   o Non-breaking space, decimal 160
                                      COMPRESS_WHITE_SPACE  also replaces mul-
                                      tiple spaces with one space.

                                      CSS_DECODE - Decode characters that were
                                      encoded  using CSS 2.x escape rules syn-
                                      data.html#characters  .  This   function
                                      uses  up  to  two  bytes in the decoding
                                      process, so it can help to uncover ASCII
                                      characters  that  were encoded using CSS
                                      encoding that wouldnt typically  be  en-
                                      coded.  It's  also  useful in countering
                                      evasion, which is  a  combination  of  a
                                      backslash  and  non-hexadecimal  charac-
                                      ters. For example, ja\vascript for java-
                                      script.

                                      ESCAPE_SEQ_DECODE - Decode the following
                                      ANSI C escape sequences: \a , \b , \f  ,
                                      \n  , \r , \t , \v , \\ , \? , \' , \" ,
                                      \xHH (hexadecimal), \0OOO  (octal).  En-
                                      codings  that aren't valid remain in the
                                      output.

                                      HEX_DECODE - Decode a string of hexadec-
                                      imal characters into a binary.

                                      HTML_ENTITY_DECODE  -  Replace  HTML-en-
                                      coded characters with unencoded  charac-
                                      ters.  HTML_ENTITY_DECODE performs these
                                      operations:

                                   o Replaces (ampersand)quot; with "

                                   o Replaces    (ampersand)nbsp;    with    a
                                     non-breaking space, decimal 160

                                   o Replaces   (ampersand)lt;  with  a  "less
                                     than" symbol

                                   o Replaces (ampersand)gt; with >

                                   o Replaces characters that are  represented
                                     in hexadecimal format, (ampersand)#xhhhh;
                                     , with the corresponding characters

                                   o Replaces characters that are  represented
                                     in  decimal  format,  (ampersand)#nnnn; ,
                                     with the corresponding characters
                                      JS_DECODE - Decode JavaScript escape se-
                                      quences.  If a \  u  HHHH code is in the
                                      full-width ASCII code range of FF01-FF5E
                                      , then the higher byte is used to detect
                                      and adjust the lower byte. If not,  only
                                      the  lower  byte  is used and the higher
                                      byte is zeroed, causing a possible  loss
                                      of information.

                                      LOWERCASE  -  Convert  uppercase letters
                                      (A-Z) to lowercase (a-z).

                                      MD5 - Calculate an  MD5  hash  from  the
                                      data  in the input. The computed hash is
                                      in a raw binary form.

                                      NONE - Specify NONE if  you  don't  want
                                      any text transformations.

                                      NORMALIZE_PATH    -    Remove   multiple
                                      slashes, directory self-references,  and
                                      directory  back-references  that are not
                                      at the beginning of the  input  from  an
                                      input string.

                                      NORMALIZE_PATH_WIN - This is the same as
                                      NORMALIZE_PATH  ,  but  first   converts
                                      backslash characters to forward slashes.

                                      REMOVE_NULLS  -  Remove  all  NULL bytes
                                      from the input.

                                      REPLACE_COMMENTS - Replace  each  occur-
                                      rence  of a C-style comment (/* ... */ )
                                      with a single space.  Multiple  consecu-
                                      tive occurrences are not compressed. Un-
                                      terminated comments  are  also  replaced
                                      with  a  space  (ASCII 0x20). However, a
                                      standalone termination of a comment  (*/
                                      ) is not acted upon.

                                      REPLACE_NULLS  -  Replace  NULL bytes in
                                      the input with space  characters  (ASCII
                                      0x20 ).

                                      SQL_HEX_DECODE  -  Decode  SQL hex data.
                                      Example (0x414243 ) will be  decoded  to
                                      (ABC ).

                                      URL_DECODE - Decode a URL-encoded value.

                                      URL_DECODE_UNI  -  Like URL_DECODE , but
                                      with support for  Microsoft-specific  %u
                                      encoding.   If   the   code  is  in  the
                                      full-width ASCII code range of FF01-FF5E
                                      ,  the higher byte is used to detect and
                                      adjust the lower byte.  Otherwise,  only
                                      the  lower  byte  is used and the higher
                                      byte is zeroed.

                                      UTF8_TO_UNICODE  -  Convert  all   UTF-8
                                      character  sequences  to  Unicode.  This
                                      helps input normalization, and  minimiz-
                                      ing  false-positives and false-negatives
                                      for non-English languages.

                        PositionalConstraint -> (string)
                            The area within the portion of a web request  that
                            you  want  WAF  to search for SearchString . Valid
                            values include the following:
                               CONTAINS

                            The specified part of the web request must include
                            the  value  of  SearchString  ,  but  the location
                            doesn't matter.
                               CONTAINS_WORD

                            The specified part of the web request must include
                            the  value of SearchString , and SearchString must
                            contain only alphanumeric characters or underscore
                            (A-Z,  a-z,  0-9, or _). In addition, SearchString
                            must be a word, which means that both of the  fol-
                            lowing are true:

                            o SearchString  is  at the beginning of the speci-
                              fied part of the web request or is preceded by a
                              character  other  than an alphanumeric character
                              or underscore (_). Examples include the value of
                              a header and ;BadBot .

                            o SearchString is at the end of the specified part
                              of the web request or is followed by a character
                              other  than  an alphanumeric character or under-
                              score (_), for example, BadBot; and -BadBot; .
                               EXACTLY

                            The value of the specified part of the web request
                            must exactly match the value of SearchString .
                               STARTS_WITH

                            The  value  of SearchString must appear at the be-
                            ginning of the specified part of the web request.
                               ENDS_WITH

                            The value of SearchString must appear at  the  end
                            of the specified part of the web request.

                     SqliMatchStatement -> (structure)
                        Attackers sometimes insert malicious SQL code into web
                        requests in an effort to extract data from your  data-
                        base.  To  allow  or block web requests that appear to
                        contain malicious SQL code, create one or more SQL in-
                        jection  match conditions. An SQL injection match con-
                        dition identifies the part of web  requests,  such  as
                        the  URI or the query string, that you want WAF to in-
                        spect. Later in the process, when  you  create  a  web
                        ACL,  you  specify  whether to allow or block requests
                        that appear to contain malicious SQL code.

                        FieldToMatch -> (structure)
                            The part of a web request that you want WAF to in-
                            spect. For more information, see  FieldToMatch .

                            SingleHeader -> (structure)
                               Inspect  a  single  header. Provide the name of
                               the header to inspect, for example,  User-Agent
                               or Referer . This setting isn't case sensitive.

                               Example   JSON:   "SingleHeader":   {   "Name":
                               "haystack" }

                               Name -> (string)
                                   The name of the query header to inspect.

                            SingleQueryArgument -> (structure)
                               Inspect a single query  argument.  Provide  the
                               name  of the query argument to inspect, such as
                               UserName or SalesRegion . The name can be up to
                               30 characters long and isn't case sensitive.

                               This  is  used only to indicate the web request
                               component for WAF to inspect,  in  the   Field-
                               ToMatch specification.

                               Example  JSON: "SingleQueryArgument": { "Name":
                               "myArgument" }

                               Name -> (string)
                                   The name of the query argument to inspect.

                            AllQueryArguments -> (structure)
                               Inspect all query arguments.

                            UriPath -> (structure)
                               Inspect the request URI path. This is the  part
                               of  a  web  request that identifies a resource,
                               for example, /images/daily-ad.jpg .

                            QueryString -> (structure)
                               Inspect the query string. This is the part of a
                               URL that appears after a ? character, if any.

                            Body -> (structure)
                               Inspect the request body as plain text. The re-
                               quest  body  immediately  follows  the  request
                               headers.  This  is  the  part of a request that
                               contains any additional data that you  want  to
                               send  to  your  web  server as the HTTP request
                               body, such as data from a form.

                               Note that only the first 8 KB (8192  bytes)  of
                               the  request  body are forwarded to WAF for in-
                               spection by the underlying host service. If you
                               don't  need  to inspect more than 8 KB, you can
                               guarantee that you don't allow additional bytes
                               in  by  combining a statement that inspects the
                               body of the web request,  such  as   ByteMatch-
                               Statement or  RegexPatternSetReferenceStatement
                               , with a  SizeConstraintStatement that enforces
                               an  8 KB size limit on the body of the request.
                               WAF doesn't support inspecting the entire  con-
                               tents of web requests whose bodies exceed the 8
                               KB limit.

                            Method -> (structure)
                               Inspect the HTTP method. The  method  indicates
                               the  type of operation that the request is ask-
                               ing the origin to perform.

                            JsonBody -> (structure)
                               Inspect the request body as JSON.  The  request
                               body  immediately  follows the request headers.
                               This is the part of a request that contains any
                               additional  data  that you want to send to your
                               web server as the HTTP request  body,  such  as
                               data from a form.

                               Note  that  only the first 8 KB (8192 bytes) of
                               the request body are forwarded to WAF  for  in-
                               spection by the underlying host service. If you
                               don't need to inspect more than 8 KB,  you  can
                               guarantee that you don't allow additional bytes
                               in by combining a statement that  inspects  the
                               body  of  the  web request, such as  ByteMatch-
                               Statement or  RegexPatternSetReferenceStatement
                               , with a  SizeConstraintStatement that enforces
                               an 8 KB size limit on the body of the  request.
                               WAF  doesn't support inspecting the entire con-
                               tents of web requests whose bodies exceed the 8
                               KB limit.

                               MatchPattern -> (structure)
                                   The  patterns to look for in the JSON body.
                                   WAF inspects the results of  these  pattern
                                   matches  against the rule inspection crite-
                                   ria.

                                   All -> (structure)
                                      Match all  of  the  elements.  See  also
                                      MatchScope in  JsonBody .

                                      You  must specify either this setting or
                                      the IncludedPaths setting, but not both.

                                   IncludedPaths -> (list)
                                      Match only the specified include  paths.
                                      See also MatchScope in  JsonBody .

                                      Provide  the  include  paths  using JSON
                                      Pointer syntax. For example,  "Included-
                                      Paths": ["/dogs/0/name", "/dogs/1/name"]
                                      . For information about this syntax, see
                                      the   Internet  Engineering  Task  Force
                                      (IETF) documentation  JavaScript  Object
                                      Notation (JSON) Pointer .

                                      You  must specify either this setting or
                                      the All setting, but not both.

                                      NOTE:
                                          Don't use this option to include all
                                          paths. Instead, use the All setting.

                                      (string)

                               MatchScope -> (string)
                                   The  parts of the JSON to match against us-
                                   ing the MatchPattern . If you specify All ,
                                   WAF matches against keys and values.

                               InvalidFallbackBehavior -> (string)
                                   What  WAF  should  do  if  it fails to com-
                                   pletely parse the JSON  body.  The  options
                                   are the following:

                                   o EVALUATE_AS_STRING  - Inspect the body as
                                     plain text. WAF applies the  text  trans-
                                     formations  and  inspection criteria that
                                     you defined for the  JSON  inspection  to
                                     the body text string.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                                   If you  don't  provide  this  setting,  WAF
                                   parses and evaluates the content only up to
                                   the first parsing failure that  it  encoun-
                                   ters.

                                   WAF  does its best to parse the entire JSON
                                   body, but might be forced to stop for  rea-
                                   sons  such as invalid characters, duplicate
                                   keys, truncation,  and  any  content  whose
                                   root node isn't an object or an array.

                                   WAF  parses the JSON in the following exam-
                                   ples as two valid key, value pairs:

                                   o Missing                            comma:
                                     {"key1":"value1""key2":"value2"}

                                   o Missing                            colon:
                                     {"key1":"value1","key2""value2"}

                                   o Extra                             colons:
                                     {"key1"::"value1","key2""value2"}

                        TextTransformations -> (list)
                            Text transformations eliminate some of the unusual
                            formatting that attackers use in web  requests  in
                            an  effort to bypass detection. If you specify one
                            or more transformations in a rule  statement,  WAF
                            performs all transformations on the content of the
                            request component  identified  by  FieldToMatch  ,
                            starting  from the lowest priority setting, before
                            inspecting the content for a match.

                            (structure)
                               Text transformations eliminate some of the  un-
                               usual  formatting that attackers use in web re-
                               quests in an effort to bypass detection.

                               Priority -> (integer)
                                   Sets the relative processing order for mul-
                                   tiple  transformations that are defined for
                                   a rule statement. WAF processes all  trans-
                                   formations,  from  lowest priority to high-
                                   est, before inspecting the transformed con-
                                   tent.  The priorities don't need to be con-
                                   secutive, but they must all be different.

                               Type -> (string)
                                   You can specify the  following  transforma-
                                   tion types:
                                      BASE64_DECODE - Decode a Base64 -encoded
                                      string.

                                      BASE64_DECODE_EXT - Decode a Base64 -en-
                                      coded string, but use a forgiving imple-
                                      mentation that ignores  characters  that
                                      aren't valid.

                                      CMD_LINE - Command-line transformations.
                                      These are helpful in reducing effective-
                                      ness  of attackers who inject an operat-
                                      ing system command-line command and  use
                                      unusual  formatting  to disguise some or
                                      all of the command.

                                   o Delete the following characters: \ " ' ^

                                   o Delete spaces before the following  char-
                                     acters: / (

                                   o Replace  the  following characters with a
                                     space: , ;

                                   o Replace multiple spaces with one space

                                   o Convert uppercase letters (A-Z) to lower-
                                     case (a-z)
                                      COMPRESS_WHITE_SPACE   -  Replace  these
                                      characters with a space character (deci-
                                      mal 32):

                                   o \f , formfeed, decimal 12

                                   o \t , tab, decimal 9

                                   o \n , newline, decimal 10

                                   o \r , carriage return, decimal 13

                                   o \v , vertical tab, decimal 11

                                   o Non-breaking space, decimal 160
                                      COMPRESS_WHITE_SPACE  also replaces mul-
                                      tiple spaces with one space.

                                      CSS_DECODE - Decode characters that were
                                      encoded  using CSS 2.x escape rules syn-
                                      data.html#characters  .  This   function
                                      uses  up  to  two  bytes in the decoding
                                      process, so it can help to uncover ASCII
                                      characters  that  were encoded using CSS
                                      encoding that wouldnt typically  be  en-
                                      coded.  It's  also  useful in countering
                                      evasion, which is  a  combination  of  a
                                      backslash  and  non-hexadecimal  charac-
                                      ters. For example, ja\vascript for java-
                                      script.

                                      ESCAPE_SEQ_DECODE - Decode the following
                                      ANSI C escape sequences: \a , \b , \f  ,
                                      \n  , \r , \t , \v , \\ , \? , \' , \" ,
                                      \xHH (hexadecimal), \0OOO  (octal).  En-
                                      codings  that aren't valid remain in the
                                      output.

                                      HEX_DECODE - Decode a string of hexadec-
                                      imal characters into a binary.

                                      HTML_ENTITY_DECODE  -  Replace  HTML-en-
                                      coded characters with unencoded  charac-
                                      ters.  HTML_ENTITY_DECODE performs these
                                      operations:

                                   o Replaces (ampersand)quot; with "

                                   o Replaces    (ampersand)nbsp;    with    a
                                     non-breaking space, decimal 160

                                   o Replaces   (ampersand)lt;  with  a  "less
                                     than" symbol

                                   o Replaces (ampersand)gt; with >

                                   o Replaces characters that are  represented
                                     in hexadecimal format, (ampersand)#xhhhh;
                                     , with the corresponding characters

                                   o Replaces characters that are  represented
                                     in  decimal  format,  (ampersand)#nnnn; ,
                                     with the corresponding characters
                                      JS_DECODE - Decode JavaScript escape se-
                                      quences.  If a \  u  HHHH code is in the
                                      full-width ASCII code range of FF01-FF5E
                                      , then the higher byte is used to detect
                                      and adjust the lower byte. If not,  only
                                      the  lower  byte  is used and the higher
                                      byte is zeroed, causing a possible  loss
                                      of information.

                                      LOWERCASE  -  Convert  uppercase letters
                                      (A-Z) to lowercase (a-z).

                                      MD5 - Calculate an  MD5  hash  from  the
                                      data  in the input. The computed hash is
                                      in a raw binary form.

                                      NONE - Specify NONE if  you  don't  want
                                      any text transformations.

                                      NORMALIZE_PATH    -    Remove   multiple
                                      slashes, directory self-references,  and
                                      directory  back-references  that are not
                                      at the beginning of the  input  from  an
                                      input string.

                                      NORMALIZE_PATH_WIN - This is the same as
                                      NORMALIZE_PATH  ,  but  first   converts
                                      backslash characters to forward slashes.

                                      REMOVE_NULLS  -  Remove  all  NULL bytes
                                      from the input.

                                      REPLACE_COMMENTS - Replace  each  occur-
                                      rence  of a C-style comment (/* ... */ )
                                      with a single space.  Multiple  consecu-
                                      tive occurrences are not compressed. Un-
                                      terminated comments  are  also  replaced
                                      with  a  space  (ASCII 0x20). However, a
                                      standalone termination of a comment  (*/
                                      ) is not acted upon.

                                      REPLACE_NULLS  -  Replace  NULL bytes in
                                      the input with space  characters  (ASCII
                                      0x20 ).

                                      SQL_HEX_DECODE  -  Decode  SQL hex data.
                                      Example (0x414243 ) will be  decoded  to
                                      (ABC ).

                                      URL_DECODE - Decode a URL-encoded value.

                                      URL_DECODE_UNI  -  Like URL_DECODE , but
                                      with support for  Microsoft-specific  %u
                                      encoding.   If   the   code  is  in  the
                                      full-width ASCII code range of FF01-FF5E
                                      ,  the higher byte is used to detect and
                                      adjust the lower byte.  Otherwise,  only
                                      the  lower  byte  is used and the higher
                                      byte is zeroed.

                                      UTF8_TO_UNICODE  -  Convert  all   UTF-8
                                      character  sequences  to  Unicode.  This
                                      helps input normalization, and  minimiz-
                                      ing  false-positives and false-negatives
                                      for non-English languages.

                     XssMatchStatement -> (structure)
                        A rule statement that defines a  cross-site  scripting
                        (XSS)  match  search for WAF to apply to web requests.
                        XSS attacks are those where the attacker uses vulnera-
                        bilities  in  a  benign website as a vehicle to inject
                        malicious client-site scripts  into  other  legitimate
                        web browsers. The XSS match statement provides the lo-
                        cation in requests that you want  WAF  to  search  and
                        text  transformations to use on the search area before
                        WAF searches for character sequences that  are  likely
                        to be malicious strings.

                        FieldToMatch -> (structure)
                            The part of a web request that you want WAF to in-
                            spect. For more information, see  FieldToMatch .

                            SingleHeader -> (structure)
                               Inspect a single header. Provide  the  name  of
                               the  header to inspect, for example, User-Agent
                               or Referer . This setting isn't case sensitive.

                               Example   JSON:   "SingleHeader":   {   "Name":
                               "haystack" }

                               Name -> (string)
                                   The name of the query header to inspect.

                            SingleQueryArgument -> (structure)
                               Inspect  a  single  query argument. Provide the
                               name of the query argument to inspect, such  as
                               UserName or SalesRegion . The name can be up to
                               30 characters long and isn't case sensitive.

                               This is used only to indicate the  web  request
                               component  for  WAF  to inspect, in the  Field-
                               ToMatch specification.

                               Example JSON: "SingleQueryArgument": {  "Name":
                               "myArgument" }

                               Name -> (string)
                                   The name of the query argument to inspect.

                            AllQueryArguments -> (structure)
                               Inspect all query arguments.

                            UriPath -> (structure)
                               Inspect  the request URI path. This is the part
                               of a web request that  identifies  a  resource,
                               for example, /images/daily-ad.jpg .

                            QueryString -> (structure)
                               Inspect the query string. This is the part of a
                               URL that appears after a ? character, if any.

                            Body -> (structure)
                               Inspect the request body as plain text. The re-
                               quest  body  immediately  follows  the  request
                               headers. This is the part  of  a  request  that
                               contains  any  additional data that you want to
                               send to your web server  as  the  HTTP  request
                               body, such as data from a form.

                               Note  that  only the first 8 KB (8192 bytes) of
                               the request body are forwarded to WAF  for  in-
                               spection by the underlying host service. If you
                               don't need to inspect more than 8 KB,  you  can
                               guarantee that you don't allow additional bytes
                               in by combining a statement that  inspects  the
                               body  of  the  web request, such as  ByteMatch-
                               Statement or  RegexPatternSetReferenceStatement
                               , with a  SizeConstraintStatement that enforces
                               an 8 KB size limit on the body of the  request.
                               WAF  doesn't support inspecting the entire con-
                               tents of web requests whose bodies exceed the 8
                               KB limit.

                            Method -> (structure)
                               Inspect  the  HTTP method. The method indicates
                               the type of operation that the request is  ask-
                               ing the origin to perform.

                            JsonBody -> (structure)
                               Inspect  the  request body as JSON. The request
                               body immediately follows the  request  headers.
                               This is the part of a request that contains any
                               additional data that you want to send  to  your
                               web  server  as  the HTTP request body, such as
                               data from a form.

                               Note that only the first 8 KB (8192  bytes)  of
                               the  request  body are forwarded to WAF for in-
                               spection by the underlying host service. If you
                               don't  need  to inspect more than 8 KB, you can
                               guarantee that you don't allow additional bytes
                               in  by  combining a statement that inspects the
                               body of the web request,  such  as   ByteMatch-
                               Statement or  RegexPatternSetReferenceStatement
                               , with a  SizeConstraintStatement that enforces
                               an  8 KB size limit on the body of the request.
                               WAF doesn't support inspecting the entire  con-
                               tents of web requests whose bodies exceed the 8
                               KB limit.

                               MatchPattern -> (structure)
                                   The patterns to look for in the JSON  body.
                                   WAF  inspects  the results of these pattern
                                   matches against the rule inspection  crite-
                                   ria.

                                   All -> (structure)
                                      Match  all  of  the  elements.  See also
                                      MatchScope in  JsonBody .

                                      You must specify either this setting  or
                                      the IncludedPaths setting, but not both.

                                   IncludedPaths -> (list)
                                      Match  only the specified include paths.
                                      See also MatchScope in  JsonBody .

                                      Provide the  include  paths  using  JSON
                                      Pointer  syntax. For example, "Included-
                                      Paths": ["/dogs/0/name", "/dogs/1/name"]
                                      . For information about this syntax, see
                                      the  Internet  Engineering  Task   Force
                                      (IETF)  documentation  JavaScript Object
                                      Notation (JSON) Pointer .

                                      You must specify either this setting  or
                                      the All setting, but not both.

                                      NOTE:
                                          Don't use this option to include all
                                          paths. Instead, use the All setting.

                                      (string)

                               MatchScope -> (string)
                                   The parts of the JSON to match against  us-
                                   ing the MatchPattern . If you specify All ,
                                   WAF matches against keys and values.

                               InvalidFallbackBehavior -> (string)
                                   What WAF should do  if  it  fails  to  com-
                                   pletely  parse  the  JSON body. The options
                                   are the following:

                                   o EVALUATE_AS_STRING - Inspect the body  as
                                     plain  text.  WAF applies the text trans-
                                     formations and inspection  criteria  that
                                     you  defined  for  the JSON inspection to
                                     the body text string.

                                   o MATCH - Treat the web request as matching
                                     the  rule statement. WAF applies the rule
                                     action to the request.

                                   o NO_MATCH - Treat the web request  as  not
                                     matching the rule statement.

                                   If  you  don't  provide  this  setting, WAF
                                   parses and evaluates the content only up to
                                   the  first  parsing failure that it encoun-
                                   ters.

                                   WAF does its best to parse the entire  JSON
                                   body,  but might be forced to stop for rea-
                                   sons such as invalid characters,  duplicate
                                   keys,  truncation,  and  any  content whose
                                   root node isn't an object or an array.

                                   WAF parses the JSON in the following  exam-
                                   ples as two valid key, value pairs:

                                   o Missing                            comma:
                                     {"key1":"value1""key2":"value2"}

                                   o Missing                            colon:
                                     {"key1":"value1","key2""value2"}

                                   o Extra                             colons:
                                     {"key1"::"value1","key2""value2"}

                        TextTransformations -> (list)
                            Text transformations eliminate some of the unusual
                            formatting  that  attackers use in web requests in
                            an effort to bypass detection. If you specify  one
                            or  more  transformations in a rule statement, WAF
                            performs all transformations on the content of the
                            request  component  identified  by  FieldToMatch ,
                            starting from the lowest priority setting,  before
                            inspecting the content for a match.

                            (structure)
                               Text  transformations eliminate some of the un-
                               usual formatting that attackers use in web  re-
                               quests in an effort to bypass detection.

                               Priority -> (integer)
                                   Sets the relative processing order for mul-
                                   tiple transformations that are defined  for
                                   a  rule statement. WAF processes all trans-
                                   formations, from lowest priority  to  high-
                                   est, before inspecting the transformed con-
                                   tent. The priorities don't need to be  con-
                                   secutive, but they must all be different.

                               Type -> (string)
                                   You  can  specify the following transforma-
                                   tion types:
                                      BASE64_DECODE - Decode a Base64 -encoded
                                      string.

                                      BASE64_DECODE_EXT - Decode a Base64 -en-
                                      coded string, but use a forgiving imple-
                                      mentation  that  ignores characters that
                                      aren't valid.

                                      CMD_LINE - Command-line transformations.
                                      These are helpful in reducing effective-
                                      ness of attackers who inject an  operat-
                                      ing  system command-line command and use
                                      unusual formatting to disguise  some  or
                                      all of the command.

                                   o Delete the following characters: \ " ' ^

                                   o Delete  spaces before the following char-
                                     acters: / (

                                   o Replace the following characters  with  a
                                     space: , ;

                                   o Replace multiple spaces with one space

                                   o Convert uppercase letters (A-Z) to lower-
                                     case (a-z)
                                      COMPRESS_WHITE_SPACE  -  Replace   these
                                      characters with a space character (deci-
                                      mal 32):

                                   o \f , formfeed, decimal 12

                                   o \t , tab, decimal 9

                                   o \n , newline, decimal 10

                                   o \r , carriage return, decimal 13

                                   o \v , vertical tab, decimal 11

                                   o Non-breaking space, decimal 160
                                      COMPRESS_WHITE_SPACE also replaces  mul-
                                      tiple spaces with one space.

                                      CSS_DECODE - Decode characters that were
                                      encoded using CSS 2.x escape rules  syn-
                                      data.html#characters   .  This  function
                                      uses up to two  bytes  in  the  decoding
                                      process, so it can help to uncover ASCII
                                      characters that were encoded  using  CSS
                                      encoding  that  wouldnt typically be en-
                                      coded. It's also  useful  in  countering
                                      evasion,  which  is  a  combination of a
                                      backslash  and  non-hexadecimal  charac-
                                      ters. For example, ja\vascript for java-
                                      script.

                                      ESCAPE_SEQ_DECODE - Decode the following
                                      ANSI  C escape sequences: \a , \b , \f ,
                                      \n , \r , \t , \v , \\ , \? , \' , \"  ,
                                      \xHH  (hexadecimal),  \0OOO (octal). En-
                                      codings that aren't valid remain in  the
                                      output.

                                      HEX_DECODE - Decode a string of hexadec-
                                      imal characters into a binary.

                                      HTML_ENTITY_DECODE  -  Replace  HTML-en-
                                      coded  characters with unencoded charac-
                                      ters. HTML_ENTITY_DECODE performs  these
                                      operations:

                                   o Replaces (ampersand)quot; with "

                                   o Replaces    (ampersand)nbsp;    with    a
                                     non-breaking space, decimal 160

                                   o Replaces  (ampersand)lt;  with  a   "less
                                     than" symbol

                                   o Replaces (ampersand)gt; with >

                                   o Replaces  characters that are represented
                                     in hexadecimal format, (ampersand)#xhhhh;
                                     , with the corresponding characters

                                   o Replaces  characters that are represented
                                     in decimal  format,  (ampersand)#nnnn;  ,
                                     with the corresponding characters
                                      JS_DECODE - Decode JavaScript escape se-
                                      quences. If a \  u  HHHH code is in  the
                                      full-width ASCII code range of FF01-FF5E
                                      , then the higher byte is used to detect
                                      and  adjust the lower byte. If not, only
                                      the lower byte is used  and  the  higher
                                      byte  is zeroed, causing a possible loss
                                      of information.

                                      LOWERCASE -  Convert  uppercase  letters
                                      (A-Z) to lowercase (a-z).

                                      MD5  -  Calculate  an  MD5 hash from the
                                      data in the input. The computed hash  is
                                      in a raw binary form.

                                      NONE  -  Specify  NONE if you don't want
                                      any text transformations.

                                      NORMALIZE_PATH   -    Remove    multiple
                                      slashes,  directory self-references, and
                                      directory back-references that  are  not
                                      at  the  beginning  of the input from an
                                      input string.

                                      NORMALIZE_PATH_WIN - This is the same as
                                      NORMALIZE_PATH   ,  but  first  converts
                                      backslash characters to forward slashes.

                                      REMOVE_NULLS -  Remove  all  NULL  bytes
                                      from the input.

                                      REPLACE_COMMENTS  -  Replace each occur-
                                      rence of a C-style comment (/* ... */  )
                                      with  a  single space. Multiple consecu-
                                      tive occurrences are not compressed. Un-
                                      terminated  comments  are  also replaced
                                      with a space (ASCII  0x20).  However,  a
                                      standalone  termination of a comment (*/
                                      ) is not acted upon.

                                      REPLACE_NULLS - Replace  NULL  bytes  in
                                      the  input  with space characters (ASCII
                                      0x20 ).

                                      SQL_HEX_DECODE - Decode  SQL  hex  data.
                                      Example  (0x414243  ) will be decoded to
                                      (ABC ).

                                      URL_DECODE - Decode a URL-encoded value.

                                      URL_DECODE_UNI - Like URL_DECODE  ,  but
                                      with  support  for Microsoft-specific %u
                                      encoding.  If  the  code   is   in   the
                                      full-width ASCII code range of FF01-FF5E
                                      , the higher byte is used to detect  and
                                      adjust  the  lower byte. Otherwise, only
                                      the lower byte is used  and  the  higher
                                      byte is zeroed.

                                      UTF8_TO_UNICODE   -  Convert  all  UTF-8
                                      character  sequences  to  Unicode.  This
                                      helps  input normalization, and minimiz-
                                      ing false-positives and  false-negatives
                                      for non-English languages.

                     SizeConstraintStatement -> (structure)
                        A  rule  statement  that  compares  a  number of bytes
                        against the size of a request component, using a  com-
                        parison  operator,  such  as  greater than (>) or less
                        than (<). For example, you can use a  size  constraint
                        statement  to  look  for query strings that are longer
                        than 100 bytes.

                        If you configure WAF to inspect the request body,  WAF
                        inspects  only the first 8192 bytes (8 KB). If the re-
                        quest body for your web requests  never  exceeds  8192
                        bytes,  you can create a size constraint condition and
                        block requests that have a request body  greater  than
                        8192 bytes.

                        If you choose URI for the value of Part of the request
                        to filter on, the slash (/) in the URI counts  as  one
                        character.  For  example,  the  URI  /logo.jpg is nine
                        characters long.

                        FieldToMatch -> (structure)
                            The part of a web request that you want WAF to in-
                            spect. For more information, see  FieldToMatch .

                            SingleHeader -> (structure)
                               Inspect  a  single  header. Provide the name of
                               the header to inspect, for example,  User-Agent
                               or Referer . This setting isn't case sensitive.

                               Example   JSON:   "SingleHeader":   {   "Name":
                               "haystack" }

                               Name -> (string)
                                   The name of the query header to inspect.

                            SingleQueryArgument -> (structure)
                               Inspect a single query  argument.  Provide  the
                               name  of the query argument to inspect, such as
                               UserName or SalesRegion . The name can be up to
                               30 characters long and isn't case sensitive.

                               This  is  used only to indicate the web request
                               component for WAF to inspect,  in  the   Field-
                               ToMatch specification.

                               Example  JSON: "SingleQueryArgument": { "Name":
                               "myArgument" }

                               Name -> (string)
                                   The name of the query argument to inspect.

                            AllQueryArguments -> (structure)
                               Inspect all query arguments.

                            UriPath -> (structure)
                               Inspect the request URI path. This is the  part
                               of  a  web  request that identifies a resource,
                               for example, /images/daily-ad.jpg .

                            QueryString -> (structure)
                               Inspect the query string. This is the part of a
                               URL that appears after a ? character, if any.

                            Body -> (structure)
                               Inspect the request body as plain text. The re-
                               quest  body  immediately  follows  the  request
                               headers.  This  is  the  part of a request that
                               contains any additional data that you  want  to
                               send  to  your  web  server as the HTTP request
                               body, such as data from a form.

                               Note that only the first 8 KB (8192  bytes)  of
                               the  request  body are forwarded to WAF for in-
                               spection by the underlying host service. If you
                               don't  need  to inspect more than 8 KB, you can
                               guarantee that you don't allow additional bytes
                               in  by  combining a statement that inspects the
                               body of the web request,  such  as   ByteMatch-
                               Statement or  RegexPatternSetReferenceStatement
                               , with a  SizeConstraintStatement that enforces
                               an  8 KB size limit on the body of the request.
                               WAF doesn't support inspecting the entire  con-
                               tents of web requests whose bodies exceed the 8
                               KB limit.

                            Method -> (structure)
                               Inspect the HTTP method. The  method  indicates
                               the  type of operation that the request is ask-
                               ing the origin to perform.

                            JsonBody -> (structure)
                               Inspect the request body as JSON.  The  request
                               body  immediately  follows the request headers.
                               This is the part of a request that contains any
                               additional  data  that you want to send to your
                               web server as the HTTP request  body,  such  as
                               data from a form.

                               Note  that  only the first 8 KB (8192 bytes) of
                               the request body are forwarded to WAF  for  in-
                               spection by the underlying host service. If you
                               don't need to inspect more than 8 KB,  you  can
                               guarantee that you don't allow additional bytes
                               in by combining a statement that  inspects  the
                               body  of  the  web request, such as  ByteMatch-
                               Statement or  RegexPatternSetReferenceStatement
                               , with a  SizeConstraintStatement that enforces
                               an 8 KB size limit on the body of the  request.
                               WAF  doesn't support inspecting the entire con-
                               tents of web requests whose bodies exceed the 8
                               KB limit.

                               MatchPattern -> (structure)
                                   The  patterns to look for in the JSON body.
                                   WAF inspects the results of  these  pattern
                                   matches  against the rule inspection crite-
                                   ria.

                                   All -> (structure)
                                      Match all  of  the  elements.  See  also
                                      MatchScope in  JsonBody .

                                      You  must specify either this setting or
                                      the IncludedPaths setting, but not both.

                                   IncludedPaths -> (list)
                                      Match only the specified include  paths.
                                      See also MatchScope in  JsonBody .

                                      Provide  the  include  paths  using JSON
                                      Pointer syntax. For example,  "Included-
                                      Paths": ["/dogs/0/name", "/dogs/1/name"]
                                      . For information about this syntax, see
                                      the   Internet  Engineering  Task  Force
                                      (IETF) documentation  JavaScript  Object
                                      Notation (JSON) Pointer .

                                      You  must specify either this setting or
                                      the All setting, but not both.

                                      NOTE:
                                          Don't use this option to include all
                                          paths. Instead, use the All setting.

                                      (string)

                               MatchScope -> (string)
                                   The  parts of the JSON to match against us-
                                   ing the MatchPattern . If you specify All ,
                                   WAF matches against keys and values.

                               InvalidFallbackBehavior -> (string)
                                   What  WAF  should  do  if  it fails to com-
                                   pletely parse the JSON  body.  The  options
                                   are the following:

                                   o EVALUATE_AS_STRING  - Inspect the body as
                                     plain text. WAF applies the  text  trans-
                                     formations  and  inspection criteria that
                                     you defined for the  JSON  inspection  to
                                     the body text string.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                                   If you  don't  provide  this  setting,  WAF
                                   parses and evaluates the content only up to
                                   the first parsing failure that  it  encoun-
                                   ters.

                                   WAF  does its best to parse the entire JSON
                                   body, but might be forced to stop for  rea-
                                   sons  such as invalid characters, duplicate
                                   keys, truncation,  and  any  content  whose
                                   root node isn't an object or an array.

                                   WAF  parses the JSON in the following exam-
                                   ples as two valid key, value pairs:

                                   o Missing                            comma:
                                     {"key1":"value1""key2":"value2"}

                                   o Missing                            colon:
                                     {"key1":"value1","key2""value2"}

                                   o Extra                             colons:
                                     {"key1"::"value1","key2""value2"}

                        ComparisonOperator -> (string)
                            The operator to use to compare the request part to
                            the size setting.

                        Size -> (long)
                            The size, in byte, to compare to the request part,
                            after any transformations.

                        TextTransformations -> (list)
                            Text transformations eliminate some of the unusual
                            formatting that attackers use in web  requests  in
                            an  effort to bypass detection. If you specify one
                            or more transformations in a rule  statement,  WAF
                            performs all transformations on the content of the
                            request component  identified  by  FieldToMatch  ,
                            starting  from the lowest priority setting, before
                            inspecting the content for a match.

                            (structure)
                               Text transformations eliminate some of the  un-
                               usual  formatting that attackers use in web re-
                               quests in an effort to bypass detection.

                               Priority -> (integer)
                                   Sets the relative processing order for mul-
                                   tiple  transformations that are defined for
                                   a rule statement. WAF processes all  trans-
                                   formations,  from  lowest priority to high-
                                   est, before inspecting the transformed con-
                                   tent.  The priorities don't need to be con-
                                   secutive, but they must all be different.

                               Type -> (string)
                                   You can specify the  following  transforma-
                                   tion types:
                                      BASE64_DECODE - Decode a Base64 -encoded
                                      string.

                                      BASE64_DECODE_EXT - Decode a Base64 -en-
                                      coded string, but use a forgiving imple-
                                      mentation that ignores  characters  that
                                      aren't valid.

                                      CMD_LINE - Command-line transformations.
                                      These are helpful in reducing effective-
                                      ness  of attackers who inject an operat-
                                      ing system command-line command and  use
                                      unusual  formatting  to disguise some or
                                      all of the command.

                                   o Delete the following characters: \ " ' ^

                                   o Delete spaces before the following  char-
                                     acters: / (

                                   o Replace  the  following characters with a
                                     space: , ;

                                   o Replace multiple spaces with one space

                                   o Convert uppercase letters (A-Z) to lower-
                                     case (a-z)
                                      COMPRESS_WHITE_SPACE   -  Replace  these
                                      characters with a space character (deci-
                                      mal 32):

                                   o \f , formfeed, decimal 12

                                   o \t , tab, decimal 9

                                   o \n , newline, decimal 10

                                   o \r , carriage return, decimal 13

                                   o \v , vertical tab, decimal 11

                                   o Non-breaking space, decimal 160
                                      COMPRESS_WHITE_SPACE  also replaces mul-
                                      tiple spaces with one space.

                                      CSS_DECODE - Decode characters that were
                                      encoded  using CSS 2.x escape rules syn-
                                      data.html#characters  .  This   function
                                      uses  up  to  two  bytes in the decoding
                                      process, so it can help to uncover ASCII
                                      characters  that  were encoded using CSS
                                      encoding that wouldnt typically  be  en-
                                      coded.  It's  also  useful in countering
                                      evasion, which is  a  combination  of  a
                                      backslash  and  non-hexadecimal  charac-
                                      ters. For example, ja\vascript for java-
                                      script.

                                      ESCAPE_SEQ_DECODE - Decode the following
                                      ANSI C escape sequences: \a , \b , \f  ,
                                      \n  , \r , \t , \v , \\ , \? , \' , \" ,
                                      \xHH (hexadecimal), \0OOO  (octal).  En-
                                      codings  that aren't valid remain in the
                                      output.

                                      HEX_DECODE - Decode a string of hexadec-
                                      imal characters into a binary.

                                      HTML_ENTITY_DECODE  -  Replace  HTML-en-
                                      coded characters with unencoded  charac-
                                      ters.  HTML_ENTITY_DECODE performs these
                                      operations:

                                   o Replaces (ampersand)quot; with "

                                   o Replaces    (ampersand)nbsp;    with    a
                                     non-breaking space, decimal 160

                                   o Replaces   (ampersand)lt;  with  a  "less
                                     than" symbol

                                   o Replaces (ampersand)gt; with >

                                   o Replaces characters that are  represented
                                     in hexadecimal format, (ampersand)#xhhhh;
                                     , with the corresponding characters

                                   o Replaces characters that are  represented
                                     in  decimal  format,  (ampersand)#nnnn; ,
                                     with the corresponding characters
                                      JS_DECODE - Decode JavaScript escape se-
                                      quences.  If a \  u  HHHH code is in the
                                      full-width ASCII code range of FF01-FF5E
                                      , then the higher byte is used to detect
                                      and adjust the lower byte. If not,  only
                                      the  lower  byte  is used and the higher
                                      byte is zeroed, causing a possible  loss
                                      of information.

                                      LOWERCASE  -  Convert  uppercase letters
                                      (A-Z) to lowercase (a-z).

                                      MD5 - Calculate an  MD5  hash  from  the
                                      data  in the input. The computed hash is
                                      in a raw binary form.

                                      NONE - Specify NONE if  you  don't  want
                                      any text transformations.

                                      NORMALIZE_PATH    -    Remove   multiple
                                      slashes, directory self-references,  and
                                      directory  back-references  that are not
                                      at the beginning of the  input  from  an
                                      input string.

                                      NORMALIZE_PATH_WIN - This is the same as
                                      NORMALIZE_PATH  ,  but  first   converts
                                      backslash characters to forward slashes.

                                      REMOVE_NULLS  -  Remove  all  NULL bytes
                                      from the input.

                                      REPLACE_COMMENTS - Replace  each  occur-
                                      rence  of a C-style comment (/* ... */ )
                                      with a single space.  Multiple  consecu-
                                      tive occurrences are not compressed. Un-
                                      terminated comments  are  also  replaced
                                      with  a  space  (ASCII 0x20). However, a
                                      standalone termination of a comment  (*/
                                      ) is not acted upon.

                                      REPLACE_NULLS  -  Replace  NULL bytes in
                                      the input with space  characters  (ASCII
                                      0x20 ).

                                      SQL_HEX_DECODE  -  Decode  SQL hex data.
                                      Example (0x414243 ) will be  decoded  to
                                      (ABC ).

                                      URL_DECODE - Decode a URL-encoded value.

                                      URL_DECODE_UNI  -  Like URL_DECODE , but
                                      with support for  Microsoft-specific  %u
                                      encoding.   If   the   code  is  in  the
                                      full-width ASCII code range of FF01-FF5E
                                      ,  the higher byte is used to detect and
                                      adjust the lower byte.  Otherwise,  only
                                      the  lower  byte  is used and the higher
                                      byte is zeroed.

                                      UTF8_TO_UNICODE  -  Convert  all   UTF-8
                                      character  sequences  to  Unicode.  This
                                      helps input normalization, and  minimiz-
                                      ing  false-positives and false-negatives
                                      for non-English languages.

                     GeoMatchStatement -> (structure)
                        A rule statement used to identify web  requests  based
                        on country of origin.

                        CountryCodes -> (list)
                            An array of two-character country codes, for exam-
                            ple, [ "US", "CN" ] , from the alpha-2 country ISO
                            codes of the ISO 3166 international standard.

                            (string)

                        ForwardedIPConfig -> (structure)
                            The  configuration  for inspecting IP addresses in
                            an HTTP header that you specify, instead of  using
                            the  IP address that's reported by the web request
                            origin.  Commonly,  this  is  the  X-Forwarded-For
                            (XFF) header, but you can specify any header name.

                            NOTE:
                               If  the  specified  header isn't present in the
                               request, WAF doesn't apply the rule to the  web
                               request at all.

                            HeaderName -> (string)
                               The  name  of the HTTP header to use for the IP
                               address.  For  example,  to  use   the   X-For-
                               warded-For  (XFF)  header,  set  this to X-For-
                               warded-For .

                               NOTE:
                                   If the specified header  isn't  present  in
                                   the  request, WAF doesn't apply the rule to
                                   the web request at all.

                            FallbackBehavior -> (string)
                               The match status to assign to the  web  request
                               if  the request doesn't have a valid IP address
                               in the specified position.

                               NOTE:
                                   If the specified header  isn't  present  in
                                   the  request, WAF doesn't apply the rule to
                                   the web request at all.

                               You can specify the following  fallback  behav-
                               iors:

                               o MATCH - Treat the web request as matching the
                                 rule statement. WAF applies the  rule  action
                                 to the request.

                               o NO_MATCH  -  Treat  the  web  request  as not
                                 matching the rule statement.

                     RuleGroupReferenceStatement -> (structure)
                        A rule statement used to run the rules  that  are  de-
                        fined  in  a   RuleGroup  . To use this, create a rule
                        group with your rules, then provide  the  ARN  of  the
                        rule group in this statement.

                        You  cannot  nest  a RuleGroupReferenceStatement , for
                        example for use inside a NotStatement or OrStatement .
                        You  can  only use a rule group reference statement at
                        the top level inside a web ACL.

                        ARN -> (string)
                            The Amazon Resource Name (ARN) of the entity.

                        ExcludedRules -> (list)
                            The rules in the referenced rule group  whose  ac-
                            tions  are set to Count . When you exclude a rule,
                            WAF evaluates it exactly as it would if  the  rule
                            action  setting  were Count . This is a useful op-
                            tion for testing the rules in a rule group without
                            modifying how they handle your web traffic.

                            (structure)
                               Specifies  a  single rule in a rule group whose
                               action you want to override to Count . When you
                               exclude  a rule, WAF evaluates it exactly as it
                               would if the rule action setting were  Count  .
                               This  is  a useful option for testing the rules
                               in a rule group without modifying how they han-
                               dle your web traffic.

                               Name -> (string)
                                   The  name of the rule whose action you want
                                   to override to Count .

                     IPSetReferenceStatement -> (structure)
                        A rule statement used to detect  web  requests  coming
                        from particular IP addresses or address ranges. To use
                        this, create an  IPSet that  specifies  the  addresses
                        you  want  to  detect, then use the ARN of that set in
                        this statement. To create an IP set, see   CreateIPSet
                        .

                        Each  IP  set rule statement references an IP set. You
                        create and maintain the set independent of your rules.
                        This  allows  you  to  use  the single set in multiple
                        rules. When you update the referenced set,  WAF  auto-
                        matically updates all rules that reference it.

                        ARN -> (string)
                            The  Amazon Resource Name (ARN) of the  IPSet that
                            this statement references.

                        IPSetForwardedIPConfig -> (structure)
                            The configuration for inspecting IP  addresses  in
                            an  HTTP header that you specify, instead of using
                            the IP address that's reported by the web  request
                            origin.  Commonly,  this  is  the  X-Forwarded-For
                            (XFF) header, but you can specify any header name.

                            NOTE:
                               If the specified header isn't  present  in  the
                               request,  WAF doesn't apply the rule to the web
                               request at all.

                            HeaderName -> (string)
                               The name of the HTTP header to use for  the  IP
                               address.   For   example,  to  use  the  X-For-
                               warded-For (XFF) header,  set  this  to  X-For-
                               warded-For .

                               NOTE:
                                   If  the  specified  header isn't present in
                                   the request, WAF doesn't apply the rule  to
                                   the web request at all.

                            FallbackBehavior -> (string)
                               The  match  status to assign to the web request
                               if the request doesn't have a valid IP  address
                               in the specified position.

                               NOTE:
                                   If  the  specified  header isn't present in
                                   the request, WAF doesn't apply the rule  to
                                   the web request at all.

                               You  can  specify the following fallback behav-
                               iors:

                               o MATCH - Treat the web request as matching the
                                 rule  statement.  WAF applies the rule action
                                 to the request.

                               o NO_MATCH -  Treat  the  web  request  as  not
                                 matching the rule statement.

                            Position -> (string)
                               The position in the header to search for the IP
                               address. The header can contain IP addresses of
                               the  original  client  and also of proxies. For
                               example, the header value  could  be  10.1.1.1,
                               127.0.0.0,  10.10.10.10  where the first IP ad-
                               dress identifies the original  client  and  the
                               rest  identify  proxies  that  the request went
                               through.

                               The options for this setting are the following:

                               o FIRST - Inspect the first IP address  in  the
                                 list  of  IP addresses in the header. This is
                                 usually the client's original IP.

                               o LAST - Inspect the last  IP  address  in  the
                                 list of IP addresses in the header.

                               o ANY  - Inspect all IP addresses in the header
                                 for a match. If the header contains more than
                                 10 IP addresses, WAF inspects the last 10.

                     RegexPatternSetReferenceStatement -> (structure)
                        A rule statement used to search web request components
                        for matches with regular  expressions.  To  use  this,
                        create  a   RegexPatternSet that specifies the expres-
                        sions that you want to detect, then  use  the  ARN  of
                        that  set in this statement. A web request matches the
                        pattern set rule statement if  the  request  component
                        matches  any  of  the patterns in the set. To create a
                        regex pattern set, see  CreateRegexPatternSet .

                        Each regex pattern set  rule  statement  references  a
                        regex pattern set. You create and maintain the set in-
                        dependent of your rules. This allows you  to  use  the
                        single set in multiple rules. When you update the ref-
                        erenced set, WAF automatically updates all rules  that
                        reference it.

                        ARN -> (string)
                            The  Amazon  Resource Name (ARN) of the  RegexPat-
                            ternSet that this statement references.

                        FieldToMatch -> (structure)
                            The part of a web request that you want WAF to in-
                            spect. For more information, see  FieldToMatch .

                            SingleHeader -> (structure)
                               Inspect  a  single  header. Provide the name of
                               the header to inspect, for example,  User-Agent
                               or Referer . This setting isn't case sensitive.

                               Example   JSON:   "SingleHeader":   {   "Name":
                               "haystack" }

                               Name -> (string)
                                   The name of the query header to inspect.

                            SingleQueryArgument -> (structure)
                               Inspect a single query  argument.  Provide  the
                               name  of the query argument to inspect, such as
                               UserName or SalesRegion . The name can be up to
                               30 characters long and isn't case sensitive.

                               This  is  used only to indicate the web request
                               component for WAF to inspect,  in  the   Field-
                               ToMatch specification.

                               Example  JSON: "SingleQueryArgument": { "Name":
                               "myArgument" }

                               Name -> (string)
                                   The name of the query argument to inspect.

                            AllQueryArguments -> (structure)
                               Inspect all query arguments.

                            UriPath -> (structure)
                               Inspect the request URI path. This is the  part
                               of  a  web  request that identifies a resource,
                               for example, /images/daily-ad.jpg .

                            QueryString -> (structure)
                               Inspect the query string. This is the part of a
                               URL that appears after a ? character, if any.

                            Body -> (structure)
                               Inspect the request body as plain text. The re-
                               quest  body  immediately  follows  the  request
                               headers.  This  is  the  part of a request that
                               contains any additional data that you  want  to
                               send  to  your  web  server as the HTTP request
                               body, such as data from a form.

                               Note that only the first 8 KB (8192  bytes)  of
                               the  request  body are forwarded to WAF for in-
                               spection by the underlying host service. If you
                               don't  need  to inspect more than 8 KB, you can
                               guarantee that you don't allow additional bytes
                               in  by  combining a statement that inspects the
                               body of the web request,  such  as   ByteMatch-
                               Statement or  RegexPatternSetReferenceStatement
                               , with a  SizeConstraintStatement that enforces
                               an  8 KB size limit on the body of the request.
                               WAF doesn't support inspecting the entire  con-
                               tents of web requests whose bodies exceed the 8
                               KB limit.

                            Method -> (structure)
                               Inspect the HTTP method. The  method  indicates
                               the  type of operation that the request is ask-
                               ing the origin to perform.

                            JsonBody -> (structure)
                               Inspect the request body as JSON.  The  request
                               body  immediately  follows the request headers.
                               This is the part of a request that contains any
                               additional  data  that you want to send to your
                               web server as the HTTP request  body,  such  as
                               data from a form.

                               Note  that  only the first 8 KB (8192 bytes) of
                               the request body are forwarded to WAF  for  in-
                               spection by the underlying host service. If you
                               don't need to inspect more than 8 KB,  you  can
                               guarantee that you don't allow additional bytes
                               in by combining a statement that  inspects  the
                               body  of  the  web request, such as  ByteMatch-
                               Statement or  RegexPatternSetReferenceStatement
                               , with a  SizeConstraintStatement that enforces
                               an 8 KB size limit on the body of the  request.
                               WAF  doesn't support inspecting the entire con-
                               tents of web requests whose bodies exceed the 8
                               KB limit.

                               MatchPattern -> (structure)
                                   The  patterns to look for in the JSON body.
                                   WAF inspects the results of  these  pattern
                                   matches  against the rule inspection crite-
                                   ria.

                                   All -> (structure)
                                      Match all  of  the  elements.  See  also
                                      MatchScope in  JsonBody .

                                      You  must specify either this setting or
                                      the IncludedPaths setting, but not both.

                                   IncludedPaths -> (list)
                                      Match only the specified include  paths.
                                      See also MatchScope in  JsonBody .

                                      Provide  the  include  paths  using JSON
                                      Pointer syntax. For example,  "Included-
                                      Paths": ["/dogs/0/name", "/dogs/1/name"]
                                      . For information about this syntax, see
                                      the   Internet  Engineering  Task  Force
                                      (IETF) documentation  JavaScript  Object
                                      Notation (JSON) Pointer .

                                      You  must specify either this setting or
                                      the All setting, but not both.

                                      NOTE:
                                          Don't use this option to include all
                                          paths. Instead, use the All setting.

                                      (string)

                               MatchScope -> (string)
                                   The  parts of the JSON to match against us-
                                   ing the MatchPattern . If you specify All ,
                                   WAF matches against keys and values.

                               InvalidFallbackBehavior -> (string)
                                   What  WAF  should  do  if  it fails to com-
                                   pletely parse the JSON  body.  The  options
                                   are the following:

                                   o EVALUATE_AS_STRING  - Inspect the body as
                                     plain text. WAF applies the  text  trans-
                                     formations  and  inspection criteria that
                                     you defined for the  JSON  inspection  to
                                     the body text string.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                                   If you  don't  provide  this  setting,  WAF
                                   parses and evaluates the content only up to
                                   the first parsing failure that  it  encoun-
                                   ters.

                                   WAF  does its best to parse the entire JSON
                                   body, but might be forced to stop for  rea-
                                   sons  such as invalid characters, duplicate
                                   keys, truncation,  and  any  content  whose
                                   root node isn't an object or an array.

                                   WAF  parses the JSON in the following exam-
                                   ples as two valid key, value pairs:

                                   o Missing                            comma:
                                     {"key1":"value1""key2":"value2"}

                                   o Missing                            colon:
                                     {"key1":"value1","key2""value2"}

                                   o Extra                             colons:
                                     {"key1"::"value1","key2""value2"}

                        TextTransformations -> (list)
                            Text transformations eliminate some of the unusual
                            formatting that attackers use in web  requests  in
                            an  effort to bypass detection. If you specify one
                            or more transformations in a rule  statement,  WAF
                            performs all transformations on the content of the
                            request component  identified  by  FieldToMatch  ,
                            starting  from the lowest priority setting, before
                            inspecting the content for a match.

                            (structure)
                               Text transformations eliminate some of the  un-
                               usual  formatting that attackers use in web re-
                               quests in an effort to bypass detection.

                               Priority -> (integer)
                                   Sets the relative processing order for mul-
                                   tiple  transformations that are defined for
                                   a rule statement. WAF processes all  trans-
                                   formations,  from  lowest priority to high-
                                   est, before inspecting the transformed con-
                                   tent.  The priorities don't need to be con-
                                   secutive, but they must all be different.

                               Type -> (string)
                                   You can specify the  following  transforma-
                                   tion types:
                                      BASE64_DECODE - Decode a Base64 -encoded
                                      string.

                                      BASE64_DECODE_EXT - Decode a Base64 -en-
                                      coded string, but use a forgiving imple-
                                      mentation that ignores  characters  that
                                      aren't valid.

                                      CMD_LINE - Command-line transformations.
                                      These are helpful in reducing effective-
                                      ness  of attackers who inject an operat-
                                      ing system command-line command and  use
                                      unusual  formatting  to disguise some or
                                      all of the command.

                                   o Delete the following characters: \ " ' ^

                                   o Delete spaces before the following  char-
                                     acters: / (

                                   o Replace  the  following characters with a
                                     space: , ;

                                   o Replace multiple spaces with one space

                                   o Convert uppercase letters (A-Z) to lower-
                                     case (a-z)
                                      COMPRESS_WHITE_SPACE   -  Replace  these
                                      characters with a space character (deci-
                                      mal 32):

                                   o \f , formfeed, decimal 12

                                   o \t , tab, decimal 9

                                   o \n , newline, decimal 10

                                   o \r , carriage return, decimal 13

                                   o \v , vertical tab, decimal 11

                                   o Non-breaking space, decimal 160
                                      COMPRESS_WHITE_SPACE  also replaces mul-
                                      tiple spaces with one space.

                                      CSS_DECODE - Decode characters that were
                                      encoded  using CSS 2.x escape rules syn-
                                      data.html#characters  .  This   function
                                      uses  up  to  two  bytes in the decoding
                                      process, so it can help to uncover ASCII
                                      characters  that  were encoded using CSS
                                      encoding that wouldnt typically  be  en-
                                      coded.  It's  also  useful in countering
                                      evasion, which is  a  combination  of  a
                                      backslash  and  non-hexadecimal  charac-
                                      ters. For example, ja\vascript for java-
                                      script.

                                      ESCAPE_SEQ_DECODE - Decode the following
                                      ANSI C escape sequences: \a , \b , \f  ,
                                      \n  , \r , \t , \v , \\ , \? , \' , \" ,
                                      \xHH (hexadecimal), \0OOO  (octal).  En-
                                      codings  that aren't valid remain in the
                                      output.

                                      HEX_DECODE - Decode a string of hexadec-
                                      imal characters into a binary.

                                      HTML_ENTITY_DECODE  -  Replace  HTML-en-
                                      coded characters with unencoded  charac-
                                      ters.  HTML_ENTITY_DECODE performs these
                                      operations:

                                   o Replaces (ampersand)quot; with "

                                   o Replaces    (ampersand)nbsp;    with    a
                                     non-breaking space, decimal 160

                                   o Replaces   (ampersand)lt;  with  a  "less
                                     than" symbol

                                   o Replaces (ampersand)gt; with >

                                   o Replaces characters that are  represented
                                     in hexadecimal format, (ampersand)#xhhhh;
                                     , with the corresponding characters

                                   o Replaces characters that are  represented
                                     in  decimal  format,  (ampersand)#nnnn; ,
                                     with the corresponding characters
                                      JS_DECODE - Decode JavaScript escape se-
                                      quences.  If a \  u  HHHH code is in the
                                      full-width ASCII code range of FF01-FF5E
                                      , then the higher byte is used to detect
                                      and adjust the lower byte. If not,  only
                                      the  lower  byte  is used and the higher
                                      byte is zeroed, causing a possible  loss
                                      of information.

                                      LOWERCASE  -  Convert  uppercase letters
                                      (A-Z) to lowercase (a-z).

                                      MD5 - Calculate an  MD5  hash  from  the
                                      data  in the input. The computed hash is
                                      in a raw binary form.

                                      NONE - Specify NONE if  you  don't  want
                                      any text transformations.

                                      NORMALIZE_PATH    -    Remove   multiple
                                      slashes, directory self-references,  and
                                      directory  back-references  that are not
                                      at the beginning of the  input  from  an
                                      input string.

                                      NORMALIZE_PATH_WIN - This is the same as
                                      NORMALIZE_PATH  ,  but  first   converts
                                      backslash characters to forward slashes.

                                      REMOVE_NULLS  -  Remove  all  NULL bytes
                                      from the input.

                                      REPLACE_COMMENTS - Replace  each  occur-
                                      rence  of a C-style comment (/* ... */ )
                                      with a single space.  Multiple  consecu-
                                      tive occurrences are not compressed. Un-
                                      terminated comments  are  also  replaced
                                      with  a  space  (ASCII 0x20). However, a
                                      standalone termination of a comment  (*/
                                      ) is not acted upon.

                                      REPLACE_NULLS  -  Replace  NULL bytes in
                                      the input with space  characters  (ASCII
                                      0x20 ).

                                      SQL_HEX_DECODE  -  Decode  SQL hex data.
                                      Example (0x414243 ) will be  decoded  to
                                      (ABC ).

                                      URL_DECODE - Decode a URL-encoded value.

                                      URL_DECODE_UNI  -  Like URL_DECODE , but
                                      with support for  Microsoft-specific  %u
                                      encoding.   If   the   code  is  in  the
                                      full-width ASCII code range of FF01-FF5E
                                      ,  the higher byte is used to detect and
                                      adjust the lower byte.  Otherwise,  only
                                      the  lower  byte  is used and the higher
                                      byte is zeroed.

                                      UTF8_TO_UNICODE  -  Convert  all   UTF-8
                                      character  sequences  to  Unicode.  This
                                      helps input normalization, and  minimiz-
                                      ing  false-positives and false-negatives
                                      for non-English languages.

                     RateBasedStatement -> (structure)
                        A rate-based rule tracks the rate of requests for each
                        originating  IP  address, and triggers the rule action
                        when the rate exceeds a limit that you specify on  the
                        number  of requests in any 5-minute time span. You can
                        use this to put a temporary block on requests from  an
                        IP address that is sending excessive requests.

                        WAF  tracks  and  manages  web requests separately for
                        each instance of a rate-based rule that you  use.  For
                        example,  if you provide the same rate-based rule set-
                        tings in two web ACLs, each of the two rule statements
                        represents  a separate instance of the rate-based rule
                        and gets its own tracking and management  by  WAF.  If
                        you  define a rate-based rule inside a rule group, and
                        then use that rule group in multiple places, each  use
                        creates  a  separate  instance  of the rate-based rule
                        that gets its own tracking and management by WAF.

                        When the rule action triggers, WAF  blocks  additional
                        requests  from  the  IP address until the request rate
                        falls below the limit.

                        You can optionally nest another statement  inside  the
                        rate-based  statement, to narrow the scope of the rule
                        so that it only counts requests that match the  nested
                        statement.  For example, based on recent requests that
                        you have seen from an attacker,  you  might  create  a
                        rate-based  rule with a nested AND rule statement that
                        contains the following nested statements:

                        o An IP match statement with an IP set that  specified
                          the address 192.0.2.44.

                        o A  string  match  statement  that  searches  in  the
                          User-Agent header for the string BadBot.

                        In this rate-based rule, you also define a rate limit.
                        For  this  example,  the rate limit is 1,000. Requests
                        that meet both of the conditions in the statements are
                        counted.  If the count exceeds 1,000 requests per five
                        minutes, the rule action triggers.  Requests  that  do
                        not  meet  both conditions are not counted towards the
                        rate limit and are not affected by this rule.

                        You cannot nest a  RateBasedStatement  inside  another
                        statement,   for  example  inside  a  NotStatement  or
                        OrStatement . You can define a RateBasedStatement  in-
                        side a web ACL and inside a rule group.

                        Limit -> (long)
                            The  limit  on  requests per 5-minute period for a
                            single originating IP address.  If  the  statement
                            includes  a ScopeDownStatement , this limit is ap-
                            plied only to the requests that match  the  state-
                            ment.

                        AggregateKeyType -> (string)
                            Setting  that  indicates  how to aggregate the re-
                            quest counts. The options are the following:

                            o IP - Aggregate the request counts on the IP  ad-
                              dress from the web request origin.

                            o FORWARDED_IP  -  Aggregate the request counts on
                              the first IP address in an HTTP header.  If  you
                              use  this,  configure the ForwardedIPConfig , to
                              specify the header to use.

                        ScopeDownStatement -> (structure)
                            An optional  nested  statement  that  narrows  the
                            scope  of  the  web requests that are evaluated by
                            the  rate-based  statement.  Requests   are   only
                            tracked  by the rate-based statement if they match
                            the scope-down statement. You can use any nestable
                            Statement in the scope-down statement, and you can
                            nest statements at any level, the same as you  can
                            for a rule statement.

                            ByteMatchStatement -> (structure)
                               A  rule  statement  that defines a string match
                               search for WAF to apply to  web  requests.  The
                               byte  match  statement  provides  the  bytes to
                               search for, the location in requests  that  you
                               want  WAF  to  search,  and other settings. The
                               bytes to search for are typically a string that
                               corresponds  with  ASCII characters. In the WAF
                               console and the developer guide, this  is  ref-
                               ered to as a string match statement.

                               SearchString -> (blob)
                                   A  string value that you want WAF to search
                                   for. WAF searches only in the part  of  web
                                   requests  that you designate for inspection
                                   in  FieldToMatch . The  maximum  length  of
                                   the value is 50 bytes.

                                   Valid  values  depend on the component that
                                   you specify for inspection in  FieldToMatch
                                   :

                                   o Method  :  The  HTTP method that you want
                                     WAF to search  for.  This  indicates  the
                                     type  of  operation  specified in the re-
                                     quest.

                                   o UriPath : The value that you want WAF  to
                                     search  for in the URI path, for example,
                                     /images/daily-ad.jpg .

                                   If SearchString includes alphabetic charac-
                                   ters  A-Z  and  a-z, note that the value is
                                   case sensitive.
                                      If you're using the WAF API

                                   Specify a  base64-encoded  version  of  the
                                   value.  The maximum length of the value be-
                                   fore you base64-encode it is 50 bytes.

                                   For example, suppose the value of  Type  is
                                   HEADER  and the value of Data is User-Agent
                                   . If you  want  to  search  the  User-Agent
                                   header   for   the   value   BadBot  ,  you
                                   base64-encode BadBot using MIME  base64-en-
                                   coding and include the resulting value, Qm-
                                   FkQm90 , in the value of SearchString .
                                      If you're using the CLI or  one  of  the
                                      Amazon Web Services SDKs

                                   The  value that you want WAF to search for.
                                   The SDK automatically  base64  encodes  the
                                   value.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to  inspect.  For  more  information,   see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect  a  single  header.  Provide the
                                      name of the header to inspect, for exam-
                                      ple,  User-Agent  or Referer . This set-
                                      ting isn't case sensitive.

                                      Example JSON: "SingleHeader": {  "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The  name of the query header to in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the  name  of  the query argument to in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This is used only to  indicate  the  web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example JSON:  "SingleQueryArgument":  {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The  name  of  the query argument to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect the request URI  path.  This  is
                                      the  part  of a web request that identi-
                                      fies  a  resource,  for  example,   /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect  the  query  string. This is the
                                      part of a URL that  appears  after  a  ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect  the request body as plain text.
                                      The request body immediately follows the
                                      request  headers.  This is the part of a
                                      request  that  contains  any  additional
                                      data  that  you want to send to your web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect  the HTTP method. The method in-
                                      dicates the type of operation  that  the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect  the  request  body as JSON. The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest that contains any additional  data
                                      that you want to send to your web server
                                      as the HTTP request body, such  as  data
                                      from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text transformations eliminate some of  the
                                   unusual  formatting  that  attackers use in
                                   web requests in an effort to bypass  detec-
                                   tion.  If you specify one or more transfor-
                                   mations in a rule statement,  WAF  performs
                                   all  transformations  on the content of the
                                   request  component  identified  by   Field-
                                   ToMatch , starting from the lowest priority
                                   setting, before inspecting the content  for
                                   a match.

                                   (structure)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets the relative  processing  order
                                          for  multiple  transformations  that
                                          are defined for  a  rule  statement.
                                          WAF  processes  all transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent. The priorities don't  need  to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                               PositionalConstraint -> (string)
                                   The  area  within  the portion of a web re-
                                   quest that  you  want  WAF  to  search  for
                                   SearchString  .  Valid  values  include the
                                   following:
                                      CONTAINS

                                   The specified part of the web request  must
                                   include the value of SearchString , but the
                                   location doesn't matter.
                                      CONTAINS_WORD

                                   The specified part of the web request  must
                                   include  the  value  of  SearchString , and
                                   SearchString must contain only alphanumeric
                                   characters or underscore (A-Z, a-z, 0-9, or
                                   _). In addition,  SearchString  must  be  a
                                   word,  which means that both of the follow-
                                   ing are true:

                                   o SearchString is at the beginning  of  the
                                     specified  part  of the web request or is
                                     preceded by a character other than an al-
                                     phanumeric  character  or underscore (_).
                                     Examples include the value  of  a  header
                                     and ;BadBot .

                                   o SearchString  is at the end of the speci-
                                     fied part of the web request or  is  fol-
                                     lowed  by  a  character other than an al-
                                     phanumeric character or  underscore  (_),
                                     for example, BadBot; and -BadBot; .
                                      EXACTLY

                                   The  value of the specified part of the web
                                   request must exactly  match  the  value  of
                                   SearchString .
                                      STARTS_WITH

                                   The  value  of  SearchString must appear at
                                   the beginning of the specified part of  the
                                   web request.
                                      ENDS_WITH

                                   The  value  of  SearchString must appear at
                                   the end of the specified part  of  the  web
                                   request.

                            SqliMatchStatement -> (structure)
                               Attackers  sometimes  insert malicious SQL code
                               into web requests in an effort to extract  data
                               from  your  database. To allow or block web re-
                               quests that appear  to  contain  malicious  SQL
                               code,  create  one  or more SQL injection match
                               conditions. An SQL  injection  match  condition
                               identifies  the  part  of web requests, such as
                               the URI or the query string, that you want  WAF
                               to inspect. Later in the process, when you cre-
                               ate a web ACL, you specify whether to allow  or
                               block requests that appear to contain malicious
                               SQL code.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to   inspect.  For  more  information,  see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This  is  used  only to indicate the web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of a web request  that  identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. If you specify one or more  transfor-
                                   mations  in  a rule statement, WAF performs
                                   all transformations on the content  of  the
                                   request   component  identified  by  Field-
                                   ToMatch , starting from the lowest priority
                                   setting,  before inspecting the content for
                                   a match.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations  that
                                          are  defined  for  a rule statement.
                                          WAF processes  all  transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent.  The  priorities don't need to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                            XssMatchStatement -> (structure)
                               A rule  statement  that  defines  a  cross-site
                               scripting  (XSS)  match search for WAF to apply
                               to web requests. XSS attacks  are  those  where
                               the  attacker  uses vulnerabilities in a benign
                               website  as  a  vehicle  to  inject   malicious
                               client-site  scripts  into other legitimate web
                               browsers. The XSS match statement provides  the
                               location  in  requests  that  you  want  WAF to
                               search and text transformations to use  on  the
                               search  area  before WAF searches for character
                               sequences  that  are  likely  to  be  malicious
                               strings.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to  inspect.  For  more  information,   see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect  a  single  header.  Provide the
                                      name of the header to inspect, for exam-
                                      ple,  User-Agent  or Referer . This set-
                                      ting isn't case sensitive.

                                      Example JSON: "SingleHeader": {  "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The  name of the query header to in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the  name  of  the query argument to in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This is used only to  indicate  the  web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example JSON:  "SingleQueryArgument":  {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The  name  of  the query argument to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect the request URI  path.  This  is
                                      the  part  of a web request that identi-
                                      fies  a  resource,  for  example,   /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect  the  query  string. This is the
                                      part of a URL that  appears  after  a  ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect  the request body as plain text.
                                      The request body immediately follows the
                                      request  headers.  This is the part of a
                                      request  that  contains  any  additional
                                      data  that  you want to send to your web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect  the HTTP method. The method in-
                                      dicates the type of operation  that  the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect  the  request  body as JSON. The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest that contains any additional  data
                                      that you want to send to your web server
                                      as the HTTP request body, such  as  data
                                      from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text transformations eliminate some of  the
                                   unusual  formatting  that  attackers use in
                                   web requests in an effort to bypass  detec-
                                   tion.  If you specify one or more transfor-
                                   mations in a rule statement,  WAF  performs
                                   all  transformations  on the content of the
                                   request  component  identified  by   Field-
                                   ToMatch , starting from the lowest priority
                                   setting, before inspecting the content  for
                                   a match.

                                   (structure)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets the relative  processing  order
                                          for  multiple  transformations  that
                                          are defined for  a  rule  statement.
                                          WAF  processes  all transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent. The priorities don't  need  to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                            SizeConstraintStatement -> (structure)
                               A  rule  statement  that  compares  a number of
                               bytes against the size of a request  component,
                               using  a  comparison  operator, such as greater
                               than (>) or less than (<). For example, you can
                               use  a  size  constraint  statement to look for
                               query strings that are longer than 100 bytes.

                               If you configure WAF  to  inspect  the  request
                               body, WAF inspects only the first 8192 bytes (8
                               KB). If the request body for your web  requests
                               never exceeds 8192 bytes, you can create a size
                               constraint condition and  block  requests  that
                               have a request body greater than 8192 bytes.

                               If  you choose URI for the value of Part of the
                               request to filter on, the slash (/) in the  URI
                               counts  as  one character. For example, the URI
                               /logo.jpg is nine characters long.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to   inspect.  For  more  information,  see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This  is  used  only to indicate the web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of a web request  that  identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               ComparisonOperator -> (string)
                                   The  operator to use to compare the request
                                   part to the size setting.

                               Size -> (long)
                                   The size, in byte, to compare  to  the  re-
                                   quest part, after any transformations.

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. If you specify one or more  transfor-
                                   mations  in  a rule statement, WAF performs
                                   all transformations on the content  of  the
                                   request   component  identified  by  Field-
                                   ToMatch , starting from the lowest priority
                                   setting,  before inspecting the content for
                                   a match.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations  that
                                          are  defined  for  a rule statement.
                                          WAF processes  all  transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent.  The  priorities don't need to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                            GeoMatchStatement -> (structure)
                               A rule statement used to identify web  requests
                               based on country of origin.

                               CountryCodes -> (list)
                                   An  array  of  two-character country codes,
                                   for example, [ "US", "CN" ] , from the  al-
                                   pha-2 country ISO codes of the ISO 3166 in-
                                   ternational standard.

                                   (string)

                               ForwardedIPConfig -> (structure)
                                   The configuration  for  inspecting  IP  ad-
                                   dresses in an HTTP header that you specify,
                                   instead of using the IP address that's  re-
                                   ported by the web request origin. Commonly,
                                   this is the X-Forwarded-For  (XFF)  header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the request, WAF doesn't apply the  rule
                                      to the web request at all.

                                   HeaderName -> (string)
                                      The  name  of the HTTP header to use for
                                      the IP address. For example, to use  the
                                      X-Forwarded-For  (XFF)  header, set this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The  match  status  to assign to the web
                                      request if the request  doesn't  have  a
                                      valid  IP address in the specified posi-
                                      tion.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      You  can  specify the following fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching  the  rule statement. WAF ap-
                                        plies the rule action to the request.

                                      o NO_MATCH - Treat the  web  request  as
                                        not matching the rule statement.

                            RuleGroupReferenceStatement -> (structure)
                               A rule statement used to run the rules that are
                               defined in a  RuleGroup . To use this, create a
                               rule  group  with  your rules, then provide the
                               ARN of the rule group in this statement.

                               You cannot nest a RuleGroupReferenceStatement ,
                               for  example  for  use inside a NotStatement or
                               OrStatement . You can only  use  a  rule  group
                               reference  statement  at the top level inside a
                               web ACL.

                               ARN -> (string)
                                   The Amazon Resource Name (ARN) of  the  en-
                                   tity.

                               ExcludedRules -> (list)
                                   The  rules  in  the  referenced  rule group
                                   whose actions are set to Count .  When  you
                                   exclude a rule, WAF evaluates it exactly as
                                   it would if the rule  action  setting  were
                                   Count . This is a useful option for testing
                                   the rules in a rule group without modifying
                                   how they handle your web traffic.

                                   (structure)
                                      Specifies  a single rule in a rule group
                                      whose action you  want  to  override  to
                                      Count  .  When  you  exclude a rule, WAF
                                      evaluates it exactly as it would if  the
                                      rule action setting were Count . This is
                                      a useful option for testing the rules in
                                      a  rule group without modifying how they
                                      handle your web traffic.

                                      Name -> (string)
                                          The name of the  rule  whose  action
                                          you want to override to Count .

                            IPSetReferenceStatement -> (structure)
                               A  rule  statement  used to detect web requests
                               coming from particular IP addresses or  address
                               ranges.  To  use  this,  create  an  IPSet that
                               specifies the addresses  you  want  to  detect,
                               then use the ARN of that set in this statement.
                               To create an IP set, see  CreateIPSet .

                               Each IP set rule  statement  references  an  IP
                               set.  You  create and maintain the set indepen-
                               dent of your rules. This allows you to use  the
                               single  set  in multiple rules. When you update
                               the referenced set, WAF  automatically  updates
                               all rules that reference it.

                               ARN -> (string)
                                   The  Amazon  Resource  Name  (ARN)  of  the
                                   IPSet that this statement references.

                               IPSetForwardedIPConfig -> (structure)
                                   The configuration  for  inspecting  IP  ad-
                                   dresses in an HTTP header that you specify,
                                   instead of using the IP address that's  re-
                                   ported by the web request origin. Commonly,
                                   this is the X-Forwarded-For  (XFF)  header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the request, WAF doesn't apply the  rule
                                      to the web request at all.

                                   HeaderName -> (string)
                                      The  name  of the HTTP header to use for
                                      the IP address. For example, to use  the
                                      X-Forwarded-For  (XFF)  header, set this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The  match  status  to assign to the web
                                      request if the request  doesn't  have  a
                                      valid  IP address in the specified posi-
                                      tion.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      You  can  specify the following fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching  the  rule statement. WAF ap-
                                        plies the rule action to the request.

                                      o NO_MATCH - Treat the  web  request  as
                                        not matching the rule statement.

                                   Position -> (string)
                                      The position in the header to search for
                                      the IP address. The header  can  contain
                                      IP  addresses of the original client and
                                      also of proxies. For example, the header
                                      value   could  be  10.1.1.1,  127.0.0.0,
                                      10.10.10.10 where the first  IP  address
                                      identifies  the  original client and the
                                      rest identify proxies that  the  request
                                      went through.

                                      The  options  for  this  setting are the
                                      following:

                                      o FIRST - Inspect the first  IP  address
                                        in  the  list  of  IP addresses in the
                                        header. This is usually  the  client's
                                        original IP.

                                      o LAST  - Inspect the last IP address in
                                        the  list  of  IP  addresses  in   the
                                        header.

                                      o ANY  - Inspect all IP addresses in the
                                        header for a match. If the header con-
                                        tains  more  than 10 IP addresses, WAF
                                        inspects the last 10.

                            RegexPatternSetReferenceStatement -> (structure)
                               A rule statement used  to  search  web  request
                               components  for  matches  with  regular expres-
                               sions. To use this, create  a   RegexPatternSet
                               that specifies the expressions that you want to
                               detect, then use the ARN of that  set  in  this
                               statement.  A  web  request matches the pattern
                               set rule statement  if  the  request  component
                               matches any of the patterns in the set. To cre-
                               ate a regex pattern set,  see   CreateRegexPat-
                               ternSet .

                               Each  regex  pattern  set rule statement refer-
                               ences a regex pattern set. You create and main-
                               tain  the  set  independent of your rules. This
                               allows you to use the single  set  in  multiple
                               rules.  When you update the referenced set, WAF
                               automatically updates all rules that  reference
                               it.

                               ARN -> (string)
                                   The Amazon Resource Name (ARN) of the  Reg-
                                   exPatternSet  that  this  statement  refer-
                                   ences.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to  inspect.  For  more  information,   see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect  a  single  header.  Provide the
                                      name of the header to inspect, for exam-
                                      ple,  User-Agent  or Referer . This set-
                                      ting isn't case sensitive.

                                      Example JSON: "SingleHeader": {  "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The  name of the query header to in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the  name  of  the query argument to in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This is used only to  indicate  the  web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example JSON:  "SingleQueryArgument":  {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The  name  of  the query argument to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect the request URI  path.  This  is
                                      the  part  of a web request that identi-
                                      fies  a  resource,  for  example,   /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect  the  query  string. This is the
                                      part of a URL that  appears  after  a  ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect  the request body as plain text.
                                      The request body immediately follows the
                                      request  headers.  This is the part of a
                                      request  that  contains  any  additional
                                      data  that  you want to send to your web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect  the HTTP method. The method in-
                                      dicates the type of operation  that  the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect  the  request  body as JSON. The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest that contains any additional  data
                                      that you want to send to your web server
                                      as the HTTP request body, such  as  data
                                      from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text transformations eliminate some of  the
                                   unusual  formatting  that  attackers use in
                                   web requests in an effort to bypass  detec-
                                   tion.  If you specify one or more transfor-
                                   mations in a rule statement,  WAF  performs
                                   all  transformations  on the content of the
                                   request  component  identified  by   Field-
                                   ToMatch , starting from the lowest priority
                                   setting, before inspecting the content  for
                                   a match.

                                   (structure)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets the relative  processing  order
                                          for  multiple  transformations  that
                                          are defined for  a  rule  statement.
                                          WAF  processes  all transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent. The priorities don't  need  to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                            RateBasedStatement -> (structure)
                               A  rate-based  rule tracks the rate of requests
                               for each originating IP address,  and  triggers
                               the  rule  action when the rate exceeds a limit
                               that you specify on the number of  requests  in
                               any 5-minute time span. You can use this to put
                               a temporary block on requests from  an  IP  ad-
                               dress that is sending excessive requests.

                               WAF  tracks and manages web requests separately
                               for each instance of a rate-based rule that you
                               use.  For  example,  if  you  provide  the same
                               rate-based rule settings in two web ACLs,  each
                               of  the  two rule statements represents a sepa-
                               rate instance of the rate-based rule  and  gets
                               its  own tracking and management by WAF. If you
                               define a rate-based rule inside a  rule  group,
                               and  then  use  that  rule  group  in  multiple
                               places, each use creates a separate instance of
                               the  rate-based rule that gets its own tracking
                               and management by WAF.

                               When the rule action triggers, WAF blocks addi-
                               tional  requests  from the IP address until the
                               request rate falls below the limit.

                               You can optionally nest another  statement  in-
                               side  the  rate-based  statement, to narrow the
                               scope of the rule so that it  only  counts  re-
                               quests that match the nested statement. For ex-
                               ample, based on recent requests that  you  have
                               seen  from  an  attacker,  you  might  create a
                               rate-based rule with a nested AND  rule  state-
                               ment  that contains the following nested state-
                               ments:

                               o An IP match statement with  an  IP  set  that
                                 specified the address 192.0.2.44.

                               o A string match statement that searches in the
                                 User-Agent header for the string BadBot.

                               In this rate-based rule, you also define a rate
                               limit.  For  this  example,  the  rate limit is
                               1,000. Requests that meet both  of  the  condi-
                               tions  in  the  statements  are counted. If the
                               count exceeds 1,000 requests per five  minutes,
                               the  rule action triggers. Requests that do not
                               meet both conditions are  not  counted  towards
                               the  rate  limit  and  are not affected by this
                               rule.

                               You cannot nest a RateBasedStatement inside an-
                               other statement, for example inside a NotState-
                               ment or OrStatement . You can  define  a  Rate-
                               BasedStatement  inside  a  web ACL and inside a
                               rule group.

                               Limit -> (long)
                                   The limit on requests per  5-minute  period
                                   for a single originating IP address. If the
                                   statement includes a  ScopeDownStatement  ,
                                   this  limit is applied only to the requests
                                   that match the statement.

                               AggregateKeyType -> (string)
                                   Setting that indicates how to aggregate the
                                   request counts. The options are the follow-
                                   ing:

                                   o IP - Aggregate the request counts on  the
                                     IP address from the web request origin.

                                   o FORWARDED_IP   -  Aggregate  the  request
                                     counts on the first IP address in an HTTP
                                     header.  If  you  use this, configure the
                                     ForwardedIPConfig , to specify the header
                                     to use.

                               (   ...  recursive  ...  )ForwardedIPConfig  ->
                               (structure)
                                   The configuration  for  inspecting  IP  ad-
                                   dresses in an HTTP header that you specify,
                                   instead of using the IP address that's  re-
                                   ported by the web request origin. Commonly,
                                   this is the X-Forwarded-For  (XFF)  header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the request, WAF doesn't apply the  rule
                                      to the web request at all.

                                   This is required if AggregateKeyType is set
                                   to FORWARDED_IP .

                                   HeaderName -> (string)
                                      The name of the HTTP header to  use  for
                                      the  IP address. For example, to use the
                                      X-Forwarded-For (XFF) header,  set  this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The match status to assign  to  the  web
                                      request  if  the  request doesn't have a
                                      valid IP address in the specified  posi-
                                      tion.

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                      You can specify the  following  fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching the rule statement.  WAF  ap-
                                        plies the rule action to the request.

                                      o NO_MATCH  -  Treat  the web request as
                                        not matching the rule statement.

                            AndStatement -> (structure)
                               A logical rule statement used to combine  other
                               rule  statements  with  AND  logic. You provide
                               more than one  Statement within  the  AndState-
                               ment .

                               Statements -> (list)
                                   The  statements  to combine with AND logic.
                                   You can use  any  statements  that  can  be
                                   nested.

                                   ( ... recursive ... )

                            OrStatement -> (structure)
                               A  logical rule statement used to combine other
                               rule statements with OR logic. You provide more
                               than one  Statement within the OrStatement .

                               Statements -> (list)
                                   The  statements  to  combine with OR logic.
                                   You can use  any  statements  that  can  be
                                   nested.

                                   ( ... recursive ... )

                            NotStatement -> (structure)
                               A logical rule statement used to negate the re-
                               sults of another rule  statement.  You  provide
                               one  Statement within the NotStatement .

                               ( ... recursive ... )

                            ManagedRuleGroupStatement -> (structure)
                               A rule statement used to run the rules that are
                               defined in a managed rule group. To  use  this,
                               provide  the  vendor  name  and the name of the
                               rule group in this statement. You can  retrieve
                               the  required names by calling  ListAvailableM-
                               anagedRuleGroups .

                               You cannot nest a  ManagedRuleGroupStatement  ,
                               for  example  for  use inside a NotStatement or
                               OrStatement . It can only be  referenced  as  a
                               top-level statement within a rule.

                               VendorName -> (string)
                                   The  name of the managed rule group vendor.
                                   You use this, along  with  the  rule  group
                                   name, to identify the rule group.

                               Name -> (string)
                                   The name of the managed rule group. You use
                                   this, along with the vendor name, to  iden-
                                   tify the rule group.

                               Version -> (string)
                                   The  version  of  the managed rule group to
                                   use. If you specify this, the version  set-
                                   ting  is  fixed until you change it. If you
                                   don't specify this, WAF uses  the  vendor's
                                   default version, and then keeps the version
                                   at the vendor's default when the vendor up-
                                   dates the managed rule group settings.

                               ExcludedRules -> (list)
                                   The  rules  in  the  referenced  rule group
                                   whose actions are set to Count .  When  you
                                   exclude a rule, WAF evaluates it exactly as
                                   it would if the rule  action  setting  were
                                   Count . This is a useful option for testing
                                   the rules in a rule group without modifying
                                   how they handle your web traffic.

                                   (structure)
                                      Specifies  a single rule in a rule group
                                      whose action you  want  to  override  to
                                      Count  .  When  you  exclude a rule, WAF
                                      evaluates it exactly as it would if  the
                                      rule action setting were Count . This is
                                      a useful option for testing the rules in
                                      a  rule group without modifying how they
                                      handle your web traffic.

                                      Name -> (string)
                                          The name of the  rule  whose  action
                                          you want to override to Count .

                               ( ... recursive ... )

                            LabelMatchStatement -> (structure)
                               A  rule  statement  that defines a string match
                               search against labels that have been  added  to
                               the  web request by rules that have already run
                               in the web ACL.

                               The label match statement provides the label or
                               namespace  string  to  search  for.  The  label
                               string can represent a part or all of the fully
                               qualified label name that had been added to the
                               web request. Fully qualified labels have a pre-
                               fix,  optional  namespaces, and label name. The
                               prefix identifies the rule  group  or  web  ACL
                               context  of  the  rule that added the label. If
                               you do not provide the fully qualified name  in
                               your  label  match  string,  WAF  performs  the
                               search for labels that were added in  the  same
                               context as the label match statement.

                               Scope -> (string)
                                   Specify whether you want to match using the
                                   label name or just the namespace.

                               Key -> (string)
                                   The string to match  against.  The  setting
                                   you  provide  for this depends on the match
                                   statement's Scope setting:

                                   o If the Scope indicates LABEL , then  this
                                     specification  must  include the name and
                                     can include any number of preceding name-
                                     space  specifications  and  prefix  up to
                                     providing the fully qualified label name.

                                   o If the Scope indicates NAMESPACE  ,  then
                                     this specification can include any number
                                     of contiguous namespace strings, and  can
                                     include the entire label namespace prefix
                                     from the rule group or web ACL where  the
                                     label originates.

                                   Labels are case sensitive and components of
                                   a label must be separated by colon, for ex-
                                   ample NS1:NS2:name .

                            RegexMatchStatement -> (structure)
                               A  rule  statement  used  to search web request
                               components for a match against a single regular
                               expression.

                               RegexString -> (string)
                                   The string representing the regular expres-
                                   sion.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to   inspect.  For  more  information,  see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This  is  used  only to indicate the web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of a web request  that  identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. If you specify one or more  transfor-
                                   mations  in  a rule statement, WAF performs
                                   all transformations on the content  of  the
                                   request   component  identified  by  Field-
                                   ToMatch , starting from the lowest priority
                                   setting,  before inspecting the content for
                                   a match.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations  that
                                          are  defined  for  a rule statement.
                                          WAF processes  all  transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent.  The  priorities don't need to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                        ForwardedIPConfig -> (structure)
                            The configuration for inspecting IP  addresses  in
                            an  HTTP header that you specify, instead of using
                            the IP address that's reported by the web  request
                            origin.  Commonly,  this  is  the  X-Forwarded-For
                            (XFF) header, but you can specify any header name.

                            NOTE:
                               If the specified header isn't  present  in  the
                               request,  WAF doesn't apply the rule to the web
                               request at all.

                            This is required if  AggregateKeyType  is  set  to
                            FORWARDED_IP .

                            HeaderName -> (string)
                               The  name  of the HTTP header to use for the IP
                               address.  For  example,  to  use   the   X-For-
                               warded-For  (XFF)  header,  set  this to X-For-
                               warded-For .

                               NOTE:
                                   If the specified header  isn't  present  in
                                   the  request, WAF doesn't apply the rule to
                                   the web request at all.

                            FallbackBehavior -> (string)
                               The match status to assign to the  web  request
                               if  the request doesn't have a valid IP address
                               in the specified position.

                               NOTE:
                                   If the specified header  isn't  present  in
                                   the  request, WAF doesn't apply the rule to
                                   the web request at all.

                               You can specify the following  fallback  behav-
                               iors:

                               o MATCH - Treat the web request as matching the
                                 rule statement. WAF applies the  rule  action
                                 to the request.

                               o NO_MATCH  -  Treat  the  web  request  as not
                                 matching the rule statement.

                     AndStatement -> (structure)
                        A logical rule statement used to  combine  other  rule
                        statements  with  AND logic. You provide more than one
                        Statement within the AndStatement .

                        Statements -> (list)
                            The statements to combine with AND logic. You  can
                            use any statements that can be nested.

                            (structure)
                               The  processing  guidance for a  Rule , used by
                               WAF to determine whether a web request  matches
                               the rule.

                               ByteMatchStatement -> (structure)
                                   A  rule  statement  that  defines  a string
                                   match search for WAF to apply  to  web  re-
                                   quests.  The  byte match statement provides
                                   the bytes to search for,  the  location  in
                                   requests  that  you want WAF to search, and
                                   other settings. The bytes to search for are
                                   typically  a  string  that corresponds with
                                   ASCII characters. In the  WAF  console  and
                                   the  developer guide, this is refered to as
                                   a string match statement.

                                   SearchString -> (blob)
                                      A string value  that  you  want  WAF  to
                                      search  for.  WAF  searches  only in the
                                      part of web requests that you  designate
                                      for  inspection  in   FieldToMatch . The
                                      maximum length of the value is 50 bytes.

                                      Valid values  depend  on  the  component
                                      that   you  specify  for  inspection  in
                                      FieldToMatch :

                                      o Method : The HTTP method that you want
                                        WAF  to search for. This indicates the
                                        type of operation specified in the re-
                                        quest.

                                      o UriPath  : The value that you want WAF
                                        to search for in the URI path, for ex-
                                        ample, /images/daily-ad.jpg .

                                      If   SearchString   includes  alphabetic
                                      characters A-Z and a-z,  note  that  the
                                      value is case sensitive.
                                          If you're using the WAF API

                                      Specify  a base64-encoded version of the
                                      value. The maximum length of  the  value
                                      before you base64-encode it is 50 bytes.

                                      For  example,  suppose the value of Type
                                      is HEADER  and  the  value  of  Data  is
                                      User-Agent  .  If you want to search the
                                      User-Agent header for the value BadBot ,
                                      you   base64-encode  BadBot  using  MIME
                                      base64-encoding and include the  result-
                                      ing  value,  QmFkQm90  , in the value of
                                      SearchString .
                                          If you're using the CLI  or  one  of
                                          the Amazon Web Services SDKs

                                      The  value  that  you want WAF to search
                                      for. The SDK  automatically  base64  en-
                                      codes the value.

                                   FieldToMatch -> (structure)
                                      The  part of a web request that you want
                                      WAF to inspect.  For  more  information,
                                      see  FieldToMatch .

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name of the header to  inspect,  for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example  JSON:   "SingleHeader":   {
                                          "Name": "haystack" }

                                          Name -> (string)
                                             The  name  of the query header to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide  the name of the query argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion  . The name can be up to
                                          30 characters long  and  isn't  case
                                          sensitive.

                                          This  is  used  only to indicate the
                                          web request component for WAF to in-
                                          spect, in the  FieldToMatch specifi-
                                          cation.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect the request URI  path.  This
                                          is  the  part  of a web request that
                                          identifies a resource, for  example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect  the  query  string. This is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect  the  request  body as plain
                                          text. The request  body  immediately
                                          follows the request headers. This is
                                          the part of a request that  contains
                                          any additional data that you want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                      Method -> (structure)
                                          Inspect the HTTP method. The  method
                                          indicates the type of operation that
                                          the request is asking the origin  to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect  the  request  body as JSON.
                                          The request body immediately follows
                                          the  request  headers.  This  is the
                                          part of a request that contains  any
                                          additional  data  that  you  want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                          MatchPattern -> (structure)
                                             The patterns to look for  in  the
                                             JSON  body.  WAF inspects the re-
                                             sults of  these  pattern  matches
                                             against  the rule inspection cri-
                                             teria.

                                             All -> (structure)
                                                 Match all  of  the  elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You must specify either  this
                                                 setting  or the IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match only the specified  in-
                                                 clude  paths. See also Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing  JSON Pointer syntax. For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"] . For  infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force   (IETF)  documentation
                                                 JavaScript  Object   Notation
                                                 (JSON) Pointer .

                                                 You  must specify either this
                                                 setting or the  All  setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't  use  this option to
                                                    include  all  paths.   In-
                                                    stead,  use  the  All set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the  JSON  to  match
                                             against  using the MatchPattern .
                                             If you specify All , WAF  matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely parse the  JSON  body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING   -  Inspect
                                               the body as plain text. WAF ap-
                                               plies  the text transformations
                                               and  inspection  criteria  that
                                               you  defined  for  the JSON in-
                                               spection  to  the   body   text
                                               string.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             If you don't  provide  this  set-
                                             ting,  WAF  parses  and evaluates
                                             the content only up to the  first
                                             parsing  failure  that it encoun-
                                             ters.

                                             WAF does its best  to  parse  the
                                             entire  JSON  body,  but might be
                                             forced to stop for  reasons  such
                                             as  invalid characters, duplicate
                                             keys, truncation, and any content
                                             whose  root  node isn't an object
                                             or an array.

                                             WAF parses the JSON in  the  fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                   TextTransformations -> (list)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass  detection.  If  you specify one or
                                      more transformations in  a  rule  state-
                                      ment,  WAF  performs all transformations
                                      on the content of the request  component
                                      identified  by  FieldToMatch  , starting
                                      from the lowest priority setting, before
                                      inspecting the content for a match.

                                      (structure)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets the relative processing  or-
                                             der  for multiple transformations
                                             that  are  defined  for  a   rule
                                             statement.   WAF   processes  all
                                             transformations, from lowest pri-
                                             ority to highest, before inspect-
                                             ing the transformed content.  The
                                             priorities  don't need to be con-
                                             secutive, but they  must  all  be
                                             different.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE  -   Decode   a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT  - Decode a
                                                 Base64 -encoded  string,  but
                                                 use  a  forgiving implementa-
                                                 tion that ignores  characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.  These   are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual  formatting to disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete  spaces  before the fol-
                                               lowing characters: / (

                                             o Replace the  following  charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE   -  Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r  ,  carriage return, decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places  multiple  spaces with
                                                 one space.

                                                 CSS_DECODE -  Decode  charac-
                                                 ters  that were encoded using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in  the  decoding process, so
                                                 it can help to uncover  ASCII
                                                 characters  that were encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's also useful in  counter-
                                                 ing  evasion, which is a com-
                                                 bination of a  backslash  and
                                                 non-hexadecimal   characters.
                                                 For example, ja\vascript  for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE   -  Decode
                                                 the following ANSI  C  escape
                                                 sequences:  \a , \b , \f , \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 ,  \"  ,  \xHH (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't  valid  remain  in the
                                                 output.

                                                 HEX_DECODE - Decode a  string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE -  Replace
                                                 HTML-encoded  characters with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces (ampersand)quot;  with
                                               "

                                             o Replaces  (ampersand)nbsp; with
                                               a non-breaking  space,  decimal
                                               160

                                             o Replaces  (ampersand)lt; with a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat, (ampersand)#xhhhh; ,  with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented in decimal  format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape  sequences.  If a \  u
                                                 HHHH   code   is    in    the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,   then   the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not,  only  the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5 - Calculate an  MD5  hash
                                                 from  the  data in the input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE  -  Specify  NONE if you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH  - Remove mul-
                                                 tiple   slashes,    directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not  at  the beginning of the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN - This  is
                                                 the  same as NORMALIZE_PATH ,
                                                 but first converts  backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS  -  Remove   all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS   -  Replace
                                                 each occurrence of a  C-style
                                                 comment  (/*  ... */ ) with a
                                                 single space.  Multiple  con-
                                                 secutive  occurrences are not
                                                 compressed. Unterminated com-
                                                 ments  are also replaced with
                                                 a space  (ASCII  0x20).  How-
                                                 ever,  a  standalone termina-
                                                 tion of a comment  (*/  )  is
                                                 not acted upon.

                                                 REPLACE_NULLS  - Replace NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE  -  Decode SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE  ,  but with support for
                                                 Microsoft-specific %u  encod-
                                                 ing.  If  the  code is in the
                                                 full-width ASCII  code  range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte is used  to  detect  and
                                                 adjust the lower byte. Other-
                                                 wise, only the lower byte  is
                                                 used  and  the higher byte is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8  character sequences to
                                                 Unicode.  This  helps   input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives  for non-Eng-
                                                 lish languages.

                                   PositionalConstraint -> (string)
                                      The area within the portion of a web re-
                                      quest  that  you  want WAF to search for
                                      SearchString . Valid values include  the
                                      following:
                                          CONTAINS

                                      The  specified  part  of the web request
                                      must include the value of SearchString ,
                                      but the location doesn't matter.
                                          CONTAINS_WORD

                                      The  specified  part  of the web request
                                      must include the value of SearchString ,
                                      and  SearchString  must contain only al-
                                      phanumeric  characters   or   underscore
                                      (A-Z,  a-z,  0-9,  or  _).  In addition,
                                      SearchString must be a word, which means
                                      that both of the following are true:

                                      o SearchString  is  at  the beginning of
                                        the specified part of the web  request
                                        or  is  preceded  by a character other
                                        than an alphanumeric character or  un-
                                        derscore  (_).  Examples  include  the
                                        value of a header and ;BadBot .

                                      o SearchString is  at  the  end  of  the
                                        specified  part  of the web request or
                                        is followed by a character other  than
                                        an  alphanumeric  character  or under-
                                        score (_), for  example,  BadBot;  and
                                        -BadBot; .
                                          EXACTLY

                                      The  value  of the specified part of the
                                      web request must exactly match the value
                                      of SearchString .
                                          STARTS_WITH

                                      The value of SearchString must appear at
                                      the beginning of the specified  part  of
                                      the web request.
                                          ENDS_WITH

                                      The value of SearchString must appear at
                                      the end of the specified part of the web
                                      request.

                               SqliMatchStatement -> (structure)
                                   Attackers  sometimes  insert  malicious SQL
                                   code into web requests in an effort to  ex-
                                   tract  data from your database. To allow or
                                   block web requests that appear  to  contain
                                   malicious  SQL code, create one or more SQL
                                   injection match conditions. An  SQL  injec-
                                   tion match condition identifies the part of
                                   web requests, such as the URI or the  query
                                   string, that you want WAF to inspect. Later
                                   in the process, when you create a web  ACL,
                                   you  specify  whether to allow or block re-
                                   quests that appear to contain malicious SQL
                                   code.

                                   FieldToMatch -> (structure)
                                      The  part of a web request that you want
                                      WAF to inspect.  For  more  information,
                                      see  FieldToMatch .

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name of the header to  inspect,  for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example  JSON:   "SingleHeader":   {
                                          "Name": "haystack" }

                                          Name -> (string)
                                             The  name  of the query header to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide  the name of the query argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion  . The name can be up to
                                          30 characters long  and  isn't  case
                                          sensitive.

                                          This  is  used  only to indicate the
                                          web request component for WAF to in-
                                          spect, in the  FieldToMatch specifi-
                                          cation.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect the request URI  path.  This
                                          is  the  part  of a web request that
                                          identifies a resource, for  example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect  the  query  string. This is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect  the  request  body as plain
                                          text. The request  body  immediately
                                          follows the request headers. This is
                                          the part of a request that  contains
                                          any additional data that you want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                      Method -> (structure)
                                          Inspect the HTTP method. The  method
                                          indicates the type of operation that
                                          the request is asking the origin  to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect  the  request  body as JSON.
                                          The request body immediately follows
                                          the  request  headers.  This  is the
                                          part of a request that contains  any
                                          additional  data  that  you  want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                          MatchPattern -> (structure)
                                             The patterns to look for  in  the
                                             JSON  body.  WAF inspects the re-
                                             sults of  these  pattern  matches
                                             against  the rule inspection cri-
                                             teria.

                                             All -> (structure)
                                                 Match all  of  the  elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You must specify either  this
                                                 setting  or the IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match only the specified  in-
                                                 clude  paths. See also Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing  JSON Pointer syntax. For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"] . For  infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force   (IETF)  documentation
                                                 JavaScript  Object   Notation
                                                 (JSON) Pointer .

                                                 You  must specify either this
                                                 setting or the  All  setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't  use  this option to
                                                    include  all  paths.   In-
                                                    stead,  use  the  All set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the  JSON  to  match
                                             against  using the MatchPattern .
                                             If you specify All , WAF  matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely parse the  JSON  body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING   -  Inspect
                                               the body as plain text. WAF ap-
                                               plies  the text transformations
                                               and  inspection  criteria  that
                                               you  defined  for  the JSON in-
                                               spection  to  the   body   text
                                               string.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             If you don't  provide  this  set-
                                             ting,  WAF  parses  and evaluates
                                             the content only up to the  first
                                             parsing  failure  that it encoun-
                                             ters.

                                             WAF does its best  to  parse  the
                                             entire  JSON  body,  but might be
                                             forced to stop for  reasons  such
                                             as  invalid characters, duplicate
                                             keys, truncation, and any content
                                             whose  root  node isn't an object
                                             or an array.

                                             WAF parses the JSON in  the  fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                   TextTransformations -> (list)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass  detection.  If  you specify one or
                                      more transformations in  a  rule  state-
                                      ment,  WAF  performs all transformations
                                      on the content of the request  component
                                      identified  by  FieldToMatch  , starting
                                      from the lowest priority setting, before
                                      inspecting the content for a match.

                                      (structure)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets the relative processing  or-
                                             der  for multiple transformations
                                             that  are  defined  for  a   rule
                                             statement.   WAF   processes  all
                                             transformations, from lowest pri-
                                             ority to highest, before inspect-
                                             ing the transformed content.  The
                                             priorities  don't need to be con-
                                             secutive, but they  must  all  be
                                             different.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE  -   Decode   a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT  - Decode a
                                                 Base64 -encoded  string,  but
                                                 use  a  forgiving implementa-
                                                 tion that ignores  characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.  These   are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual  formatting to disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete  spaces  before the fol-
                                               lowing characters: / (

                                             o Replace the  following  charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE   -  Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r  ,  carriage return, decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places  multiple  spaces with
                                                 one space.

                                                 CSS_DECODE -  Decode  charac-
                                                 ters  that were encoded using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in  the  decoding process, so
                                                 it can help to uncover  ASCII
                                                 characters  that were encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's also useful in  counter-
                                                 ing  evasion, which is a com-
                                                 bination of a  backslash  and
                                                 non-hexadecimal   characters.
                                                 For example, ja\vascript  for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE   -  Decode
                                                 the following ANSI  C  escape
                                                 sequences:  \a , \b , \f , \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 ,  \"  ,  \xHH (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't  valid  remain  in the
                                                 output.

                                                 HEX_DECODE - Decode a  string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE -  Replace
                                                 HTML-encoded  characters with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces (ampersand)quot;  with
                                               "

                                             o Replaces  (ampersand)nbsp; with
                                               a non-breaking  space,  decimal
                                               160

                                             o Replaces  (ampersand)lt; with a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat, (ampersand)#xhhhh; ,  with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented in decimal  format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape  sequences.  If a \  u
                                                 HHHH   code   is    in    the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,   then   the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not,  only  the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5 - Calculate an  MD5  hash
                                                 from  the  data in the input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE  -  Specify  NONE if you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH  - Remove mul-
                                                 tiple   slashes,    directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not  at  the beginning of the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN - This  is
                                                 the  same as NORMALIZE_PATH ,
                                                 but first converts  backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS  -  Remove   all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS   -  Replace
                                                 each occurrence of a  C-style
                                                 comment  (/*  ... */ ) with a
                                                 single space.  Multiple  con-
                                                 secutive  occurrences are not
                                                 compressed. Unterminated com-
                                                 ments  are also replaced with
                                                 a space  (ASCII  0x20).  How-
                                                 ever,  a  standalone termina-
                                                 tion of a comment  (*/  )  is
                                                 not acted upon.

                                                 REPLACE_NULLS  - Replace NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE  -  Decode SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE  ,  but with support for
                                                 Microsoft-specific %u  encod-
                                                 ing.  If  the  code is in the
                                                 full-width ASCII  code  range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte is used  to  detect  and
                                                 adjust the lower byte. Other-
                                                 wise, only the lower byte  is
                                                 used  and  the higher byte is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8  character sequences to
                                                 Unicode.  This  helps   input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives  for non-Eng-
                                                 lish languages.

                               XssMatchStatement -> (structure)
                                   A rule statement that defines a  cross-site
                                   scripting (XSS) match search for WAF to ap-
                                   ply to web requests. XSS attacks are  those
                                   where  the attacker uses vulnerabilities in
                                   a benign website as a vehicle to inject ma-
                                   licious  client-site scripts into other le-
                                   gitimate web browsers. The XSS match state-
                                   ment provides the location in requests that
                                   you want WAF to search and text transforma-
                                   tions  to use on the search area before WAF
                                   searches for character sequences  that  are
                                   likely to be malicious strings.

                                   FieldToMatch -> (structure)
                                      The  part of a web request that you want
                                      WAF to inspect.  For  more  information,
                                      see  FieldToMatch .

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name of the header to  inspect,  for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example  JSON:   "SingleHeader":   {
                                          "Name": "haystack" }

                                          Name -> (string)
                                             The  name  of the query header to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide  the name of the query argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion  . The name can be up to
                                          30 characters long  and  isn't  case
                                          sensitive.

                                          This  is  used  only to indicate the
                                          web request component for WAF to in-
                                          spect, in the  FieldToMatch specifi-
                                          cation.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect the request URI  path.  This
                                          is  the  part  of a web request that
                                          identifies a resource, for  example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect  the  query  string. This is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect  the  request  body as plain
                                          text. The request  body  immediately
                                          follows the request headers. This is
                                          the part of a request that  contains
                                          any additional data that you want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                      Method -> (structure)
                                          Inspect the HTTP method. The  method
                                          indicates the type of operation that
                                          the request is asking the origin  to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect  the  request  body as JSON.
                                          The request body immediately follows
                                          the  request  headers.  This  is the
                                          part of a request that contains  any
                                          additional  data  that  you  want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                          MatchPattern -> (structure)
                                             The patterns to look for  in  the
                                             JSON  body.  WAF inspects the re-
                                             sults of  these  pattern  matches
                                             against  the rule inspection cri-
                                             teria.

                                             All -> (structure)
                                                 Match all  of  the  elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You must specify either  this
                                                 setting  or the IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match only the specified  in-
                                                 clude  paths. See also Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing  JSON Pointer syntax. For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"] . For  infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force   (IETF)  documentation
                                                 JavaScript  Object   Notation
                                                 (JSON) Pointer .

                                                 You  must specify either this
                                                 setting or the  All  setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't  use  this option to
                                                    include  all  paths.   In-
                                                    stead,  use  the  All set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the  JSON  to  match
                                             against  using the MatchPattern .
                                             If you specify All , WAF  matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely parse the  JSON  body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING   -  Inspect
                                               the body as plain text. WAF ap-
                                               plies  the text transformations
                                               and  inspection  criteria  that
                                               you  defined  for  the JSON in-
                                               spection  to  the   body   text
                                               string.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             If you don't  provide  this  set-
                                             ting,  WAF  parses  and evaluates
                                             the content only up to the  first
                                             parsing  failure  that it encoun-
                                             ters.

                                             WAF does its best  to  parse  the
                                             entire  JSON  body,  but might be
                                             forced to stop for  reasons  such
                                             as  invalid characters, duplicate
                                             keys, truncation, and any content
                                             whose  root  node isn't an object
                                             or an array.

                                             WAF parses the JSON in  the  fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                   TextTransformations -> (list)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass  detection.  If  you specify one or
                                      more transformations in  a  rule  state-
                                      ment,  WAF  performs all transformations
                                      on the content of the request  component
                                      identified  by  FieldToMatch  , starting
                                      from the lowest priority setting, before
                                      inspecting the content for a match.

                                      (structure)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets the relative processing  or-
                                             der  for multiple transformations
                                             that  are  defined  for  a   rule
                                             statement.   WAF   processes  all
                                             transformations, from lowest pri-
                                             ority to highest, before inspect-
                                             ing the transformed content.  The
                                             priorities  don't need to be con-
                                             secutive, but they  must  all  be
                                             different.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE  -   Decode   a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT  - Decode a
                                                 Base64 -encoded  string,  but
                                                 use  a  forgiving implementa-
                                                 tion that ignores  characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.  These   are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual  formatting to disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete  spaces  before the fol-
                                               lowing characters: / (

                                             o Replace the  following  charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE   -  Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r  ,  carriage return, decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places  multiple  spaces with
                                                 one space.

                                                 CSS_DECODE -  Decode  charac-
                                                 ters  that were encoded using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in  the  decoding process, so
                                                 it can help to uncover  ASCII
                                                 characters  that were encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's also useful in  counter-
                                                 ing  evasion, which is a com-
                                                 bination of a  backslash  and
                                                 non-hexadecimal   characters.
                                                 For example, ja\vascript  for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE   -  Decode
                                                 the following ANSI  C  escape
                                                 sequences:  \a , \b , \f , \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 ,  \"  ,  \xHH (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't  valid  remain  in the
                                                 output.

                                                 HEX_DECODE - Decode a  string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE -  Replace
                                                 HTML-encoded  characters with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces (ampersand)quot;  with
                                               "

                                             o Replaces  (ampersand)nbsp; with
                                               a non-breaking  space,  decimal
                                               160

                                             o Replaces  (ampersand)lt; with a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat, (ampersand)#xhhhh; ,  with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented in decimal  format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape  sequences.  If a \  u
                                                 HHHH   code   is    in    the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,   then   the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not,  only  the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5 - Calculate an  MD5  hash
                                                 from  the  data in the input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE  -  Specify  NONE if you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH  - Remove mul-
                                                 tiple   slashes,    directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not  at  the beginning of the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN - This  is
                                                 the  same as NORMALIZE_PATH ,
                                                 but first converts  backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS  -  Remove   all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS   -  Replace
                                                 each occurrence of a  C-style
                                                 comment  (/*  ... */ ) with a
                                                 single space.  Multiple  con-
                                                 secutive  occurrences are not
                                                 compressed. Unterminated com-
                                                 ments  are also replaced with
                                                 a space  (ASCII  0x20).  How-
                                                 ever,  a  standalone termina-
                                                 tion of a comment  (*/  )  is
                                                 not acted upon.

                                                 REPLACE_NULLS  - Replace NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE  -  Decode SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE  ,  but with support for
                                                 Microsoft-specific %u  encod-
                                                 ing.  If  the  code is in the
                                                 full-width ASCII  code  range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte is used  to  detect  and
                                                 adjust the lower byte. Other-
                                                 wise, only the lower byte  is
                                                 used  and  the higher byte is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8  character sequences to
                                                 Unicode.  This  helps   input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives  for non-Eng-
                                                 lish languages.

                               SizeConstraintStatement -> (structure)
                                   A rule statement that compares a number  of
                                   bytes  against the size of a request compo-
                                   nent, using a comparison operator, such  as
                                   greater  than (>) or less than (<). For ex-
                                   ample, you can use a size constraint state-
                                   ment  to  look  for  query strings that are
                                   longer than 100 bytes.

                                   If you configure WAF to inspect the request
                                   body,  WAF  inspects  only  the  first 8192
                                   bytes (8 KB). If the request body for  your
                                   web  requests never exceeds 8192 bytes, you
                                   can create a size constraint condition  and
                                   block  requests  that  have  a request body
                                   greater than 8192 bytes.

                                   If you choose URI for the value of Part  of
                                   the  request to filter on, the slash (/) in
                                   the URI counts as one character. For  exam-
                                   ple,  the  URI /logo.jpg is nine characters
                                   long.

                                   FieldToMatch -> (structure)
                                      The part of a web request that you  want
                                      WAF  to  inspect.  For more information,
                                      see  FieldToMatch .

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name  of  the header to inspect, for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example   JSON:   "SingleHeader":  {
                                          "Name": "haystack" }

                                          Name -> (string)
                                             The name of the query  header  to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide the name of the query  argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion . The name can be up  to
                                          30  characters  long  and isn't case
                                          sensitive.

                                          This is used only  to  indicate  the
                                          web request component for WAF to in-
                                          spect, in the  FieldToMatch specifi-
                                          cation.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect  the  request URI path. This
                                          is the part of a  web  request  that
                                          identifies  a resource, for example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect the query  string.  This  is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect the request  body  as  plain
                                          text.  The  request body immediately
                                          follows the request headers. This is
                                          the  part of a request that contains
                                          any additional data that you want to
                                          send  to your web server as the HTTP
                                          request body, such as  data  from  a
                                          form.

                                          Note  that only the first 8 KB (8192
                                          bytes) of the request body are  for-
                                          warded  to WAF for inspection by the
                                          underlying  host  service.  If   you
                                          don't  need  to  inspect more than 8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing a statement  that  inspects  the
                                          body  of  the  web  request, such as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement  ,  with a
                                          SizeConstraintStatement   that   en-
                                          forces  an  8  KB  size limit on the
                                          body of  the  request.  WAF  doesn't
                                          support  inspecting  the entire con-
                                          tents of web requests  whose  bodies
                                          exceed the 8 KB limit.

                                      Method -> (structure)
                                          Inspect  the HTTP method. The method
                                          indicates the type of operation that
                                          the  request is asking the origin to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect the request  body  as  JSON.
                                          The request body immediately follows
                                          the request  headers.  This  is  the
                                          part  of a request that contains any
                                          additional data  that  you  want  to
                                          send  to your web server as the HTTP
                                          request body, such as  data  from  a
                                          form.

                                          Note  that only the first 8 KB (8192
                                          bytes) of the request body are  for-
                                          warded  to WAF for inspection by the
                                          underlying  host  service.  If   you
                                          don't  need  to  inspect more than 8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing a statement  that  inspects  the
                                          body  of  the  web  request, such as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement  ,  with a
                                          SizeConstraintStatement   that   en-
                                          forces  an  8  KB  size limit on the
                                          body of  the  request.  WAF  doesn't
                                          support  inspecting  the entire con-
                                          tents of web requests  whose  bodies
                                          exceed the 8 KB limit.

                                          MatchPattern -> (structure)
                                             The  patterns  to look for in the
                                             JSON body. WAF inspects  the  re-
                                             sults  of  these  pattern matches
                                             against the rule inspection  cri-
                                             teria.

                                             All -> (structure)
                                                 Match  all  of  the elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You  must specify either this
                                                 setting or the  IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match  only the specified in-
                                                 clude paths. See also  Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing JSON Pointer syntax.  For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"]  . For infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force  (IETF)   documentation
                                                 JavaScript   Object  Notation
                                                 (JSON) Pointer .

                                                 You must specify either  this
                                                 setting  or  the All setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't use this  option  to
                                                    include   all  paths.  In-
                                                    stead, use  the  All  set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The  parts  of  the JSON to match
                                             against using the MatchPattern  .
                                             If  you specify All , WAF matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely  parse  the JSON body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING  -   Inspect
                                               the body as plain text. WAF ap-
                                               plies the text  transformations
                                               and  inspection  criteria  that
                                               you defined for  the  JSON  in-
                                               spection   to   the  body  text
                                               string.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             If  you  don't  provide this set-
                                             ting, WAF  parses  and  evaluates
                                             the  content only up to the first
                                             parsing failure that  it  encoun-
                                             ters.

                                             WAF  does  its  best to parse the
                                             entire JSON body,  but  might  be
                                             forced  to  stop for reasons such
                                             as invalid characters,  duplicate
                                             keys, truncation, and any content
                                             whose root node isn't  an  object
                                             or an array.

                                             WAF  parses  the JSON in the fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                   ComparisonOperator -> (string)
                                      The  operator  to use to compare the re-
                                      quest part to the size setting.

                                   Size -> (long)
                                      The size, in byte, to compare to the re-
                                      quest part, after any transformations.

                                   TextTransformations -> (list)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection. If you  specify  one  or
                                      more  transformations  in  a rule state-
                                      ment, WAF performs  all  transformations
                                      on  the content of the request component
                                      identified by  FieldToMatch  ,  starting
                                      from the lowest priority setting, before
                                      inspecting the content for a match.

                                      (structure)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets  the relative processing or-
                                             der for multiple  transformations
                                             that   are  defined  for  a  rule
                                             statement.  WAF   processes   all
                                             transformations, from lowest pri-
                                             ority to highest, before inspect-
                                             ing  the transformed content. The
                                             priorities don't need to be  con-
                                             secutive,  but  they  must all be
                                             different.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE   -   Decode  a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT - Decode  a
                                                 Base64  -encoded  string, but
                                                 use a  forgiving  implementa-
                                                 tion  that ignores characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.   These  are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual formatting to  disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete spaces before  the  fol-
                                               lowing characters: / (

                                             o Replace  the  following charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE  -   Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r , carriage  return,  decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places multiple  spaces  with
                                                 one space.

                                                 CSS_DECODE  -  Decode charac-
                                                 ters that were encoded  using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in the decoding  process,  so
                                                 it  can help to uncover ASCII
                                                 characters that were  encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's  also useful in counter-
                                                 ing evasion, which is a  com-
                                                 bination  of  a backslash and
                                                 non-hexadecimal   characters.
                                                 For  example, ja\vascript for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE  -   Decode
                                                 the  following  ANSI C escape
                                                 sequences: \a , \b , \f ,  \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 , \"  ,  \xHH  (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't valid  remain  in  the
                                                 output.

                                                 HEX_DECODE  - Decode a string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE  - Replace
                                                 HTML-encoded characters  with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces  (ampersand)quot; with
                                               "

                                             o Replaces (ampersand)nbsp;  with
                                               a  non-breaking  space, decimal
                                               160

                                             o Replaces (ampersand)lt; with  a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat,  (ampersand)#xhhhh; , with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented  in decimal format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape sequences. If a  \   u
                                                 HHHH    code    is   in   the
                                                 full-width ASCII  code  range
                                                 of   FF01-FF5E   ,  then  the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not, only the lower  byte  is
                                                 used  and  the higher byte is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5  -  Calculate an MD5 hash
                                                 from the data in  the  input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE - Specify  NONE  if  you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH - Remove  mul-
                                                 tiple    slashes,   directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not at the beginning  of  the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN  - This is
                                                 the same as NORMALIZE_PATH  ,
                                                 but  first converts backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS   -  Remove  all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS  -   Replace
                                                 each  occurrence of a C-style
                                                 comment (/* ... */ )  with  a
                                                 single  space.  Multiple con-
                                                 secutive occurrences are  not
                                                 compressed. Unterminated com-
                                                 ments are also replaced  with
                                                 a  space  (ASCII  0x20). How-
                                                 ever, a  standalone  termina-
                                                 tion  of  a  comment (*/ ) is
                                                 not acted upon.

                                                 REPLACE_NULLS - Replace  NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE -  Decode  SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE , but with  support  for
                                                 Microsoft-specific  %u encod-
                                                 ing. If the code  is  in  the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte  is  used  to detect and
                                                 adjust the lower byte. Other-
                                                 wise,  only the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8 character sequences  to
                                                 Unicode.   This  helps  input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives for  non-Eng-
                                                 lish languages.

                               GeoMatchStatement -> (structure)
                                   A  rule  statement used to identify web re-
                                   quests based on country of origin.

                                   CountryCodes -> (list)
                                      An array of two-character country codes,
                                      for  example,  [ "US", "CN" ] , from the
                                      alpha-2 country ISO  codes  of  the  ISO
                                      3166 international standard.

                                      (string)

                                   ForwardedIPConfig -> (structure)
                                      The  configuration for inspecting IP ad-
                                      dresses in an HTTP header that you spec-
                                      ify,  instead  of  using  the IP address
                                      that's reported by the web request  ori-
                                      gin.   Commonly,   this  is  the  X-For-
                                      warded-For (XFF)  header,  but  you  can
                                      specify any header name.

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                      HeaderName -> (string)
                                          The name of the HTTP header  to  use
                                          for  the IP address. For example, to
                                          use   the   X-Forwarded-For    (XFF)
                                          header,  set this to X-Forwarded-For
                                          .

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present   in   the  request,  WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                      FallbackBehavior -> (string)
                                          The  match  status  to assign to the
                                          web request if the  request  doesn't
                                          have a valid IP address in the spec-
                                          ified position.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present   in   the  request,  WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          You  can specify the following fall-
                                          back behaviors:

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                               RuleGroupReferenceStatement -> (structure)
                                   A rule statement used to run the rules that
                                   are defined in a  RuleGroup . To use  this,
                                   create  a  rule group with your rules, then
                                   provide the ARN of the rule group  in  this
                                   statement.

                                   You  cannot nest a RuleGroupReferenceState-
                                   ment , for example for use  inside  a  Not-
                                   Statement or OrStatement . You can only use
                                   a rule group reference statement at the top
                                   level inside a web ACL.

                                   ARN -> (string)
                                      The  Amazon  Resource  Name (ARN) of the
                                      entity.

                                   ExcludedRules -> (list)
                                      The rules in the referenced  rule  group
                                      whose  actions  are  set to Count . When
                                      you exclude a rule, WAF evaluates it ex-
                                      actly  as  it  would  if the rule action
                                      setting were Count . This  is  a  useful
                                      option  for  testing the rules in a rule
                                      group without modifying how they  handle
                                      your web traffic.

                                      (structure)
                                          Specifies  a  single  rule in a rule
                                          group whose action you want to over-
                                          ride  to  Count . When you exclude a
                                          rule, WAF evaluates it exactly as it
                                          would  if  the  rule  action setting
                                          were Count . This is a useful option
                                          for  testing  the  rules  in  a rule
                                          group  without  modifying  how  they
                                          handle your web traffic.

                                          Name -> (string)
                                             The name of the rule whose action
                                             you want to override to Count .

                               IPSetReferenceStatement -> (structure)
                                   A rule statement used  to  detect  web  re-
                                   quests  coming from particular IP addresses
                                   or address ranges. To use this,  create  an
                                   IPSet that specifies the addresses you want
                                   to detect, then use the ARN of that set  in
                                   this  statement.  To  create an IP set, see
                                   CreateIPSet .

                                   Each IP set rule statement references an IP
                                   set.  You create and maintain the set inde-
                                   pendent of your rules. This allows  you  to
                                   use  the single set in multiple rules. When
                                   you update the referenced set, WAF automat-
                                   ically updates all rules that reference it.

                                   ARN -> (string)
                                      The  Amazon  Resource  Name (ARN) of the
                                      IPSet that this statement references.

                                   IPSetForwardedIPConfig -> (structure)
                                      The configuration for inspecting IP  ad-
                                      dresses in an HTTP header that you spec-
                                      ify, instead of  using  the  IP  address
                                      that's  reported by the web request ori-
                                      gin.  Commonly,  this  is   the   X-For-
                                      warded-For  (XFF)  header,  but  you can
                                      specify any header name.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      HeaderName -> (string)
                                          The  name  of the HTTP header to use
                                          for the IP address. For example,  to
                                          use    the   X-Forwarded-For   (XFF)
                                          header, set this to  X-Forwarded-For
                                          .

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                      FallbackBehavior -> (string)
                                          The match status to  assign  to  the
                                          web  request  if the request doesn't
                                          have a valid IP address in the spec-
                                          ified position.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          You can specify the following  fall-
                                          back behaviors:

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                      Position -> (string)
                                          The position in the header to search
                                          for  the  IP address. The header can
                                          contain IP addresses of the original
                                          client  and also of proxies. For ex-
                                          ample, the  header  value  could  be
                                          10.1.1.1,   127.0.0.0,   10.10.10.10
                                          where the first IP  address  identi-
                                          fies  the  original  client  and the
                                          rest identify proxies that  the  re-
                                          quest went through.

                                          The options for this setting are the
                                          following:

                                          o FIRST - Inspect the first  IP  ad-
                                            dress  in the list of IP addresses
                                            in the header. This is usually the
                                            client's original IP.

                                          o LAST - Inspect the last IP address
                                            in the list of IP addresses in the
                                            header.

                                          o ANY  - Inspect all IP addresses in
                                            the header for  a  match.  If  the
                                            header  contains  more  than 10 IP
                                            addresses, WAF inspects  the  last
                                            10.

                               RegexPatternSetReferenceStatement   ->  (struc-
                               ture)
                                   A rule statement used to search web request
                                   components for matches with regular expres-
                                   sions. To use  this,  create  a   RegexPat-
                                   ternSet that specifies the expressions that
                                   you want to detect, then  use  the  ARN  of
                                   that  set  in this statement. A web request
                                   matches the pattern set rule  statement  if
                                   the  request  component  matches any of the
                                   patterns in the set. To create a regex pat-
                                   tern set, see  CreateRegexPatternSet .

                                   Each  regex pattern set rule statement ref-
                                   erences a regex pattern set. You create and
                                   maintain the set independent of your rules.
                                   This allows you to use the  single  set  in
                                   multiple  rules. When you update the refer-
                                   enced set, WAF  automatically  updates  all
                                   rules that reference it.

                                   ARN -> (string)
                                      The  Amazon  Resource  Name (ARN) of the
                                      RegexPatternSet that this statement ref-
                                      erences.

                                   FieldToMatch -> (structure)
                                      The  part of a web request that you want
                                      WAF to inspect.  For  more  information,
                                      see  FieldToMatch .

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name of the header to  inspect,  for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example  JSON:   "SingleHeader":   {
                                          "Name": "haystack" }

                                          Name -> (string)
                                             The  name  of the query header to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide  the name of the query argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion  . The name can be up to
                                          30 characters long  and  isn't  case
                                          sensitive.

                                          This  is  used  only to indicate the
                                          web request component for WAF to in-
                                          spect, in the  FieldToMatch specifi-
                                          cation.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect the request URI  path.  This
                                          is  the  part  of a web request that
                                          identifies a resource, for  example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect  the  query  string. This is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect  the  request  body as plain
                                          text. The request  body  immediately
                                          follows the request headers. This is
                                          the part of a request that  contains
                                          any additional data that you want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                      Method -> (structure)
                                          Inspect the HTTP method. The  method
                                          indicates the type of operation that
                                          the request is asking the origin  to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect  the  request  body as JSON.
                                          The request body immediately follows
                                          the  request  headers.  This  is the
                                          part of a request that contains  any
                                          additional  data  that  you  want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                          MatchPattern -> (structure)
                                             The patterns to look for  in  the
                                             JSON  body.  WAF inspects the re-
                                             sults of  these  pattern  matches
                                             against  the rule inspection cri-
                                             teria.

                                             All -> (structure)
                                                 Match all  of  the  elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You must specify either  this
                                                 setting  or the IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match only the specified  in-
                                                 clude  paths. See also Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing  JSON Pointer syntax. For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"] . For  infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force   (IETF)  documentation
                                                 JavaScript  Object   Notation
                                                 (JSON) Pointer .

                                                 You  must specify either this
                                                 setting or the  All  setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't  use  this option to
                                                    include  all  paths.   In-
                                                    stead,  use  the  All set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the  JSON  to  match
                                             against  using the MatchPattern .
                                             If you specify All , WAF  matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely parse the  JSON  body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING   -  Inspect
                                               the body as plain text. WAF ap-
                                               plies  the text transformations
                                               and  inspection  criteria  that
                                               you  defined  for  the JSON in-
                                               spection  to  the   body   text
                                               string.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             If you don't  provide  this  set-
                                             ting,  WAF  parses  and evaluates
                                             the content only up to the  first
                                             parsing  failure  that it encoun-
                                             ters.

                                             WAF does its best  to  parse  the
                                             entire  JSON  body,  but might be
                                             forced to stop for  reasons  such
                                             as  invalid characters, duplicate
                                             keys, truncation, and any content
                                             whose  root  node isn't an object
                                             or an array.

                                             WAF parses the JSON in  the  fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                   TextTransformations -> (list)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass  detection.  If  you specify one or
                                      more transformations in  a  rule  state-
                                      ment,  WAF  performs all transformations
                                      on the content of the request  component
                                      identified  by  FieldToMatch  , starting
                                      from the lowest priority setting, before
                                      inspecting the content for a match.

                                      (structure)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets the relative processing  or-
                                             der  for multiple transformations
                                             that  are  defined  for  a   rule
                                             statement.   WAF   processes  all
                                             transformations, from lowest pri-
                                             ority to highest, before inspect-
                                             ing the transformed content.  The
                                             priorities  don't need to be con-
                                             secutive, but they  must  all  be
                                             different.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE  -   Decode   a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT  - Decode a
                                                 Base64 -encoded  string,  but
                                                 use  a  forgiving implementa-
                                                 tion that ignores  characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.  These   are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual  formatting to disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete  spaces  before the fol-
                                               lowing characters: / (

                                             o Replace the  following  charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE   -  Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r  ,  carriage return, decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places  multiple  spaces with
                                                 one space.

                                                 CSS_DECODE -  Decode  charac-
                                                 ters  that were encoded using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in  the  decoding process, so
                                                 it can help to uncover  ASCII
                                                 characters  that were encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's also useful in  counter-
                                                 ing  evasion, which is a com-
                                                 bination of a  backslash  and
                                                 non-hexadecimal   characters.
                                                 For example, ja\vascript  for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE   -  Decode
                                                 the following ANSI  C  escape
                                                 sequences:  \a , \b , \f , \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 ,  \"  ,  \xHH (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't  valid  remain  in the
                                                 output.

                                                 HEX_DECODE - Decode a  string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE -  Replace
                                                 HTML-encoded  characters with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces (ampersand)quot;  with
                                               "

                                             o Replaces  (ampersand)nbsp; with
                                               a non-breaking  space,  decimal
                                               160

                                             o Replaces  (ampersand)lt; with a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat, (ampersand)#xhhhh; ,  with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented in decimal  format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape  sequences.  If a \  u
                                                 HHHH   code   is    in    the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,   then   the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not,  only  the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5 - Calculate an  MD5  hash
                                                 from  the  data in the input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE  -  Specify  NONE if you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH  - Remove mul-
                                                 tiple   slashes,    directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not  at  the beginning of the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN - This  is
                                                 the  same as NORMALIZE_PATH ,
                                                 but first converts  backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS  -  Remove   all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS   -  Replace
                                                 each occurrence of a  C-style
                                                 comment  (/*  ... */ ) with a
                                                 single space.  Multiple  con-
                                                 secutive  occurrences are not
                                                 compressed. Unterminated com-
                                                 ments  are also replaced with
                                                 a space  (ASCII  0x20).  How-
                                                 ever,  a  standalone termina-
                                                 tion of a comment  (*/  )  is
                                                 not acted upon.

                                                 REPLACE_NULLS  - Replace NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE  -  Decode SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE  ,  but with support for
                                                 Microsoft-specific %u  encod-
                                                 ing.  If  the  code is in the
                                                 full-width ASCII  code  range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte is used  to  detect  and
                                                 adjust the lower byte. Other-
                                                 wise, only the lower byte  is
                                                 used  and  the higher byte is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8  character sequences to
                                                 Unicode.  This  helps   input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives  for non-Eng-
                                                 lish languages.

                               RateBasedStatement -> (structure)
                                   A rate-based rule tracks the  rate  of  re-
                                   quests for each originating IP address, and
                                   triggers the rule action when the rate  ex-
                                   ceeds  a limit that you specify on the num-
                                   ber of requests in any 5-minute time  span.
                                   You  can  use this to put a temporary block
                                   on requests from  an  IP  address  that  is
                                   sending excessive requests.

                                   WAF  tracks  and manages web requests sepa-
                                   rately for each instance  of  a  rate-based
                                   rule that you use. For example, if you pro-
                                   vide the same rate-based rule  settings  in
                                   two  web  ACLs, each of the two rule state-
                                   ments represents a separate instance of the
                                   rate-based  rule  and gets its own tracking
                                   and management by  WAF.  If  you  define  a
                                   rate-based  rule  inside  a rule group, and
                                   then  use  that  rule  group  in   multiple
                                   places,  each  use  creates  a separate in-
                                   stance of the rate-based rule that gets its
                                   own tracking and management by WAF.

                                   When  the  rule action triggers, WAF blocks
                                   additional requests from the IP address un-
                                   til the request rate falls below the limit.

                                   You  can  optionally nest another statement
                                   inside the rate-based statement, to  narrow
                                   the  scope  of  the  rule  so  that it only
                                   counts  requests  that  match  the   nested
                                   statement. For example, based on recent re-
                                   quests that you have seen from an attacker,
                                   you  might  create a rate-based rule with a
                                   nested AND rule statement that contains the
                                   following nested statements:

                                   o An IP match statement with an IP set that
                                     specified the address 192.0.2.44.

                                   o A string match statement that searches in
                                     the User-Agent header for the string Bad-
                                     Bot.

                                   In this rate-based rule, you also define  a
                                   rate  limit.  For  this  example,  the rate
                                   limit is 1,000. Requests that meet both  of
                                   the   conditions   in  the  statements  are
                                   counted. If the  count  exceeds  1,000  re-
                                   quests  per  five  minutes, the rule action
                                   triggers. Requests that do  not  meet  both
                                   conditions are not counted towards the rate
                                   limit and are not affected by this rule.

                                   You cannot nest a RateBasedStatement inside
                                   another  statement,  for  example  inside a
                                   NotStatement or OrStatement . You  can  de-
                                   fine  a RateBasedStatement inside a web ACL
                                   and inside a rule group.

                                   Limit -> (long)
                                      The limit on requests per  5-minute  pe-
                                      riod  for  a  single  originating IP ad-
                                      dress.  If  the  statement  includes   a
                                      ScopeDownStatement  ,  this limit is ap-
                                      plied only to the  requests  that  match
                                      the statement.

                                   AggregateKeyType -> (string)
                                      Setting  that indicates how to aggregate
                                      the request counts. The options are  the
                                      following:

                                      o IP  -  Aggregate the request counts on
                                        the IP address from  the  web  request
                                        origin.

                                      o FORWARDED_IP  -  Aggregate the request
                                        counts on the first IP address  in  an
                                        HTTP  header. If you use this, config-
                                        ure the ForwardedIPConfig , to specify
                                        the header to use.

                                   (  ...  recursive ... )ForwardedIPConfig ->
                                   (structure)
                                      The configuration for inspecting IP  ad-
                                      dresses in an HTTP header that you spec-
                                      ify, instead of  using  the  IP  address
                                      that's  reported by the web request ori-
                                      gin.  Commonly,  this  is   the   X-For-
                                      warded-For  (XFF)  header,  but  you can
                                      specify any header name.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      This  is required if AggregateKeyType is
                                      set to FORWARDED_IP .

                                      HeaderName -> (string)
                                          The name of the HTTP header  to  use
                                          for  the IP address. For example, to
                                          use   the   X-Forwarded-For    (XFF)
                                          header,  set this to X-Forwarded-For
                                          .

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present   in   the  request,  WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                      FallbackBehavior -> (string)
                                          The  match  status  to assign to the
                                          web request if the  request  doesn't
                                          have a valid IP address in the spec-
                                          ified position.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present   in   the  request,  WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          You  can specify the following fall-
                                          back behaviors:

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                               AndStatement -> (structure)
                                   A  logical  rule  statement used to combine
                                   other rule statements with AND  logic.  You
                                   provide more than one  Statement within the
                                   AndStatement .

                                   Statements -> (list)
                                      The  statements  to  combine  with   AND
                                      logic.  You  can use any statements that
                                      can be nested.

                                      ( ... recursive ... )

                               OrStatement -> (structure)
                                   A logical rule statement  used  to  combine
                                   other  rule  statements  with OR logic. You
                                   provide more than one  Statement within the
                                   OrStatement .

                                   Statements -> (list)
                                      The statements to combine with OR logic.
                                      You can use any statements that  can  be
                                      nested.

                                      ( ... recursive ... )

                               NotStatement -> (structure)
                                   A logical rule statement used to negate the
                                   results of another rule statement. You pro-
                                   vide one  Statement within the NotStatement
                                   .

                                   ( ... recursive ... )

                               ManagedRuleGroupStatement -> (structure)
                                   A rule statement used to run the rules that
                                   are defined in a managed rule group. To use
                                   this, provide the vendor name and the  name
                                   of  the  rule  group in this statement. You
                                   can retrieve the required names by  calling
                                   ListAvailableManagedRuleGroups .

                                   You cannot nest a ManagedRuleGroupStatement
                                   , for example for use inside a NotStatement
                                   or  OrStatement . It can only be referenced
                                   as a top-level statement within a rule.

                                   VendorName -> (string)
                                      The name of the managed rule group  ven-
                                      dor.  You  use this, along with the rule
                                      group name, to identify the rule group.

                                   Name -> (string)
                                      The name of the managed rule group.  You
                                      use this, along with the vendor name, to
                                      identify the rule group.

                                   Version -> (string)
                                      The version of the managed rule group to
                                      use.  If  you  specify this, the version
                                      setting is fixed until you change it. If
                                      you  don't  specify  this,  WAF uses the
                                      vendor's default version, and then keeps
                                      the version at the vendor's default when
                                      the  vendor  updates  the  managed  rule
                                      group settings.

                                   ExcludedRules -> (list)
                                      The  rules  in the referenced rule group
                                      whose actions are set to  Count  .  When
                                      you exclude a rule, WAF evaluates it ex-
                                      actly as it would  if  the  rule  action
                                      setting  were  Count  . This is a useful
                                      option for testing the rules in  a  rule
                                      group  without modifying how they handle
                                      your web traffic.

                                      (structure)
                                          Specifies a single rule  in  a  rule
                                          group whose action you want to over-
                                          ride to Count . When you  exclude  a
                                          rule, WAF evaluates it exactly as it
                                          would if  the  rule  action  setting
                                          were Count . This is a useful option
                                          for testing  the  rules  in  a  rule
                                          group  without  modifying  how  they
                                          handle your web traffic.

                                          Name -> (string)
                                             The name of the rule whose action
                                             you want to override to Count .

                                   ( ... recursive ... )

                               LabelMatchStatement -> (structure)
                                   A  rule  statement  that  defines  a string
                                   match search against labels that have  been
                                   added to the web request by rules that have
                                   already run in the web ACL.

                                   The label match statement provides the  la-
                                   bel  or namespace string to search for. The
                                   label string can represent a part or all of
                                   the  fully  qualified  label  name that had
                                   been added to the web request. Fully quali-
                                   fied  labels  have a prefix, optional name-
                                   spaces, and label name. The prefix  identi-
                                   fies  the  rule group or web ACL context of
                                   the rule that added the label.  If  you  do
                                   not  provide  the  fully  qualified name in
                                   your label match string, WAF  performs  the
                                   search  for  labels  that were added in the
                                   same context as the label match statement.

                                   Scope -> (string)
                                      Specify whether you want to match  using
                                      the label name or just the namespace.

                                   Key -> (string)
                                      The string to match against. The setting
                                      you provide  for  this  depends  on  the
                                      match statement's Scope setting:

                                      o If  the  Scope  indicates LABEL , then
                                        this specification  must  include  the
                                        name  and  can  include  any number of
                                        preceding namespace specifications and
                                        prefix up to providing the fully qual-
                                        ified label name.

                                      o If the  Scope  indicates  NAMESPACE  ,
                                        then  this  specification  can include
                                        any  number  of  contiguous  namespace
                                        strings,  and  can  include the entire
                                        label namespace prefix from  the  rule
                                        group or web ACL where the label orig-
                                        inates.

                                      Labels are case sensitive and components
                                      of  a  label must be separated by colon,
                                      for example NS1:NS2:name .

                               RegexMatchStatement -> (structure)
                                   A rule statement used to search web request
                                   components  for  a  match  against a single
                                   regular expression.

                                   RegexString -> (string)
                                      The string representing the regular  ex-
                                      pression.

                                   FieldToMatch -> (structure)
                                      The  part of a web request that you want
                                      WAF to inspect.  For  more  information,
                                      see  FieldToMatch .

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name of the header to  inspect,  for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example  JSON:   "SingleHeader":   {
                                          "Name": "haystack" }

                                          Name -> (string)
                                             The  name  of the query header to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide  the name of the query argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion  . The name can be up to
                                          30 characters long  and  isn't  case
                                          sensitive.

                                          This  is  used  only to indicate the
                                          web request component for WAF to in-
                                          spect, in the  FieldToMatch specifi-
                                          cation.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect the request URI  path.  This
                                          is  the  part  of a web request that
                                          identifies a resource, for  example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect  the  query  string. This is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect  the  request  body as plain
                                          text. The request  body  immediately
                                          follows the request headers. This is
                                          the part of a request that  contains
                                          any additional data that you want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                      Method -> (structure)
                                          Inspect the HTTP method. The  method
                                          indicates the type of operation that
                                          the request is asking the origin  to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect  the  request  body as JSON.
                                          The request body immediately follows
                                          the  request  headers.  This  is the
                                          part of a request that contains  any
                                          additional  data  that  you  want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                          MatchPattern -> (structure)
                                             The patterns to look for  in  the
                                             JSON  body.  WAF inspects the re-
                                             sults of  these  pattern  matches
                                             against  the rule inspection cri-
                                             teria.

                                             All -> (structure)
                                                 Match all  of  the  elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You must specify either  this
                                                 setting  or the IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match only the specified  in-
                                                 clude  paths. See also Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing  JSON Pointer syntax. For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"] . For  infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force   (IETF)  documentation
                                                 JavaScript  Object   Notation
                                                 (JSON) Pointer .

                                                 You  must specify either this
                                                 setting or the  All  setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't  use  this option to
                                                    include  all  paths.   In-
                                                    stead,  use  the  All set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the  JSON  to  match
                                             against  using the MatchPattern .
                                             If you specify All , WAF  matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely parse the  JSON  body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING   -  Inspect
                                               the body as plain text. WAF ap-
                                               plies  the text transformations
                                               and  inspection  criteria  that
                                               you  defined  for  the JSON in-
                                               spection  to  the   body   text
                                               string.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             If you don't  provide  this  set-
                                             ting,  WAF  parses  and evaluates
                                             the content only up to the  first
                                             parsing  failure  that it encoun-
                                             ters.

                                             WAF does its best  to  parse  the
                                             entire  JSON  body,  but might be
                                             forced to stop for  reasons  such
                                             as  invalid characters, duplicate
                                             keys, truncation, and any content
                                             whose  root  node isn't an object
                                             or an array.

                                             WAF parses the JSON in  the  fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                   TextTransformations -> (list)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass  detection.  If  you specify one or
                                      more transformations in  a  rule  state-
                                      ment,  WAF  performs all transformations
                                      on the content of the request  component
                                      identified  by  FieldToMatch  , starting
                                      from the lowest priority setting, before
                                      inspecting the content for a match.

                                      (structure)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets the relative processing  or-
                                             der  for multiple transformations
                                             that  are  defined  for  a   rule
                                             statement.   WAF   processes  all
                                             transformations, from lowest pri-
                                             ority to highest, before inspect-
                                             ing the transformed content.  The
                                             priorities  don't need to be con-
                                             secutive, but they  must  all  be
                                             different.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE  -   Decode   a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT  - Decode a
                                                 Base64 -encoded  string,  but
                                                 use  a  forgiving implementa-
                                                 tion that ignores  characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.  These   are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual  formatting to disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete  spaces  before the fol-
                                               lowing characters: / (

                                             o Replace the  following  charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE   -  Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r  ,  carriage return, decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places  multiple  spaces with
                                                 one space.

                                                 CSS_DECODE -  Decode  charac-
                                                 ters  that were encoded using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in  the  decoding process, so
                                                 it can help to uncover  ASCII
                                                 characters  that were encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's also useful in  counter-
                                                 ing  evasion, which is a com-
                                                 bination of a  backslash  and
                                                 non-hexadecimal   characters.
                                                 For example, ja\vascript  for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE   -  Decode
                                                 the following ANSI  C  escape
                                                 sequences:  \a , \b , \f , \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 ,  \"  ,  \xHH (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't  valid  remain  in the
                                                 output.

                                                 HEX_DECODE - Decode a  string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE -  Replace
                                                 HTML-encoded  characters with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces (ampersand)quot;  with
                                               "

                                             o Replaces  (ampersand)nbsp; with
                                               a non-breaking  space,  decimal
                                               160

                                             o Replaces  (ampersand)lt; with a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat, (ampersand)#xhhhh; ,  with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented in decimal  format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape  sequences.  If a \  u
                                                 HHHH   code   is    in    the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,   then   the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not,  only  the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5 - Calculate an  MD5  hash
                                                 from  the  data in the input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE  -  Specify  NONE if you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH  - Remove mul-
                                                 tiple   slashes,    directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not  at  the beginning of the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN - This  is
                                                 the  same as NORMALIZE_PATH ,
                                                 but first converts  backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS  -  Remove   all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS   -  Replace
                                                 each occurrence of a  C-style
                                                 comment  (/*  ... */ ) with a
                                                 single space.  Multiple  con-
                                                 secutive  occurrences are not
                                                 compressed. Unterminated com-
                                                 ments  are also replaced with
                                                 a space  (ASCII  0x20).  How-
                                                 ever,  a  standalone termina-
                                                 tion of a comment  (*/  )  is
                                                 not acted upon.

                                                 REPLACE_NULLS  - Replace NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE  -  Decode SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE  ,  but with support for
                                                 Microsoft-specific %u  encod-
                                                 ing.  If  the  code is in the
                                                 full-width ASCII  code  range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte is used  to  detect  and
                                                 adjust the lower byte. Other-
                                                 wise, only the lower byte  is
                                                 used  and  the higher byte is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8  character sequences to
                                                 Unicode.  This  helps   input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives  for non-Eng-
                                                 lish languages.

                     OrStatement -> (structure)
                        A logical rule statement used to  combine  other  rule
                        statements  with  OR  logic. You provide more than one
                        Statement within the OrStatement .

                        Statements -> (list)
                            The statements to combine with OR logic.  You  can
                            use any statements that can be nested.

                            (structure)
                               The  processing  guidance for a  Rule , used by
                               WAF to determine whether a web request  matches
                               the rule.

                               ByteMatchStatement -> (structure)
                                   A  rule  statement  that  defines  a string
                                   match search for WAF to apply  to  web  re-
                                   quests.  The  byte match statement provides
                                   the bytes to search for,  the  location  in
                                   requests  that  you want WAF to search, and
                                   other settings. The bytes to search for are
                                   typically  a  string  that corresponds with
                                   ASCII characters. In the  WAF  console  and
                                   the  developer guide, this is refered to as
                                   a string match statement.

                                   SearchString -> (blob)
                                      A string value  that  you  want  WAF  to
                                      search  for.  WAF  searches  only in the
                                      part of web requests that you  designate
                                      for  inspection  in   FieldToMatch . The
                                      maximum length of the value is 50 bytes.

                                      Valid values  depend  on  the  component
                                      that   you  specify  for  inspection  in
                                      FieldToMatch :

                                      o Method : The HTTP method that you want
                                        WAF  to search for. This indicates the
                                        type of operation specified in the re-
                                        quest.

                                      o UriPath  : The value that you want WAF
                                        to search for in the URI path, for ex-
                                        ample, /images/daily-ad.jpg .

                                      If   SearchString   includes  alphabetic
                                      characters A-Z and a-z,  note  that  the
                                      value is case sensitive.
                                          If you're using the WAF API

                                      Specify  a base64-encoded version of the
                                      value. The maximum length of  the  value
                                      before you base64-encode it is 50 bytes.

                                      For  example,  suppose the value of Type
                                      is HEADER  and  the  value  of  Data  is
                                      User-Agent  .  If you want to search the
                                      User-Agent header for the value BadBot ,
                                      you   base64-encode  BadBot  using  MIME
                                      base64-encoding and include the  result-
                                      ing  value,  QmFkQm90  , in the value of
                                      SearchString .
                                          If you're using the CLI  or  one  of
                                          the Amazon Web Services SDKs

                                      The  value  that  you want WAF to search
                                      for. The SDK  automatically  base64  en-
                                      codes the value.

                                   FieldToMatch -> (structure)
                                      The  part of a web request that you want
                                      WAF to inspect.  For  more  information,
                                      see  FieldToMatch .

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name of the header to  inspect,  for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example  JSON:   "SingleHeader":   {
                                          "Name": "haystack" }

                                          Name -> (string)
                                             The  name  of the query header to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide  the name of the query argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion  . The name can be up to
                                          30 characters long  and  isn't  case
                                          sensitive.

                                          This  is  used  only to indicate the
                                          web request component for WAF to in-
                                          spect, in the  FieldToMatch specifi-
                                          cation.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect the request URI  path.  This
                                          is  the  part  of a web request that
                                          identifies a resource, for  example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect  the  query  string. This is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect  the  request  body as plain
                                          text. The request  body  immediately
                                          follows the request headers. This is
                                          the part of a request that  contains
                                          any additional data that you want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                      Method -> (structure)
                                          Inspect the HTTP method. The  method
                                          indicates the type of operation that
                                          the request is asking the origin  to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect  the  request  body as JSON.
                                          The request body immediately follows
                                          the  request  headers.  This  is the
                                          part of a request that contains  any
                                          additional  data  that  you  want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                          MatchPattern -> (structure)
                                             The patterns to look for  in  the
                                             JSON  body.  WAF inspects the re-
                                             sults of  these  pattern  matches
                                             against  the rule inspection cri-
                                             teria.

                                             All -> (structure)
                                                 Match all  of  the  elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You must specify either  this
                                                 setting  or the IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match only the specified  in-
                                                 clude  paths. See also Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing  JSON Pointer syntax. For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"] . For  infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force   (IETF)  documentation
                                                 JavaScript  Object   Notation
                                                 (JSON) Pointer .

                                                 You  must specify either this
                                                 setting or the  All  setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't  use  this option to
                                                    include  all  paths.   In-
                                                    stead,  use  the  All set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the  JSON  to  match
                                             against  using the MatchPattern .
                                             If you specify All , WAF  matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely parse the  JSON  body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING   -  Inspect
                                               the body as plain text. WAF ap-
                                               plies  the text transformations
                                               and  inspection  criteria  that
                                               you  defined  for  the JSON in-
                                               spection  to  the   body   text
                                               string.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             If you don't  provide  this  set-
                                             ting,  WAF  parses  and evaluates
                                             the content only up to the  first
                                             parsing  failure  that it encoun-
                                             ters.

                                             WAF does its best  to  parse  the
                                             entire  JSON  body,  but might be
                                             forced to stop for  reasons  such
                                             as  invalid characters, duplicate
                                             keys, truncation, and any content
                                             whose  root  node isn't an object
                                             or an array.

                                             WAF parses the JSON in  the  fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                   TextTransformations -> (list)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass  detection.  If  you specify one or
                                      more transformations in  a  rule  state-
                                      ment,  WAF  performs all transformations
                                      on the content of the request  component
                                      identified  by  FieldToMatch  , starting
                                      from the lowest priority setting, before
                                      inspecting the content for a match.

                                      (structure)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets the relative processing  or-
                                             der  for multiple transformations
                                             that  are  defined  for  a   rule
                                             statement.   WAF   processes  all
                                             transformations, from lowest pri-
                                             ority to highest, before inspect-
                                             ing the transformed content.  The
                                             priorities  don't need to be con-
                                             secutive, but they  must  all  be
                                             different.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE  -   Decode   a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT  - Decode a
                                                 Base64 -encoded  string,  but
                                                 use  a  forgiving implementa-
                                                 tion that ignores  characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.  These   are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual  formatting to disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete  spaces  before the fol-
                                               lowing characters: / (

                                             o Replace the  following  charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE   -  Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r  ,  carriage return, decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places  multiple  spaces with
                                                 one space.

                                                 CSS_DECODE -  Decode  charac-
                                                 ters  that were encoded using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in  the  decoding process, so
                                                 it can help to uncover  ASCII
                                                 characters  that were encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's also useful in  counter-
                                                 ing  evasion, which is a com-
                                                 bination of a  backslash  and
                                                 non-hexadecimal   characters.
                                                 For example, ja\vascript  for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE   -  Decode
                                                 the following ANSI  C  escape
                                                 sequences:  \a , \b , \f , \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 ,  \"  ,  \xHH (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't  valid  remain  in the
                                                 output.

                                                 HEX_DECODE - Decode a  string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE -  Replace
                                                 HTML-encoded  characters with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces (ampersand)quot;  with
                                               "

                                             o Replaces  (ampersand)nbsp; with
                                               a non-breaking  space,  decimal
                                               160

                                             o Replaces  (ampersand)lt; with a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat, (ampersand)#xhhhh; ,  with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented in decimal  format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape  sequences.  If a \  u
                                                 HHHH   code   is    in    the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,   then   the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not,  only  the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5 - Calculate an  MD5  hash
                                                 from  the  data in the input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE  -  Specify  NONE if you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH  - Remove mul-
                                                 tiple   slashes,    directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not  at  the beginning of the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN - This  is
                                                 the  same as NORMALIZE_PATH ,
                                                 but first converts  backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS  -  Remove   all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS   -  Replace
                                                 each occurrence of a  C-style
                                                 comment  (/*  ... */ ) with a
                                                 single space.  Multiple  con-
                                                 secutive  occurrences are not
                                                 compressed. Unterminated com-
                                                 ments  are also replaced with
                                                 a space  (ASCII  0x20).  How-
                                                 ever,  a  standalone termina-
                                                 tion of a comment  (*/  )  is
                                                 not acted upon.

                                                 REPLACE_NULLS  - Replace NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE  -  Decode SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE  ,  but with support for
                                                 Microsoft-specific %u  encod-
                                                 ing.  If  the  code is in the
                                                 full-width ASCII  code  range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte is used  to  detect  and
                                                 adjust the lower byte. Other-
                                                 wise, only the lower byte  is
                                                 used  and  the higher byte is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8  character sequences to
                                                 Unicode.  This  helps   input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives  for non-Eng-
                                                 lish languages.

                                   PositionalConstraint -> (string)
                                      The area within the portion of a web re-
                                      quest  that  you  want WAF to search for
                                      SearchString . Valid values include  the
                                      following:
                                          CONTAINS

                                      The  specified  part  of the web request
                                      must include the value of SearchString ,
                                      but the location doesn't matter.
                                          CONTAINS_WORD

                                      The  specified  part  of the web request
                                      must include the value of SearchString ,
                                      and  SearchString  must contain only al-
                                      phanumeric  characters   or   underscore
                                      (A-Z,  a-z,  0-9,  or  _).  In addition,
                                      SearchString must be a word, which means
                                      that both of the following are true:

                                      o SearchString  is  at  the beginning of
                                        the specified part of the web  request
                                        or  is  preceded  by a character other
                                        than an alphanumeric character or  un-
                                        derscore  (_).  Examples  include  the
                                        value of a header and ;BadBot .

                                      o SearchString is  at  the  end  of  the
                                        specified  part  of the web request or
                                        is followed by a character other  than
                                        an  alphanumeric  character  or under-
                                        score (_), for  example,  BadBot;  and
                                        -BadBot; .
                                          EXACTLY

                                      The  value  of the specified part of the
                                      web request must exactly match the value
                                      of SearchString .
                                          STARTS_WITH

                                      The value of SearchString must appear at
                                      the beginning of the specified  part  of
                                      the web request.
                                          ENDS_WITH

                                      The value of SearchString must appear at
                                      the end of the specified part of the web
                                      request.

                               SqliMatchStatement -> (structure)
                                   Attackers  sometimes  insert  malicious SQL
                                   code into web requests in an effort to  ex-
                                   tract  data from your database. To allow or
                                   block web requests that appear  to  contain
                                   malicious  SQL code, create one or more SQL
                                   injection match conditions. An  SQL  injec-
                                   tion match condition identifies the part of
                                   web requests, such as the URI or the  query
                                   string, that you want WAF to inspect. Later
                                   in the process, when you create a web  ACL,
                                   you  specify  whether to allow or block re-
                                   quests that appear to contain malicious SQL
                                   code.

                                   FieldToMatch -> (structure)
                                      The  part of a web request that you want
                                      WAF to inspect.  For  more  information,
                                      see  FieldToMatch .

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name of the header to  inspect,  for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example  JSON:   "SingleHeader":   {
                                          "Name": "haystack" }

                                          Name -> (string)
                                             The  name  of the query header to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide  the name of the query argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion  . The name can be up to
                                          30 characters long  and  isn't  case
                                          sensitive.

                                          This  is  used  only to indicate the
                                          web request component for WAF to in-
                                          spect, in the  FieldToMatch specifi-
                                          cation.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect the request URI  path.  This
                                          is  the  part  of a web request that
                                          identifies a resource, for  example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect  the  query  string. This is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect  the  request  body as plain
                                          text. The request  body  immediately
                                          follows the request headers. This is
                                          the part of a request that  contains
                                          any additional data that you want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                      Method -> (structure)
                                          Inspect the HTTP method. The  method
                                          indicates the type of operation that
                                          the request is asking the origin  to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect  the  request  body as JSON.
                                          The request body immediately follows
                                          the  request  headers.  This  is the
                                          part of a request that contains  any
                                          additional  data  that  you  want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                          MatchPattern -> (structure)
                                             The patterns to look for  in  the
                                             JSON  body.  WAF inspects the re-
                                             sults of  these  pattern  matches
                                             against  the rule inspection cri-
                                             teria.

                                             All -> (structure)
                                                 Match all  of  the  elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You must specify either  this
                                                 setting  or the IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match only the specified  in-
                                                 clude  paths. See also Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing  JSON Pointer syntax. For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"] . For  infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force   (IETF)  documentation
                                                 JavaScript  Object   Notation
                                                 (JSON) Pointer .

                                                 You  must specify either this
                                                 setting or the  All  setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't  use  this option to
                                                    include  all  paths.   In-
                                                    stead,  use  the  All set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the  JSON  to  match
                                             against  using the MatchPattern .
                                             If you specify All , WAF  matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely parse the  JSON  body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING   -  Inspect
                                               the body as plain text. WAF ap-
                                               plies  the text transformations
                                               and  inspection  criteria  that
                                               you  defined  for  the JSON in-
                                               spection  to  the   body   text
                                               string.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             If you don't  provide  this  set-
                                             ting,  WAF  parses  and evaluates
                                             the content only up to the  first
                                             parsing  failure  that it encoun-
                                             ters.

                                             WAF does its best  to  parse  the
                                             entire  JSON  body,  but might be
                                             forced to stop for  reasons  such
                                             as  invalid characters, duplicate
                                             keys, truncation, and any content
                                             whose  root  node isn't an object
                                             or an array.

                                             WAF parses the JSON in  the  fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                   TextTransformations -> (list)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass  detection.  If  you specify one or
                                      more transformations in  a  rule  state-
                                      ment,  WAF  performs all transformations
                                      on the content of the request  component
                                      identified  by  FieldToMatch  , starting
                                      from the lowest priority setting, before
                                      inspecting the content for a match.

                                      (structure)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets the relative processing  or-
                                             der  for multiple transformations
                                             that  are  defined  for  a   rule
                                             statement.   WAF   processes  all
                                             transformations, from lowest pri-
                                             ority to highest, before inspect-
                                             ing the transformed content.  The
                                             priorities  don't need to be con-
                                             secutive, but they  must  all  be
                                             different.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE  -   Decode   a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT  - Decode a
                                                 Base64 -encoded  string,  but
                                                 use  a  forgiving implementa-
                                                 tion that ignores  characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.  These   are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual  formatting to disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete  spaces  before the fol-
                                               lowing characters: / (

                                             o Replace the  following  charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE   -  Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r  ,  carriage return, decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places  multiple  spaces with
                                                 one space.

                                                 CSS_DECODE -  Decode  charac-
                                                 ters  that were encoded using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in  the  decoding process, so
                                                 it can help to uncover  ASCII
                                                 characters  that were encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's also useful in  counter-
                                                 ing  evasion, which is a com-
                                                 bination of a  backslash  and
                                                 non-hexadecimal   characters.
                                                 For example, ja\vascript  for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE   -  Decode
                                                 the following ANSI  C  escape
                                                 sequences:  \a , \b , \f , \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 ,  \"  ,  \xHH (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't  valid  remain  in the
                                                 output.

                                                 HEX_DECODE - Decode a  string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE -  Replace
                                                 HTML-encoded  characters with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces (ampersand)quot;  with
                                               "

                                             o Replaces  (ampersand)nbsp; with
                                               a non-breaking  space,  decimal
                                               160

                                             o Replaces  (ampersand)lt; with a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat, (ampersand)#xhhhh; ,  with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented in decimal  format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape  sequences.  If a \  u
                                                 HHHH   code   is    in    the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,   then   the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not,  only  the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5 - Calculate an  MD5  hash
                                                 from  the  data in the input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE  -  Specify  NONE if you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH  - Remove mul-
                                                 tiple   slashes,    directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not  at  the beginning of the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN - This  is
                                                 the  same as NORMALIZE_PATH ,
                                                 but first converts  backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS  -  Remove   all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS   -  Replace
                                                 each occurrence of a  C-style
                                                 comment  (/*  ... */ ) with a
                                                 single space.  Multiple  con-
                                                 secutive  occurrences are not
                                                 compressed. Unterminated com-
                                                 ments  are also replaced with
                                                 a space  (ASCII  0x20).  How-
                                                 ever,  a  standalone termina-
                                                 tion of a comment  (*/  )  is
                                                 not acted upon.

                                                 REPLACE_NULLS  - Replace NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE  -  Decode SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE  ,  but with support for
                                                 Microsoft-specific %u  encod-
                                                 ing.  If  the  code is in the
                                                 full-width ASCII  code  range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte is used  to  detect  and
                                                 adjust the lower byte. Other-
                                                 wise, only the lower byte  is
                                                 used  and  the higher byte is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8  character sequences to
                                                 Unicode.  This  helps   input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives  for non-Eng-
                                                 lish languages.

                               XssMatchStatement -> (structure)
                                   A rule statement that defines a  cross-site
                                   scripting (XSS) match search for WAF to ap-
                                   ply to web requests. XSS attacks are  those
                                   where  the attacker uses vulnerabilities in
                                   a benign website as a vehicle to inject ma-
                                   licious  client-site scripts into other le-
                                   gitimate web browsers. The XSS match state-
                                   ment provides the location in requests that
                                   you want WAF to search and text transforma-
                                   tions  to use on the search area before WAF
                                   searches for character sequences  that  are
                                   likely to be malicious strings.

                                   FieldToMatch -> (structure)
                                      The  part of a web request that you want
                                      WAF to inspect.  For  more  information,
                                      see  FieldToMatch .

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name of the header to  inspect,  for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example  JSON:   "SingleHeader":   {
                                          "Name": "haystack" }

                                          Name -> (string)
                                             The  name  of the query header to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide  the name of the query argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion  . The name can be up to
                                          30 characters long  and  isn't  case
                                          sensitive.

                                          This  is  used  only to indicate the
                                          web request component for WAF to in-
                                          spect, in the  FieldToMatch specifi-
                                          cation.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect the request URI  path.  This
                                          is  the  part  of a web request that
                                          identifies a resource, for  example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect  the  query  string. This is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect  the  request  body as plain
                                          text. The request  body  immediately
                                          follows the request headers. This is
                                          the part of a request that  contains
                                          any additional data that you want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                      Method -> (structure)
                                          Inspect the HTTP method. The  method
                                          indicates the type of operation that
                                          the request is asking the origin  to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect  the  request  body as JSON.
                                          The request body immediately follows
                                          the  request  headers.  This  is the
                                          part of a request that contains  any
                                          additional  data  that  you  want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                          MatchPattern -> (structure)
                                             The patterns to look for  in  the
                                             JSON  body.  WAF inspects the re-
                                             sults of  these  pattern  matches
                                             against  the rule inspection cri-
                                             teria.

                                             All -> (structure)
                                                 Match all  of  the  elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You must specify either  this
                                                 setting  or the IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match only the specified  in-
                                                 clude  paths. See also Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing  JSON Pointer syntax. For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"] . For  infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force   (IETF)  documentation
                                                 JavaScript  Object   Notation
                                                 (JSON) Pointer .

                                                 You  must specify either this
                                                 setting or the  All  setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't  use  this option to
                                                    include  all  paths.   In-
                                                    stead,  use  the  All set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the  JSON  to  match
                                             against  using the MatchPattern .
                                             If you specify All , WAF  matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely parse the  JSON  body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING   -  Inspect
                                               the body as plain text. WAF ap-
                                               plies  the text transformations
                                               and  inspection  criteria  that
                                               you  defined  for  the JSON in-
                                               spection  to  the   body   text
                                               string.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             If you don't  provide  this  set-
                                             ting,  WAF  parses  and evaluates
                                             the content only up to the  first
                                             parsing  failure  that it encoun-
                                             ters.

                                             WAF does its best  to  parse  the
                                             entire  JSON  body,  but might be
                                             forced to stop for  reasons  such
                                             as  invalid characters, duplicate
                                             keys, truncation, and any content
                                             whose  root  node isn't an object
                                             or an array.

                                             WAF parses the JSON in  the  fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                   TextTransformations -> (list)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass  detection.  If  you specify one or
                                      more transformations in  a  rule  state-
                                      ment,  WAF  performs all transformations
                                      on the content of the request  component
                                      identified  by  FieldToMatch  , starting
                                      from the lowest priority setting, before
                                      inspecting the content for a match.

                                      (structure)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets the relative processing  or-
                                             der  for multiple transformations
                                             that  are  defined  for  a   rule
                                             statement.   WAF   processes  all
                                             transformations, from lowest pri-
                                             ority to highest, before inspect-
                                             ing the transformed content.  The
                                             priorities  don't need to be con-
                                             secutive, but they  must  all  be
                                             different.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE  -   Decode   a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT  - Decode a
                                                 Base64 -encoded  string,  but
                                                 use  a  forgiving implementa-
                                                 tion that ignores  characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.  These   are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual  formatting to disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete  spaces  before the fol-
                                               lowing characters: / (

                                             o Replace the  following  charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE   -  Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r  ,  carriage return, decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places  multiple  spaces with
                                                 one space.

                                                 CSS_DECODE -  Decode  charac-
                                                 ters  that were encoded using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in  the  decoding process, so
                                                 it can help to uncover  ASCII
                                                 characters  that were encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's also useful in  counter-
                                                 ing  evasion, which is a com-
                                                 bination of a  backslash  and
                                                 non-hexadecimal   characters.
                                                 For example, ja\vascript  for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE   -  Decode
                                                 the following ANSI  C  escape
                                                 sequences:  \a , \b , \f , \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 ,  \"  ,  \xHH (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't  valid  remain  in the
                                                 output.

                                                 HEX_DECODE - Decode a  string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE -  Replace
                                                 HTML-encoded  characters with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces (ampersand)quot;  with
                                               "

                                             o Replaces  (ampersand)nbsp; with
                                               a non-breaking  space,  decimal
                                               160

                                             o Replaces  (ampersand)lt; with a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat, (ampersand)#xhhhh; ,  with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented in decimal  format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape  sequences.  If a \  u
                                                 HHHH   code   is    in    the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,   then   the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not,  only  the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5 - Calculate an  MD5  hash
                                                 from  the  data in the input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE  -  Specify  NONE if you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH  - Remove mul-
                                                 tiple   slashes,    directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not  at  the beginning of the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN - This  is
                                                 the  same as NORMALIZE_PATH ,
                                                 but first converts  backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS  -  Remove   all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS   -  Replace
                                                 each occurrence of a  C-style
                                                 comment  (/*  ... */ ) with a
                                                 single space.  Multiple  con-
                                                 secutive  occurrences are not
                                                 compressed. Unterminated com-
                                                 ments  are also replaced with
                                                 a space  (ASCII  0x20).  How-
                                                 ever,  a  standalone termina-
                                                 tion of a comment  (*/  )  is
                                                 not acted upon.

                                                 REPLACE_NULLS  - Replace NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE  -  Decode SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE  ,  but with support for
                                                 Microsoft-specific %u  encod-
                                                 ing.  If  the  code is in the
                                                 full-width ASCII  code  range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte is used  to  detect  and
                                                 adjust the lower byte. Other-
                                                 wise, only the lower byte  is
                                                 used  and  the higher byte is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8  character sequences to
                                                 Unicode.  This  helps   input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives  for non-Eng-
                                                 lish languages.

                               SizeConstraintStatement -> (structure)
                                   A rule statement that compares a number  of
                                   bytes  against the size of a request compo-
                                   nent, using a comparison operator, such  as
                                   greater  than (>) or less than (<). For ex-
                                   ample, you can use a size constraint state-
                                   ment  to  look  for  query strings that are
                                   longer than 100 bytes.

                                   If you configure WAF to inspect the request
                                   body,  WAF  inspects  only  the  first 8192
                                   bytes (8 KB). If the request body for  your
                                   web  requests never exceeds 8192 bytes, you
                                   can create a size constraint condition  and
                                   block  requests  that  have  a request body
                                   greater than 8192 bytes.

                                   If you choose URI for the value of Part  of
                                   the  request to filter on, the slash (/) in
                                   the URI counts as one character. For  exam-
                                   ple,  the  URI /logo.jpg is nine characters
                                   long.

                                   FieldToMatch -> (structure)
                                      The part of a web request that you  want
                                      WAF  to  inspect.  For more information,
                                      see  FieldToMatch .

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name  of  the header to inspect, for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example   JSON:   "SingleHeader":  {
                                          "Name": "haystack" }

                                          Name -> (string)
                                             The name of the query  header  to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide the name of the query  argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion . The name can be up  to
                                          30  characters  long  and isn't case
                                          sensitive.

                                          This is used only  to  indicate  the
                                          web request component for WAF to in-
                                          spect, in the  FieldToMatch specifi-
                                          cation.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect  the  request URI path. This
                                          is the part of a  web  request  that
                                          identifies  a resource, for example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect the query  string.  This  is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect the request  body  as  plain
                                          text.  The  request body immediately
                                          follows the request headers. This is
                                          the  part of a request that contains
                                          any additional data that you want to
                                          send  to your web server as the HTTP
                                          request body, such as  data  from  a
                                          form.

                                          Note  that only the first 8 KB (8192
                                          bytes) of the request body are  for-
                                          warded  to WAF for inspection by the
                                          underlying  host  service.  If   you
                                          don't  need  to  inspect more than 8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing a statement  that  inspects  the
                                          body  of  the  web  request, such as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement  ,  with a
                                          SizeConstraintStatement   that   en-
                                          forces  an  8  KB  size limit on the
                                          body of  the  request.  WAF  doesn't
                                          support  inspecting  the entire con-
                                          tents of web requests  whose  bodies
                                          exceed the 8 KB limit.

                                      Method -> (structure)
                                          Inspect  the HTTP method. The method
                                          indicates the type of operation that
                                          the  request is asking the origin to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect the request  body  as  JSON.
                                          The request body immediately follows
                                          the request  headers.  This  is  the
                                          part  of a request that contains any
                                          additional data  that  you  want  to
                                          send  to your web server as the HTTP
                                          request body, such as  data  from  a
                                          form.

                                          Note  that only the first 8 KB (8192
                                          bytes) of the request body are  for-
                                          warded  to WAF for inspection by the
                                          underlying  host  service.  If   you
                                          don't  need  to  inspect more than 8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing a statement  that  inspects  the
                                          body  of  the  web  request, such as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement  ,  with a
                                          SizeConstraintStatement   that   en-
                                          forces  an  8  KB  size limit on the
                                          body of  the  request.  WAF  doesn't
                                          support  inspecting  the entire con-
                                          tents of web requests  whose  bodies
                                          exceed the 8 KB limit.

                                          MatchPattern -> (structure)
                                             The  patterns  to look for in the
                                             JSON body. WAF inspects  the  re-
                                             sults  of  these  pattern matches
                                             against the rule inspection  cri-
                                             teria.

                                             All -> (structure)
                                                 Match  all  of  the elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You  must specify either this
                                                 setting or the  IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match  only the specified in-
                                                 clude paths. See also  Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing JSON Pointer syntax.  For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"]  . For infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force  (IETF)   documentation
                                                 JavaScript   Object  Notation
                                                 (JSON) Pointer .

                                                 You must specify either  this
                                                 setting  or  the All setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't use this  option  to
                                                    include   all  paths.  In-
                                                    stead, use  the  All  set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The  parts  of  the JSON to match
                                             against using the MatchPattern  .
                                             If  you specify All , WAF matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely  parse  the JSON body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING  -   Inspect
                                               the body as plain text. WAF ap-
                                               plies the text  transformations
                                               and  inspection  criteria  that
                                               you defined for  the  JSON  in-
                                               spection   to   the  body  text
                                               string.

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                             If  you  don't  provide this set-
                                             ting, WAF  parses  and  evaluates
                                             the  content only up to the first
                                             parsing failure that  it  encoun-
                                             ters.

                                             WAF  does  its  best to parse the
                                             entire JSON body,  but  might  be
                                             forced  to  stop for reasons such
                                             as invalid characters,  duplicate
                                             keys, truncation, and any content
                                             whose root node isn't  an  object
                                             or an array.

                                             WAF  parses  the JSON in the fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                   ComparisonOperator -> (string)
                                      The  operator  to use to compare the re-
                                      quest part to the size setting.

                                   Size -> (long)
                                      The size, in byte, to compare to the re-
                                      quest part, after any transformations.

                                   TextTransformations -> (list)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection. If you  specify  one  or
                                      more  transformations  in  a rule state-
                                      ment, WAF performs  all  transformations
                                      on  the content of the request component
                                      identified by  FieldToMatch  ,  starting
                                      from the lowest priority setting, before
                                      inspecting the content for a match.

                                      (structure)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets  the relative processing or-
                                             der for multiple  transformations
                                             that   are  defined  for  a  rule
                                             statement.  WAF   processes   all
                                             transformations, from lowest pri-
                                             ority to highest, before inspect-
                                             ing  the transformed content. The
                                             priorities don't need to be  con-
                                             secutive,  but  they  must all be
                                             different.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE   -   Decode  a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT - Decode  a
                                                 Base64  -encoded  string, but
                                                 use a  forgiving  implementa-
                                                 tion  that ignores characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.   These  are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual formatting to  disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete spaces before  the  fol-
                                               lowing characters: / (

                                             o Replace  the  following charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE  -   Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r , carriage  return,  decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places multiple  spaces  with
                                                 one space.

                                                 CSS_DECODE  -  Decode charac-
                                                 ters that were encoded  using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in the decoding  process,  so
                                                 it  can help to uncover ASCII
                                                 characters that were  encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's  also useful in counter-
                                                 ing evasion, which is a  com-
                                                 bination  of  a backslash and
                                                 non-hexadecimal   characters.
                                                 For  example, ja\vascript for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE  -   Decode
                                                 the  following  ANSI C escape
                                                 sequences: \a , \b , \f ,  \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 , \"  ,  \xHH  (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't valid  remain  in  the
                                                 output.

                                                 HEX_DECODE  - Decode a string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE  - Replace
                                                 HTML-encoded characters  with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces  (ampersand)quot; with
                                               "

                                             o Replaces (ampersand)nbsp;  with
                                               a  non-breaking  space, decimal
                                               160

                                             o Replaces (ampersand)lt; with  a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat,  (ampersand)#xhhhh; , with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented  in decimal format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape sequences. If a  \   u
                                                 HHHH    code    is   in   the
                                                 full-width ASCII  code  range
                                                 of   FF01-FF5E   ,  then  the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not, only the lower  byte  is
                                                 used  and  the higher byte is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5  -  Calculate an MD5 hash
                                                 from the data in  the  input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE - Specify  NONE  if  you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH - Remove  mul-
                                                 tiple    slashes,   directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not at the beginning  of  the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN  - This is
                                                 the same as NORMALIZE_PATH  ,
                                                 but  first converts backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS   -  Remove  all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS  -   Replace
                                                 each  occurrence of a C-style
                                                 comment (/* ... */ )  with  a
                                                 single  space.  Multiple con-
                                                 secutive occurrences are  not
                                                 compressed. Unterminated com-
                                                 ments are also replaced  with
                                                 a  space  (ASCII  0x20). How-
                                                 ever, a  standalone  termina-
                                                 tion  of  a  comment (*/ ) is
                                                 not acted upon.

                                                 REPLACE_NULLS - Replace  NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE -  Decode  SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE , but with  support  for
                                                 Microsoft-specific  %u encod-
                                                 ing. If the code  is  in  the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte  is  used  to detect and
                                                 adjust the lower byte. Other-
                                                 wise,  only the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8 character sequences  to
                                                 Unicode.   This  helps  input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives for  non-Eng-
                                                 lish languages.

                               GeoMatchStatement -> (structure)
                                   A  rule  statement used to identify web re-
                                   quests based on country of origin.

                                   CountryCodes -> (list)
                                      An array of two-character country codes,
                                      for  example,  [ "US", "CN" ] , from the
                                      alpha-2 country ISO  codes  of  the  ISO
                                      3166 international standard.

                                      (string)

                                   ForwardedIPConfig -> (structure)
                                      The  configuration for inspecting IP ad-
                                      dresses in an HTTP header that you spec-
                                      ify,  instead  of  using  the IP address
                                      that's reported by the web request  ori-
                                      gin.   Commonly,   this  is  the  X-For-
                                      warded-For (XFF)  header,  but  you  can
                                      specify any header name.

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                      HeaderName -> (string)
                                          The name of the HTTP header  to  use
                                          for  the IP address. For example, to
                                          use   the   X-Forwarded-For    (XFF)
                                          header,  set this to X-Forwarded-For
                                          .

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present   in   the  request,  WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                      FallbackBehavior -> (string)
                                          The  match  status  to assign to the
                                          web request if the  request  doesn't
                                          have a valid IP address in the spec-
                                          ified position.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present   in   the  request,  WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          You  can specify the following fall-
                                          back behaviors:

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                               RuleGroupReferenceStatement -> (structure)
                                   A rule statement used to run the rules that
                                   are defined in a  RuleGroup . To use  this,
                                   create  a  rule group with your rules, then
                                   provide the ARN of the rule group  in  this
                                   statement.

                                   You  cannot nest a RuleGroupReferenceState-
                                   ment , for example for use  inside  a  Not-
                                   Statement or OrStatement . You can only use
                                   a rule group reference statement at the top
                                   level inside a web ACL.

                                   ARN -> (string)
                                      The  Amazon  Resource  Name (ARN) of the
                                      entity.

                                   ExcludedRules -> (list)
                                      The rules in the referenced  rule  group
                                      whose  actions  are  set to Count . When
                                      you exclude a rule, WAF evaluates it ex-
                                      actly  as  it  would  if the rule action
                                      setting were Count . This  is  a  useful
                                      option  for  testing the rules in a rule
                                      group without modifying how they  handle
                                      your web traffic.

                                      (structure)
                                          Specifies  a  single  rule in a rule
                                          group whose action you want to over-
                                          ride  to  Count . When you exclude a
                                          rule, WAF evaluates it exactly as it
                                          would  if  the  rule  action setting
                                          were Count . This is a useful option
                                          for  testing  the  rules  in  a rule
                                          group  without  modifying  how  they
                                          handle your web traffic.

                                          Name -> (string)
                                             The name of the rule whose action
                                             you want to override to Count .

                               IPSetReferenceStatement -> (structure)
                                   A rule statement used  to  detect  web  re-
                                   quests  coming from particular IP addresses
                                   or address ranges. To use this,  create  an
                                   IPSet that specifies the addresses you want
                                   to detect, then use the ARN of that set  in
                                   this  statement.  To  create an IP set, see
                                   CreateIPSet .

                                   Each IP set rule statement references an IP
                                   set.  You create and maintain the set inde-
                                   pendent of your rules. This allows  you  to
                                   use  the single set in multiple rules. When
                                   you update the referenced set, WAF automat-
                                   ically updates all rules that reference it.

                                   ARN -> (string)
                                      The  Amazon  Resource  Name (ARN) of the
                                      IPSet that this statement references.

                                   IPSetForwardedIPConfig -> (structure)
                                      The configuration for inspecting IP  ad-
                                      dresses in an HTTP header that you spec-
                                      ify, instead of  using  the  IP  address
                                      that's  reported by the web request ori-
                                      gin.  Commonly,  this  is   the   X-For-
                                      warded-For  (XFF)  header,  but  you can
                                      specify any header name.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      HeaderName -> (string)
                                          The  name  of the HTTP header to use
                                          for the IP address. For example,  to
                                          use    the   X-Forwarded-For   (XFF)
                                          header, set this to  X-Forwarded-For
                                          .

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                      FallbackBehavior -> (string)
                                          The match status to  assign  to  the
                                          web  request  if the request doesn't
                                          have a valid IP address in the spec-
                                          ified position.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          You can specify the following  fall-
                                          back behaviors:

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                      Position -> (string)
                                          The position in the header to search
                                          for  the  IP address. The header can
                                          contain IP addresses of the original
                                          client  and also of proxies. For ex-
                                          ample, the  header  value  could  be
                                          10.1.1.1,   127.0.0.0,   10.10.10.10
                                          where the first IP  address  identi-
                                          fies  the  original  client  and the
                                          rest identify proxies that  the  re-
                                          quest went through.

                                          The options for this setting are the
                                          following:

                                          o FIRST - Inspect the first  IP  ad-
                                            dress  in the list of IP addresses
                                            in the header. This is usually the
                                            client's original IP.

                                          o LAST - Inspect the last IP address
                                            in the list of IP addresses in the
                                            header.

                                          o ANY  - Inspect all IP addresses in
                                            the header for  a  match.  If  the
                                            header  contains  more  than 10 IP
                                            addresses, WAF inspects  the  last
                                            10.

                               RegexPatternSetReferenceStatement   ->  (struc-
                               ture)
                                   A rule statement used to search web request
                                   components for matches with regular expres-
                                   sions. To use  this,  create  a   RegexPat-
                                   ternSet that specifies the expressions that
                                   you want to detect, then  use  the  ARN  of
                                   that  set  in this statement. A web request
                                   matches the pattern set rule  statement  if
                                   the  request  component  matches any of the
                                   patterns in the set. To create a regex pat-
                                   tern set, see  CreateRegexPatternSet .

                                   Each  regex pattern set rule statement ref-
                                   erences a regex pattern set. You create and
                                   maintain the set independent of your rules.
                                   This allows you to use the  single  set  in
                                   multiple  rules. When you update the refer-
                                   enced set, WAF  automatically  updates  all
                                   rules that reference it.

                                   ARN -> (string)
                                      The  Amazon  Resource  Name (ARN) of the
                                      RegexPatternSet that this statement ref-
                                      erences.

                                   FieldToMatch -> (structure)
                                      The  part of a web request that you want
                                      WAF to inspect.  For  more  information,
                                      see  FieldToMatch .

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name of the header to  inspect,  for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example  JSON:   "SingleHeader":   {
                                          "Name": "haystack" }

                                          Name -> (string)
                                             The  name  of the query header to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide  the name of the query argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion  . The name can be up to
                                          30 characters long  and  isn't  case
                                          sensitive.

                                          This  is  used  only to indicate the
                                          web request component for WAF to in-
                                          spect, in the  FieldToMatch specifi-
                                          cation.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect the request URI  path.  This
                                          is  the  part  of a web request that
                                          identifies a resource, for  example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect  the  query  string. This is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect  the  request  body as plain
                                          text. The request  body  immediately
                                          follows the request headers. This is
                                          the part of a request that  contains
                                          any additional data that you want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                      Method -> (structure)
                                          Inspect the HTTP method. The  method
                                          indicates the type of operation that
                                          the request is asking the origin  to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect  the  request  body as JSON.
                                          The request body immediately follows
                                          the  request  headers.  This  is the
                                          part of a request that contains  any
                                          additional  data  that  you  want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                          MatchPattern -> (structure)
                                             The patterns to look for  in  the
                                             JSON  body.  WAF inspects the re-
                                             sults of  these  pattern  matches
                                             against  the rule inspection cri-
                                             teria.

                                             All -> (structure)
                                                 Match all  of  the  elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You must specify either  this
                                                 setting  or the IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match only the specified  in-
                                                 clude  paths. See also Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing  JSON Pointer syntax. For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"] . For  infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force   (IETF)  documentation
                                                 JavaScript  Object   Notation
                                                 (JSON) Pointer .

                                                 You  must specify either this
                                                 setting or the  All  setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't  use  this option to
                                                    include  all  paths.   In-
                                                    stead,  use  the  All set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the  JSON  to  match
                                             against  using the MatchPattern .
                                             If you specify All , WAF  matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely parse the  JSON  body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING   -  Inspect
                                               the body as plain text. WAF ap-
                                               plies  the text transformations
                                               and  inspection  criteria  that
                                               you  defined  for  the JSON in-
                                               spection  to  the   body   text
                                               string.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             If you don't  provide  this  set-
                                             ting,  WAF  parses  and evaluates
                                             the content only up to the  first
                                             parsing  failure  that it encoun-
                                             ters.

                                             WAF does its best  to  parse  the
                                             entire  JSON  body,  but might be
                                             forced to stop for  reasons  such
                                             as  invalid characters, duplicate
                                             keys, truncation, and any content
                                             whose  root  node isn't an object
                                             or an array.

                                             WAF parses the JSON in  the  fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                   TextTransformations -> (list)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass  detection.  If  you specify one or
                                      more transformations in  a  rule  state-
                                      ment,  WAF  performs all transformations
                                      on the content of the request  component
                                      identified  by  FieldToMatch  , starting
                                      from the lowest priority setting, before
                                      inspecting the content for a match.

                                      (structure)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets the relative processing  or-
                                             der  for multiple transformations
                                             that  are  defined  for  a   rule
                                             statement.   WAF   processes  all
                                             transformations, from lowest pri-
                                             ority to highest, before inspect-
                                             ing the transformed content.  The
                                             priorities  don't need to be con-
                                             secutive, but they  must  all  be
                                             different.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE  -   Decode   a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT  - Decode a
                                                 Base64 -encoded  string,  but
                                                 use  a  forgiving implementa-
                                                 tion that ignores  characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.  These   are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual  formatting to disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete  spaces  before the fol-
                                               lowing characters: / (

                                             o Replace the  following  charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE   -  Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r  ,  carriage return, decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places  multiple  spaces with
                                                 one space.

                                                 CSS_DECODE -  Decode  charac-
                                                 ters  that were encoded using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in  the  decoding process, so
                                                 it can help to uncover  ASCII
                                                 characters  that were encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's also useful in  counter-
                                                 ing  evasion, which is a com-
                                                 bination of a  backslash  and
                                                 non-hexadecimal   characters.
                                                 For example, ja\vascript  for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE   -  Decode
                                                 the following ANSI  C  escape
                                                 sequences:  \a , \b , \f , \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 ,  \"  ,  \xHH (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't  valid  remain  in the
                                                 output.

                                                 HEX_DECODE - Decode a  string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE -  Replace
                                                 HTML-encoded  characters with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces (ampersand)quot;  with
                                               "

                                             o Replaces  (ampersand)nbsp; with
                                               a non-breaking  space,  decimal
                                               160

                                             o Replaces  (ampersand)lt; with a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat, (ampersand)#xhhhh; ,  with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented in decimal  format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape  sequences.  If a \  u
                                                 HHHH   code   is    in    the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,   then   the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not,  only  the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5 - Calculate an  MD5  hash
                                                 from  the  data in the input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE  -  Specify  NONE if you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH  - Remove mul-
                                                 tiple   slashes,    directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not  at  the beginning of the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN - This  is
                                                 the  same as NORMALIZE_PATH ,
                                                 but first converts  backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS  -  Remove   all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS   -  Replace
                                                 each occurrence of a  C-style
                                                 comment  (/*  ... */ ) with a
                                                 single space.  Multiple  con-
                                                 secutive  occurrences are not
                                                 compressed. Unterminated com-
                                                 ments  are also replaced with
                                                 a space  (ASCII  0x20).  How-
                                                 ever,  a  standalone termina-
                                                 tion of a comment  (*/  )  is
                                                 not acted upon.

                                                 REPLACE_NULLS  - Replace NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE  -  Decode SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE  ,  but with support for
                                                 Microsoft-specific %u  encod-
                                                 ing.  If  the  code is in the
                                                 full-width ASCII  code  range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte is used  to  detect  and
                                                 adjust the lower byte. Other-
                                                 wise, only the lower byte  is
                                                 used  and  the higher byte is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8  character sequences to
                                                 Unicode.  This  helps   input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives  for non-Eng-
                                                 lish languages.

                               RateBasedStatement -> (structure)
                                   A rate-based rule tracks the  rate  of  re-
                                   quests for each originating IP address, and
                                   triggers the rule action when the rate  ex-
                                   ceeds  a limit that you specify on the num-
                                   ber of requests in any 5-minute time  span.
                                   You  can  use this to put a temporary block
                                   on requests from  an  IP  address  that  is
                                   sending excessive requests.

                                   WAF  tracks  and manages web requests sepa-
                                   rately for each instance  of  a  rate-based
                                   rule that you use. For example, if you pro-
                                   vide the same rate-based rule  settings  in
                                   two  web  ACLs, each of the two rule state-
                                   ments represents a separate instance of the
                                   rate-based  rule  and gets its own tracking
                                   and management by  WAF.  If  you  define  a
                                   rate-based  rule  inside  a rule group, and
                                   then  use  that  rule  group  in   multiple
                                   places,  each  use  creates  a separate in-
                                   stance of the rate-based rule that gets its
                                   own tracking and management by WAF.

                                   When  the  rule action triggers, WAF blocks
                                   additional requests from the IP address un-
                                   til the request rate falls below the limit.

                                   You  can  optionally nest another statement
                                   inside the rate-based statement, to  narrow
                                   the  scope  of  the  rule  so  that it only
                                   counts  requests  that  match  the   nested
                                   statement. For example, based on recent re-
                                   quests that you have seen from an attacker,
                                   you  might  create a rate-based rule with a
                                   nested AND rule statement that contains the
                                   following nested statements:

                                   o An IP match statement with an IP set that
                                     specified the address 192.0.2.44.

                                   o A string match statement that searches in
                                     the User-Agent header for the string Bad-
                                     Bot.

                                   In this rate-based rule, you also define  a
                                   rate  limit.  For  this  example,  the rate
                                   limit is 1,000. Requests that meet both  of
                                   the   conditions   in  the  statements  are
                                   counted. If the  count  exceeds  1,000  re-
                                   quests  per  five  minutes, the rule action
                                   triggers. Requests that do  not  meet  both
                                   conditions are not counted towards the rate
                                   limit and are not affected by this rule.

                                   You cannot nest a RateBasedStatement inside
                                   another  statement,  for  example  inside a
                                   NotStatement or OrStatement . You  can  de-
                                   fine  a RateBasedStatement inside a web ACL
                                   and inside a rule group.

                                   Limit -> (long)
                                      The limit on requests per  5-minute  pe-
                                      riod  for  a  single  originating IP ad-
                                      dress.  If  the  statement  includes   a
                                      ScopeDownStatement  ,  this limit is ap-
                                      plied only to the  requests  that  match
                                      the statement.

                                   AggregateKeyType -> (string)
                                      Setting  that indicates how to aggregate
                                      the request counts. The options are  the
                                      following:

                                      o IP  -  Aggregate the request counts on
                                        the IP address from  the  web  request
                                        origin.

                                      o FORWARDED_IP  -  Aggregate the request
                                        counts on the first IP address  in  an
                                        HTTP  header. If you use this, config-
                                        ure the ForwardedIPConfig , to specify
                                        the header to use.

                                   (  ...  recursive ... )ForwardedIPConfig ->
                                   (structure)
                                      The configuration for inspecting IP  ad-
                                      dresses in an HTTP header that you spec-
                                      ify, instead of  using  the  IP  address
                                      that's  reported by the web request ori-
                                      gin.  Commonly,  this  is   the   X-For-
                                      warded-For  (XFF)  header,  but  you can
                                      specify any header name.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      This  is required if AggregateKeyType is
                                      set to FORWARDED_IP .

                                      HeaderName -> (string)
                                          The name of the HTTP header  to  use
                                          for  the IP address. For example, to
                                          use   the   X-Forwarded-For    (XFF)
                                          header,  set this to X-Forwarded-For
                                          .

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present   in   the  request,  WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                      FallbackBehavior -> (string)
                                          The  match  status  to assign to the
                                          web request if the  request  doesn't
                                          have a valid IP address in the spec-
                                          ified position.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present   in   the  request,  WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          You  can specify the following fall-
                                          back behaviors:

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                               AndStatement -> (structure)
                                   A  logical  rule  statement used to combine
                                   other rule statements with AND  logic.  You
                                   provide more than one  Statement within the
                                   AndStatement .

                                   Statements -> (list)
                                      The  statements  to  combine  with   AND
                                      logic.  You  can use any statements that
                                      can be nested.

                                      ( ... recursive ... )

                               OrStatement -> (structure)
                                   A logical rule statement  used  to  combine
                                   other  rule  statements  with OR logic. You
                                   provide more than one  Statement within the
                                   OrStatement .

                                   Statements -> (list)
                                      The statements to combine with OR logic.
                                      You can use any statements that  can  be
                                      nested.

                                      ( ... recursive ... )

                               NotStatement -> (structure)
                                   A logical rule statement used to negate the
                                   results of another rule statement. You pro-
                                   vide one  Statement within the NotStatement
                                   .

                                   ( ... recursive ... )

                               ManagedRuleGroupStatement -> (structure)
                                   A rule statement used to run the rules that
                                   are defined in a managed rule group. To use
                                   this, provide the vendor name and the  name
                                   of  the  rule  group in this statement. You
                                   can retrieve the required names by  calling
                                   ListAvailableManagedRuleGroups .

                                   You cannot nest a ManagedRuleGroupStatement
                                   , for example for use inside a NotStatement
                                   or  OrStatement . It can only be referenced
                                   as a top-level statement within a rule.

                                   VendorName -> (string)
                                      The name of the managed rule group  ven-
                                      dor.  You  use this, along with the rule
                                      group name, to identify the rule group.

                                   Name -> (string)
                                      The name of the managed rule group.  You
                                      use this, along with the vendor name, to
                                      identify the rule group.

                                   Version -> (string)
                                      The version of the managed rule group to
                                      use.  If  you  specify this, the version
                                      setting is fixed until you change it. If
                                      you  don't  specify  this,  WAF uses the
                                      vendor's default version, and then keeps
                                      the version at the vendor's default when
                                      the  vendor  updates  the  managed  rule
                                      group settings.

                                   ExcludedRules -> (list)
                                      The  rules  in the referenced rule group
                                      whose actions are set to  Count  .  When
                                      you exclude a rule, WAF evaluates it ex-
                                      actly as it would  if  the  rule  action
                                      setting  were  Count  . This is a useful
                                      option for testing the rules in  a  rule
                                      group  without modifying how they handle
                                      your web traffic.

                                      (structure)
                                          Specifies a single rule  in  a  rule
                                          group whose action you want to over-
                                          ride to Count . When you  exclude  a
                                          rule, WAF evaluates it exactly as it
                                          would if  the  rule  action  setting
                                          were Count . This is a useful option
                                          for testing  the  rules  in  a  rule
                                          group  without  modifying  how  they
                                          handle your web traffic.

                                          Name -> (string)
                                             The name of the rule whose action
                                             you want to override to Count .

                                   ( ... recursive ... )

                               LabelMatchStatement -> (structure)
                                   A  rule  statement  that  defines  a string
                                   match search against labels that have  been
                                   added to the web request by rules that have
                                   already run in the web ACL.

                                   The label match statement provides the  la-
                                   bel  or namespace string to search for. The
                                   label string can represent a part or all of
                                   the  fully  qualified  label  name that had
                                   been added to the web request. Fully quali-
                                   fied  labels  have a prefix, optional name-
                                   spaces, and label name. The prefix  identi-
                                   fies  the  rule group or web ACL context of
                                   the rule that added the label.  If  you  do
                                   not  provide  the  fully  qualified name in
                                   your label match string, WAF  performs  the
                                   search  for  labels  that were added in the
                                   same context as the label match statement.

                                   Scope -> (string)
                                      Specify whether you want to match  using
                                      the label name or just the namespace.

                                   Key -> (string)
                                      The string to match against. The setting
                                      you provide  for  this  depends  on  the
                                      match statement's Scope setting:

                                      o If  the  Scope  indicates LABEL , then
                                        this specification  must  include  the
                                        name  and  can  include  any number of
                                        preceding namespace specifications and
                                        prefix up to providing the fully qual-
                                        ified label name.

                                      o If the  Scope  indicates  NAMESPACE  ,
                                        then  this  specification  can include
                                        any  number  of  contiguous  namespace
                                        strings,  and  can  include the entire
                                        label namespace prefix from  the  rule
                                        group or web ACL where the label orig-
                                        inates.

                                      Labels are case sensitive and components
                                      of  a  label must be separated by colon,
                                      for example NS1:NS2:name .

                               RegexMatchStatement -> (structure)
                                   A rule statement used to search web request
                                   components  for  a  match  against a single
                                   regular expression.

                                   RegexString -> (string)
                                      The string representing the regular  ex-
                                      pression.

                                   FieldToMatch -> (structure)
                                      The  part of a web request that you want
                                      WAF to inspect.  For  more  information,
                                      see  FieldToMatch .

                                      SingleHeader -> (structure)
                                          Inspect a single header. Provide the
                                          name of the header to  inspect,  for
                                          example,  User-Agent  or  Referer  .
                                          This setting isn't case sensitive.

                                          Example  JSON:   "SingleHeader":   {
                                          "Name": "haystack" }

                                          Name -> (string)
                                             The  name  of the query header to
                                             inspect.

                                      SingleQueryArgument -> (structure)
                                          Inspect  a  single  query  argument.
                                          Provide  the name of the query argu-
                                          ment to inspect, such as UserName or
                                          SalesRegion  . The name can be up to
                                          30 characters long  and  isn't  case
                                          sensitive.

                                          This  is  used  only to indicate the
                                          web request component for WAF to in-
                                          spect, in the  FieldToMatch specifi-
                                          cation.

                                          Example JSON: "SingleQueryArgument":
                                          { "Name": "myArgument" }

                                          Name -> (string)
                                             The name of the query argument to
                                             inspect.

                                      AllQueryArguments -> (structure)
                                          Inspect all query arguments.

                                      UriPath -> (structure)
                                          Inspect the request URI  path.  This
                                          is  the  part  of a web request that
                                          identifies a resource, for  example,
                                          /images/daily-ad.jpg .

                                      QueryString -> (structure)
                                          Inspect  the  query  string. This is
                                          the part of a URL that appears after
                                          a ? character, if any.

                                      Body -> (structure)
                                          Inspect  the  request  body as plain
                                          text. The request  body  immediately
                                          follows the request headers. This is
                                          the part of a request that  contains
                                          any additional data that you want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                      Method -> (structure)
                                          Inspect the HTTP method. The  method
                                          indicates the type of operation that
                                          the request is asking the origin  to
                                          perform.

                                      JsonBody -> (structure)
                                          Inspect  the  request  body as JSON.
                                          The request body immediately follows
                                          the  request  headers.  This  is the
                                          part of a request that contains  any
                                          additional  data  that  you  want to
                                          send to your web server as the  HTTP
                                          request  body,  such  as data from a
                                          form.

                                          Note that only the first 8 KB  (8192
                                          bytes)  of the request body are for-
                                          warded to WAF for inspection by  the
                                          underlying   host  service.  If  you
                                          don't need to inspect  more  than  8
                                          KB, you can guarantee that you don't
                                          allow additional bytes in by combin-
                                          ing  a  statement  that inspects the
                                          body of the  web  request,  such  as
                                          ByteMatchStatement   or    RegexPat-
                                          ternSetReferenceStatement ,  with  a
                                          SizeConstraintStatement   that   en-
                                          forces an 8 KB  size  limit  on  the
                                          body  of  the  request.  WAF doesn't
                                          support inspecting the  entire  con-
                                          tents  of  web requests whose bodies
                                          exceed the 8 KB limit.

                                          MatchPattern -> (structure)
                                             The patterns to look for  in  the
                                             JSON  body.  WAF inspects the re-
                                             sults of  these  pattern  matches
                                             against  the rule inspection cri-
                                             teria.

                                             All -> (structure)
                                                 Match all  of  the  elements.
                                                 See also MatchScope in  Json-
                                                 Body .

                                                 You must specify either  this
                                                 setting  or the IncludedPaths
                                                 setting, but not both.

                                             IncludedPaths -> (list)
                                                 Match only the specified  in-
                                                 clude  paths. See also Match-
                                                 Scope in  JsonBody .

                                                 Provide the include paths us-
                                                 ing  JSON Pointer syntax. For
                                                 example,     "IncludedPaths":
                                                 ["/dogs/0/name",
                                                 "/dogs/1/name"] . For  infor-
                                                 mation about this syntax, see
                                                 the Internet Engineering Task
                                                 Force   (IETF)  documentation
                                                 JavaScript  Object   Notation
                                                 (JSON) Pointer .

                                                 You  must specify either this
                                                 setting or the  All  setting,
                                                 but not both.

                                                 NOTE:
                                                    Don't  use  this option to
                                                    include  all  paths.   In-
                                                    stead,  use  the  All set-
                                                    ting.

                                                 (string)

                                          MatchScope -> (string)
                                             The parts of the  JSON  to  match
                                             against  using the MatchPattern .
                                             If you specify All , WAF  matches
                                             against keys and values.

                                          InvalidFallbackBehavior -> (string)
                                             What WAF should do if it fails to
                                             completely parse the  JSON  body.
                                             The options are the following:

                                             o EVALUATE_AS_STRING   -  Inspect
                                               the body as plain text. WAF ap-
                                               plies  the text transformations
                                               and  inspection  criteria  that
                                               you  defined  for  the JSON in-
                                               spection  to  the   body   text
                                               string.

                                             o MATCH  -  Treat the web request
                                               as matching the rule statement.
                                               WAF  applies the rule action to
                                               the request.

                                             o NO_MATCH - Treat  the  web  re-
                                               quest  as not matching the rule
                                               statement.

                                             If you don't  provide  this  set-
                                             ting,  WAF  parses  and evaluates
                                             the content only up to the  first
                                             parsing  failure  that it encoun-
                                             ters.

                                             WAF does its best  to  parse  the
                                             entire  JSON  body,  but might be
                                             forced to stop for  reasons  such
                                             as  invalid characters, duplicate
                                             keys, truncation, and any content
                                             whose  root  node isn't an object
                                             or an array.

                                             WAF parses the JSON in  the  fol-
                                             lowing examples as two valid key,
                                             value pairs:

                                             o Missing                  comma:
                                               {"key1":"value1""key2":"value2"}

                                             o Missing                  colon:
                                               {"key1":"value1","key2""value2"}

                                             o Extra                   colons:
                                               {"key1"::"value1","key2""value2"}

                                   TextTransformations -> (list)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass  detection.  If  you specify one or
                                      more transformations in  a  rule  state-
                                      ment,  WAF  performs all transformations
                                      on the content of the request  component
                                      identified  by  FieldToMatch  , starting
                                      from the lowest priority setting, before
                                      inspecting the content for a match.

                                      (structure)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.

                                          Priority -> (integer)
                                             Sets the relative processing  or-
                                             der  for multiple transformations
                                             that  are  defined  for  a   rule
                                             statement.   WAF   processes  all
                                             transformations, from lowest pri-
                                             ority to highest, before inspect-
                                             ing the transformed content.  The
                                             priorities  don't need to be con-
                                             secutive, but they  must  all  be
                                             different.

                                          Type -> (string)
                                             You  can  specify  the  following
                                             transformation types:
                                                 BASE64_DECODE  -   Decode   a
                                                 Base64 -encoded string.

                                                 BASE64_DECODE_EXT  - Decode a
                                                 Base64 -encoded  string,  but
                                                 use  a  forgiving implementa-
                                                 tion that ignores  characters
                                                 that aren't valid.

                                                 CMD_LINE    -    Command-line
                                                 transformations.  These   are
                                                 helpful  in  reducing  effec-
                                                 tiveness of attackers who in-
                                                 ject an operating system com-
                                                 mand-line command and use un-
                                                 usual  formatting to disguise
                                                 some or all of the command.

                                             o Delete  the  following  charac-
                                               ters: \ " ' ^

                                             o Delete  spaces  before the fol-
                                               lowing characters: / (

                                             o Replace the  following  charac-
                                               ters with a space: , ;

                                             o Replace  multiple  spaces  with
                                               one space

                                             o Convert uppercase letters (A-Z)
                                               to lowercase (a-z)
                                                 COMPRESS_WHITE_SPACE   -  Re-
                                                 place these characters with a
                                                 space character (decimal 32):

                                             o \f , formfeed, decimal 12

                                             o \t , tab, decimal 9

                                             o \n , newline, decimal 10

                                             o \r  ,  carriage return, decimal
                                               13

                                             o \v , vertical tab, decimal 11

                                             o Non-breaking space, decimal 160
                                                 COMPRESS_WHITE_SPACE also re-
                                                 places  multiple  spaces with
                                                 one space.

                                                 CSS_DECODE -  Decode  charac-
                                                 ters  that were encoded using
                                                 CSS  2.x  escape  rules  syn-
                                                 data.html#characters  .  This
                                                 function uses up to two bytes
                                                 in  the  decoding process, so
                                                 it can help to uncover  ASCII
                                                 characters  that were encoded
                                                 using   CSS   encoding   that
                                                 wouldnt typically be encoded.
                                                 It's also useful in  counter-
                                                 ing  evasion, which is a com-
                                                 bination of a  backslash  and
                                                 non-hexadecimal   characters.
                                                 For example, ja\vascript  for
                                                 javascript.

                                                 ESCAPE_SEQ_DECODE   -  Decode
                                                 the following ANSI  C  escape
                                                 sequences:  \a , \b , \f , \n
                                                 , \r , \t , \v , \\ , \? , \'
                                                 ,  \"  ,  \xHH (hexadecimal),
                                                 \0OOO (octal). Encodings that
                                                 aren't  valid  remain  in the
                                                 output.

                                                 HEX_DECODE - Decode a  string
                                                 of   hexadecimal   characters
                                                 into a binary.

                                                 HTML_ENTITY_DECODE -  Replace
                                                 HTML-encoded  characters with
                                                 unencoded         characters.
                                                 HTML_ENTITY_DECODE   performs
                                                 these operations:

                                             o Replaces (ampersand)quot;  with
                                               "

                                             o Replaces  (ampersand)nbsp; with
                                               a non-breaking  space,  decimal
                                               160

                                             o Replaces  (ampersand)lt; with a
                                               "less than" symbol

                                             o Replaces (ampersand)gt; with >

                                             o Replaces  characters  that  are
                                               represented in hexadecimal for-
                                               mat, (ampersand)#xhhhh; ,  with
                                               the corresponding characters

                                             o Replaces  characters  that  are
                                               represented in decimal  format,
                                               (ampersand)#nnnn;  ,  with  the
                                               corresponding characters
                                                 JS_DECODE - Decode JavaScript
                                                 escape  sequences.  If a \  u
                                                 HHHH   code   is    in    the
                                                 full-width  ASCII  code range
                                                 of  FF01-FF5E  ,   then   the
                                                 higher byte is used to detect
                                                 and adjust the lower byte. If
                                                 not,  only  the lower byte is
                                                 used and the higher  byte  is
                                                 zeroed,  causing  a  possible
                                                 loss of information.

                                                 LOWERCASE - Convert uppercase
                                                 letters  (A-Z)  to  lowercase
                                                 (a-z).

                                                 MD5 - Calculate an  MD5  hash
                                                 from  the  data in the input.
                                                 The computed hash is in a raw
                                                 binary form.

                                                 NONE  -  Specify  NONE if you
                                                 don't want any text transfor-
                                                 mations.

                                                 NORMALIZE_PATH  - Remove mul-
                                                 tiple   slashes,    directory
                                                 self-references,  and  direc-
                                                 tory back-references that are
                                                 not  at  the beginning of the
                                                 input from an input string.

                                                 NORMALIZE_PATH_WIN - This  is
                                                 the  same as NORMALIZE_PATH ,
                                                 but first converts  backslash
                                                 characters     to     forward
                                                 slashes.

                                                 REMOVE_NULLS  -  Remove   all
                                                 NULL bytes from the input.

                                                 REPLACE_COMMENTS   -  Replace
                                                 each occurrence of a  C-style
                                                 comment  (/*  ... */ ) with a
                                                 single space.  Multiple  con-
                                                 secutive  occurrences are not
                                                 compressed. Unterminated com-
                                                 ments  are also replaced with
                                                 a space  (ASCII  0x20).  How-
                                                 ever,  a  standalone termina-
                                                 tion of a comment  (*/  )  is
                                                 not acted upon.

                                                 REPLACE_NULLS  - Replace NULL
                                                 bytes in the input with space
                                                 characters (ASCII 0x20 ).

                                                 SQL_HEX_DECODE  -  Decode SQL
                                                 hex data. Example (0x414243 )
                                                 will be decoded to (ABC ).

                                                 URL_DECODE - Decode a URL-en-
                                                 coded value.

                                                 URL_DECODE_UNI - Like URL_DE-
                                                 CODE  ,  but with support for
                                                 Microsoft-specific %u  encod-
                                                 ing.  If  the  code is in the
                                                 full-width ASCII  code  range
                                                 of  FF01-FF5E  ,  the  higher
                                                 byte is used  to  detect  and
                                                 adjust the lower byte. Other-
                                                 wise, only the lower byte  is
                                                 used  and  the higher byte is
                                                 zeroed.

                                                 UTF8_TO_UNICODE - Convert all
                                                 UTF-8  character sequences to
                                                 Unicode.  This  helps   input
                                                 normalization, and minimizing
                                                 false-positives           and
                                                 false-negatives  for non-Eng-
                                                 lish languages.

                     NotStatement -> (structure)
                        A logical rule statement used to negate the results of
                        another  rule  statement.  You  provide one  Statement
                        within the NotStatement .

                        Statement -> (structure)
                            The statement to negate. You can use any statement
                            that can be nested.

                            ByteMatchStatement -> (structure)
                               A  rule  statement  that defines a string match
                               search for WAF to apply to  web  requests.  The
                               byte  match  statement  provides  the  bytes to
                               search for, the location in requests  that  you
                               want  WAF  to  search,  and other settings. The
                               bytes to search for are typically a string that
                               corresponds  with  ASCII characters. In the WAF
                               console and the developer guide, this  is  ref-
                               ered to as a string match statement.

                               SearchString -> (blob)
                                   A  string value that you want WAF to search
                                   for. WAF searches only in the part  of  web
                                   requests  that you designate for inspection
                                   in  FieldToMatch . The  maximum  length  of
                                   the value is 50 bytes.

                                   Valid  values  depend on the component that
                                   you specify for inspection in  FieldToMatch
                                   :

                                   o Method  :  The  HTTP method that you want
                                     WAF to search  for.  This  indicates  the
                                     type  of  operation  specified in the re-
                                     quest.

                                   o UriPath : The value that you want WAF  to
                                     search  for in the URI path, for example,
                                     /images/daily-ad.jpg .

                                   If SearchString includes alphabetic charac-
                                   ters  A-Z  and  a-z, note that the value is
                                   case sensitive.
                                      If you're using the WAF API

                                   Specify a  base64-encoded  version  of  the
                                   value.  The maximum length of the value be-
                                   fore you base64-encode it is 50 bytes.

                                   For example, suppose the value of  Type  is
                                   HEADER  and the value of Data is User-Agent
                                   . If you  want  to  search  the  User-Agent
                                   header   for   the   value   BadBot  ,  you
                                   base64-encode BadBot using MIME  base64-en-
                                   coding and include the resulting value, Qm-
                                   FkQm90 , in the value of SearchString .
                                      If you're using the CLI or  one  of  the
                                      Amazon Web Services SDKs

                                   The  value that you want WAF to search for.
                                   The SDK automatically  base64  encodes  the
                                   value.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to  inspect.  For  more  information,   see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect  a  single  header.  Provide the
                                      name of the header to inspect, for exam-
                                      ple,  User-Agent  or Referer . This set-
                                      ting isn't case sensitive.

                                      Example JSON: "SingleHeader": {  "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The  name of the query header to in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the  name  of  the query argument to in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This is used only to  indicate  the  web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example JSON:  "SingleQueryArgument":  {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The  name  of  the query argument to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect the request URI  path.  This  is
                                      the  part  of a web request that identi-
                                      fies  a  resource,  for  example,   /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect  the  query  string. This is the
                                      part of a URL that  appears  after  a  ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect  the request body as plain text.
                                      The request body immediately follows the
                                      request  headers.  This is the part of a
                                      request  that  contains  any  additional
                                      data  that  you want to send to your web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect  the HTTP method. The method in-
                                      dicates the type of operation  that  the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect  the  request  body as JSON. The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest that contains any additional  data
                                      that you want to send to your web server
                                      as the HTTP request body, such  as  data
                                      from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text transformations eliminate some of  the
                                   unusual  formatting  that  attackers use in
                                   web requests in an effort to bypass  detec-
                                   tion.  If you specify one or more transfor-
                                   mations in a rule statement,  WAF  performs
                                   all  transformations  on the content of the
                                   request  component  identified  by   Field-
                                   ToMatch , starting from the lowest priority
                                   setting, before inspecting the content  for
                                   a match.

                                   (structure)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets the relative  processing  order
                                          for  multiple  transformations  that
                                          are defined for  a  rule  statement.
                                          WAF  processes  all transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent. The priorities don't  need  to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                               PositionalConstraint -> (string)
                                   The  area  within  the portion of a web re-
                                   quest that  you  want  WAF  to  search  for
                                   SearchString  .  Valid  values  include the
                                   following:
                                      CONTAINS

                                   The specified part of the web request  must
                                   include the value of SearchString , but the
                                   location doesn't matter.
                                      CONTAINS_WORD

                                   The specified part of the web request  must
                                   include  the  value  of  SearchString , and
                                   SearchString must contain only alphanumeric
                                   characters or underscore (A-Z, a-z, 0-9, or
                                   _). In addition,  SearchString  must  be  a
                                   word,  which means that both of the follow-
                                   ing are true:

                                   o SearchString is at the beginning  of  the
                                     specified  part  of the web request or is
                                     preceded by a character other than an al-
                                     phanumeric  character  or underscore (_).
                                     Examples include the value  of  a  header
                                     and ;BadBot .

                                   o SearchString  is at the end of the speci-
                                     fied part of the web request or  is  fol-
                                     lowed  by  a  character other than an al-
                                     phanumeric character or  underscore  (_),
                                     for example, BadBot; and -BadBot; .
                                      EXACTLY

                                   The  value of the specified part of the web
                                   request must exactly  match  the  value  of
                                   SearchString .
                                      STARTS_WITH

                                   The  value  of  SearchString must appear at
                                   the beginning of the specified part of  the
                                   web request.
                                      ENDS_WITH

                                   The  value  of  SearchString must appear at
                                   the end of the specified part  of  the  web
                                   request.

                            SqliMatchStatement -> (structure)
                               Attackers  sometimes  insert malicious SQL code
                               into web requests in an effort to extract  data
                               from  your  database. To allow or block web re-
                               quests that appear  to  contain  malicious  SQL
                               code,  create  one  or more SQL injection match
                               conditions. An SQL  injection  match  condition
                               identifies  the  part  of web requests, such as
                               the URI or the query string, that you want  WAF
                               to inspect. Later in the process, when you cre-
                               ate a web ACL, you specify whether to allow  or
                               block requests that appear to contain malicious
                               SQL code.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to   inspect.  For  more  information,  see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This  is  used  only to indicate the web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of a web request  that  identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. If you specify one or more  transfor-
                                   mations  in  a rule statement, WAF performs
                                   all transformations on the content  of  the
                                   request   component  identified  by  Field-
                                   ToMatch , starting from the lowest priority
                                   setting,  before inspecting the content for
                                   a match.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations  that
                                          are  defined  for  a rule statement.
                                          WAF processes  all  transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent.  The  priorities don't need to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                            XssMatchStatement -> (structure)
                               A rule  statement  that  defines  a  cross-site
                               scripting  (XSS)  match search for WAF to apply
                               to web requests. XSS attacks  are  those  where
                               the  attacker  uses vulnerabilities in a benign
                               website  as  a  vehicle  to  inject   malicious
                               client-site  scripts  into other legitimate web
                               browsers. The XSS match statement provides  the
                               location  in  requests  that  you  want  WAF to
                               search and text transformations to use  on  the
                               search  area  before WAF searches for character
                               sequences  that  are  likely  to  be  malicious
                               strings.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to  inspect.  For  more  information,   see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect  a  single  header.  Provide the
                                      name of the header to inspect, for exam-
                                      ple,  User-Agent  or Referer . This set-
                                      ting isn't case sensitive.

                                      Example JSON: "SingleHeader": {  "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The  name of the query header to in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the  name  of  the query argument to in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This is used only to  indicate  the  web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example JSON:  "SingleQueryArgument":  {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The  name  of  the query argument to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect the request URI  path.  This  is
                                      the  part  of a web request that identi-
                                      fies  a  resource,  for  example,   /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect  the  query  string. This is the
                                      part of a URL that  appears  after  a  ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect  the request body as plain text.
                                      The request body immediately follows the
                                      request  headers.  This is the part of a
                                      request  that  contains  any  additional
                                      data  that  you want to send to your web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect  the HTTP method. The method in-
                                      dicates the type of operation  that  the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect  the  request  body as JSON. The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest that contains any additional  data
                                      that you want to send to your web server
                                      as the HTTP request body, such  as  data
                                      from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text transformations eliminate some of  the
                                   unusual  formatting  that  attackers use in
                                   web requests in an effort to bypass  detec-
                                   tion.  If you specify one or more transfor-
                                   mations in a rule statement,  WAF  performs
                                   all  transformations  on the content of the
                                   request  component  identified  by   Field-
                                   ToMatch , starting from the lowest priority
                                   setting, before inspecting the content  for
                                   a match.

                                   (structure)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets the relative  processing  order
                                          for  multiple  transformations  that
                                          are defined for  a  rule  statement.
                                          WAF  processes  all transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent. The priorities don't  need  to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                            SizeConstraintStatement -> (structure)
                               A  rule  statement  that  compares  a number of
                               bytes against the size of a request  component,
                               using  a  comparison  operator, such as greater
                               than (>) or less than (<). For example, you can
                               use  a  size  constraint  statement to look for
                               query strings that are longer than 100 bytes.

                               If you configure WAF  to  inspect  the  request
                               body, WAF inspects only the first 8192 bytes (8
                               KB). If the request body for your web  requests
                               never exceeds 8192 bytes, you can create a size
                               constraint condition and  block  requests  that
                               have a request body greater than 8192 bytes.

                               If  you choose URI for the value of Part of the
                               request to filter on, the slash (/) in the  URI
                               counts  as  one character. For example, the URI
                               /logo.jpg is nine characters long.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to   inspect.  For  more  information,  see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This  is  used  only to indicate the web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of a web request  that  identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               ComparisonOperator -> (string)
                                   The  operator to use to compare the request
                                   part to the size setting.

                               Size -> (long)
                                   The size, in byte, to compare  to  the  re-
                                   quest part, after any transformations.

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. If you specify one or more  transfor-
                                   mations  in  a rule statement, WAF performs
                                   all transformations on the content  of  the
                                   request   component  identified  by  Field-
                                   ToMatch , starting from the lowest priority
                                   setting,  before inspecting the content for
                                   a match.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations  that
                                          are  defined  for  a rule statement.
                                          WAF processes  all  transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent.  The  priorities don't need to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                            GeoMatchStatement -> (structure)
                               A rule statement used to identify web  requests
                               based on country of origin.

                               CountryCodes -> (list)
                                   An  array  of  two-character country codes,
                                   for example, [ "US", "CN" ] , from the  al-
                                   pha-2 country ISO codes of the ISO 3166 in-
                                   ternational standard.

                                   (string)

                               ForwardedIPConfig -> (structure)
                                   The configuration  for  inspecting  IP  ad-
                                   dresses in an HTTP header that you specify,
                                   instead of using the IP address that's  re-
                                   ported by the web request origin. Commonly,
                                   this is the X-Forwarded-For  (XFF)  header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the request, WAF doesn't apply the  rule
                                      to the web request at all.

                                   HeaderName -> (string)
                                      The  name  of the HTTP header to use for
                                      the IP address. For example, to use  the
                                      X-Forwarded-For  (XFF)  header, set this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The  match  status  to assign to the web
                                      request if the request  doesn't  have  a
                                      valid  IP address in the specified posi-
                                      tion.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      You  can  specify the following fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching  the  rule statement. WAF ap-
                                        plies the rule action to the request.

                                      o NO_MATCH - Treat the  web  request  as
                                        not matching the rule statement.

                            RuleGroupReferenceStatement -> (structure)
                               A rule statement used to run the rules that are
                               defined in a  RuleGroup . To use this, create a
                               rule  group  with  your rules, then provide the
                               ARN of the rule group in this statement.

                               You cannot nest a RuleGroupReferenceStatement ,
                               for  example  for  use inside a NotStatement or
                               OrStatement . You can only  use  a  rule  group
                               reference  statement  at the top level inside a
                               web ACL.

                               ARN -> (string)
                                   The Amazon Resource Name (ARN) of  the  en-
                                   tity.

                               ExcludedRules -> (list)
                                   The  rules  in  the  referenced  rule group
                                   whose actions are set to Count .  When  you
                                   exclude a rule, WAF evaluates it exactly as
                                   it would if the rule  action  setting  were
                                   Count . This is a useful option for testing
                                   the rules in a rule group without modifying
                                   how they handle your web traffic.

                                   (structure)
                                      Specifies  a single rule in a rule group
                                      whose action you  want  to  override  to
                                      Count  .  When  you  exclude a rule, WAF
                                      evaluates it exactly as it would if  the
                                      rule action setting were Count . This is
                                      a useful option for testing the rules in
                                      a  rule group without modifying how they
                                      handle your web traffic.

                                      Name -> (string)
                                          The name of the  rule  whose  action
                                          you want to override to Count .

                            IPSetReferenceStatement -> (structure)
                               A  rule  statement  used to detect web requests
                               coming from particular IP addresses or  address
                               ranges.  To  use  this,  create  an  IPSet that
                               specifies the addresses  you  want  to  detect,
                               then use the ARN of that set in this statement.
                               To create an IP set, see  CreateIPSet .

                               Each IP set rule  statement  references  an  IP
                               set.  You  create and maintain the set indepen-
                               dent of your rules. This allows you to use  the
                               single  set  in multiple rules. When you update
                               the referenced set, WAF  automatically  updates
                               all rules that reference it.

                               ARN -> (string)
                                   The  Amazon  Resource  Name  (ARN)  of  the
                                   IPSet that this statement references.

                               IPSetForwardedIPConfig -> (structure)
                                   The configuration  for  inspecting  IP  ad-
                                   dresses in an HTTP header that you specify,
                                   instead of using the IP address that's  re-
                                   ported by the web request origin. Commonly,
                                   this is the X-Forwarded-For  (XFF)  header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the request, WAF doesn't apply the  rule
                                      to the web request at all.

                                   HeaderName -> (string)
                                      The  name  of the HTTP header to use for
                                      the IP address. For example, to use  the
                                      X-Forwarded-For  (XFF)  header, set this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The  match  status  to assign to the web
                                      request if the request  doesn't  have  a
                                      valid  IP address in the specified posi-
                                      tion.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      You  can  specify the following fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching  the  rule statement. WAF ap-
                                        plies the rule action to the request.

                                      o NO_MATCH - Treat the  web  request  as
                                        not matching the rule statement.

                                   Position -> (string)
                                      The position in the header to search for
                                      the IP address. The header  can  contain
                                      IP  addresses of the original client and
                                      also of proxies. For example, the header
                                      value   could  be  10.1.1.1,  127.0.0.0,
                                      10.10.10.10 where the first  IP  address
                                      identifies  the  original client and the
                                      rest identify proxies that  the  request
                                      went through.

                                      The  options  for  this  setting are the
                                      following:

                                      o FIRST - Inspect the first  IP  address
                                        in  the  list  of  IP addresses in the
                                        header. This is usually  the  client's
                                        original IP.

                                      o LAST  - Inspect the last IP address in
                                        the  list  of  IP  addresses  in   the
                                        header.

                                      o ANY  - Inspect all IP addresses in the
                                        header for a match. If the header con-
                                        tains  more  than 10 IP addresses, WAF
                                        inspects the last 10.

                            RegexPatternSetReferenceStatement -> (structure)
                               A rule statement used  to  search  web  request
                               components  for  matches  with  regular expres-
                               sions. To use this, create  a   RegexPatternSet
                               that specifies the expressions that you want to
                               detect, then use the ARN of that  set  in  this
                               statement.  A  web  request matches the pattern
                               set rule statement  if  the  request  component
                               matches any of the patterns in the set. To cre-
                               ate a regex pattern set,  see   CreateRegexPat-
                               ternSet .

                               Each  regex  pattern  set rule statement refer-
                               ences a regex pattern set. You create and main-
                               tain  the  set  independent of your rules. This
                               allows you to use the single  set  in  multiple
                               rules.  When you update the referenced set, WAF
                               automatically updates all rules that  reference
                               it.

                               ARN -> (string)
                                   The Amazon Resource Name (ARN) of the  Reg-
                                   exPatternSet  that  this  statement  refer-
                                   ences.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to  inspect.  For  more  information,   see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect  a  single  header.  Provide the
                                      name of the header to inspect, for exam-
                                      ple,  User-Agent  or Referer . This set-
                                      ting isn't case sensitive.

                                      Example JSON: "SingleHeader": {  "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The  name of the query header to in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the  name  of  the query argument to in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This is used only to  indicate  the  web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example JSON:  "SingleQueryArgument":  {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The  name  of  the query argument to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect the request URI  path.  This  is
                                      the  part  of a web request that identi-
                                      fies  a  resource,  for  example,   /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect  the  query  string. This is the
                                      part of a URL that  appears  after  a  ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect  the request body as plain text.
                                      The request body immediately follows the
                                      request  headers.  This is the part of a
                                      request  that  contains  any  additional
                                      data  that  you want to send to your web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect  the HTTP method. The method in-
                                      dicates the type of operation  that  the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect  the  request  body as JSON. The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest that contains any additional  data
                                      that you want to send to your web server
                                      as the HTTP request body, such  as  data
                                      from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text transformations eliminate some of  the
                                   unusual  formatting  that  attackers use in
                                   web requests in an effort to bypass  detec-
                                   tion.  If you specify one or more transfor-
                                   mations in a rule statement,  WAF  performs
                                   all  transformations  on the content of the
                                   request  component  identified  by   Field-
                                   ToMatch , starting from the lowest priority
                                   setting, before inspecting the content  for
                                   a match.

                                   (structure)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets the relative  processing  order
                                          for  multiple  transformations  that
                                          are defined for  a  rule  statement.
                                          WAF  processes  all transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent. The priorities don't  need  to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                            RateBasedStatement -> (structure)
                               A  rate-based  rule tracks the rate of requests
                               for each originating IP address,  and  triggers
                               the  rule  action when the rate exceeds a limit
                               that you specify on the number of  requests  in
                               any 5-minute time span. You can use this to put
                               a temporary block on requests from  an  IP  ad-
                               dress that is sending excessive requests.

                               WAF  tracks and manages web requests separately
                               for each instance of a rate-based rule that you
                               use.  For  example,  if  you  provide  the same
                               rate-based rule settings in two web ACLs,  each
                               of  the  two rule statements represents a sepa-
                               rate instance of the rate-based rule  and  gets
                               its  own tracking and management by WAF. If you
                               define a rate-based rule inside a  rule  group,
                               and  then  use  that  rule  group  in  multiple
                               places, each use creates a separate instance of
                               the  rate-based rule that gets its own tracking
                               and management by WAF.

                               When the rule action triggers, WAF blocks addi-
                               tional  requests  from the IP address until the
                               request rate falls below the limit.

                               You can optionally nest another  statement  in-
                               side  the  rate-based  statement, to narrow the
                               scope of the rule so that it  only  counts  re-
                               quests that match the nested statement. For ex-
                               ample, based on recent requests that  you  have
                               seen  from  an  attacker,  you  might  create a
                               rate-based rule with a nested AND  rule  state-
                               ment  that contains the following nested state-
                               ments:

                               o An IP match statement with  an  IP  set  that
                                 specified the address 192.0.2.44.

                               o A string match statement that searches in the
                                 User-Agent header for the string BadBot.

                               In this rate-based rule, you also define a rate
                               limit.  For  this  example,  the  rate limit is
                               1,000. Requests that meet both  of  the  condi-
                               tions  in  the  statements  are counted. If the
                               count exceeds 1,000 requests per five  minutes,
                               the  rule action triggers. Requests that do not
                               meet both conditions are  not  counted  towards
                               the  rate  limit  and  are not affected by this
                               rule.

                               You cannot nest a RateBasedStatement inside an-
                               other statement, for example inside a NotState-
                               ment or OrStatement . You can  define  a  Rate-
                               BasedStatement  inside  a  web ACL and inside a
                               rule group.

                               Limit -> (long)
                                   The limit on requests per  5-minute  period
                                   for a single originating IP address. If the
                                   statement includes a  ScopeDownStatement  ,
                                   this  limit is applied only to the requests
                                   that match the statement.

                               AggregateKeyType -> (string)
                                   Setting that indicates how to aggregate the
                                   request counts. The options are the follow-
                                   ing:

                                   o IP - Aggregate the request counts on  the
                                     IP address from the web request origin.

                                   o FORWARDED_IP   -  Aggregate  the  request
                                     counts on the first IP address in an HTTP
                                     header.  If  you  use this, configure the
                                     ForwardedIPConfig , to specify the header
                                     to use.

                               (   ...  recursive  ...  )ForwardedIPConfig  ->
                               (structure)
                                   The configuration  for  inspecting  IP  ad-
                                   dresses in an HTTP header that you specify,
                                   instead of using the IP address that's  re-
                                   ported by the web request origin. Commonly,
                                   this is the X-Forwarded-For  (XFF)  header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the request, WAF doesn't apply the  rule
                                      to the web request at all.

                                   This is required if AggregateKeyType is set
                                   to FORWARDED_IP .

                                   HeaderName -> (string)
                                      The name of the HTTP header to  use  for
                                      the  IP address. For example, to use the
                                      X-Forwarded-For (XFF) header,  set  this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The match status to assign  to  the  web
                                      request  if  the  request doesn't have a
                                      valid IP address in the specified  posi-
                                      tion.

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                      You can specify the  following  fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching the rule statement.  WAF  ap-
                                        plies the rule action to the request.

                                      o NO_MATCH  -  Treat  the web request as
                                        not matching the rule statement.

                            AndStatement -> (structure)
                               A logical rule statement used to combine  other
                               rule  statements  with  AND  logic. You provide
                               more than one  Statement within  the  AndState-
                               ment .

                               Statements -> (list)
                                   The  statements  to combine with AND logic.
                                   You can use  any  statements  that  can  be
                                   nested.

                                   ( ... recursive ... )

                            OrStatement -> (structure)
                               A  logical rule statement used to combine other
                               rule statements with OR logic. You provide more
                               than one  Statement within the OrStatement .

                               Statements -> (list)
                                   The  statements  to  combine with OR logic.
                                   You can use  any  statements  that  can  be
                                   nested.

                                   ( ... recursive ... )

                            NotStatement -> (structure)
                               A logical rule statement used to negate the re-
                               sults of another rule  statement.  You  provide
                               one  Statement within the NotStatement .

                               ( ... recursive ... )

                            ManagedRuleGroupStatement -> (structure)
                               A rule statement used to run the rules that are
                               defined in a managed rule group. To  use  this,
                               provide  the  vendor  name  and the name of the
                               rule group in this statement. You can  retrieve
                               the  required names by calling  ListAvailableM-
                               anagedRuleGroups .

                               You cannot nest a  ManagedRuleGroupStatement  ,
                               for  example  for  use inside a NotStatement or
                               OrStatement . It can only be  referenced  as  a
                               top-level statement within a rule.

                               VendorName -> (string)
                                   The  name of the managed rule group vendor.
                                   You use this, along  with  the  rule  group
                                   name, to identify the rule group.

                               Name -> (string)
                                   The name of the managed rule group. You use
                                   this, along with the vendor name, to  iden-
                                   tify the rule group.

                               Version -> (string)
                                   The  version  of  the managed rule group to
                                   use. If you specify this, the version  set-
                                   ting  is  fixed until you change it. If you
                                   don't specify this, WAF uses  the  vendor's
                                   default version, and then keeps the version
                                   at the vendor's default when the vendor up-
                                   dates the managed rule group settings.

                               ExcludedRules -> (list)
                                   The  rules  in  the  referenced  rule group
                                   whose actions are set to Count .  When  you
                                   exclude a rule, WAF evaluates it exactly as
                                   it would if the rule  action  setting  were
                                   Count . This is a useful option for testing
                                   the rules in a rule group without modifying
                                   how they handle your web traffic.

                                   (structure)
                                      Specifies  a single rule in a rule group
                                      whose action you  want  to  override  to
                                      Count  .  When  you  exclude a rule, WAF
                                      evaluates it exactly as it would if  the
                                      rule action setting were Count . This is
                                      a useful option for testing the rules in
                                      a  rule group without modifying how they
                                      handle your web traffic.

                                      Name -> (string)
                                          The name of the  rule  whose  action
                                          you want to override to Count .

                               ( ... recursive ... )

                            LabelMatchStatement -> (structure)
                               A  rule  statement  that defines a string match
                               search against labels that have been  added  to
                               the  web request by rules that have already run
                               in the web ACL.

                               The label match statement provides the label or
                               namespace  string  to  search  for.  The  label
                               string can represent a part or all of the fully
                               qualified label name that had been added to the
                               web request. Fully qualified labels have a pre-
                               fix,  optional  namespaces, and label name. The
                               prefix identifies the rule  group  or  web  ACL
                               context  of  the  rule that added the label. If
                               you do not provide the fully qualified name  in
                               your  label  match  string,  WAF  performs  the
                               search for labels that were added in  the  same
                               context as the label match statement.

                               Scope -> (string)
                                   Specify whether you want to match using the
                                   label name or just the namespace.

                               Key -> (string)
                                   The string to match  against.  The  setting
                                   you  provide  for this depends on the match
                                   statement's Scope setting:

                                   o If the Scope indicates LABEL , then  this
                                     specification  must  include the name and
                                     can include any number of preceding name-
                                     space  specifications  and  prefix  up to
                                     providing the fully qualified label name.

                                   o If the Scope indicates NAMESPACE  ,  then
                                     this specification can include any number
                                     of contiguous namespace strings, and  can
                                     include the entire label namespace prefix
                                     from the rule group or web ACL where  the
                                     label originates.

                                   Labels are case sensitive and components of
                                   a label must be separated by colon, for ex-
                                   ample NS1:NS2:name .

                            RegexMatchStatement -> (structure)
                               A  rule  statement  used  to search web request
                               components for a match against a single regular
                               expression.

                               RegexString -> (string)
                                   The string representing the regular expres-
                                   sion.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to   inspect.  For  more  information,  see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This  is  used  only to indicate the web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of a web request  that  identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. If you specify one or more  transfor-
                                   mations  in  a rule statement, WAF performs
                                   all transformations on the content  of  the
                                   request   component  identified  by  Field-
                                   ToMatch , starting from the lowest priority
                                   setting,  before inspecting the content for
                                   a match.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations  that
                                          are  defined  for  a rule statement.
                                          WAF processes  all  transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent.  The  priorities don't need to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                     ManagedRuleGroupStatement -> (structure)
                        A rule statement used to run the rules  that  are  de-
                        fined  in  a  managed rule group. To use this, provide
                        the vendor name and the name of the rule group in this
                        statement.  You  can  retrieve  the  required names by
                        calling  ListAvailableManagedRuleGroups .

                        You cannot nest a ManagedRuleGroupStatement , for  ex-
                        ample  for  use inside a NotStatement or OrStatement .
                        It can only be referenced  as  a  top-level  statement
                        within a rule.

                        VendorName -> (string)
                            The name of the managed rule group vendor. You use
                            this, along with the rule group name, to  identify
                            the rule group.

                        Name -> (string)
                            The  name of the managed rule group. You use this,
                            along with the vendor name, to identify  the  rule
                            group.

                        Version -> (string)
                            The  version  of the managed rule group to use. If
                            you specify this, the version setting is fixed un-
                            til  you change it. If you don't specify this, WAF
                            uses the vendor's default version, and then  keeps
                            the  version at the vendor's default when the ven-
                            dor updates the managed rule group settings.

                        ExcludedRules -> (list)
                            The rules in the referenced rule group  whose  ac-
                            tions  are set to Count . When you exclude a rule,
                            WAF evaluates it exactly as it would if  the  rule
                            action  setting  were Count . This is a useful op-
                            tion for testing the rules in a rule group without
                            modifying how they handle your web traffic.

                            (structure)
                               Specifies  a  single rule in a rule group whose
                               action you want to override to Count . When you
                               exclude  a rule, WAF evaluates it exactly as it
                               would if the rule action setting were  Count  .
                               This  is  a useful option for testing the rules
                               in a rule group without modifying how they han-
                               dle your web traffic.

                               Name -> (string)
                                   The  name of the rule whose action you want
                                   to override to Count .

                        ScopeDownStatement -> (structure)
                            An optional  nested  statement  that  narrows  the
                            scope  of  the  web requests that are evaluated by
                            the managed rule group. Requests are  only  evalu-
                            ated   by   the  rule  group  if  they  match  the
                            scope-down statement. You  can  use  any  nestable
                            Statement in the scope-down statement, and you can
                            nest statements at any level, the same as you  can
                            for a rule statement.

                            ByteMatchStatement -> (structure)
                               A  rule  statement  that defines a string match
                               search for WAF to apply to  web  requests.  The
                               byte  match  statement  provides  the  bytes to
                               search for, the location in requests  that  you
                               want  WAF  to  search,  and other settings. The
                               bytes to search for are typically a string that
                               corresponds  with  ASCII characters. In the WAF
                               console and the developer guide, this  is  ref-
                               ered to as a string match statement.

                               SearchString -> (blob)
                                   A  string value that you want WAF to search
                                   for. WAF searches only in the part  of  web
                                   requests  that you designate for inspection
                                   in  FieldToMatch . The  maximum  length  of
                                   the value is 50 bytes.

                                   Valid  values  depend on the component that
                                   you specify for inspection in  FieldToMatch
                                   :

                                   o Method  :  The  HTTP method that you want
                                     WAF to search  for.  This  indicates  the
                                     type  of  operation  specified in the re-
                                     quest.

                                   o UriPath : The value that you want WAF  to
                                     search  for in the URI path, for example,
                                     /images/daily-ad.jpg .

                                   If SearchString includes alphabetic charac-
                                   ters  A-Z  and  a-z, note that the value is
                                   case sensitive.
                                      If you're using the WAF API

                                   Specify a  base64-encoded  version  of  the
                                   value.  The maximum length of the value be-
                                   fore you base64-encode it is 50 bytes.

                                   For example, suppose the value of  Type  is
                                   HEADER  and the value of Data is User-Agent
                                   . If you  want  to  search  the  User-Agent
                                   header   for   the   value   BadBot  ,  you
                                   base64-encode BadBot using MIME  base64-en-
                                   coding and include the resulting value, Qm-
                                   FkQm90 , in the value of SearchString .
                                      If you're using the CLI or  one  of  the
                                      Amazon Web Services SDKs

                                   The  value that you want WAF to search for.
                                   The SDK automatically  base64  encodes  the
                                   value.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to  inspect.  For  more  information,   see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect  a  single  header.  Provide the
                                      name of the header to inspect, for exam-
                                      ple,  User-Agent  or Referer . This set-
                                      ting isn't case sensitive.

                                      Example JSON: "SingleHeader": {  "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The  name of the query header to in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the  name  of  the query argument to in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This is used only to  indicate  the  web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example JSON:  "SingleQueryArgument":  {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The  name  of  the query argument to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect the request URI  path.  This  is
                                      the  part  of a web request that identi-
                                      fies  a  resource,  for  example,   /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect  the  query  string. This is the
                                      part of a URL that  appears  after  a  ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect  the request body as plain text.
                                      The request body immediately follows the
                                      request  headers.  This is the part of a
                                      request  that  contains  any  additional
                                      data  that  you want to send to your web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect  the HTTP method. The method in-
                                      dicates the type of operation  that  the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect  the  request  body as JSON. The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest that contains any additional  data
                                      that you want to send to your web server
                                      as the HTTP request body, such  as  data
                                      from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text transformations eliminate some of  the
                                   unusual  formatting  that  attackers use in
                                   web requests in an effort to bypass  detec-
                                   tion.  If you specify one or more transfor-
                                   mations in a rule statement,  WAF  performs
                                   all  transformations  on the content of the
                                   request  component  identified  by   Field-
                                   ToMatch , starting from the lowest priority
                                   setting, before inspecting the content  for
                                   a match.

                                   (structure)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets the relative  processing  order
                                          for  multiple  transformations  that
                                          are defined for  a  rule  statement.
                                          WAF  processes  all transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent. The priorities don't  need  to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                               PositionalConstraint -> (string)
                                   The  area  within  the portion of a web re-
                                   quest that  you  want  WAF  to  search  for
                                   SearchString  .  Valid  values  include the
                                   following:
                                      CONTAINS

                                   The specified part of the web request  must
                                   include the value of SearchString , but the
                                   location doesn't matter.
                                      CONTAINS_WORD

                                   The specified part of the web request  must
                                   include  the  value  of  SearchString , and
                                   SearchString must contain only alphanumeric
                                   characters or underscore (A-Z, a-z, 0-9, or
                                   _). In addition,  SearchString  must  be  a
                                   word,  which means that both of the follow-
                                   ing are true:

                                   o SearchString is at the beginning  of  the
                                     specified  part  of the web request or is
                                     preceded by a character other than an al-
                                     phanumeric  character  or underscore (_).
                                     Examples include the value  of  a  header
                                     and ;BadBot .

                                   o SearchString  is at the end of the speci-
                                     fied part of the web request or  is  fol-
                                     lowed  by  a  character other than an al-
                                     phanumeric character or  underscore  (_),
                                     for example, BadBot; and -BadBot; .
                                      EXACTLY

                                   The  value of the specified part of the web
                                   request must exactly  match  the  value  of
                                   SearchString .
                                      STARTS_WITH

                                   The  value  of  SearchString must appear at
                                   the beginning of the specified part of  the
                                   web request.
                                      ENDS_WITH

                                   The  value  of  SearchString must appear at
                                   the end of the specified part  of  the  web
                                   request.

                            SqliMatchStatement -> (structure)
                               Attackers  sometimes  insert malicious SQL code
                               into web requests in an effort to extract  data
                               from  your  database. To allow or block web re-
                               quests that appear  to  contain  malicious  SQL
                               code,  create  one  or more SQL injection match
                               conditions. An SQL  injection  match  condition
                               identifies  the  part  of web requests, such as
                               the URI or the query string, that you want  WAF
                               to inspect. Later in the process, when you cre-
                               ate a web ACL, you specify whether to allow  or
                               block requests that appear to contain malicious
                               SQL code.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to   inspect.  For  more  information,  see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This  is  used  only to indicate the web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of a web request  that  identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. If you specify one or more  transfor-
                                   mations  in  a rule statement, WAF performs
                                   all transformations on the content  of  the
                                   request   component  identified  by  Field-
                                   ToMatch , starting from the lowest priority
                                   setting,  before inspecting the content for
                                   a match.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations  that
                                          are  defined  for  a rule statement.
                                          WAF processes  all  transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent.  The  priorities don't need to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                            XssMatchStatement -> (structure)
                               A rule  statement  that  defines  a  cross-site
                               scripting  (XSS)  match search for WAF to apply
                               to web requests. XSS attacks  are  those  where
                               the  attacker  uses vulnerabilities in a benign
                               website  as  a  vehicle  to  inject   malicious
                               client-site  scripts  into other legitimate web
                               browsers. The XSS match statement provides  the
                               location  in  requests  that  you  want  WAF to
                               search and text transformations to use  on  the
                               search  area  before WAF searches for character
                               sequences  that  are  likely  to  be  malicious
                               strings.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to  inspect.  For  more  information,   see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect  a  single  header.  Provide the
                                      name of the header to inspect, for exam-
                                      ple,  User-Agent  or Referer . This set-
                                      ting isn't case sensitive.

                                      Example JSON: "SingleHeader": {  "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The  name of the query header to in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the  name  of  the query argument to in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This is used only to  indicate  the  web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example JSON:  "SingleQueryArgument":  {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The  name  of  the query argument to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect the request URI  path.  This  is
                                      the  part  of a web request that identi-
                                      fies  a  resource,  for  example,   /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect  the  query  string. This is the
                                      part of a URL that  appears  after  a  ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect  the request body as plain text.
                                      The request body immediately follows the
                                      request  headers.  This is the part of a
                                      request  that  contains  any  additional
                                      data  that  you want to send to your web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect  the HTTP method. The method in-
                                      dicates the type of operation  that  the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect  the  request  body as JSON. The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest that contains any additional  data
                                      that you want to send to your web server
                                      as the HTTP request body, such  as  data
                                      from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text transformations eliminate some of  the
                                   unusual  formatting  that  attackers use in
                                   web requests in an effort to bypass  detec-
                                   tion.  If you specify one or more transfor-
                                   mations in a rule statement,  WAF  performs
                                   all  transformations  on the content of the
                                   request  component  identified  by   Field-
                                   ToMatch , starting from the lowest priority
                                   setting, before inspecting the content  for
                                   a match.

                                   (structure)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets the relative  processing  order
                                          for  multiple  transformations  that
                                          are defined for  a  rule  statement.
                                          WAF  processes  all transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent. The priorities don't  need  to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                            SizeConstraintStatement -> (structure)
                               A  rule  statement  that  compares  a number of
                               bytes against the size of a request  component,
                               using  a  comparison  operator, such as greater
                               than (>) or less than (<). For example, you can
                               use  a  size  constraint  statement to look for
                               query strings that are longer than 100 bytes.

                               If you configure WAF  to  inspect  the  request
                               body, WAF inspects only the first 8192 bytes (8
                               KB). If the request body for your web  requests
                               never exceeds 8192 bytes, you can create a size
                               constraint condition and  block  requests  that
                               have a request body greater than 8192 bytes.

                               If  you choose URI for the value of Part of the
                               request to filter on, the slash (/) in the  URI
                               counts  as  one character. For example, the URI
                               /logo.jpg is nine characters long.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to   inspect.  For  more  information,  see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This  is  used  only to indicate the web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of a web request  that  identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               ComparisonOperator -> (string)
                                   The  operator to use to compare the request
                                   part to the size setting.

                               Size -> (long)
                                   The size, in byte, to compare  to  the  re-
                                   quest part, after any transformations.

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. If you specify one or more  transfor-
                                   mations  in  a rule statement, WAF performs
                                   all transformations on the content  of  the
                                   request   component  identified  by  Field-
                                   ToMatch , starting from the lowest priority
                                   setting,  before inspecting the content for
                                   a match.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations  that
                                          are  defined  for  a rule statement.
                                          WAF processes  all  transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent.  The  priorities don't need to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                            GeoMatchStatement -> (structure)
                               A rule statement used to identify web  requests
                               based on country of origin.

                               CountryCodes -> (list)
                                   An  array  of  two-character country codes,
                                   for example, [ "US", "CN" ] , from the  al-
                                   pha-2 country ISO codes of the ISO 3166 in-
                                   ternational standard.

                                   (string)

                               ForwardedIPConfig -> (structure)
                                   The configuration  for  inspecting  IP  ad-
                                   dresses in an HTTP header that you specify,
                                   instead of using the IP address that's  re-
                                   ported by the web request origin. Commonly,
                                   this is the X-Forwarded-For  (XFF)  header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the request, WAF doesn't apply the  rule
                                      to the web request at all.

                                   HeaderName -> (string)
                                      The  name  of the HTTP header to use for
                                      the IP address. For example, to use  the
                                      X-Forwarded-For  (XFF)  header, set this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The  match  status  to assign to the web
                                      request if the request  doesn't  have  a
                                      valid  IP address in the specified posi-
                                      tion.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      You  can  specify the following fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching  the  rule statement. WAF ap-
                                        plies the rule action to the request.

                                      o NO_MATCH - Treat the  web  request  as
                                        not matching the rule statement.

                            RuleGroupReferenceStatement -> (structure)
                               A rule statement used to run the rules that are
                               defined in a  RuleGroup . To use this, create a
                               rule  group  with  your rules, then provide the
                               ARN of the rule group in this statement.

                               You cannot nest a RuleGroupReferenceStatement ,
                               for  example  for  use inside a NotStatement or
                               OrStatement . You can only  use  a  rule  group
                               reference  statement  at the top level inside a
                               web ACL.

                               ARN -> (string)
                                   The Amazon Resource Name (ARN) of  the  en-
                                   tity.

                               ExcludedRules -> (list)
                                   The  rules  in  the  referenced  rule group
                                   whose actions are set to Count .  When  you
                                   exclude a rule, WAF evaluates it exactly as
                                   it would if the rule  action  setting  were
                                   Count . This is a useful option for testing
                                   the rules in a rule group without modifying
                                   how they handle your web traffic.

                                   (structure)
                                      Specifies  a single rule in a rule group
                                      whose action you  want  to  override  to
                                      Count  .  When  you  exclude a rule, WAF
                                      evaluates it exactly as it would if  the
                                      rule action setting were Count . This is
                                      a useful option for testing the rules in
                                      a  rule group without modifying how they
                                      handle your web traffic.

                                      Name -> (string)
                                          The name of the  rule  whose  action
                                          you want to override to Count .

                            IPSetReferenceStatement -> (structure)
                               A  rule  statement  used to detect web requests
                               coming from particular IP addresses or  address
                               ranges.  To  use  this,  create  an  IPSet that
                               specifies the addresses  you  want  to  detect,
                               then use the ARN of that set in this statement.
                               To create an IP set, see  CreateIPSet .

                               Each IP set rule  statement  references  an  IP
                               set.  You  create and maintain the set indepen-
                               dent of your rules. This allows you to use  the
                               single  set  in multiple rules. When you update
                               the referenced set, WAF  automatically  updates
                               all rules that reference it.

                               ARN -> (string)
                                   The  Amazon  Resource  Name  (ARN)  of  the
                                   IPSet that this statement references.

                               IPSetForwardedIPConfig -> (structure)
                                   The configuration  for  inspecting  IP  ad-
                                   dresses in an HTTP header that you specify,
                                   instead of using the IP address that's  re-
                                   ported by the web request origin. Commonly,
                                   this is the X-Forwarded-For  (XFF)  header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the request, WAF doesn't apply the  rule
                                      to the web request at all.

                                   HeaderName -> (string)
                                      The  name  of the HTTP header to use for
                                      the IP address. For example, to use  the
                                      X-Forwarded-For  (XFF)  header, set this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The  match  status  to assign to the web
                                      request if the request  doesn't  have  a
                                      valid  IP address in the specified posi-
                                      tion.

                                      NOTE:
                                          If  the   specified   header   isn't
                                          present  in the request, WAF doesn't
                                          apply the rule to the web request at
                                          all.

                                      You  can  specify the following fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching  the  rule statement. WAF ap-
                                        plies the rule action to the request.

                                      o NO_MATCH - Treat the  web  request  as
                                        not matching the rule statement.

                                   Position -> (string)
                                      The position in the header to search for
                                      the IP address. The header  can  contain
                                      IP  addresses of the original client and
                                      also of proxies. For example, the header
                                      value   could  be  10.1.1.1,  127.0.0.0,
                                      10.10.10.10 where the first  IP  address
                                      identifies  the  original client and the
                                      rest identify proxies that  the  request
                                      went through.

                                      The  options  for  this  setting are the
                                      following:

                                      o FIRST - Inspect the first  IP  address
                                        in  the  list  of  IP addresses in the
                                        header. This is usually  the  client's
                                        original IP.

                                      o LAST  - Inspect the last IP address in
                                        the  list  of  IP  addresses  in   the
                                        header.

                                      o ANY  - Inspect all IP addresses in the
                                        header for a match. If the header con-
                                        tains  more  than 10 IP addresses, WAF
                                        inspects the last 10.

                            RegexPatternSetReferenceStatement -> (structure)
                               A rule statement used  to  search  web  request
                               components  for  matches  with  regular expres-
                               sions. To use this, create  a   RegexPatternSet
                               that specifies the expressions that you want to
                               detect, then use the ARN of that  set  in  this
                               statement.  A  web  request matches the pattern
                               set rule statement  if  the  request  component
                               matches any of the patterns in the set. To cre-
                               ate a regex pattern set,  see   CreateRegexPat-
                               ternSet .

                               Each  regex  pattern  set rule statement refer-
                               ences a regex pattern set. You create and main-
                               tain  the  set  independent of your rules. This
                               allows you to use the single  set  in  multiple
                               rules.  When you update the referenced set, WAF
                               automatically updates all rules that  reference
                               it.

                               ARN -> (string)
                                   The Amazon Resource Name (ARN) of the  Reg-
                                   exPatternSet  that  this  statement  refer-
                                   ences.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to  inspect.  For  more  information,   see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect  a  single  header.  Provide the
                                      name of the header to inspect, for exam-
                                      ple,  User-Agent  or Referer . This set-
                                      ting isn't case sensitive.

                                      Example JSON: "SingleHeader": {  "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The  name of the query header to in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the  name  of  the query argument to in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This is used only to  indicate  the  web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example JSON:  "SingleQueryArgument":  {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The  name  of  the query argument to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect the request URI  path.  This  is
                                      the  part  of a web request that identi-
                                      fies  a  resource,  for  example,   /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect  the  query  string. This is the
                                      part of a URL that  appears  after  a  ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect  the request body as plain text.
                                      The request body immediately follows the
                                      request  headers.  This is the part of a
                                      request  that  contains  any  additional
                                      data  that  you want to send to your web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect  the HTTP method. The method in-
                                      dicates the type of operation  that  the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect  the  request  body as JSON. The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest that contains any additional  data
                                      that you want to send to your web server
                                      as the HTTP request body, such  as  data
                                      from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text transformations eliminate some of  the
                                   unusual  formatting  that  attackers use in
                                   web requests in an effort to bypass  detec-
                                   tion.  If you specify one or more transfor-
                                   mations in a rule statement,  WAF  performs
                                   all  transformations  on the content of the
                                   request  component  identified  by   Field-
                                   ToMatch , starting from the lowest priority
                                   setting, before inspecting the content  for
                                   a match.

                                   (structure)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets the relative  processing  order
                                          for  multiple  transformations  that
                                          are defined for  a  rule  statement.
                                          WAF  processes  all transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent. The priorities don't  need  to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                            RateBasedStatement -> (structure)
                               A  rate-based  rule tracks the rate of requests
                               for each originating IP address,  and  triggers
                               the  rule  action when the rate exceeds a limit
                               that you specify on the number of  requests  in
                               any 5-minute time span. You can use this to put
                               a temporary block on requests from  an  IP  ad-
                               dress that is sending excessive requests.

                               WAF  tracks and manages web requests separately
                               for each instance of a rate-based rule that you
                               use.  For  example,  if  you  provide  the same
                               rate-based rule settings in two web ACLs,  each
                               of  the  two rule statements represents a sepa-
                               rate instance of the rate-based rule  and  gets
                               its  own tracking and management by WAF. If you
                               define a rate-based rule inside a  rule  group,
                               and  then  use  that  rule  group  in  multiple
                               places, each use creates a separate instance of
                               the  rate-based rule that gets its own tracking
                               and management by WAF.

                               When the rule action triggers, WAF blocks addi-
                               tional  requests  from the IP address until the
                               request rate falls below the limit.

                               You can optionally nest another  statement  in-
                               side  the  rate-based  statement, to narrow the
                               scope of the rule so that it  only  counts  re-
                               quests that match the nested statement. For ex-
                               ample, based on recent requests that  you  have
                               seen  from  an  attacker,  you  might  create a
                               rate-based rule with a nested AND  rule  state-
                               ment  that contains the following nested state-
                               ments:

                               o An IP match statement with  an  IP  set  that
                                 specified the address 192.0.2.44.

                               o A string match statement that searches in the
                                 User-Agent header for the string BadBot.

                               In this rate-based rule, you also define a rate
                               limit.  For  this  example,  the  rate limit is
                               1,000. Requests that meet both  of  the  condi-
                               tions  in  the  statements  are counted. If the
                               count exceeds 1,000 requests per five  minutes,
                               the  rule action triggers. Requests that do not
                               meet both conditions are  not  counted  towards
                               the  rate  limit  and  are not affected by this
                               rule.

                               You cannot nest a RateBasedStatement inside an-
                               other statement, for example inside a NotState-
                               ment or OrStatement . You can  define  a  Rate-
                               BasedStatement  inside  a  web ACL and inside a
                               rule group.

                               Limit -> (long)
                                   The limit on requests per  5-minute  period
                                   for a single originating IP address. If the
                                   statement includes a  ScopeDownStatement  ,
                                   this  limit is applied only to the requests
                                   that match the statement.

                               AggregateKeyType -> (string)
                                   Setting that indicates how to aggregate the
                                   request counts. The options are the follow-
                                   ing:

                                   o IP - Aggregate the request counts on  the
                                     IP address from the web request origin.

                                   o FORWARDED_IP   -  Aggregate  the  request
                                     counts on the first IP address in an HTTP
                                     header.  If  you  use this, configure the
                                     ForwardedIPConfig , to specify the header
                                     to use.

                               (   ...  recursive  ...  )ForwardedIPConfig  ->
                               (structure)
                                   The configuration  for  inspecting  IP  ad-
                                   dresses in an HTTP header that you specify,
                                   instead of using the IP address that's  re-
                                   ported by the web request origin. Commonly,
                                   this is the X-Forwarded-For  (XFF)  header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the request, WAF doesn't apply the  rule
                                      to the web request at all.

                                   This is required if AggregateKeyType is set
                                   to FORWARDED_IP .

                                   HeaderName -> (string)
                                      The name of the HTTP header to  use  for
                                      the  IP address. For example, to use the
                                      X-Forwarded-For (XFF) header,  set  this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The match status to assign  to  the  web
                                      request  if  the  request doesn't have a
                                      valid IP address in the specified  posi-
                                      tion.

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                      You can specify the  following  fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching the rule statement.  WAF  ap-
                                        plies the rule action to the request.

                                      o NO_MATCH  -  Treat  the web request as
                                        not matching the rule statement.

                            AndStatement -> (structure)
                               A logical rule statement used to combine  other
                               rule  statements  with  AND  logic. You provide
                               more than one  Statement within  the  AndState-
                               ment .

                               Statements -> (list)
                                   The  statements  to combine with AND logic.
                                   You can use  any  statements  that  can  be
                                   nested.

                                   ( ... recursive ... )

                            OrStatement -> (structure)
                               A  logical rule statement used to combine other
                               rule statements with OR logic. You provide more
                               than one  Statement within the OrStatement .

                               Statements -> (list)
                                   The  statements  to  combine with OR logic.
                                   You can use  any  statements  that  can  be
                                   nested.

                                   ( ... recursive ... )

                            NotStatement -> (structure)
                               A logical rule statement used to negate the re-
                               sults of another rule  statement.  You  provide
                               one  Statement within the NotStatement .

                               ( ... recursive ... )

                            ManagedRuleGroupStatement -> (structure)
                               A rule statement used to run the rules that are
                               defined in a managed rule group. To  use  this,
                               provide  the  vendor  name  and the name of the
                               rule group in this statement. You can  retrieve
                               the  required names by calling  ListAvailableM-
                               anagedRuleGroups .

                               You cannot nest a  ManagedRuleGroupStatement  ,
                               for  example  for  use inside a NotStatement or
                               OrStatement . It can only be  referenced  as  a
                               top-level statement within a rule.

                               VendorName -> (string)
                                   The  name of the managed rule group vendor.
                                   You use this, along  with  the  rule  group
                                   name, to identify the rule group.

                               Name -> (string)
                                   The name of the managed rule group. You use
                                   this, along with the vendor name, to  iden-
                                   tify the rule group.

                               Version -> (string)
                                   The  version  of  the managed rule group to
                                   use. If you specify this, the version  set-
                                   ting  is  fixed until you change it. If you
                                   don't specify this, WAF uses  the  vendor's
                                   default version, and then keeps the version
                                   at the vendor's default when the vendor up-
                                   dates the managed rule group settings.

                               ExcludedRules -> (list)
                                   The  rules  in  the  referenced  rule group
                                   whose actions are set to Count .  When  you
                                   exclude a rule, WAF evaluates it exactly as
                                   it would if the rule  action  setting  were
                                   Count . This is a useful option for testing
                                   the rules in a rule group without modifying
                                   how they handle your web traffic.

                                   (structure)
                                      Specifies  a single rule in a rule group
                                      whose action you  want  to  override  to
                                      Count  .  When  you  exclude a rule, WAF
                                      evaluates it exactly as it would if  the
                                      rule action setting were Count . This is
                                      a useful option for testing the rules in
                                      a  rule group without modifying how they
                                      handle your web traffic.

                                      Name -> (string)
                                          The name of the  rule  whose  action
                                          you want to override to Count .

                               ( ... recursive ... )

                            LabelMatchStatement -> (structure)
                               A  rule  statement  that defines a string match
                               search against labels that have been  added  to
                               the  web request by rules that have already run
                               in the web ACL.

                               The label match statement provides the label or
                               namespace  string  to  search  for.  The  label
                               string can represent a part or all of the fully
                               qualified label name that had been added to the
                               web request. Fully qualified labels have a pre-
                               fix,  optional  namespaces, and label name. The
                               prefix identifies the rule  group  or  web  ACL
                               context  of  the  rule that added the label. If
                               you do not provide the fully qualified name  in
                               your  label  match  string,  WAF  performs  the
                               search for labels that were added in  the  same
                               context as the label match statement.

                               Scope -> (string)
                                   Specify whether you want to match using the
                                   label name or just the namespace.

                               Key -> (string)
                                   The string to match  against.  The  setting
                                   you  provide  for this depends on the match
                                   statement's Scope setting:

                                   o If the Scope indicates LABEL , then  this
                                     specification  must  include the name and
                                     can include any number of preceding name-
                                     space  specifications  and  prefix  up to
                                     providing the fully qualified label name.

                                   o If the Scope indicates NAMESPACE  ,  then
                                     this specification can include any number
                                     of contiguous namespace strings, and  can
                                     include the entire label namespace prefix
                                     from the rule group or web ACL where  the
                                     label originates.

                                   Labels are case sensitive and components of
                                   a label must be separated by colon, for ex-
                                   ample NS1:NS2:name .

                            RegexMatchStatement -> (structure)
                               A  rule  statement  used  to search web request
                               components for a match against a single regular
                               expression.

                               RegexString -> (string)
                                   The string representing the regular expres-
                                   sion.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to   inspect.  For  more  information,  see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This  is  used  only to indicate the web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of a web request  that  identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. If you specify one or more  transfor-
                                   mations  in  a rule statement, WAF performs
                                   all transformations on the content  of  the
                                   request   component  identified  by  Field-
                                   ToMatch , starting from the lowest priority
                                   setting,  before inspecting the content for
                                   a match.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations  that
                                          are  defined  for  a rule statement.
                                          WAF processes  all  transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent.  The  priorities don't need to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                     LabelMatchStatement -> (structure)
                        A rule statement that defines a  string  match  search
                        against labels that have been added to the web request
                        by rules that have already run in the web ACL.

                        The label match statement provides the label or  name-
                        space  string to search for. The label string can rep-
                        resent a part or all of the fully qualified label name
                        that  had  been added to the web request. Fully quali-
                        fied labels have a prefix,  optional  namespaces,  and
                        label  name.  The  prefix identifies the rule group or
                        web ACL context of the rule that added the  label.  If
                        you  do  not  provide the fully qualified name in your
                        label match string, WAF performs the search for labels
                        that were added in the same context as the label match
                        statement.

                        Scope -> (string)
                            Specify whether you want to match using the  label
                            name or just the namespace.

                        Key -> (string)
                            The  string to match against. The setting you pro-
                            vide for this depends  on  the  match  statement's
                            Scope setting:

                            o If  the Scope indicates LABEL , then this speci-
                              fication must include the name and  can  include
                              any number of preceding namespace specifications
                              and prefix up to providing the  fully  qualified
                              label name.

                            o If  the  Scope  indicates  NAMESPACE , then this
                              specification can include any number of contigu-
                              ous  namespace  strings, and can include the en-
                              tire label namespace prefix from the rule  group
                              or web ACL where the label originates.

                            Labels  are case sensitive and components of a la-
                            bel  must  be  separated  by  colon,  for  example
                            NS1:NS2:name .

                     RegexMatchStatement -> (structure)
                        A rule statement used to search web request components
                        for a match against a single regular expression.

                        RegexString -> (string)
                            The string representing the regular expression.

                        FieldToMatch -> (structure)
                            The part of a web request that you want WAF to in-
                            spect. For more information, see  FieldToMatch .

                            SingleHeader -> (structure)
                               Inspect  a  single  header. Provide the name of
                               the header to inspect, for example,  User-Agent
                               or Referer . This setting isn't case sensitive.

                               Example   JSON:   "SingleHeader":   {   "Name":
                               "haystack" }

                               Name -> (string)
                                   The name of the query header to inspect.

                            SingleQueryArgument -> (structure)
                               Inspect a single query  argument.  Provide  the
                               name  of the query argument to inspect, such as
                               UserName or SalesRegion . The name can be up to
                               30 characters long and isn't case sensitive.

                               This  is  used only to indicate the web request
                               component for WAF to inspect,  in  the   Field-
                               ToMatch specification.

                               Example  JSON: "SingleQueryArgument": { "Name":
                               "myArgument" }

                               Name -> (string)
                                   The name of the query argument to inspect.

                            AllQueryArguments -> (structure)
                               Inspect all query arguments.

                            UriPath -> (structure)
                               Inspect the request URI path. This is the  part
                               of  a  web  request that identifies a resource,
                               for example, /images/daily-ad.jpg .

                            QueryString -> (structure)
                               Inspect the query string. This is the part of a
                               URL that appears after a ? character, if any.

                            Body -> (structure)
                               Inspect the request body as plain text. The re-
                               quest  body  immediately  follows  the  request
                               headers.  This  is  the  part of a request that
                               contains any additional data that you  want  to
                               send  to  your  web  server as the HTTP request
                               body, such as data from a form.

                               Note that only the first 8 KB (8192  bytes)  of
                               the  request  body are forwarded to WAF for in-
                               spection by the underlying host service. If you
                               don't  need  to inspect more than 8 KB, you can
                               guarantee that you don't allow additional bytes
                               in  by  combining a statement that inspects the
                               body of the web request,  such  as   ByteMatch-
                               Statement or  RegexPatternSetReferenceStatement
                               , with a  SizeConstraintStatement that enforces
                               an  8 KB size limit on the body of the request.
                               WAF doesn't support inspecting the entire  con-
                               tents of web requests whose bodies exceed the 8
                               KB limit.

                            Method -> (structure)
                               Inspect the HTTP method. The  method  indicates
                               the  type of operation that the request is ask-
                               ing the origin to perform.

                            JsonBody -> (structure)
                               Inspect the request body as JSON.  The  request
                               body  immediately  follows the request headers.
                               This is the part of a request that contains any
                               additional  data  that you want to send to your
                               web server as the HTTP request  body,  such  as
                               data from a form.

                               Note  that  only the first 8 KB (8192 bytes) of
                               the request body are forwarded to WAF  for  in-
                               spection by the underlying host service. If you
                               don't need to inspect more than 8 KB,  you  can
                               guarantee that you don't allow additional bytes
                               in by combining a statement that  inspects  the
                               body  of  the  web request, such as  ByteMatch-
                               Statement or  RegexPatternSetReferenceStatement
                               , with a  SizeConstraintStatement that enforces
                               an 8 KB size limit on the body of the  request.
                               WAF  doesn't support inspecting the entire con-
                               tents of web requests whose bodies exceed the 8
                               KB limit.

                               MatchPattern -> (structure)
                                   The  patterns to look for in the JSON body.
                                   WAF inspects the results of  these  pattern
                                   matches  against the rule inspection crite-
                                   ria.

                                   All -> (structure)
                                      Match all  of  the  elements.  See  also
                                      MatchScope in  JsonBody .

                                      You  must specify either this setting or
                                      the IncludedPaths setting, but not both.

                                   IncludedPaths -> (list)
                                      Match only the specified include  paths.
                                      See also MatchScope in  JsonBody .

                                      Provide  the  include  paths  using JSON
                                      Pointer syntax. For example,  "Included-
                                      Paths": ["/dogs/0/name", "/dogs/1/name"]
                                      . For information about this syntax, see
                                      the   Internet  Engineering  Task  Force
                                      (IETF) documentation  JavaScript  Object
                                      Notation (JSON) Pointer .

                                      You  must specify either this setting or
                                      the All setting, but not both.

                                      NOTE:
                                          Don't use this option to include all
                                          paths. Instead, use the All setting.

                                      (string)

                               MatchScope -> (string)
                                   The  parts of the JSON to match against us-
                                   ing the MatchPattern . If you specify All ,
                                   WAF matches against keys and values.

                               InvalidFallbackBehavior -> (string)
                                   What  WAF  should  do  if  it fails to com-
                                   pletely parse the JSON  body.  The  options
                                   are the following:

                                   o EVALUATE_AS_STRING  - Inspect the body as
                                     plain text. WAF applies the  text  trans-
                                     formations  and  inspection criteria that
                                     you defined for the  JSON  inspection  to
                                     the body text string.

                                   o MATCH - Treat the web request as matching
                                     the rule statement. WAF applies the  rule
                                     action to the request.

                                   o NO_MATCH  -  Treat the web request as not
                                     matching the rule statement.

                                   If you  don't  provide  this  setting,  WAF
                                   parses and evaluates the content only up to
                                   the first parsing failure that  it  encoun-
                                   ters.

                                   WAF  does its best to parse the entire JSON
                                   body, but might be forced to stop for  rea-
                                   sons  such as invalid characters, duplicate
                                   keys, truncation,  and  any  content  whose
                                   root node isn't an object or an array.

                                   WAF  parses the JSON in the following exam-
                                   ples as two valid key, value pairs:

                                   o Missing                            comma:
                                     {"key1":"value1""key2":"value2"}

                                   o Missing                            colon:
                                     {"key1":"value1","key2""value2"}

                                   o Extra                             colons:
                                     {"key1"::"value1","key2""value2"}

                        TextTransformations -> (list)
                            Text transformations eliminate some of the unusual
                            formatting that attackers use in web  requests  in
                            an  effort to bypass detection. If you specify one
                            or more transformations in a rule  statement,  WAF
                            performs all transformations on the content of the
                            request component  identified  by  FieldToMatch  ,
                            starting  from the lowest priority setting, before
                            inspecting the content for a match.

                            (structure)
                               Text transformations eliminate some of the  un-
                               usual  formatting that attackers use in web re-
                               quests in an effort to bypass detection.

                               Priority -> (integer)
                                   Sets the relative processing order for mul-
                                   tiple  transformations that are defined for
                                   a rule statement. WAF processes all  trans-
                                   formations,  from  lowest priority to high-
                                   est, before inspecting the transformed con-
                                   tent.  The priorities don't need to be con-
                                   secutive, but they must all be different.

                               Type -> (string)
                                   You can specify the  following  transforma-
                                   tion types:
                                      BASE64_DECODE - Decode a Base64 -encoded
                                      string.

                                      BASE64_DECODE_EXT - Decode a Base64 -en-
                                      coded string, but use a forgiving imple-
                                      mentation that ignores  characters  that
                                      aren't valid.

                                      CMD_LINE - Command-line transformations.
                                      These are helpful in reducing effective-
                                      ness  of attackers who inject an operat-
                                      ing system command-line command and  use
                                      unusual  formatting  to disguise some or
                                      all of the command.

                                   o Delete the following characters: \ " ' ^

                                   o Delete spaces before the following  char-
                                     acters: / (

                                   o Replace  the  following characters with a
                                     space: , ;

                                   o Replace multiple spaces with one space

                                   o Convert uppercase letters (A-Z) to lower-
                                     case (a-z)
                                      COMPRESS_WHITE_SPACE   -  Replace  these
                                      characters with a space character (deci-
                                      mal 32):

                                   o \f , formfeed, decimal 12

                                   o \t , tab, decimal 9

                                   o \n , newline, decimal 10

                                   o \r , carriage return, decimal 13

                                   o \v , vertical tab, decimal 11

                                   o Non-breaking space, decimal 160
                                      COMPRESS_WHITE_SPACE  also replaces mul-
                                      tiple spaces with one space.

                                      CSS_DECODE - Decode characters that were
                                      encoded  using CSS 2.x escape rules syn-
                                      data.html#characters  .  This   function
                                      uses  up  to  two  bytes in the decoding
                                      process, so it can help to uncover ASCII
                                      characters  that  were encoded using CSS
                                      encoding that wouldnt typically  be  en-
                                      coded.  It's  also  useful in countering
                                      evasion, which is  a  combination  of  a
                                      backslash  and  non-hexadecimal  charac-
                                      ters. For example, ja\vascript for java-
                                      script.

                                      ESCAPE_SEQ_DECODE - Decode the following
                                      ANSI C escape sequences: \a , \b , \f  ,
                                      \n  , \r , \t , \v , \\ , \? , \' , \" ,
                                      \xHH (hexadecimal), \0OOO  (octal).  En-
                                      codings  that aren't valid remain in the
                                      output.

                                      HEX_DECODE - Decode a string of hexadec-
                                      imal characters into a binary.

                                      HTML_ENTITY_DECODE  -  Replace  HTML-en-
                                      coded characters with unencoded  charac-
                                      ters.  HTML_ENTITY_DECODE performs these
                                      operations:

                                   o Replaces (ampersand)quot; with "

                                   o Replaces    (ampersand)nbsp;    with    a
                                     non-breaking space, decimal 160

                                   o Replaces   (ampersand)lt;  with  a  "less
                                     than" symbol

                                   o Replaces (ampersand)gt; with >

                                   o Replaces characters that are  represented
                                     in hexadecimal format, (ampersand)#xhhhh;
                                     , with the corresponding characters

                                   o Replaces characters that are  represented
                                     in  decimal  format,  (ampersand)#nnnn; ,
                                     with the corresponding characters
                                      JS_DECODE - Decode JavaScript escape se-
                                      quences.  If a \  u  HHHH code is in the
                                      full-width ASCII code range of FF01-FF5E
                                      , then the higher byte is used to detect
                                      and adjust the lower byte. If not,  only
                                      the  lower  byte  is used and the higher
                                      byte is zeroed, causing a possible  loss
                                      of information.

                                      LOWERCASE  -  Convert  uppercase letters
                                      (A-Z) to lowercase (a-z).

                                      MD5 - Calculate an  MD5  hash  from  the
                                      data  in the input. The computed hash is
                                      in a raw binary form.

                                      NONE - Specify NONE if  you  don't  want
                                      any text transformations.

                                      NORMALIZE_PATH    -    Remove   multiple
                                      slashes, directory self-references,  and
                                      directory  back-references  that are not
                                      at the beginning of the  input  from  an
                                      input string.

                                      NORMALIZE_PATH_WIN - This is the same as
                                      NORMALIZE_PATH  ,  but  first   converts
                                      backslash characters to forward slashes.

                                      REMOVE_NULLS  -  Remove  all  NULL bytes
                                      from the input.

                                      REPLACE_COMMENTS - Replace  each  occur-
                                      rence  of a C-style comment (/* ... */ )
                                      with a single space.  Multiple  consecu-
                                      tive occurrences are not compressed. Un-
                                      terminated comments  are  also  replaced
                                      with  a  space  (ASCII 0x20). However, a
                                      standalone termination of a comment  (*/
                                      ) is not acted upon.

                                      REPLACE_NULLS  -  Replace  NULL bytes in
                                      the input with space  characters  (ASCII
                                      0x20 ).

                                      SQL_HEX_DECODE  -  Decode  SQL hex data.
                                      Example (0x414243 ) will be  decoded  to
                                      (ABC ).

                                      URL_DECODE - Decode a URL-encoded value.

                                      URL_DECODE_UNI  -  Like URL_DECODE , but
                                      with support for  Microsoft-specific  %u
                                      encoding.   If   the   code  is  in  the
                                      full-width ASCII code range of FF01-FF5E
                                      ,  the higher byte is used to detect and
                                      adjust the lower byte.  Otherwise,  only
                                      the  lower  byte  is used and the higher
                                      byte is zeroed.

                                      UTF8_TO_UNICODE  -  Convert  all   UTF-8
                                      character  sequences  to  Unicode.  This
                                      helps input normalization, and  minimiz-
                                      ing  false-positives and false-negatives
                                      for non-English languages.

                 Action -> (structure)
                     The action that WAF should take on a web request when  it
                     matches the rule statement. Settings at the web ACL level
                     can override the rule action setting.

                     This is used only for rules whose statements do not  ref-
                     erence  a  rule  group.  Rule statements that reference a
                     rule group include RuleGroupReferenceStatement  and  Man-
                     agedRuleGroupStatement .

                     You  must  specify either this Action setting or the rule
                     OverrideAction setting, but not both:

                     o If the rule statement does not reference a rule  group,
                       use  this rule action setting and not the rule override
                       action setting.

                     o If the rule statement references a rule group, use  the
                       override action setting and not this action setting.

                     Block -> (structure)
                        Instructs WAF to block the web request.

                        CustomResponse -> (structure)
                            Defines a custom response for the web request.

                            For information about customizing web requests and
                            responses, see Customizing web  requests  and  re-
                            sponses in WAF in the WAF Developer Guide .

                            ResponseCode -> (integer)
                               The HTTP status code to return to the client.

                               For  a list of status codes that you can use in
                               your custom  reqponses,  see  Supported  status
                               codes  for custom response in the WAF Developer
                               Guide .

                            CustomResponseBodyKey -> (string)
                               References the response body that you want  WAF
                               to  return  to  the web request client. You can
                               define a custom response for a rule action or a
                               default web ACL action that is set to block. To
                               do this, you first define the response body key
                               and  value  in the CustomResponseBodies setting
                               for the  WebACL or  RuleGroup where you want to
                               use it. Then, in the rule action or web ACL de-
                               fault action BlockAction setting, you reference
                               the response body using this key.

                            ResponseHeaders -> (list)
                               The HTTP headers to use in the response. Dupli-
                               cate header names are not allowed.

                               For information about the limits on  count  and
                               size  for custom request and response settings,
                               see WAF quotas in the WAF Developer Guide .

                               (structure)
                                   A custom header for custom request and  re-
                                   sponse handling. This is used in  CustomRe-
                                   sponse and  CustomRequestHandling .

                                   Name -> (string)
                                      The name of the custom header.

                                      For  custom  request  header  insertion,
                                      when WAF inserts the header into the re-
                                      quest, it prefixes this name x-amzn-waf-
                                      ,  to  avoid  confusion with the headers
                                      that are already in the request. For ex-
                                      ample,  for the header name sample , WAF
                                      inserts the header x-amzn-waf-sample .

                                   Value -> (string)
                                      The value of the custom header.

                     Allow -> (structure)
                        Instructs WAF to allow the web request.

                        CustomRequestHandling -> (structure)
                            Defines custom handling for the web request.

                            For information about customizing web requests and
                            responses,  see  Customizing  web requests and re-
                            sponses in WAF in the WAF Developer Guide .

                            InsertHeaders -> (list)
                               The HTTP headers to insert  into  the  request.
                               Duplicate header names are not allowed.

                               For  information  about the limits on count and
                               size for custom request and response  settings,
                               see WAF quotas in the WAF Developer Guide .

                               (structure)
                                   A  custom header for custom request and re-
                                   sponse handling. This is used in  CustomRe-
                                   sponse and  CustomRequestHandling .

                                   Name -> (string)
                                      The name of the custom header.

                                      For  custom  request  header  insertion,
                                      when WAF inserts the header into the re-
                                      quest, it prefixes this name x-amzn-waf-
                                      , to avoid confusion  with  the  headers
                                      that are already in the request. For ex-
                                      ample, for the header name sample ,  WAF
                                      inserts the header x-amzn-waf-sample .

                                   Value -> (string)
                                      The value of the custom header.

                     Count -> (structure)
                        Instructs WAF to count the web request and allow it.

                        CustomRequestHandling -> (structure)
                            Defines custom handling for the web request.

                            For information about customizing web requests and
                            responses, see Customizing web  requests  and  re-
                            sponses in WAF in the WAF Developer Guide .

                            InsertHeaders -> (list)
                               The  HTTP  headers  to insert into the request.
                               Duplicate header names are not allowed.

                               For information about the limits on  count  and
                               size  for custom request and response settings,
                               see WAF quotas in the WAF Developer Guide .

                               (structure)
                                   A custom header for custom request and  re-
                                   sponse handling. This is used in  CustomRe-
                                   sponse and  CustomRequestHandling .

                                   Name -> (string)
                                      The name of the custom header.

                                      For  custom  request  header  insertion,
                                      when WAF inserts the header into the re-
                                      quest, it prefixes this name x-amzn-waf-
                                      ,  to  avoid  confusion with the headers
                                      that are already in the request. For ex-
                                      ample,  for the header name sample , WAF
                                      inserts the header x-amzn-waf-sample .

                                   Value -> (string)
                                      The value of the custom header.

                     Captcha -> (structure)
                        Instructs WAF to run a CAPTCHA check against  the  web
                        request.

                        CustomRequestHandling -> (structure)
                            Defines custom handling for the web request.

                            For information about customizing web requests and
                            responses, see Customizing web  requests  and  re-
                            sponses in WAF in the WAF Developer Guide .

                            InsertHeaders -> (list)
                               The  HTTP  headers  to insert into the request.
                               Duplicate header names are not allowed.

                               For information about the limits on  count  and
                               size  for custom request and response settings,
                               see WAF quotas in the WAF Developer Guide .

                               (structure)
                                   A custom header for custom request and  re-
                                   sponse handling. This is used in  CustomRe-
                                   sponse and  CustomRequestHandling .

                                   Name -> (string)
                                      The name of the custom header.

                                      For  custom  request  header  insertion,
                                      when WAF inserts the header into the re-
                                      quest, it prefixes this name x-amzn-waf-
                                      ,  to  avoid  confusion with the headers
                                      that are already in the request. For ex-
                                      ample,  for the header name sample , WAF
                                      inserts the header x-amzn-waf-sample .

                                   Value -> (string)
                                      The value of the custom header.

                 OverrideAction -> (structure)
                     The action to use in the place of the action that results
                     from  the  rule group evaluation. Set the override action
                     to none to leave the result of the rule group alone.  Set
                     it to count to override the result to count only.

                     You  can only use this for rule statements that reference
                     a rule group, like RuleGroupReferenceStatement  and  Man-
                     agedRuleGroupStatement .

                     NOTE:
                        This option is usually set to none. It does not affect
                        how the rules in the rule group are evaluated. If  you
                        want  the  rules  in  the  rule  group  to  only count
                        matches, do not use this  and  instead  exclude  those
                        rules in your rule group reference statement settings.

                     Count -> (structure)
                        Override  the  rule  group  evaluation result to count
                        only.

                        NOTE:
                            This option is usually set to none.  It  does  not
                            affect  how the rules in the rule group are evalu-
                            ated. If you want the rules in the rule  group  to
                            only  count  matches,  do not use this and instead
                            exclude those rules in your rule  group  reference
                            statement settings.

                        CustomRequestHandling -> (structure)
                            Defines custom handling for the web request.

                            For information about customizing web requests and
                            responses, see Customizing web  requests  and  re-
                            sponses in WAF in the WAF Developer Guide .

                            InsertHeaders -> (list)
                               The  HTTP  headers  to insert into the request.
                               Duplicate header names are not allowed.

                               For information about the limits on  count  and
                               size  for custom request and response settings,
                               see WAF quotas in the WAF Developer Guide .

                               (structure)
                                   A custom header for custom request and  re-
                                   sponse handling. This is used in  CustomRe-
                                   sponse and  CustomRequestHandling .

                                   Name -> (string)
                                      The name of the custom header.

                                      For  custom  request  header  insertion,
                                      when WAF inserts the header into the re-
                                      quest, it prefixes this name x-amzn-waf-
                                      ,  to  avoid  confusion with the headers
                                      that are already in the request. For ex-
                                      ample,  for the header name sample , WAF
                                      inserts the header x-amzn-waf-sample .

                                   Value -> (string)
                                      The value of the custom header.

                     None -> (structure)
                        Don't override the rule group evaluation result.  This
                        is the most common setting.

                 RuleLabels -> (list)
                     Labels to apply to web requests that match the rule match
                     statement. WAF applies fully qualified labels to matching
                     web  requests.  A fully qualified label is the concatena-
                     tion of a label namespace and a rule  label.  The  rule's
                     rule group or web ACL defines the label namespace.

                     Rules  that  run after this rule in the web ACL can match
                     against these labels using a LabelMatchStatement .

                     For each label, provide a case-sensitive string  contain-
                     ing  optional  namespaces  and a label name, according to
                     the following guidelines:

                     o Separate each component of the label with a colon.

                     o Each namespace or name can have up to 128 characters.

                     o You can specify up to 5 namespaces in a label.

                     o Don't use the following reserved words  in  your  label
                       specification: aws , waf , managed , rulegroup , webacl
                       , regexpatternset , or ipset .

                     For example, myLabelName  or  nameSpace1:nameSpace2:myLa-
                     belName .

                     (structure)
                        A  single  label container. This is used as an element
                        of a label array in multiple contexts, for example, in
                        RuleLabels inside a  Rule and in Labels inside a  Sam-
                        pledHTTPRequest .

                        Name -> (string)
                            The label string.

                 VisibilityConfig -> (structure)
                     Defines and enables Amazon CloudWatch metrics and web re-
                     quest sample collection.

                     SampledRequestsEnabled -> (boolean)
                        A  boolean  indicating whether WAF should store a sam-
                        pling of the web requests that match  the  rules.  You
                        can view the sampled requests through the WAF console.

                     CloudWatchMetricsEnabled -> (boolean)
                        A  boolean  indicating whether the associated resource
                        sends metrics to Amazon CloudWatch. For  the  list  of
                        available metrics, see WAF Metrics .

                     MetricName -> (string)
                        A  name  of the Amazon CloudWatch metric. The name can
                        contain only the characters: A-Z,  a-z,  0-9,  -  (hy-
                        phen), and _ (underscore). The name can be from one to
                        128 characters long. It can't  contain  whitespace  or
                        metric  names  reserved for WAF, for example "All" and
                        "Default_Action."

                 CaptchaConfig -> (structure)
                     Specifies how WAF should handle CAPTCHA  evaluations.  If
                     you  don't  specify this, WAF uses the CAPTCHA configura-
                     tion that's defined for the web ACL.

                     ImmunityTimeProperty -> (structure)
                        Determines how long a CAPTCHA token remains valid  af-
                        ter the client successfully solves a CAPTCHA puzzle.

                        ImmunityTime -> (long)
                            The amount of time, in seconds, that a CAPTCHA to-
                            ken is valid. The default setting is 300.

          VisibilityConfig -> (structure)
              Defines and enables Amazon CloudWatch metrics  and  web  request
              sample collection.

              SampledRequestsEnabled -> (boolean)
                 A  boolean  indicating whether WAF should store a sampling of
                 the web requests that match the rules. You can view the  sam-
                 pled requests through the WAF console.

              CloudWatchMetricsEnabled -> (boolean)
                 A  boolean  indicating  whether the associated resource sends
                 metrics to Amazon CloudWatch. For the list of available  met-
                 rics, see WAF Metrics .

              MetricName -> (string)
                 A  name of the Amazon CloudWatch metric. The name can contain
                 only the characters: A-Z, a-z, 0-9, - (hyphen), and _ (under-
                 score).  The  name can be from one to 128 characters long. It
                 can't contain whitespace or metric names  reserved  for  WAF,
                 for example "All" and "Default_Action."

          Capacity -> (long)
              The  web  ACL capacity units (WCUs) currently being used by this
              web ACL.

              WAF uses WCUs to calculate and control the  operating  resources
              that  are used to run your rules, rule groups, and web ACLs. WAF
              calculates capacity differently for each rule type,  to  reflect
              the relative cost of each rule. Simple rules that cost little to
              run use fewer WCUs than more complex rules that  use  more  pro-
              cessing  power.  Rule group capacity is fixed at creation, which
              helps users plan their web ACL WCU usage when they  use  a  rule
              group. The WCU limit for web ACLs is 1,500.

          PreProcessFirewallManagerRuleGroups -> (list)
              The  first  set of rules for WAF to process in the web ACL. This
              is defined in an Firewall Manager WAF policy and  contains  only
              rule group references. You can't alter these. Any rules and rule
              groups that you define for the web  ACL  are  prioritized  after
              these.

              In  the Firewall Manager WAF policy, the Firewall Manager admin-
              istrator can define a set of rule groups to run first in the web
              ACL  and  a set of rule groups to run last. Within each set, the
              administrator prioritizes the rule groups,  to  determine  their
              relative processing order.

              (structure)
                 A  rule group that's defined for an Firewall Manager WAF pol-
                 icy.

                 Name -> (string)
                     The name of the rule group. You cannot change the name of
                     a rule group after you create it.

                 Priority -> (integer)
                     If  you  define  more than one rule group in the first or
                     last Firewall Manager rule groups, WAF evaluates each re-
                     quest against the rule groups in order, starting from the
                     lowest priority setting. The priorities don't need to  be
                     consecutive, but they must all be different.

                 FirewallManagerStatement -> (structure)
                     The  processing  guidance  for  an Firewall Manager rule.
                     This is like a regular rule  Statement , but it can  only
                     contain a rule group reference.

                     ManagedRuleGroupStatement -> (structure)
                        A  rule  statement  used to run the rules that are de-
                        fined in a managed rule group. To  use  this,  provide
                        the vendor name and the name of the rule group in this
                        statement. You can  retrieve  the  required  names  by
                        calling  ListAvailableManagedRuleGroups .

                        You  cannot nest a ManagedRuleGroupStatement , for ex-
                        ample for use inside a NotStatement or  OrStatement  .
                        It  can  only  be  referenced as a top-level statement
                        within a rule.

                        VendorName -> (string)
                            The name of the managed rule group vendor. You use
                            this,  along with the rule group name, to identify
                            the rule group.

                        Name -> (string)
                            The name of the managed rule group. You use  this,
                            along  with  the vendor name, to identify the rule
                            group.

                        Version -> (string)
                            The version of the managed rule group to  use.  If
                            you specify this, the version setting is fixed un-
                            til you change it. If you don't specify this,  WAF
                            uses  the vendor's default version, and then keeps
                            the version at the vendor's default when the  ven-
                            dor updates the managed rule group settings.

                        ExcludedRules -> (list)
                            The  rules  in the referenced rule group whose ac-
                            tions are set to Count . When you exclude a  rule,
                            WAF  evaluates  it exactly as it would if the rule
                            action setting were Count . This is a  useful  op-
                            tion for testing the rules in a rule group without
                            modifying how they handle your web traffic.

                            (structure)
                               Specifies a single rule in a rule  group  whose
                               action you want to override to Count . When you
                               exclude a rule, WAF evaluates it exactly as  it
                               would  if  the rule action setting were Count .
                               This is a useful option for testing  the  rules
                               in a rule group without modifying how they han-
                               dle your web traffic.

                               Name -> (string)
                                   The name of the rule whose action you  want
                                   to override to Count .

                        ScopeDownStatement -> (structure)
                            An  optional  nested  statement  that  narrows the
                            scope of the web requests that  are  evaluated  by
                            the  managed  rule group. Requests are only evalu-
                            ated  by  the  rule  group  if  they   match   the
                            scope-down  statement.  You  can  use any nestable
                            Statement in the scope-down statement, and you can
                            nest  statements at any level, the same as you can
                            for a rule statement.

                            ByteMatchStatement -> (structure)
                               A rule statement that defines  a  string  match
                               search  for  WAF  to apply to web requests. The
                               byte match  statement  provides  the  bytes  to
                               search  for,  the location in requests that you
                               want WAF to search,  and  other  settings.  The
                               bytes to search for are typically a string that
                               corresponds with ASCII characters. In  the  WAF
                               console  and  the developer guide, this is ref-
                               ered to as a string match statement.

                               SearchString -> (blob)
                                   A string value that you want WAF to  search
                                   for.  WAF  searches only in the part of web
                                   requests that you designate for  inspection
                                   in   FieldToMatch  .  The maximum length of
                                   the value is 50 bytes.

                                   Valid values depend on the  component  that
                                   you  specify for inspection in FieldToMatch
                                   :

                                   o Method : The HTTP method  that  you  want
                                     WAF  to  search  for.  This indicates the
                                     type of operation specified  in  the  re-
                                     quest.

                                   o UriPath  : The value that you want WAF to
                                     search for in the URI path, for  example,
                                     /images/daily-ad.jpg .

                                   If SearchString includes alphabetic charac-
                                   ters A-Z and a-z, note that  the  value  is
                                   case sensitive.
                                      If you're using the WAF API

                                   Specify  a  base64-encoded  version  of the
                                   value. The maximum length of the value  be-
                                   fore you base64-encode it is 50 bytes.

                                   For  example,  suppose the value of Type is
                                   HEADER and the value of Data is  User-Agent
                                   .  If  you  want  to  search the User-Agent
                                   header  for  the   value   BadBot   ,   you
                                   base64-encode  BadBot using MIME base64-en-
                                   coding and include the resulting value, Qm-
                                   FkQm90 , in the value of SearchString .
                                      If  you're  using  the CLI or one of the
                                      Amazon Web Services SDKs

                                   The value that you want WAF to search  for.
                                   The  SDK  automatically  base64 encodes the
                                   value.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to   inspect.  For  more  information,  see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This  is  used  only to indicate the web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of a web request  that  identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. If you specify one or more  transfor-
                                   mations  in  a rule statement, WAF performs
                                   all transformations on the content  of  the
                                   request   component  identified  by  Field-
                                   ToMatch , starting from the lowest priority
                                   setting,  before inspecting the content for
                                   a match.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations  that
                                          are  defined  for  a rule statement.
                                          WAF processes  all  transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent.  The  priorities don't need to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                               PositionalConstraint -> (string)
                                   The area within the portion of  a  web  re-
                                   quest  that  you  want  WAF  to  search for
                                   SearchString .  Valid  values  include  the
                                   following:
                                      CONTAINS

                                   The  specified part of the web request must
                                   include the value of SearchString , but the
                                   location doesn't matter.
                                      CONTAINS_WORD

                                   The  specified part of the web request must
                                   include the value  of  SearchString  ,  and
                                   SearchString must contain only alphanumeric
                                   characters or underscore (A-Z, a-z, 0-9, or
                                   _).  In  addition,  SearchString  must be a
                                   word, which means that both of the  follow-
                                   ing are true:

                                   o SearchString  is  at the beginning of the
                                     specified part of the web request  or  is
                                     preceded by a character other than an al-
                                     phanumeric character or  underscore  (_).
                                     Examples  include  the  value of a header
                                     and ;BadBot .

                                   o SearchString is at the end of the  speci-
                                     fied  part  of the web request or is fol-
                                     lowed by a character other  than  an  al-
                                     phanumeric  character  or underscore (_),
                                     for example, BadBot; and -BadBot; .
                                      EXACTLY

                                   The value of the specified part of the  web
                                   request  must  exactly  match  the value of
                                   SearchString .
                                      STARTS_WITH

                                   The value of SearchString  must  appear  at
                                   the  beginning of the specified part of the
                                   web request.
                                      ENDS_WITH

                                   The value of SearchString  must  appear  at
                                   the  end  of  the specified part of the web
                                   request.

                            SqliMatchStatement -> (structure)
                               Attackers sometimes insert malicious  SQL  code
                               into  web requests in an effort to extract data
                               from your database. To allow or block  web  re-
                               quests  that  appear  to  contain malicious SQL
                               code, create one or more  SQL  injection  match
                               conditions.  An  SQL  injection match condition
                               identifies the part of web  requests,  such  as
                               the  URI or the query string, that you want WAF
                               to inspect. Later in the process, when you cre-
                               ate  a web ACL, you specify whether to allow or
                               block requests that appear to contain malicious
                               SQL code.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to  inspect.  For  more  information,   see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect  a  single  header.  Provide the
                                      name of the header to inspect, for exam-
                                      ple,  User-Agent  or Referer . This set-
                                      ting isn't case sensitive.

                                      Example JSON: "SingleHeader": {  "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The  name of the query header to in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the  name  of  the query argument to in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This is used only to  indicate  the  web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example JSON:  "SingleQueryArgument":  {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The  name  of  the query argument to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect the request URI  path.  This  is
                                      the  part  of a web request that identi-
                                      fies  a  resource,  for  example,   /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect  the  query  string. This is the
                                      part of a URL that  appears  after  a  ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect  the request body as plain text.
                                      The request body immediately follows the
                                      request  headers.  This is the part of a
                                      request  that  contains  any  additional
                                      data  that  you want to send to your web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect  the HTTP method. The method in-
                                      dicates the type of operation  that  the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect  the  request  body as JSON. The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest that contains any additional  data
                                      that you want to send to your web server
                                      as the HTTP request body, such  as  data
                                      from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text transformations eliminate some of  the
                                   unusual  formatting  that  attackers use in
                                   web requests in an effort to bypass  detec-
                                   tion.  If you specify one or more transfor-
                                   mations in a rule statement,  WAF  performs
                                   all  transformations  on the content of the
                                   request  component  identified  by   Field-
                                   ToMatch , starting from the lowest priority
                                   setting, before inspecting the content  for
                                   a match.

                                   (structure)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets the relative  processing  order
                                          for  multiple  transformations  that
                                          are defined for  a  rule  statement.
                                          WAF  processes  all transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent. The priorities don't  need  to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                            XssMatchStatement -> (structure)
                               A  rule  statement  that  defines  a cross-site
                               scripting (XSS) match search for WAF  to  apply
                               to  web  requests.  XSS attacks are those where
                               the attacker uses vulnerabilities in  a  benign
                               website   as  a  vehicle  to  inject  malicious
                               client-site scripts into other  legitimate  web
                               browsers.  The XSS match statement provides the
                               location in  requests  that  you  want  WAF  to
                               search  and  text transformations to use on the
                               search area before WAF searches  for  character
                               sequences  that  are  likely  to  be  malicious
                               strings.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to   inspect.  For  more  information,  see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This  is  used  only to indicate the web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of a web request  that  identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. If you specify one or more  transfor-
                                   mations  in  a rule statement, WAF performs
                                   all transformations on the content  of  the
                                   request   component  identified  by  Field-
                                   ToMatch , starting from the lowest priority
                                   setting,  before inspecting the content for
                                   a match.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations  that
                                          are  defined  for  a rule statement.
                                          WAF processes  all  transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent.  The  priorities don't need to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                            SizeConstraintStatement -> (structure)
                               A rule statement  that  compares  a  number  of
                               bytes  against the size of a request component,
                               using a comparison operator,  such  as  greater
                               than (>) or less than (<). For example, you can
                               use a size constraint  statement  to  look  for
                               query strings that are longer than 100 bytes.

                               If  you  configure  WAF  to inspect the request
                               body, WAF inspects only the first 8192 bytes (8
                               KB).  If the request body for your web requests
                               never exceeds 8192 bytes, you can create a size
                               constraint  condition  and  block requests that
                               have a request body greater than 8192 bytes.

                               If you choose URI for the value of Part of  the
                               request  to filter on, the slash (/) in the URI
                               counts as one character. For example,  the  URI
                               /logo.jpg is nine characters long.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to  inspect.  For  more  information,   see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect  a  single  header.  Provide the
                                      name of the header to inspect, for exam-
                                      ple,  User-Agent  or Referer . This set-
                                      ting isn't case sensitive.

                                      Example JSON: "SingleHeader": {  "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The  name of the query header to in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the  name  of  the query argument to in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This is used only to  indicate  the  web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example JSON:  "SingleQueryArgument":  {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The  name  of  the query argument to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect the request URI  path.  This  is
                                      the  part  of a web request that identi-
                                      fies  a  resource,  for  example,   /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect  the  query  string. This is the
                                      part of a URL that  appears  after  a  ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect  the request body as plain text.
                                      The request body immediately follows the
                                      request  headers.  This is the part of a
                                      request  that  contains  any  additional
                                      data  that  you want to send to your web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect  the HTTP method. The method in-
                                      dicates the type of operation  that  the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect  the  request  body as JSON. The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest that contains any additional  data
                                      that you want to send to your web server
                                      as the HTTP request body, such  as  data
                                      from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               ComparisonOperator -> (string)
                                   The operator to use to compare the  request
                                   part to the size setting.

                               Size -> (long)
                                   The  size,  in  byte, to compare to the re-
                                   quest part, after any transformations.

                               TextTransformations -> (list)
                                   Text transformations eliminate some of  the
                                   unusual  formatting  that  attackers use in
                                   web requests in an effort to bypass  detec-
                                   tion.  If you specify one or more transfor-
                                   mations in a rule statement,  WAF  performs
                                   all  transformations  on the content of the
                                   request  component  identified  by   Field-
                                   ToMatch , starting from the lowest priority
                                   setting, before inspecting the content  for
                                   a match.

                                   (structure)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets the relative  processing  order
                                          for  multiple  transformations  that
                                          are defined for  a  rule  statement.
                                          WAF  processes  all transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent. The priorities don't  need  to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                            GeoMatchStatement -> (structure)
                               A  rule statement used to identify web requests
                               based on country of origin.

                               CountryCodes -> (list)
                                   An array of  two-character  country  codes,
                                   for  example, [ "US", "CN" ] , from the al-
                                   pha-2 country ISO codes of the ISO 3166 in-
                                   ternational standard.

                                   (string)

                               ForwardedIPConfig -> (structure)
                                   The  configuration  for  inspecting  IP ad-
                                   dresses in an HTTP header that you specify,
                                   instead  of using the IP address that's re-
                                   ported by the web request origin. Commonly,
                                   this  is  the X-Forwarded-For (XFF) header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the  request, WAF doesn't apply the rule
                                      to the web request at all.

                                   HeaderName -> (string)
                                      The name of the HTTP header to  use  for
                                      the  IP address. For example, to use the
                                      X-Forwarded-For (XFF) header,  set  this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The match status to assign  to  the  web
                                      request  if  the  request doesn't have a
                                      valid IP address in the specified  posi-
                                      tion.

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                      You can specify the  following  fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching the rule statement.  WAF  ap-
                                        plies the rule action to the request.

                                      o NO_MATCH  -  Treat  the web request as
                                        not matching the rule statement.

                            RuleGroupReferenceStatement -> (structure)
                               A rule statement used to run the rules that are
                               defined in a  RuleGroup . To use this, create a
                               rule group with your rules,  then  provide  the
                               ARN of the rule group in this statement.

                               You cannot nest a RuleGroupReferenceStatement ,
                               for example for use inside  a  NotStatement  or
                               OrStatement  .  You  can  only use a rule group
                               reference statement at the top level  inside  a
                               web ACL.

                               ARN -> (string)
                                   The  Amazon  Resource Name (ARN) of the en-
                                   tity.

                               ExcludedRules -> (list)
                                   The rules  in  the  referenced  rule  group
                                   whose  actions  are set to Count . When you
                                   exclude a rule, WAF evaluates it exactly as
                                   it  would  if  the rule action setting were
                                   Count . This is a useful option for testing
                                   the rules in a rule group without modifying
                                   how they handle your web traffic.

                                   (structure)
                                      Specifies a single rule in a rule  group
                                      whose  action  you  want  to override to
                                      Count . When you  exclude  a  rule,  WAF
                                      evaluates  it exactly as it would if the
                                      rule action setting were Count . This is
                                      a useful option for testing the rules in
                                      a rule group without modifying how  they
                                      handle your web traffic.

                                      Name -> (string)
                                          The  name  of  the rule whose action
                                          you want to override to Count .

                            IPSetReferenceStatement -> (structure)
                               A rule statement used to  detect  web  requests
                               coming  from particular IP addresses or address
                               ranges. To use  this,  create  an   IPSet  that
                               specifies  the  addresses  you  want to detect,
                               then use the ARN of that set in this statement.
                               To create an IP set, see  CreateIPSet .

                               Each  IP  set  rule  statement references an IP
                               set. You create and maintain the  set  indepen-
                               dent  of your rules. This allows you to use the
                               single set in multiple rules. When  you  update
                               the  referenced  set, WAF automatically updates
                               all rules that reference it.

                               ARN -> (string)
                                   The  Amazon  Resource  Name  (ARN)  of  the
                                   IPSet that this statement references.

                               IPSetForwardedIPConfig -> (structure)
                                   The  configuration  for  inspecting  IP ad-
                                   dresses in an HTTP header that you specify,
                                   instead  of using the IP address that's re-
                                   ported by the web request origin. Commonly,
                                   this  is  the X-Forwarded-For (XFF) header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the  request, WAF doesn't apply the rule
                                      to the web request at all.

                                   HeaderName -> (string)
                                      The name of the HTTP header to  use  for
                                      the  IP address. For example, to use the
                                      X-Forwarded-For (XFF) header,  set  this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The match status to assign  to  the  web
                                      request  if  the  request doesn't have a
                                      valid IP address in the specified  posi-
                                      tion.

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                      You can specify the  following  fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching the rule statement.  WAF  ap-
                                        plies the rule action to the request.

                                      o NO_MATCH  -  Treat  the web request as
                                        not matching the rule statement.

                                   Position -> (string)
                                      The position in the header to search for
                                      the  IP  address. The header can contain
                                      IP addresses of the original client  and
                                      also of proxies. For example, the header
                                      value  could  be  10.1.1.1,   127.0.0.0,
                                      10.10.10.10  where  the first IP address
                                      identifies the original client  and  the
                                      rest  identify  proxies that the request
                                      went through.

                                      The options for  this  setting  are  the
                                      following:

                                      o FIRST  -  Inspect the first IP address
                                        in the list of  IP  addresses  in  the
                                        header.  This  is usually the client's
                                        original IP.

                                      o LAST - Inspect the last IP address  in
                                        the   list  of  IP  addresses  in  the
                                        header.

                                      o ANY - Inspect all IP addresses in  the
                                        header for a match. If the header con-
                                        tains more than 10 IP  addresses,  WAF
                                        inspects the last 10.

                            RegexPatternSetReferenceStatement -> (structure)
                               A  rule  statement  used  to search web request
                               components for  matches  with  regular  expres-
                               sions.  To  use this, create a  RegexPatternSet
                               that specifies the expressions that you want to
                               detect,  then  use  the ARN of that set in this
                               statement. A web request  matches  the  pattern
                               set  rule  statement  if  the request component
                               matches any of the patterns in the set. To cre-
                               ate  a  regex pattern set, see  CreateRegexPat-
                               ternSet .

                               Each regex pattern set  rule  statement  refer-
                               ences a regex pattern set. You create and main-
                               tain the set independent of  your  rules.  This
                               allows  you  to  use the single set in multiple
                               rules. When you update the referenced set,  WAF
                               automatically  updates all rules that reference
                               it.

                               ARN -> (string)
                                   The Amazon Resource Name (ARN) of the  Reg-
                                   exPatternSet  that  this  statement  refer-
                                   ences.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to   inspect.  For  more  information,  see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This  is  used  only to indicate the web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of a web request  that  identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. If you specify one or more  transfor-
                                   mations  in  a rule statement, WAF performs
                                   all transformations on the content  of  the
                                   request   component  identified  by  Field-
                                   ToMatch , starting from the lowest priority
                                   setting,  before inspecting the content for
                                   a match.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations  that
                                          are  defined  for  a rule statement.
                                          WAF processes  all  transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent.  The  priorities don't need to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                            RateBasedStatement -> (structure)
                               A rate-based rule tracks the rate  of  requests
                               for  each  originating IP address, and triggers
                               the rule action when the rate exceeds  a  limit
                               that  you  specify on the number of requests in
                               any 5-minute time span. You can use this to put
                               a  temporary  block  on requests from an IP ad-
                               dress that is sending excessive requests.

                               WAF tracks and manages web requests  separately
                               for each instance of a rate-based rule that you
                               use. For  example,  if  you  provide  the  same
                               rate-based  rule settings in two web ACLs, each
                               of the two rule statements represents  a  sepa-
                               rate  instance  of the rate-based rule and gets
                               its own tracking and management by WAF. If  you
                               define  a  rate-based rule inside a rule group,
                               and  then  use  that  rule  group  in  multiple
                               places, each use creates a separate instance of
                               the rate-based rule that gets its own  tracking
                               and management by WAF.

                               When the rule action triggers, WAF blocks addi-
                               tional requests from the IP address  until  the
                               request rate falls below the limit.

                               You  can  optionally nest another statement in-
                               side the rate-based statement,  to  narrow  the
                               scope  of  the  rule so that it only counts re-
                               quests that match the nested statement. For ex-
                               ample,  based  on recent requests that you have
                               seen from  an  attacker,  you  might  create  a
                               rate-based  rule  with a nested AND rule state-
                               ment that contains the following nested  state-
                               ments:

                               o An  IP  match  statement  with an IP set that
                                 specified the address 192.0.2.44.

                               o A string match statement that searches in the
                                 User-Agent header for the string BadBot.

                               In this rate-based rule, you also define a rate
                               limit. For this  example,  the  rate  limit  is
                               1,000.  Requests  that  meet both of the condi-
                               tions in the statements  are  counted.  If  the
                               count  exceeds 1,000 requests per five minutes,
                               the rule action triggers. Requests that do  not
                               meet  both  conditions  are not counted towards
                               the rate limit and are  not  affected  by  this
                               rule.

                               You cannot nest a RateBasedStatement inside an-
                               other statement, for example inside a NotState-
                               ment  or  OrStatement  . You can define a Rate-
                               BasedStatement inside a web ACL  and  inside  a
                               rule group.

                               Limit -> (long)
                                   The  limit  on requests per 5-minute period
                                   for a single originating IP address. If the
                                   statement  includes  a ScopeDownStatement ,
                                   this limit is applied only to the  requests
                                   that match the statement.

                               AggregateKeyType -> (string)
                                   Setting that indicates how to aggregate the
                                   request counts. The options are the follow-
                                   ing:

                                   o IP  - Aggregate the request counts on the
                                     IP address from the web request origin.

                                   o FORWARDED_IP  -  Aggregate  the   request
                                     counts on the first IP address in an HTTP
                                     header. If you use  this,  configure  the
                                     ForwardedIPConfig , to specify the header
                                     to use.

                               ScopeDownStatement -> (structure)
                                   An optional nested statement  that  narrows
                                   the  scope  of  the  web  requests that are
                                   evaluated by the rate-based statement.  Re-
                                   quests  are  only tracked by the rate-based
                                   statement  if  they  match  the  scope-down
                                   statement. You can use any nestable  State-
                                   ment in the scope-down statement,  and  you
                                   can  nest statements at any level, the same
                                   as you can for a rule statement.

                                   ByteMatchStatement -> (structure)
                                      A rule statement that defines  a  string
                                      match search for WAF to apply to web re-
                                      quests. The byte  match  statement  pro-
                                      vides the bytes to search for, the loca-
                                      tion in requests that you  want  WAF  to
                                      search, and other settings. The bytes to
                                      search for are typically a  string  that
                                      corresponds  with  ASCII  characters. In
                                      the WAF console and the developer guide,
                                      this  is  refered  to  as a string match
                                      statement.

                                      SearchString -> (blob)
                                          A string value that you want WAF  to
                                          search for. WAF searches only in the
                                          part of web requests that you desig-
                                          nate for inspection in  FieldToMatch
                                          . The maximum length of the value is
                                          50 bytes.

                                          Valid values depend on the component
                                          that you specify for  inspection  in
                                          FieldToMatch :

                                          o Method  : The HTTP method that you
                                            want WAF to search for. This indi-
                                            cates the type of operation speci-
                                            fied in the request.

                                          o UriPath : The value that you  want
                                            WAF to search for in the URI path,
                                            for example,  /images/daily-ad.jpg
                                            .

                                          If  SearchString includes alphabetic
                                          characters A-Z and  a-z,  note  that
                                          the value is case sensitive.
                                             If you're using the WAF API

                                          Specify  a base64-encoded version of
                                          the value. The maximum length of the
                                          value before you base64-encode it is
                                          50 bytes.

                                          For example, suppose  the  value  of
                                          Type is HEADER and the value of Data
                                          is  User-Agent  .  If  you  want  to
                                          search the User-Agent header for the
                                          value  BadBot  ,  you  base64-encode
                                          BadBot  using  MIME  base64-encoding
                                          and include the resulting value, Qm-
                                          FkQm90  ,  in  the  value of Search-
                                          String .
                                             If you're using the CLI or one of
                                             the Amazon Web Services SDKs

                                          The  value  that  you  want  WAF  to
                                          search for.  The  SDK  automatically
                                          base64 encodes the value.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.  If  you
                                          specify  one or more transformations
                                          in a rule  statement,  WAF  performs
                                          all  transformations  on the content
                                          of the request component  identified
                                          by  FieldToMatch , starting from the
                                          lowest priority setting, before  in-
                                          specting the content for a match.

                                          (structure)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets  the relative processing
                                                 order for multiple  transfor-
                                                 mations  that are defined for
                                                 a rule  statement.  WAF  pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive, but they  must  all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE -  Decode  a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a Base64 -encoded  string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE  -   Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness  of attackers who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use unusual formatting  to
                                                    disguise  some  or  all of
                                                    the command.

                                                 o Delete the following  char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with   a  space  character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v  , vertical tab, decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE  - Decode char-
                                                    acters that  were  encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This  function  uses up to
                                                    two bytes in the  decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS encoding that  wouldnt
                                                    typically be encoded. It's
                                                    also useful in  countering
                                                    evasion, which is a combi-
                                                    nation of a backslash  and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript    for   java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the  following  ANSI C es-
                                                    cape sequences: \a , \b  ,
                                                    \f  ,  \n , \r , \t , \v ,
                                                    \\ , \? , \' , \"  ,  \xHH
                                                    (hexadecimal),  \0OOO (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE  -   Decode   a
                                                    string    of   hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters with unencoded  char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with a non-breaking  space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces   characters  that
                                                   are represented in hexadec-
                                                   imal     format,    (amper-
                                                   sand)#xhhhh;  ,  with   the
                                                   corresponding characters

                                                 o Replaces   characters  that
                                                   are represented in  decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with   the    corresponding
                                                   characters
                                                    JS_DECODE  -  Decode Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the full-width ASCII  code
                                                    range  of FF01-FF5E , then
                                                    the higher byte is used to
                                                    detect   and   adjust  the
                                                    lower byte. If  not,  only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash  from the data in the
                                                    input. The  computed  hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH   -  Remove
                                                    multiple  slashes,  direc-
                                                    tory  self-references, and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning of the input from  an
                                                    input string.

                                                    NORMALIZE_PATH_WIN  - This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH  , but first con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS  - Remove all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences   are  not  com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination of a comment  (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS   -  Replace
                                                    NULL bytes  in  the  input
                                                    with    space   characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE  -   Decode
                                                    SQL   hex   data.  Example
                                                    (0x414243 )  will  be  de-
                                                    coded to (ABC ).

                                                    URL_DECODE   -   Decode  a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI   -    Like
                                                    URL_DECODE , but with sup-
                                                    port  for   Microsoft-spe-
                                                    cific  %u encoding. If the
                                                    code is in the  full-width
                                                    ASCII    code   range   of
                                                    FF01-FF5E  ,  the   higher
                                                    byte is used to detect and
                                                    adjust  the  lower   byte.
                                                    Otherwise,  only the lower
                                                    byte  is  used   and   the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE  - Convert
                                                    all  UTF-8  character  se-
                                                    quences  to  Unicode. This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives and  false-negatives
                                                    for non-English languages.

                                      PositionalConstraint -> (string)
                                          The area within the portion of a web
                                          request that you want WAF to  search
                                          for  SearchString . Valid values in-
                                          clude the following:
                                             CONTAINS

                                          The specified part of  the  web  re-
                                          quest  must  include  the  value  of
                                          SearchString  ,  but  the   location
                                          doesn't matter.
                                             CONTAINS_WORD

                                          The  specified  part  of the web re-
                                          quest  must  include  the  value  of
                                          SearchString , and SearchString must
                                          contain only alphanumeric characters
                                          or underscore (A-Z, a-z, 0-9, or _).
                                          In addition, SearchString must be  a
                                          word,  which  means that both of the
                                          following are true:

                                          o SearchString is at  the  beginning
                                            of  the  specified part of the web
                                            request or is preceded by a  char-
                                            acter  other  than an alphanumeric
                                            character or underscore (_). Exam-
                                            ples include the value of a header
                                            and ;BadBot .

                                          o SearchString is at the end of  the
                                            specified  part of the web request
                                            or  is  followed  by  a  character
                                            other than an alphanumeric charac-
                                            ter or underscore (_),  for  exam-
                                            ple, BadBot; and -BadBot; .
                                             EXACTLY

                                          The  value  of the specified part of
                                          the web request must  exactly  match
                                          the value of SearchString .
                                             STARTS_WITH

                                          The  value  of SearchString must ap-
                                          pear at the beginning of the  speci-
                                          fied part of the web request.
                                             ENDS_WITH

                                          The  value  of SearchString must ap-
                                          pear at the  end  of  the  specified
                                          part of the web request.

                                   SqliMatchStatement -> (structure)
                                      Attackers sometimes insert malicious SQL
                                      code into web requests in an  effort  to
                                      extract  data from your database. To al-
                                      low or block web requests that appear to
                                      contain  malicious  SQL code, create one
                                      or more SQL injection match  conditions.
                                      An SQL injection match condition identi-
                                      fies the part of web requests,  such  as
                                      the  URI  or  the query string, that you
                                      want  WAF  to  inspect.  Later  in   the
                                      process,  when you create a web ACL, you
                                      specify whether to allow  or  block  re-
                                      quests  that appear to contain malicious
                                      SQL code.

                                      FieldToMatch -> (structure)
                                          The part of a web request  that  you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect a single header.  Provide
                                             the  name  of  the  header to in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example JSON:  "SingleHeader":  {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The  name of the query header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect a single query  argument.
                                             Provide the name of the query ar-
                                             gument to inspect, such as  User-
                                             Name  or  SalesRegion  . The name
                                             can be up to 30  characters  long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web request component for WAF  to
                                             inspect,   in  the   FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The  name  of the query argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that identifies a  resource,  for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the part of a  URL  that  appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text. The  request  body  immedi-
                                             ately  follows  the request head-
                                             ers. This is the part  of  a  re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to  your  web  server as the HTTP
                                             request body, such as data from a
                                             form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect   the  HTTP  method.  The
                                             method indicates the type of  op-
                                             eration  that the request is ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the  part  of a request that con-
                                             tains any  additional  data  that
                                             you  want  to  send  to  your web
                                             server as the HTTP request  body,
                                             such as data from a form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The  patterns  to look for in
                                                 the JSON body.  WAF  inspects
                                                 the  results of these pattern
                                                 matches against the rule  in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See  also  MatchScope   in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this setting  or  the  In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match only  the  specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide the include  paths
                                                    using JSON Pointer syntax.
                                                    For  example,   "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"] . For  in-
                                                    formation  about this syn-
                                                    tax, see the Internet  En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this  setting  or  the All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't use this  option
                                                        to  include all paths.
                                                        Instead, use  the  All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON body.  The  options  are
                                                 the following:

                                                 o EVALUATE_AS_STRING   -  In-
                                                   spect  the  body  as  plain
                                                   text.  WAF applies the text
                                                   transformations and inspec-
                                                   tion  criteria that you de-
                                                   fined for the JSON  inspec-
                                                   tion   to   the  body  text
                                                   string.

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates  the content only up to
                                                 the  first  parsing   failure
                                                 that it encounters.

                                                 WAF  does  its  best to parse
                                                 the  entire  JSON  body,  but
                                                 might  be  forced to stop for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root  node isn't an object or
                                                 an array.

                                                 WAF parses the  JSON  in  the
                                                 following   examples  as  two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                                   XssMatchStatement -> (structure)
                                      A  rule   statement   that   defines   a
                                      cross-site  scripting (XSS) match search
                                      for WAF to apply to  web  requests.  XSS
                                      attacks  are  those  where  the attacker
                                      uses vulnerabilities in a benign website
                                      as   a   vehicle   to  inject  malicious
                                      client-site scripts into  other  legiti-
                                      mate  web browsers. The XSS match state-
                                      ment provides the location  in  requests
                                      that  you  want  WAF  to search and text
                                      transformations to  use  on  the  search
                                      area  before  WAF searches for character
                                      sequences that are likely  to  be  mali-
                                      cious strings.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.  If  you
                                          specify  one or more transformations
                                          in a rule  statement,  WAF  performs
                                          all  transformations  on the content
                                          of the request component  identified
                                          by  FieldToMatch , starting from the
                                          lowest priority setting, before  in-
                                          specting the content for a match.

                                          (structure)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets  the relative processing
                                                 order for multiple  transfor-
                                                 mations  that are defined for
                                                 a rule  statement.  WAF  pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive, but they  must  all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE -  Decode  a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a Base64 -encoded  string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE  -   Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness  of attackers who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use unusual formatting  to
                                                    disguise  some  or  all of
                                                    the command.

                                                 o Delete the following  char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with   a  space  character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v  , vertical tab, decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE  - Decode char-
                                                    acters that  were  encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This  function  uses up to
                                                    two bytes in the  decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS encoding that  wouldnt
                                                    typically be encoded. It's
                                                    also useful in  countering
                                                    evasion, which is a combi-
                                                    nation of a backslash  and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript    for   java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the  following  ANSI C es-
                                                    cape sequences: \a , \b  ,
                                                    \f  ,  \n , \r , \t , \v ,
                                                    \\ , \? , \' , \"  ,  \xHH
                                                    (hexadecimal),  \0OOO (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE  -   Decode   a
                                                    string    of   hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters with unencoded  char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with a non-breaking  space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces   characters  that
                                                   are represented in hexadec-
                                                   imal     format,    (amper-
                                                   sand)#xhhhh;  ,  with   the
                                                   corresponding characters

                                                 o Replaces   characters  that
                                                   are represented in  decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with   the    corresponding
                                                   characters
                                                    JS_DECODE  -  Decode Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the full-width ASCII  code
                                                    range  of FF01-FF5E , then
                                                    the higher byte is used to
                                                    detect   and   adjust  the
                                                    lower byte. If  not,  only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash  from the data in the
                                                    input. The  computed  hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH   -  Remove
                                                    multiple  slashes,  direc-
                                                    tory  self-references, and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning of the input from  an
                                                    input string.

                                                    NORMALIZE_PATH_WIN  - This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH  , but first con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS  - Remove all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences   are  not  com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination of a comment  (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS   -  Replace
                                                    NULL bytes  in  the  input
                                                    with    space   characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE  -   Decode
                                                    SQL   hex   data.  Example
                                                    (0x414243 )  will  be  de-
                                                    coded to (ABC ).

                                                    URL_DECODE   -   Decode  a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI   -    Like
                                                    URL_DECODE , but with sup-
                                                    port  for   Microsoft-spe-
                                                    cific  %u encoding. If the
                                                    code is in the  full-width
                                                    ASCII    code   range   of
                                                    FF01-FF5E  ,  the   higher
                                                    byte is used to detect and
                                                    adjust  the  lower   byte.
                                                    Otherwise,  only the lower
                                                    byte  is  used   and   the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE  - Convert
                                                    all  UTF-8  character  se-
                                                    quences  to  Unicode. This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives and  false-negatives
                                                    for non-English languages.

                                   SizeConstraintStatement -> (structure)
                                      A  rule statement that compares a number
                                      of bytes against the size of  a  request
                                      component,  using a comparison operator,
                                      such as greater than (>)  or  less  than
                                      (<).  For  example,  you  can use a size
                                      constraint statement to look  for  query
                                      strings that are longer than 100 bytes.

                                      If  you configure WAF to inspect the re-
                                      quest body, WAF inspects only the  first
                                      8192  bytes  (8 KB). If the request body
                                      for your web requests never exceeds 8192
                                      bytes,  you can create a size constraint
                                      condition and block requests that have a
                                      request body greater than 8192 bytes.

                                      If  you choose URI for the value of Part
                                      of the request to filter on,  the  slash
                                      (/)  in the URI counts as one character.
                                      For example, the URI /logo.jpg  is  nine
                                      characters long.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      ComparisonOperator -> (string)
                                          The  operator  to use to compare the
                                          request part to the size setting.

                                      Size -> (long)
                                          The size, in byte, to compare to the
                                          request  part, after any transforma-
                                          tions.

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                                   GeoMatchStatement -> (structure)
                                      A rule statement used  to  identify  web
                                      requests based on country of origin.

                                      CountryCodes -> (list)
                                          An  array  of  two-character country
                                          codes, for example, [ "US", "CN" ] ,
                                          from  the  alpha-2 country ISO codes
                                          of the ISO 3166 international  stan-
                                          dard.

                                          (string)

                                      ForwardedIPConfig -> (structure)
                                          The  configuration for inspecting IP
                                          addresses in an HTTP header that you
                                          specify, instead of using the IP ad-
                                          dress that's reported by the web re-
                                          quest  origin. Commonly, this is the
                                          X-Forwarded-For  (XFF)  header,  but
                                          you can specify any header name.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          HeaderName -> (string)
                                             The name of the  HTTP  header  to
                                             use for the IP address. For exam-
                                             ple, to use  the  X-Forwarded-For
                                             (XFF)  header, set this to X-For-
                                             warded-For .

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                          FallbackBehavior -> (string)
                                             The match status to assign to the
                                             web  request   if   the   request
                                             doesn't  have  a valid IP address
                                             in the specified position.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             You  can  specify  the  following
                                             fallback behaviors:

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                   RuleGroupReferenceStatement -> (structure)
                                      A  rule  statement used to run the rules
                                      that are defined in a   RuleGroup  .  To
                                      use  this, create a rule group with your
                                      rules, then provide the ARN of the  rule
                                      group in this statement.

                                      You  cannot  nest a RuleGroupReferenceS-
                                      tatement , for example for use inside  a
                                      NotStatement  or  OrStatement  . You can
                                      only use a rule group  reference  state-
                                      ment at the top level inside a web ACL.

                                      ARN -> (string)
                                          The  Amazon  Resource  Name (ARN) of
                                          the entity.

                                      ExcludedRules -> (list)
                                          The rules  in  the  referenced  rule
                                          group whose actions are set to Count
                                          . When you exclude a rule, WAF eval-
                                          uates  it exactly as it would if the
                                          rule action  setting  were  Count  .
                                          This  is a useful option for testing
                                          the rules in a  rule  group  without
                                          modifying  how  they handle your web
                                          traffic.

                                          (structure)
                                             Specifies a single rule in a rule
                                             group  whose  action  you want to
                                             override to Count . When you  ex-
                                             clude  a  rule,  WAF evaluates it
                                             exactly as it would if  the  rule
                                             action  setting were Count . This
                                             is a useful  option  for  testing
                                             the rules in a rule group without
                                             modifying how  they  handle  your
                                             web traffic.

                                             Name -> (string)
                                                 The  name  of  the rule whose
                                                 action you want  to  override
                                                 to Count .

                                   IPSetReferenceStatement -> (structure)
                                      A  rule statement used to detect web re-
                                      quests coming  from  particular  IP  ad-
                                      dresses  or address ranges. To use this,
                                      create an  IPSet that specifies the  ad-
                                      dresses you want to detect, then use the
                                      ARN of that set in  this  statement.  To
                                      create an IP set, see  CreateIPSet .

                                      Each IP set rule statement references an
                                      IP set. You create and maintain the  set
                                      independent  of  your rules. This allows
                                      you to use the single  set  in  multiple
                                      rules.  When  you  update the referenced
                                      set, WAF automatically updates all rules
                                      that reference it.

                                      ARN -> (string)
                                          The  Amazon  Resource  Name (ARN) of
                                          the  IPSet that this statement  ref-
                                          erences.

                                      IPSetForwardedIPConfig -> (structure)
                                          The  configuration for inspecting IP
                                          addresses in an HTTP header that you
                                          specify, instead of using the IP ad-
                                          dress that's reported by the web re-
                                          quest  origin. Commonly, this is the
                                          X-Forwarded-For  (XFF)  header,  but
                                          you can specify any header name.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          HeaderName -> (string)
                                             The name of the  HTTP  header  to
                                             use for the IP address. For exam-
                                             ple, to use  the  X-Forwarded-For
                                             (XFF)  header, set this to X-For-
                                             warded-For .

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                          FallbackBehavior -> (string)
                                             The match status to assign to the
                                             web  request   if   the   request
                                             doesn't  have  a valid IP address
                                             in the specified position.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             You  can  specify  the  following
                                             fallback behaviors:

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                          Position -> (string)
                                             The  position  in  the  header to
                                             search for the  IP  address.  The
                                             header  can  contain IP addresses
                                             of the original client  and  also
                                             of   proxies.  For  example,  the
                                             header value could  be  10.1.1.1,
                                             127.0.0.0,  10.10.10.10 where the
                                             first IP address  identifies  the
                                             original   client  and  the  rest
                                             identify proxies that the request
                                             went through.

                                             The  options for this setting are
                                             the following:

                                             o FIRST - Inspect  the  first  IP
                                               address  in  the list of IP ad-
                                               dresses in the header. This  is
                                               usually  the  client's original
                                               IP.

                                             o LAST - Inspect the last IP  ad-
                                               dress  in  the  list  of IP ad-
                                               dresses in the header.

                                             o ANY - Inspect all IP  addresses
                                               in  the  header for a match. If
                                               the header contains  more  than
                                               10  IP  addresses, WAF inspects
                                               the last 10.

                                   RegexPatternSetReferenceStatement        ->
                                   (structure)
                                      A  rule statement used to search web re-
                                      quest components for matches with  regu-
                                      lar  expressions.  To use this, create a
                                      RegexPatternSet that specifies  the  ex-
                                      pressions  that you want to detect, then
                                      use the ARN of that set in  this  state-
                                      ment.  A web request matches the pattern
                                      set rule statement if the request compo-
                                      nent  matches any of the patterns in the
                                      set. To create a regex pattern set,  see
                                      CreateRegexPatternSet .

                                      Each  regex  pattern  set rule statement
                                      references a regex pattern set. You cre-
                                      ate  and maintain the set independent of
                                      your rules. This allows you to  use  the
                                      single  set  in multiple rules. When you
                                      update the referenced set, WAF automati-
                                      cally  updates  all rules that reference
                                      it.

                                      ARN -> (string)
                                          The Amazon Resource  Name  (ARN)  of
                                          the    RegexPatternSet   that   this
                                          statement references.

                                      FieldToMatch -> (structure)
                                          The part of a web request  that  you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect a single header.  Provide
                                             the  name  of  the  header to in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example JSON:  "SingleHeader":  {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The  name of the query header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect a single query  argument.
                                             Provide the name of the query ar-
                                             gument to inspect, such as  User-
                                             Name  or  SalesRegion  . The name
                                             can be up to 30  characters  long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web request component for WAF  to
                                             inspect,   in  the   FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The  name  of the query argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that identifies a  resource,  for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the part of a  URL  that  appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text. The  request  body  immedi-
                                             ately  follows  the request head-
                                             ers. This is the part  of  a  re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to  your  web  server as the HTTP
                                             request body, such as data from a
                                             form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect   the  HTTP  method.  The
                                             method indicates the type of  op-
                                             eration  that the request is ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the  part  of a request that con-
                                             tains any  additional  data  that
                                             you  want  to  send  to  your web
                                             server as the HTTP request  body,
                                             such as data from a form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The  patterns  to look for in
                                                 the JSON body.  WAF  inspects
                                                 the  results of these pattern
                                                 matches against the rule  in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See  also  MatchScope   in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this setting  or  the  In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match only  the  specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide the include  paths
                                                    using JSON Pointer syntax.
                                                    For  example,   "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"] . For  in-
                                                    formation  about this syn-
                                                    tax, see the Internet  En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this  setting  or  the All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't use this  option
                                                        to  include all paths.
                                                        Instead, use  the  All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON body.  The  options  are
                                                 the following:

                                                 o EVALUATE_AS_STRING   -  In-
                                                   spect  the  body  as  plain
                                                   text.  WAF applies the text
                                                   transformations and inspec-
                                                   tion  criteria that you de-
                                                   fined for the JSON  inspec-
                                                   tion   to   the  body  text
                                                   string.

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates  the content only up to
                                                 the  first  parsing   failure
                                                 that it encounters.

                                                 WAF  does  its  best to parse
                                                 the  entire  JSON  body,  but
                                                 might  be  forced to stop for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root  node isn't an object or
                                                 an array.

                                                 WAF parses the  JSON  in  the
                                                 following   examples  as  two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                                   RateBasedStatement -> (structure)
                                      A rate-based rule tracks the rate of re-
                                      quests  for each originating IP address,
                                      and triggers the rule  action  when  the
                                      rate exceeds a limit that you specify on
                                      the number of requests in  any  5-minute
                                      time  span.  You  can  use this to put a
                                      temporary block on requests from  an  IP
                                      address  that  is  sending excessive re-
                                      quests.

                                      WAF tracks and manages web requests sep-
                                      arately   for   each   instance   of   a
                                      rate-based rule that you use. For  exam-
                                      ple,  if you provide the same rate-based
                                      rule settings in two web ACLs,  each  of
                                      the  two  rule  statements  represents a
                                      separate instance of the rate-based rule
                                      and gets its own tracking and management
                                      by WAF. If you define a rate-based  rule
                                      inside  a  rule group, and then use that
                                      rule group in multiple places, each  use
                                      creates   a  separate  instance  of  the
                                      rate-based rule that gets its own track-
                                      ing and management by WAF.

                                      When   the  rule  action  triggers,  WAF
                                      blocks additional requests from  the  IP
                                      address until the request rate falls be-
                                      low the limit.

                                      You can optionally nest  another  state-
                                      ment inside the rate-based statement, to
                                      narrow the scope of the rule so that  it
                                      only  counts  requests  that  match  the
                                      nested statement. For example, based  on
                                      recent  requests that you have seen from
                                      an  attacker,   you   might   create   a
                                      rate-based  rule  with a nested AND rule
                                      statement that  contains  the  following
                                      nested statements:

                                      o An  IP  match statement with an IP set
                                        that specified the address 192.0.2.44.

                                      o A string match statement that searches
                                        in   the  User-Agent  header  for  the
                                        string BadBot.

                                      In this rate-based rule, you also define
                                      a rate limit. For this example, the rate
                                      limit is 1,000. Requests that meet  both
                                      of  the conditions in the statements are
                                      counted. If the count exceeds 1,000  re-
                                      quests per five minutes, the rule action
                                      triggers. Requests that do not meet both
                                      conditions  are  not counted towards the
                                      rate limit and are not affected by  this
                                      rule.

                                      You cannot nest a RateBasedStatement in-
                                      side another statement, for example  in-
                                      side a NotStatement or OrStatement . You
                                      can define a RateBasedStatement inside a
                                      web ACL and inside a rule group.

                                      Limit -> (long)
                                          The  limit  on requests per 5-minute
                                          period for a single  originating  IP
                                          address. If the statement includes a
                                          ScopeDownStatement , this  limit  is
                                          applied  only  to  the requests that
                                          match the statement.

                                      AggregateKeyType -> (string)
                                          Setting that indicates how to aggre-
                                          gate the request counts. The options
                                          are the following:

                                          o IP - Aggregate the request  counts
                                            on the IP address from the web re-
                                            quest origin.

                                          o FORWARDED_IP - Aggregate  the  re-
                                            quest  counts  on the first IP ad-
                                            dress in an HTTP  header.  If  you
                                            use   this,   configure  the  For-
                                            wardedIPConfig ,  to  specify  the
                                            header to use.

                                      (  ...  recursive ... )ForwardedIPConfig
                                      -> (structure)
                                          The configuration for inspecting  IP
                                          addresses in an HTTP header that you
                                          specify, instead of using the IP ad-
                                          dress that's reported by the web re-
                                          quest origin. Commonly, this is  the
                                          X-Forwarded-For  (XFF)  header,  but
                                          you can specify any header name.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present   in   the  request,  WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          This is required if AggregateKeyType
                                          is set to FORWARDED_IP .

                                          HeaderName -> (string)
                                             The name of the  HTTP  header  to
                                             use for the IP address. For exam-
                                             ple, to use  the  X-Forwarded-For
                                             (XFF)  header, set this to X-For-
                                             warded-For .

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                          FallbackBehavior -> (string)
                                             The match status to assign to the
                                             web  request   if   the   request
                                             doesn't  have  a valid IP address
                                             in the specified position.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             You  can  specify  the  following
                                             fallback behaviors:

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                   AndStatement -> (structure)
                                      A logical rule statement used to combine
                                      other rule statements  with  AND  logic.
                                      You  provide  more  than  one  Statement
                                      within the AndStatement .

                                      Statements -> (list)
                                          The statements to combine  with  AND
                                          logic.  You  can  use any statements
                                          that can be nested.

                                          ( ... recursive ... )

                                   OrStatement -> (structure)
                                      A logical rule statement used to combine
                                      other rule statements with OR logic. You
                                      provide more than one  Statement  within
                                      the OrStatement .

                                      Statements -> (list)
                                          The  statements  to  combine with OR
                                          logic. You can  use  any  statements
                                          that can be nested.

                                          ( ... recursive ... )

                                   NotStatement -> (structure)
                                      A  logical rule statement used to negate
                                      the results of another  rule  statement.
                                      You  provide  one   Statement within the
                                      NotStatement .

                                      ( ... recursive ... )

                                   ManagedRuleGroupStatement -> (structure)
                                      A rule statement used to run  the  rules
                                      that  are  defined  in  a  managed  rule
                                      group. To use this, provide  the  vendor
                                      name  and  the name of the rule group in
                                      this statement. You can retrieve the re-
                                      quired names by calling  ListAvailableM-
                                      anagedRuleGroups .

                                      You cannot nest a ManagedRuleGroupState-
                                      ment , for example for use inside a Not-
                                      Statement or OrStatement . It  can  only
                                      be  referenced  as a top-level statement
                                      within a rule.

                                      VendorName -> (string)
                                          The name of the managed  rule  group
                                          vendor. You use this, along with the
                                          rule group  name,  to  identify  the
                                          rule group.

                                      Name -> (string)
                                          The  name of the managed rule group.
                                          You use this, along with the  vendor
                                          name, to identify the rule group.

                                      Version -> (string)
                                          The  version  of  the  managed  rule
                                          group to use. If you  specify  this,
                                          the  version  setting is fixed until
                                          you change it. If you don't  specify
                                          this,  WAF uses the vendor's default
                                          version, and then keeps the  version
                                          at  the  vendor's  default  when the
                                          vendor  updates  the  managed   rule
                                          group settings.

                                      ExcludedRules -> (list)
                                          The  rules  in  the  referenced rule
                                          group whose actions are set to Count
                                          . When you exclude a rule, WAF eval-
                                          uates it exactly as it would if  the
                                          rule  action  setting  were  Count .
                                          This is a useful option for  testing
                                          the  rules  in  a rule group without
                                          modifying how they handle  your  web
                                          traffic.

                                          (structure)
                                             Specifies a single rule in a rule
                                             group whose action  you  want  to
                                             override  to Count . When you ex-
                                             clude a rule,  WAF  evaluates  it
                                             exactly  as  it would if the rule
                                             action setting were Count .  This
                                             is  a  useful  option for testing
                                             the rules in a rule group without
                                             modifying  how  they  handle your
                                             web traffic.

                                             Name -> (string)
                                                 The name of  the  rule  whose
                                                 action  you  want to override
                                                 to Count .

                                      ( ... recursive ... )

                                   LabelMatchStatement -> (structure)
                                      A rule statement that defines  a  string
                                      match  search  against  labels that have
                                      been added to the web request  by  rules
                                      that have already run in the web ACL.

                                      The  label  match statement provides the
                                      label or namespace string to search for.
                                      The label string can represent a part or
                                      all of the fully  qualified  label  name
                                      that  had been added to the web request.
                                      Fully qualified labels  have  a  prefix,
                                      optional namespaces, and label name. The
                                      prefix identifies the rule group or  web
                                      ACL  context  of the rule that added the
                                      label. If you do not provide  the  fully
                                      qualified   name  in  your  label  match
                                      string, WAF performs the search for  la-
                                      bels that were added in the same context
                                      as the label match statement.

                                      Scope -> (string)
                                          Specify whether you  want  to  match
                                          using  the  label  name  or just the
                                          namespace.

                                      Key -> (string)
                                          The string  to  match  against.  The
                                          setting you provide for this depends
                                          on the match statement's Scope  set-
                                          ting:

                                          o If  the  Scope  indicates  LABEL ,
                                            then this specification  must  in-
                                            clude the name and can include any
                                            number  of   preceding   namespace
                                            specifications  and  prefix  up to
                                            providing the fully qualified  la-
                                            bel name.

                                          o If the Scope indicates NAMESPACE ,
                                            then this  specification  can  in-
                                            clude  any  number  of  contiguous
                                            namespace strings, and can include
                                            the  entire label namespace prefix
                                            from the rule  group  or  web  ACL
                                            where the label originates.

                                          Labels are case sensitive and compo-
                                          nents of a label must  be  separated
                                          by colon, for example NS1:NS2:name .

                                   RegexMatchStatement -> (structure)
                                      A  rule statement used to search web re-
                                      quest components for a match  against  a
                                      single regular expression.

                                      RegexString -> (string)
                                          The  string representing the regular
                                          expression.

                                      FieldToMatch -> (structure)
                                          The part of a web request  that  you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect a single header.  Provide
                                             the  name  of  the  header to in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example JSON:  "SingleHeader":  {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The  name of the query header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect a single query  argument.
                                             Provide the name of the query ar-
                                             gument to inspect, such as  User-
                                             Name  or  SalesRegion  . The name
                                             can be up to 30  characters  long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web request component for WAF  to
                                             inspect,   in  the   FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The  name  of the query argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that identifies a  resource,  for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the part of a  URL  that  appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text. The  request  body  immedi-
                                             ately  follows  the request head-
                                             ers. This is the part  of  a  re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to  your  web  server as the HTTP
                                             request body, such as data from a
                                             form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect   the  HTTP  method.  The
                                             method indicates the type of  op-
                                             eration  that the request is ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the  part  of a request that con-
                                             tains any  additional  data  that
                                             you  want  to  send  to  your web
                                             server as the HTTP request  body,
                                             such as data from a form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The  patterns  to look for in
                                                 the JSON body.  WAF  inspects
                                                 the  results of these pattern
                                                 matches against the rule  in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See  also  MatchScope   in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this setting  or  the  In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match only  the  specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide the include  paths
                                                    using JSON Pointer syntax.
                                                    For  example,   "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"] . For  in-
                                                    formation  about this syn-
                                                    tax, see the Internet  En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this  setting  or  the All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't use this  option
                                                        to  include all paths.
                                                        Instead, use  the  All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON body.  The  options  are
                                                 the following:

                                                 o EVALUATE_AS_STRING   -  In-
                                                   spect  the  body  as  plain
                                                   text.  WAF applies the text
                                                   transformations and inspec-
                                                   tion  criteria that you de-
                                                   fined for the JSON  inspec-
                                                   tion   to   the  body  text
                                                   string.

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates  the content only up to
                                                 the  first  parsing   failure
                                                 that it encounters.

                                                 WAF  does  its  best to parse
                                                 the  entire  JSON  body,  but
                                                 might  be  forced to stop for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root  node isn't an object or
                                                 an array.

                                                 WAF parses the  JSON  in  the
                                                 following   examples  as  two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                               ForwardedIPConfig -> (structure)
                                   The configuration  for  inspecting  IP  ad-
                                   dresses in an HTTP header that you specify,
                                   instead of using the IP address that's  re-
                                   ported by the web request origin. Commonly,
                                   this is the X-Forwarded-For  (XFF)  header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the request, WAF doesn't apply the  rule
                                      to the web request at all.

                                   This is required if AggregateKeyType is set
                                   to FORWARDED_IP .

                                   HeaderName -> (string)
                                      The name of the HTTP header to  use  for
                                      the  IP address. For example, to use the
                                      X-Forwarded-For (XFF) header,  set  this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The match status to assign  to  the  web
                                      request  if  the  request doesn't have a
                                      valid IP address in the specified  posi-
                                      tion.

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                      You can specify the  following  fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching the rule statement.  WAF  ap-
                                        plies the rule action to the request.

                                      o NO_MATCH  -  Treat  the web request as
                                        not matching the rule statement.

                            AndStatement -> (structure)
                               A logical rule statement used to combine  other
                               rule  statements  with  AND  logic. You provide
                               more than one  Statement within  the  AndState-
                               ment .

                               Statements -> (list)
                                   The  statements  to combine with AND logic.
                                   You can use  any  statements  that  can  be
                                   nested.

                                   (structure)
                                      The  processing  guidance  for a  Rule ,
                                      used by WAF to determine whether  a  web
                                      request matches the rule.

                                      ByteMatchStatement -> (structure)
                                          A  rule  statement  that  defines  a
                                          string match search for WAF to apply
                                          to  web  requests.  The  byte  match
                                          statement  provides  the  bytes   to
                                          search for, the location in requests
                                          that you want  WAF  to  search,  and
                                          other  settings. The bytes to search
                                          for are typically a string that cor-
                                          responds  with  ASCII characters. In
                                          the WAF console  and  the  developer
                                          guide,  this  is  refered  to  as  a
                                          string match statement.

                                          SearchString -> (blob)
                                             A string value that you want  WAF
                                             to  search for. WAF searches only
                                             in the part of web requests  that
                                             you  designate  for inspection in
                                             FieldToMatch . The maximum length
                                             of the value is 50 bytes.

                                             Valid values depend on the compo-
                                             nent that you specify for inspec-
                                             tion in FieldToMatch :

                                             o Method  :  The HTTP method that
                                               you want  WAF  to  search  for.
                                               This  indicates the type of op-
                                               eration specified  in  the  re-
                                               quest.

                                             o UriPath  :  The  value that you
                                               want WAF to search for  in  the
                                               URI  path,  for  example,  /im-
                                               ages/daily-ad.jpg .

                                             If SearchString  includes  alpha-
                                             betic  characters  A-Z  and  a-z,
                                             note that the value is case  sen-
                                             sitive.
                                                 If you're using the WAF API

                                             Specify  a base64-encoded version
                                             of the value. The maximum  length
                                             of    the    value   before   you
                                             base64-encode it is 50 bytes.

                                             For example, suppose the value of
                                             Type  is  HEADER and the value of
                                             Data is User-Agent . If you  want
                                             to  search  the User-Agent header
                                             for  the  value  BadBot   ,   you
                                             base64-encode  BadBot  using MIME
                                             base64-encoding and  include  the
                                             resulting  value,  QmFkQm90  , in
                                             the value of SearchString .
                                                 If you're using  the  CLI  or
                                                 one  of  the  Amazon Web Ser-
                                                 vices SDKs

                                             The value that you  want  WAF  to
                                             search for. The SDK automatically
                                             base64 encodes the value.

                                          FieldToMatch -> (structure)
                                             The part of a  web  request  that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide  the  name of the header
                                                 to  inspect,   for   example,
                                                 User-Agent  or Referer . This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The   name  of  the  query
                                                    header to inspect.

                                             SingleQueryArgument  ->   (struc-
                                             ture)
                                                 Inspect  a single query argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such as UserName or  SalesRe-
                                                 gion  . The name can be up to
                                                 30 characters long and  isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF   to   inspect,   in  the
                                                 FieldToMatch specification.

                                                 Example  JSON:   "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The name of the query  ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest  that  identifies a re-
                                                 source,  for  example,   /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect   the  query  string.
                                                 This is the  part  of  a  URL
                                                 that  appears after a ? char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect the request  body  as
                                                 plain  text. The request body
                                                 immediately follows  the  re-
                                                 quest  headers.  This  is the
                                                 part of a request  that  con-
                                                 tains   any  additional  data
                                                 that you want to send to your
                                                 web  server  as  the HTTP re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect  the HTTP method. The
                                                 method indicates the type  of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect the request  body  as
                                                 JSON.  The request body imme-
                                                 diately follows  the  request
                                                 headers.  This is the part of
                                                 a request that  contains  any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the  HTTP  request body, such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The patterns to  look  for
                                                    in  the JSON body. WAF in-
                                                    spects  the   results   of
                                                    these    pattern   matches
                                                    against the  rule  inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match  all of the ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match only the  speci-
                                                        fied   include  paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide   the  include
                                                        paths    using    JSON
                                                        Pointer   syntax.  For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"]  . For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force  (IETF) documen-
                                                        tation JavaScript  Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the All  setting,  but
                                                        not both.

                                                        NOTE:
                                                           Don't  use this op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The parts of the  JSON  to
                                                    match  against  using  the
                                                    MatchPattern  .   If   you
                                                    specify  All , WAF matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What  WAF  should do if it
                                                    fails to completely  parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect  the body as plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection to  the  body
                                                      text string.

                                                    o MATCH  -  Treat  the web
                                                      request as matching  the
                                                      rule  statement. WAF ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request as not  matching
                                                      the rule statement.

                                                    If  you don't provide this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up to  the  first  parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the  entire JSON body, but
                                                    might be  forced  to  stop
                                                    for  reasons  such  as in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any  content  whose   root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following  examples as two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. If you  specify  one  or
                                             more  transformations  in  a rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the request component  identified
                                             by  FieldToMatch  , starting from
                                             the lowest priority setting,  be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations  that  are
                                                    defined  for a rule state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est priority  to  highest,
                                                    before    inspecting   the
                                                    transformed  content.  The
                                                    priorities  don't  need to
                                                    be consecutive,  but  they
                                                    must all be different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                          PositionalConstraint -> (string)
                                             The area within the portion of  a
                                             web  request that you want WAF to
                                             search for SearchString  .  Valid
                                             values include the following:
                                                 CONTAINS

                                             The specified part of the web re-
                                             quest must include the  value  of
                                             SearchString  ,  but the location
                                             doesn't matter.
                                                 CONTAINS_WORD

                                             The specified part of the web re-
                                             quest  must  include the value of
                                             SearchString ,  and  SearchString
                                             must  contain  only  alphanumeric
                                             characters  or  underscore  (A-Z,
                                             a-z,  0-9,  or  _).  In addition,
                                             SearchString  must  be  a   word,
                                             which means that both of the fol-
                                             lowing are true:

                                             o SearchString is at  the  begin-
                                               ning  of  the specified part of
                                               the web request or is  preceded
                                               by  a  character  other than an
                                               alphanumeric character  or  un-
                                               derscore  (_). Examples include
                                               the value of a header and ;Bad-
                                               Bot .

                                             o SearchString  is  at the end of
                                               the specified part of  the  web
                                               request  or  is  followed  by a
                                               character  other  than  an  al-
                                               phanumeric  character or under-
                                               score (_), for example, BadBot;
                                               and -BadBot; .
                                                 EXACTLY

                                             The  value  of the specified part
                                             of the web request  must  exactly
                                             match the value of SearchString .
                                                 STARTS_WITH

                                             The  value  of  SearchString must
                                             appear at the  beginning  of  the
                                             specified  part  of  the  web re-
                                             quest.
                                                 ENDS_WITH

                                             The value  of  SearchString  must
                                             appear  at  the end of the speci-
                                             fied part of the web request.

                                      SqliMatchStatement -> (structure)
                                          Attackers sometimes insert malicious
                                          SQL code into web requests in an ef-
                                          fort to extract data from your data-
                                          base. To allow or block web requests
                                          that appear to contain malicious SQL
                                          code,  create one or more SQL injec-
                                          tion match conditions. An SQL injec-
                                          tion  match condition identifies the
                                          part of web requests,  such  as  the
                                          URI  or  the  query string, that you
                                          want WAF to inspect.  Later  in  the
                                          process,  when you create a web ACL,
                                          you  specify  whether  to  allow  or
                                          block  requests  that appear to con-
                                          tain malicious SQL code.

                                          FieldToMatch -> (structure)
                                             The part of a  web  request  that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide  the  name of the header
                                                 to  inspect,   for   example,
                                                 User-Agent  or Referer . This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The   name  of  the  query
                                                    header to inspect.

                                             SingleQueryArgument  ->   (struc-
                                             ture)
                                                 Inspect  a single query argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such as UserName or  SalesRe-
                                                 gion  . The name can be up to
                                                 30 characters long and  isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF   to   inspect,   in  the
                                                 FieldToMatch specification.

                                                 Example  JSON:   "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The name of the query  ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest  that  identifies a re-
                                                 source,  for  example,   /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect   the  query  string.
                                                 This is the  part  of  a  URL
                                                 that  appears after a ? char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect the request  body  as
                                                 plain  text. The request body
                                                 immediately follows  the  re-
                                                 quest  headers.  This  is the
                                                 part of a request  that  con-
                                                 tains   any  additional  data
                                                 that you want to send to your
                                                 web  server  as  the HTTP re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect  the HTTP method. The
                                                 method indicates the type  of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect the request  body  as
                                                 JSON.  The request body imme-
                                                 diately follows  the  request
                                                 headers.  This is the part of
                                                 a request that  contains  any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the  HTTP  request body, such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The patterns to  look  for
                                                    in  the JSON body. WAF in-
                                                    spects  the   results   of
                                                    these    pattern   matches
                                                    against the  rule  inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match  all of the ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match only the  speci-
                                                        fied   include  paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide   the  include
                                                        paths    using    JSON
                                                        Pointer   syntax.  For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"]  . For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force  (IETF) documen-
                                                        tation JavaScript  Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the All  setting,  but
                                                        not both.

                                                        NOTE:
                                                           Don't  use this op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The parts of the  JSON  to
                                                    match  against  using  the
                                                    MatchPattern  .   If   you
                                                    specify  All , WAF matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What  WAF  should do if it
                                                    fails to completely  parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect  the body as plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection to  the  body
                                                      text string.

                                                    o MATCH  -  Treat  the web
                                                      request as matching  the
                                                      rule  statement. WAF ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request as not  matching
                                                      the rule statement.

                                                    If  you don't provide this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up to  the  first  parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the  entire JSON body, but
                                                    might be  forced  to  stop
                                                    for  reasons  such  as in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any  content  whose   root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following  examples as two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. If you  specify  one  or
                                             more  transformations  in  a rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the request component  identified
                                             by  FieldToMatch  , starting from
                                             the lowest priority setting,  be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations  that  are
                                                    defined  for a rule state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est priority  to  highest,
                                                    before    inspecting   the
                                                    transformed  content.  The
                                                    priorities  don't  need to
                                                    be consecutive,  but  they
                                                    must all be different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                      XssMatchStatement -> (structure)
                                          A  rule  statement  that  defines  a
                                          cross-site   scripting  (XSS)  match
                                          search for WAF to apply to  web  re-
                                          quests.  XSS attacks are those where
                                          the attacker uses vulnerabilities in
                                          a benign website as a vehicle to in-
                                          ject malicious  client-site  scripts
                                          into  other legitimate web browsers.
                                          The XSS match statement provides the
                                          location  in  requests that you want
                                          WAF to search and  text  transforma-
                                          tions  to use on the search area be-
                                          fore WAF searches for character  se-
                                          quences  that are likely to be mali-
                                          cious strings.

                                          FieldToMatch -> (structure)
                                             The part of a  web  request  that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide  the  name of the header
                                                 to  inspect,   for   example,
                                                 User-Agent  or Referer . This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The   name  of  the  query
                                                    header to inspect.

                                             SingleQueryArgument  ->   (struc-
                                             ture)
                                                 Inspect  a single query argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such as UserName or  SalesRe-
                                                 gion  . The name can be up to
                                                 30 characters long and  isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF   to   inspect,   in  the
                                                 FieldToMatch specification.

                                                 Example  JSON:   "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The name of the query  ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest  that  identifies a re-
                                                 source,  for  example,   /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect   the  query  string.
                                                 This is the  part  of  a  URL
                                                 that  appears after a ? char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect the request  body  as
                                                 plain  text. The request body
                                                 immediately follows  the  re-
                                                 quest  headers.  This  is the
                                                 part of a request  that  con-
                                                 tains   any  additional  data
                                                 that you want to send to your
                                                 web  server  as  the HTTP re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect  the HTTP method. The
                                                 method indicates the type  of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect the request  body  as
                                                 JSON.  The request body imme-
                                                 diately follows  the  request
                                                 headers.  This is the part of
                                                 a request that  contains  any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the  HTTP  request body, such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The patterns to  look  for
                                                    in  the JSON body. WAF in-
                                                    spects  the   results   of
                                                    these    pattern   matches
                                                    against the  rule  inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match  all of the ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match only the  speci-
                                                        fied   include  paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide   the  include
                                                        paths    using    JSON
                                                        Pointer   syntax.  For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"]  . For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force  (IETF) documen-
                                                        tation JavaScript  Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the All  setting,  but
                                                        not both.

                                                        NOTE:
                                                           Don't  use this op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The parts of the  JSON  to
                                                    match  against  using  the
                                                    MatchPattern  .   If   you
                                                    specify  All , WAF matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What  WAF  should do if it
                                                    fails to completely  parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect  the body as plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection to  the  body
                                                      text string.

                                                    o MATCH  -  Treat  the web
                                                      request as matching  the
                                                      rule  statement. WAF ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request as not  matching
                                                      the rule statement.

                                                    If  you don't provide this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up to  the  first  parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the  entire JSON body, but
                                                    might be  forced  to  stop
                                                    for  reasons  such  as in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any  content  whose   root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following  examples as two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. If you  specify  one  or
                                             more  transformations  in  a rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the request component  identified
                                             by  FieldToMatch  , starting from
                                             the lowest priority setting,  be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations  that  are
                                                    defined  for a rule state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est priority  to  highest,
                                                    before    inspecting   the
                                                    transformed  content.  The
                                                    priorities  don't  need to
                                                    be consecutive,  but  they
                                                    must all be different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                      SizeConstraintStatement -> (structure)
                                          A rule  statement  that  compares  a
                                          number  of bytes against the size of
                                          a request component, using a compar-
                                          ison  operator, such as greater than
                                          (>) or less than (<).  For  example,
                                          you can use a size constraint state-
                                          ment to look for query strings  that
                                          are longer than 100 bytes.

                                          If  you configure WAF to inspect the
                                          request body, WAF inspects only  the
                                          first  8192 bytes (8 KB). If the re-
                                          quest body  for  your  web  requests
                                          never  exceeds  8192  bytes, you can
                                          create a size  constraint  condition
                                          and  block  requests that have a re-
                                          quest body greater than 8192 bytes.

                                          If you choose URI for the  value  of
                                          Part  of  the  request to filter on,
                                          the slash (/) in the URI  counts  as
                                          one  character. For example, the URI
                                          /logo.jpg is nine characters long.

                                          FieldToMatch -> (structure)
                                             The part of a  web  request  that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide  the  name of the header
                                                 to  inspect,   for   example,
                                                 User-Agent  or Referer . This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The   name  of  the  query
                                                    header to inspect.

                                             SingleQueryArgument  ->   (struc-
                                             ture)
                                                 Inspect  a single query argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such as UserName or  SalesRe-
                                                 gion  . The name can be up to
                                                 30 characters long and  isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF   to   inspect,   in  the
                                                 FieldToMatch specification.

                                                 Example  JSON:   "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The name of the query  ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest  that  identifies a re-
                                                 source,  for  example,   /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect   the  query  string.
                                                 This is the  part  of  a  URL
                                                 that  appears after a ? char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect the request  body  as
                                                 plain  text. The request body
                                                 immediately follows  the  re-
                                                 quest  headers.  This  is the
                                                 part of a request  that  con-
                                                 tains   any  additional  data
                                                 that you want to send to your
                                                 web  server  as  the HTTP re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect  the HTTP method. The
                                                 method indicates the type  of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect the request  body  as
                                                 JSON.  The request body imme-
                                                 diately follows  the  request
                                                 headers.  This is the part of
                                                 a request that  contains  any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the  HTTP  request body, such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The patterns to  look  for
                                                    in  the JSON body. WAF in-
                                                    spects  the   results   of
                                                    these    pattern   matches
                                                    against the  rule  inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match  all of the ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match only the  speci-
                                                        fied   include  paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide   the  include
                                                        paths    using    JSON
                                                        Pointer   syntax.  For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"]  . For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force  (IETF) documen-
                                                        tation JavaScript  Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the All  setting,  but
                                                        not both.

                                                        NOTE:
                                                           Don't  use this op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The parts of the  JSON  to
                                                    match  against  using  the
                                                    MatchPattern  .   If   you
                                                    specify  All , WAF matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What  WAF  should do if it
                                                    fails to completely  parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect  the body as plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection to  the  body
                                                      text string.

                                                    o MATCH  -  Treat  the web
                                                      request as matching  the
                                                      rule  statement. WAF ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request as not  matching
                                                      the rule statement.

                                                    If  you don't provide this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up to  the  first  parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the  entire JSON body, but
                                                    might be  forced  to  stop
                                                    for  reasons  such  as in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any  content  whose   root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following  examples as two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          ComparisonOperator -> (string)
                                             The operator to  use  to  compare
                                             the request part to the size set-
                                             ting.

                                          Size -> (long)
                                             The size, in byte, to compare  to
                                             the   request   part,  after  any
                                             transformations.

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. If you  specify  one  or
                                             more  transformations  in  a rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the request component  identified
                                             by  FieldToMatch  , starting from
                                             the lowest priority setting,  be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations  that  are
                                                    defined  for a rule state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est priority  to  highest,
                                                    before    inspecting   the
                                                    transformed  content.  The
                                                    priorities  don't  need to
                                                    be consecutive,  but  they
                                                    must all be different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                      GeoMatchStatement -> (structure)
                                          A rule statement  used  to  identify
                                          web  requests  based  on  country of
                                          origin.

                                          CountryCodes -> (list)
                                             An array of two-character country
                                             codes,  for example, [ "US", "CN"
                                             ] , from the alpha-2 country  ISO
                                             codes  of  the  ISO 3166 interna-
                                             tional standard.

                                             (string)

                                          ForwardedIPConfig -> (structure)
                                             The configuration for  inspecting
                                             IP  addresses  in  an HTTP header
                                             that you specify, instead of  us-
                                             ing  the  IP  address  that's re-
                                             ported by the web request origin.
                                             Commonly,   this  is  the  X-For-
                                             warded-For (XFF) header, but  you
                                             can specify any header name.

                                             NOTE:
                                                 If the specified header isn't
                                                 present in the  request,  WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             HeaderName -> (string)
                                                 The name of the  HTTP  header
                                                 to  use  for  the IP address.
                                                 For  example,  to   use   the
                                                 X-Forwarded-For (XFF) header,
                                                 set this to X-Forwarded-For .

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't  present  in the re-
                                                    quest, WAF  doesn't  apply
                                                    the  rule  to  the web re-
                                                    quest at all.

                                             FallbackBehavior -> (string)
                                                 The match status to assign to
                                                 the  web  request  if the re-
                                                 quest doesn't have a valid IP
                                                 address  in the specified po-
                                                 sition.

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't  present  in the re-
                                                    quest, WAF  doesn't  apply
                                                    the  rule  to  the web re-
                                                    quest at all.

                                                 You can specify the following
                                                 fallback behaviors:

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                      RuleGroupReferenceStatement  ->  (struc-
                                      ture)
                                          A  rule  statement  used  to run the
                                          rules that are defined in  a   Rule-
                                          Group  .  To use this, create a rule
                                          group with your rules, then  provide
                                          the  ARN  of  the rule group in this
                                          statement.

                                          You cannot  nest  a  RuleGroupRefer-
                                          enceStatement  , for example for use
                                          inside a NotStatement or OrStatement
                                          . You can only use a rule group ref-
                                          erence statement at  the  top  level
                                          inside a web ACL.

                                          ARN -> (string)
                                             The Amazon Resource Name (ARN) of
                                             the entity.

                                          ExcludedRules -> (list)
                                             The rules in the referenced  rule
                                             group  whose  actions  are set to
                                             Count . When you exclude a  rule,
                                             WAF  evaluates  it  exactly as it
                                             would if the rule action  setting
                                             were Count . This is a useful op-
                                             tion for testing the rules  in  a
                                             rule  group without modifying how
                                             they handle your web traffic.

                                             (structure)
                                                 Specifies a single rule in  a
                                                 rule  group  whose action you
                                                 want to override to  Count  .
                                                 When  you exclude a rule, WAF
                                                 evaluates it  exactly  as  it
                                                 would if the rule action set-
                                                 ting were Count . This  is  a
                                                 useful option for testing the
                                                 rules in a rule group without
                                                 modifying   how  they  handle
                                                 your web traffic.

                                                 Name -> (string)
                                                    The name of the rule whose
                                                    action  you  want to over-
                                                    ride to Count .

                                      IPSetReferenceStatement -> (structure)
                                          A rule statement used to detect  web
                                          requests  coming  from particular IP
                                          addresses or address ranges. To  use
                                          this,  create  an  IPSet that speci-
                                          fies the addresses you want  to  de-
                                          tect,  then  use the ARN of that set
                                          in this statement. To create  an  IP
                                          set, see  CreateIPSet .

                                          Each  IP  set  rule statement refer-
                                          ences an  IP  set.  You  create  and
                                          maintain the set independent of your
                                          rules. This allows you  to  use  the
                                          single  set  in multiple rules. When
                                          you update the referenced  set,  WAF
                                          automatically updates all rules that
                                          reference it.

                                          ARN -> (string)
                                             The Amazon Resource Name (ARN) of
                                             the   IPSet  that  this statement
                                             references.

                                          IPSetForwardedIPConfig  ->   (struc-
                                          ture)
                                             The  configuration for inspecting
                                             IP addresses in  an  HTTP  header
                                             that  you specify, instead of us-
                                             ing the  IP  address  that's  re-
                                             ported by the web request origin.
                                             Commonly,  this  is  the   X-For-
                                             warded-For  (XFF) header, but you
                                             can specify any header name.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             HeaderName -> (string)
                                                 The  name  of the HTTP header
                                                 to use for  the  IP  address.
                                                 For   example,   to  use  the
                                                 X-Forwarded-For (XFF) header,
                                                 set this to X-Forwarded-For .

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't present in  the  re-
                                                    quest,  WAF  doesn't apply
                                                    the rule to  the  web  re-
                                                    quest at all.

                                             FallbackBehavior -> (string)
                                                 The match status to assign to
                                                 the web request  if  the  re-
                                                 quest doesn't have a valid IP
                                                 address in the specified  po-
                                                 sition.

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't present in  the  re-
                                                    quest,  WAF  doesn't apply
                                                    the rule to  the  web  re-
                                                    quest at all.

                                                 You can specify the following
                                                 fallback behaviors:

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                             Position -> (string)
                                                 The position in the header to
                                                 search for  the  IP  address.
                                                 The header can contain IP ad-
                                                 dresses   of   the   original
                                                 client  and  also of proxies.
                                                 For example, the header value
                                                 could be 10.1.1.1, 127.0.0.0,
                                                 10.10.10.10 where  the  first
                                                 IP   address  identifies  the
                                                 original client and the  rest
                                                 identify proxies that the re-
                                                 quest went through.

                                                 The options for this  setting
                                                 are the following:

                                                 o FIRST  -  Inspect the first
                                                   IP address in the  list  of
                                                   IP addresses in the header.
                                                   This   is    usually    the
                                                   client's original IP.

                                                 o LAST  - Inspect the last IP
                                                   address in the list  of  IP
                                                   addresses in the header.

                                                 o ANY  -  Inspect  all IP ad-
                                                   dresses in the header for a
                                                   match.  If  the header con-
                                                   tains more than 10  IP  ad-
                                                   dresses,  WAF  inspects the
                                                   last 10.

                                      RegexPatternSetReferenceStatement     ->
                                      (structure)
                                          A  rule statement used to search web
                                          request components for matches  with
                                          regular  expressions.  To  use this,
                                          create a  RegexPatternSet that spec-
                                          ifies  the expressions that you want
                                          to detect, then use the ARN of  that
                                          set in this statement. A web request
                                          matches the pattern set rule  state-
                                          ment   if   the   request  component
                                          matches any of the patterns  in  the
                                          set.  To create a regex pattern set,
                                          see  CreateRegexPatternSet .

                                          Each regex pattern set  rule  state-
                                          ment references a regex pattern set.
                                          You create and maintain the set  in-
                                          dependent of your rules. This allows
                                          you to use the single set in  multi-
                                          ple  rules. When you update the ref-
                                          erenced set, WAF  automatically  up-
                                          dates all rules that reference it.

                                          ARN -> (string)
                                             The Amazon Resource Name (ARN) of
                                             the   RegexPatternSet  that  this
                                             statement references.

                                          FieldToMatch -> (structure)
                                             The  part  of  a web request that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide the name of  the  header
                                                 to   inspect,   for  example,
                                                 User-Agent or Referer .  This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The  name  of  the   query
                                                    header to inspect.

                                             SingleQueryArgument   ->  (struc-
                                             ture)
                                                 Inspect a single query  argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such  as UserName or SalesRe-
                                                 gion . The name can be up  to
                                                 30  characters long and isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF  to   inspect,   in   the
                                                 FieldToMatch specification.

                                                 Example   JSON:  "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The  name of the query ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest that identifies  a  re-
                                                 source,   for  example,  /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect  the  query   string.
                                                 This  is  the  part  of a URL
                                                 that appears after a ?  char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect  the  request body as
                                                 plain text. The request  body
                                                 immediately  follows  the re-
                                                 quest headers.  This  is  the
                                                 part  of  a request that con-
                                                 tains  any  additional   data
                                                 that you want to send to your
                                                 web server as  the  HTTP  re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect the HTTP method.  The
                                                 method  indicates the type of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect  the  request body as
                                                 JSON. The request body  imme-
                                                 diately  follows  the request
                                                 headers. This is the part  of
                                                 a  request  that contains any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the HTTP request  body,  such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The  patterns  to look for
                                                    in the JSON body. WAF  in-
                                                    spects   the   results  of
                                                    these   pattern    matches
                                                    against  the  rule inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match all of the  ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match  only the speci-
                                                        fied  include   paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide  the   include
                                                        paths    using    JSON
                                                        Pointer  syntax.   For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"] .  For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force (IETF)  documen-
                                                        tation  JavaScript Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the  All  setting, but
                                                        not both.

                                                        NOTE:
                                                           Don't use this  op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The  parts  of the JSON to
                                                    match  against  using  the
                                                    MatchPattern   .   If  you
                                                    specify All , WAF  matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What WAF should do  if  it
                                                    fails  to completely parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect the body as  plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection  to  the body
                                                      text string.

                                                    o MATCH -  Treat  the  web
                                                      request  as matching the
                                                      rule statement. WAF  ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request  as not matching
                                                      the rule statement.

                                                    If you don't provide  this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up  to  the  first parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the entire JSON body,  but
                                                    might  be  forced  to stop
                                                    for reasons  such  as  in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any   content  whose  root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following examples as  two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.  If  you  specify one or
                                             more transformations  in  a  rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the  request component identified
                                             by FieldToMatch ,  starting  from
                                             the  lowest priority setting, be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web requests in an effort  to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing  order  for   multiple
                                                    transformations  that  are
                                                    defined for a rule  state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est  priority  to highest,
                                                    before   inspecting    the
                                                    transformed  content.  The
                                                    priorities don't  need  to
                                                    be  consecutive,  but they
                                                    must all be different.

                                                 Type -> (string)
                                                    You can specify  the  fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a    Base64   -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode  a  Base64 -en-
                                                        coded string, but  use
                                                        a  forgiving implemen-
                                                        tation  that   ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE    -     Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness of  attackers
                                                        who  inject an operat-
                                                        ing    system     com-
                                                        mand-line  command and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following characters:  /
                                                      (

                                                    o Replace   the  following
                                                      characters with a space:
                                                      , ;

                                                    o Replace  multiple spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters  (A-Z) to lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace  these charac-
                                                        ters  with   a   space
                                                        character     (decimal
                                                        32):

                                                    o \f ,  formfeed,  decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE  -   Decode
                                                        characters  that  were
                                                        encoded using CSS  2.x
                                                        escape    rules   syn-
                                                        data.html#characters .
                                                        This  function uses up
                                                        to two  bytes  in  the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII  characters that
                                                        were encoded using CSS
                                                        encoding  that wouldnt
                                                        typically be  encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of  a  backslash   and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript  for java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI  C   escape   se-
                                                        quences:  \a , \b , \f
                                                        , \n , \r , \t , \v  ,
                                                        \\  ,  \?  , \' , \" ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO  (octal). Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE  - Decode a
                                                        string of  hexadecimal
                                                        characters  into a bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters with  unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs  these opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;    with     a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with  a "less than" sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal  format, (amper-
                                                      sand)#xhhhh; , with  the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal    format,   (amper-
                                                      sand)#nnnn; ,  with  the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript escape  se-
                                                        quences.  If  a  \   u
                                                        HHHH code  is  in  the
                                                        full-width  ASCII code
                                                        range of  FF01-FF5E  ,
                                                        then  the  higher byte
                                                        is used to detect  and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte  is  used and the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE  -   Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash from the data  in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you  don't  want   any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are not at the  begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This  is  the  same as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash  characters   to
                                                        forward slashes.

                                                        REMOVE_NULLS  - Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place each  occurrence
                                                        of  a  C-style comment
                                                        (/* ... */  )  with  a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments  are also re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a standalone  termina-
                                                        tion  of a comment (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS  -   Re-
                                                        place  NULL  bytes  in
                                                        the input  with  space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE  - Decode a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI -  Like
                                                        URL_DECODE  , but with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in    the   full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and  adjust  the lower
                                                        byte. Otherwise,  only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter  sequences to Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives  and false-nega-
                                                        tives for  non-English
                                                        languages.

                                      RateBasedStatement -> (structure)
                                          A rate-based rule tracks the rate of
                                          requests for each originating IP ad-
                                          dress,  and triggers the rule action
                                          when the rate exceeds a  limit  that
                                          you  specify  on  the  number of re-
                                          quests in any  5-minute  time  span.
                                          You  can use this to put a temporary
                                          block on requests from an IP address
                                          that is sending excessive requests.

                                          WAF  tracks and manages web requests
                                          separately for each  instance  of  a
                                          rate-based  rule  that  you use. For
                                          example, if  you  provide  the  same
                                          rate-based  rule settings in two web
                                          ACLs, each of the  two  rule  state-
                                          ments represents a separate instance
                                          of the rate-based rule and gets  its
                                          own  tracking and management by WAF.
                                          If you define a rate-based rule  in-
                                          side a rule group, and then use that
                                          rule group in multiple places,  each
                                          use  creates  a separate instance of
                                          the rate-based rule  that  gets  its
                                          own tracking and management by WAF.

                                          When  the  rule action triggers, WAF
                                          blocks additional requests from  the
                                          IP  address  until  the request rate
                                          falls below the limit.

                                          You  can  optionally  nest   another
                                          statement   inside   the  rate-based
                                          statement, to narrow  the  scope  of
                                          the  rule so that it only counts re-
                                          quests that match the nested  state-
                                          ment.  For  example, based on recent
                                          requests that you have seen from  an
                                          attacker,   you   might   create   a
                                          rate-based rule with  a  nested  AND
                                          rule  statement  that  contains  the
                                          following nested statements:

                                          o An IP match statement with  an  IP
                                            set  that  specified  the  address
                                            192.0.2.44.

                                          o A  string  match  statement   that
                                            searches  in the User-Agent header
                                            for the string BadBot.

                                          In this rate-based  rule,  you  also
                                          define  a rate limit. For this exam-
                                          ple, the rate limit  is  1,000.  Re-
                                          quests  that meet both of the condi-
                                          tions in the statements are counted.
                                          If  the count exceeds 1,000 requests
                                          per five minutes,  the  rule  action
                                          triggers.  Requests that do not meet
                                          both conditions are not counted  to-
                                          wards the rate limit and are not af-
                                          fected by this rule.

                                          You cannot nest a RateBasedStatement
                                          inside  another statement, for exam-
                                          ple   inside   a   NotStatement   or
                                          OrStatement . You can define a Rate-
                                          BasedStatement inside a web ACL  and
                                          inside a rule group.

                                          Limit -> (long)
                                             The   limit   on   requests   per
                                             5-minute  period  for  a   single
                                             originating  IP  address.  If the
                                             statement includes  a  ScopeDown-
                                             Statement , this limit is applied
                                             only to the requests  that  match
                                             the statement.

                                          AggregateKeyType -> (string)
                                             Setting that indicates how to ag-
                                             gregate the request  counts.  The
                                             options are the following:

                                             o IP   -  Aggregate  the  request
                                               counts on the IP  address  from
                                               the web request origin.

                                             o FORWARDED_IP  -  Aggregate  the
                                               request counts on the first  IP
                                               address  in  an HTTP header. If
                                               you  use  this,  configure  the
                                               ForwardedIPConfig  , to specify
                                               the header to use.

                                          ( ... recursive ... )ForwardedIPCon-
                                          fig -> (structure)
                                             The  configuration for inspecting
                                             IP addresses in  an  HTTP  header
                                             that  you specify, instead of us-
                                             ing the  IP  address  that's  re-
                                             ported by the web request origin.
                                             Commonly,  this  is  the   X-For-
                                             warded-For  (XFF) header, but you
                                             can specify any header name.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             This is required if AggregateKey-
                                             Type is set to FORWARDED_IP .

                                             HeaderName -> (string)
                                                 The name of the  HTTP  header
                                                 to  use  for  the IP address.
                                                 For  example,  to   use   the
                                                 X-Forwarded-For (XFF) header,
                                                 set this to X-Forwarded-For .

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't  present  in the re-
                                                    quest, WAF  doesn't  apply
                                                    the  rule  to  the web re-
                                                    quest at all.

                                             FallbackBehavior -> (string)
                                                 The match status to assign to
                                                 the  web  request  if the re-
                                                 quest doesn't have a valid IP
                                                 address  in the specified po-
                                                 sition.

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't  present  in the re-
                                                    quest, WAF  doesn't  apply
                                                    the  rule  to  the web re-
                                                    quest at all.

                                                 You can specify the following
                                                 fallback behaviors:

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                      AndStatement -> (structure)
                                          A logical  rule  statement  used  to
                                          combine  other  rule statements with
                                          AND logic. You provide more than one
                                          Statement within the AndStatement .

                                          Statements -> (list)
                                             The  statements  to  combine with
                                             AND logic. You can use any state-
                                             ments that can be nested.

                                             ( ... recursive ... )

                                      OrStatement -> (structure)
                                          A  logical  rule  statement  used to
                                          combine other rule  statements  with
                                          OR  logic. You provide more than one
                                          Statement within the OrStatement .

                                          Statements -> (list)
                                             The statements to combine with OR
                                             logic. You can use any statements
                                             that can be nested.

                                             ( ... recursive ... )

                                      NotStatement -> (structure)
                                          A logical  rule  statement  used  to
                                          negate  the  results of another rule
                                          statement. You provide  one   State-
                                          ment within the NotStatement .

                                          ( ... recursive ... )

                                      ManagedRuleGroupStatement -> (structure)
                                          A  rule  statement  used  to run the
                                          rules that are defined in a  managed
                                          rule group. To use this, provide the
                                          vendor name and the name of the rule
                                          group in this statement. You can re-
                                          trieve the required names by calling
                                          ListAvailableManagedRuleGroups .

                                          You  cannot nest a ManagedRuleGroup-
                                          Statement , for example for use  in-
                                          side a NotStatement or OrStatement .
                                          It  can  only  be  referenced  as  a
                                          top-level statement within a rule.

                                          VendorName -> (string)
                                             The  name  of  the  managed  rule
                                             group vendor. You use this, along
                                             with  the  rule  group  name,  to
                                             identify the rule group.

                                          Name -> (string)
                                             The  name  of  the  managed  rule
                                             group.  You  use this, along with
                                             the vendor name, to identify  the
                                             rule group.

                                          Version -> (string)
                                             The  version  of the managed rule
                                             group  to  use.  If  you  specify
                                             this,   the  version  setting  is
                                             fixed until you change it. If you
                                             don't  specify this, WAF uses the
                                             vendor's  default  version,   and
                                             then  keeps  the  version  at the
                                             vendor's default when the  vendor
                                             updates  the  managed  rule group
                                             settings.

                                          ExcludedRules -> (list)
                                             The rules in the referenced  rule
                                             group  whose  actions  are set to
                                             Count . When you exclude a  rule,
                                             WAF  evaluates  it  exactly as it
                                             would if the rule action  setting
                                             were Count . This is a useful op-
                                             tion for testing the rules  in  a
                                             rule  group without modifying how
                                             they handle your web traffic.

                                             (structure)
                                                 Specifies a single rule in  a
                                                 rule  group  whose action you
                                                 want to override to  Count  .
                                                 When  you exclude a rule, WAF
                                                 evaluates it  exactly  as  it
                                                 would if the rule action set-
                                                 ting were Count . This  is  a
                                                 useful option for testing the
                                                 rules in a rule group without
                                                 modifying   how  they  handle
                                                 your web traffic.

                                                 Name -> (string)
                                                    The name of the rule whose
                                                    action  you  want to over-
                                                    ride to Count .

                                          ( ... recursive ... )

                                      LabelMatchStatement -> (structure)
                                          A  rule  statement  that  defines  a
                                          string  match  search against labels
                                          that have been added to the web  re-
                                          quest by rules that have already run
                                          in the web ACL.

                                          The label match  statement  provides
                                          the  label  or  namespace  string to
                                          search for.  The  label  string  can
                                          represent a part or all of the fully
                                          qualified label name that  had  been
                                          added  to  the  web  request.  Fully
                                          qualified labels have a prefix,  op-
                                          tional  namespaces,  and label name.
                                          The prefix identifies the rule group
                                          or  web ACL context of the rule that
                                          added the label. If you do not  pro-
                                          vide  the  fully  qualified  name in
                                          your label match  string,  WAF  per-
                                          forms  the  search  for  labels that
                                          were added in the  same  context  as
                                          the label match statement.

                                          Scope -> (string)
                                             Specify whether you want to match
                                             using the label name or just  the
                                             namespace.

                                          Key -> (string)
                                             The  string to match against. The
                                             setting you provide for this  de-
                                             pends  on  the  match statement's
                                             Scope setting:

                                             o If the Scope indicates LABEL  ,
                                               then  this  specification  must
                                               include the name  and  can  in-
                                               clude  any  number of preceding
                                               namespace  specifications   and
                                               prefix   up  to  providing  the
                                               fully qualified label name.

                                             o If the  Scope  indicates  NAME-
                                               SPACE , then this specification
                                               can include any number of  con-
                                               tiguous  namespace strings, and
                                               can include  the  entire  label
                                               namespace  prefix from the rule
                                               group or web ACL where the  la-
                                               bel originates.

                                             Labels  are  case  sensitive  and
                                             components of  a  label  must  be
                                             separated  by  colon, for example
                                             NS1:NS2:name .

                                      RegexMatchStatement -> (structure)
                                          A rule statement used to search  web
                                          request   components   for  a  match
                                          against a single regular expression.

                                          RegexString -> (string)
                                             The string representing the regu-
                                             lar expression.

                                          FieldToMatch -> (structure)
                                             The  part  of  a web request that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide the name of  the  header
                                                 to   inspect,   for  example,
                                                 User-Agent or Referer .  This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The  name  of  the   query
                                                    header to inspect.

                                             SingleQueryArgument   ->  (struc-
                                             ture)
                                                 Inspect a single query  argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such  as UserName or SalesRe-
                                                 gion . The name can be up  to
                                                 30  characters long and isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF  to   inspect,   in   the
                                                 FieldToMatch specification.

                                                 Example   JSON:  "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The  name of the query ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest that identifies  a  re-
                                                 source,   for  example,  /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect  the  query   string.
                                                 This  is  the  part  of a URL
                                                 that appears after a ?  char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect  the  request body as
                                                 plain text. The request  body
                                                 immediately  follows  the re-
                                                 quest headers.  This  is  the
                                                 part  of  a request that con-
                                                 tains  any  additional   data
                                                 that you want to send to your
                                                 web server as  the  HTTP  re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect the HTTP method.  The
                                                 method  indicates the type of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect  the  request body as
                                                 JSON. The request body  imme-
                                                 diately  follows  the request
                                                 headers. This is the part  of
                                                 a  request  that contains any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the HTTP request  body,  such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The  patterns  to look for
                                                    in the JSON body. WAF  in-
                                                    spects   the   results  of
                                                    these   pattern    matches
                                                    against  the  rule inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match all of the  ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match  only the speci-
                                                        fied  include   paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide  the   include
                                                        paths    using    JSON
                                                        Pointer  syntax.   For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"] .  For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force (IETF)  documen-
                                                        tation  JavaScript Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the  All  setting, but
                                                        not both.

                                                        NOTE:
                                                           Don't use this  op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The  parts  of the JSON to
                                                    match  against  using  the
                                                    MatchPattern   .   If  you
                                                    specify All , WAF  matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What WAF should do  if  it
                                                    fails  to completely parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect the body as  plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection  to  the body
                                                      text string.

                                                    o MATCH -  Treat  the  web
                                                      request  as matching the
                                                      rule statement. WAF  ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request  as not matching
                                                      the rule statement.

                                                    If you don't provide  this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up  to  the  first parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the entire JSON body,  but
                                                    might  be  forced  to stop
                                                    for reasons  such  as  in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any   content  whose  root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following examples as  two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.  If  you  specify one or
                                             more transformations  in  a  rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the  request component identified
                                             by FieldToMatch ,  starting  from
                                             the  lowest priority setting, be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web requests in an effort  to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing  order  for   multiple
                                                    transformations  that  are
                                                    defined for a rule  state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est  priority  to highest,
                                                    before   inspecting    the
                                                    transformed  content.  The
                                                    priorities don't  need  to
                                                    be  consecutive,  but they
                                                    must all be different.

                                                 Type -> (string)
                                                    You can specify  the  fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a    Base64   -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode  a  Base64 -en-
                                                        coded string, but  use
                                                        a  forgiving implemen-
                                                        tation  that   ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE    -     Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness of  attackers
                                                        who  inject an operat-
                                                        ing    system     com-
                                                        mand-line  command and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following characters:  /
                                                      (

                                                    o Replace   the  following
                                                      characters with a space:
                                                      , ;

                                                    o Replace  multiple spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters  (A-Z) to lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace  these charac-
                                                        ters  with   a   space
                                                        character     (decimal
                                                        32):

                                                    o \f ,  formfeed,  decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE  -   Decode
                                                        characters  that  were
                                                        encoded using CSS  2.x
                                                        escape    rules   syn-
                                                        data.html#characters .
                                                        This  function uses up
                                                        to two  bytes  in  the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII  characters that
                                                        were encoded using CSS
                                                        encoding  that wouldnt
                                                        typically be  encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of  a  backslash   and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript  for java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI  C   escape   se-
                                                        quences:  \a , \b , \f
                                                        , \n , \r , \t , \v  ,
                                                        \\  ,  \?  , \' , \" ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO  (octal). Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE  - Decode a
                                                        string of  hexadecimal
                                                        characters  into a bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters with  unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs  these opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;    with     a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with  a "less than" sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal  format, (amper-
                                                      sand)#xhhhh; , with  the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal    format,   (amper-
                                                      sand)#nnnn; ,  with  the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript escape  se-
                                                        quences.  If  a  \   u
                                                        HHHH code  is  in  the
                                                        full-width  ASCII code
                                                        range of  FF01-FF5E  ,
                                                        then  the  higher byte
                                                        is used to detect  and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte  is  used and the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE  -   Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash from the data  in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you  don't  want   any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are not at the  begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This  is  the  same as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash  characters   to
                                                        forward slashes.

                                                        REMOVE_NULLS  - Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place each  occurrence
                                                        of  a  C-style comment
                                                        (/* ... */  )  with  a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments  are also re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a standalone  termina-
                                                        tion  of a comment (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS  -   Re-
                                                        place  NULL  bytes  in
                                                        the input  with  space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE  - Decode a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI -  Like
                                                        URL_DECODE  , but with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in    the   full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and  adjust  the lower
                                                        byte. Otherwise,  only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter  sequences to Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives  and false-nega-
                                                        tives for  non-English
                                                        languages.

                            OrStatement -> (structure)
                               A  logical rule statement used to combine other
                               rule statements with OR logic. You provide more
                               than one  Statement within the OrStatement .

                               Statements -> (list)
                                   The  statements  to  combine with OR logic.
                                   You can use  any  statements  that  can  be
                                   nested.

                                   (structure)
                                      The  processing  guidance  for a  Rule ,
                                      used by WAF to determine whether  a  web
                                      request matches the rule.

                                      ByteMatchStatement -> (structure)
                                          A  rule  statement  that  defines  a
                                          string match search for WAF to apply
                                          to  web  requests.  The  byte  match
                                          statement  provides  the  bytes   to
                                          search for, the location in requests
                                          that you want  WAF  to  search,  and
                                          other  settings. The bytes to search
                                          for are typically a string that cor-
                                          responds  with  ASCII characters. In
                                          the WAF console  and  the  developer
                                          guide,  this  is  refered  to  as  a
                                          string match statement.

                                          SearchString -> (blob)
                                             A string value that you want  WAF
                                             to  search for. WAF searches only
                                             in the part of web requests  that
                                             you  designate  for inspection in
                                             FieldToMatch . The maximum length
                                             of the value is 50 bytes.

                                             Valid values depend on the compo-
                                             nent that you specify for inspec-
                                             tion in FieldToMatch :

                                             o Method  :  The HTTP method that
                                               you want  WAF  to  search  for.
                                               This  indicates the type of op-
                                               eration specified  in  the  re-
                                               quest.

                                             o UriPath  :  The  value that you
                                               want WAF to search for  in  the
                                               URI  path,  for  example,  /im-
                                               ages/daily-ad.jpg .

                                             If SearchString  includes  alpha-
                                             betic  characters  A-Z  and  a-z,
                                             note that the value is case  sen-
                                             sitive.
                                                 If you're using the WAF API

                                             Specify  a base64-encoded version
                                             of the value. The maximum  length
                                             of    the    value   before   you
                                             base64-encode it is 50 bytes.

                                             For example, suppose the value of
                                             Type  is  HEADER and the value of
                                             Data is User-Agent . If you  want
                                             to  search  the User-Agent header
                                             for  the  value  BadBot   ,   you
                                             base64-encode  BadBot  using MIME
                                             base64-encoding and  include  the
                                             resulting  value,  QmFkQm90  , in
                                             the value of SearchString .
                                                 If you're using  the  CLI  or
                                                 one  of  the  Amazon Web Ser-
                                                 vices SDKs

                                             The value that you  want  WAF  to
                                             search for. The SDK automatically
                                             base64 encodes the value.

                                          FieldToMatch -> (structure)
                                             The part of a  web  request  that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide  the  name of the header
                                                 to  inspect,   for   example,
                                                 User-Agent  or Referer . This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The   name  of  the  query
                                                    header to inspect.

                                             SingleQueryArgument  ->   (struc-
                                             ture)
                                                 Inspect  a single query argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such as UserName or  SalesRe-
                                                 gion  . The name can be up to
                                                 30 characters long and  isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF   to   inspect,   in  the
                                                 FieldToMatch specification.

                                                 Example  JSON:   "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The name of the query  ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest  that  identifies a re-
                                                 source,  for  example,   /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect   the  query  string.
                                                 This is the  part  of  a  URL
                                                 that  appears after a ? char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect the request  body  as
                                                 plain  text. The request body
                                                 immediately follows  the  re-
                                                 quest  headers.  This  is the
                                                 part of a request  that  con-
                                                 tains   any  additional  data
                                                 that you want to send to your
                                                 web  server  as  the HTTP re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect  the HTTP method. The
                                                 method indicates the type  of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect the request  body  as
                                                 JSON.  The request body imme-
                                                 diately follows  the  request
                                                 headers.  This is the part of
                                                 a request that  contains  any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the  HTTP  request body, such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The patterns to  look  for
                                                    in  the JSON body. WAF in-
                                                    spects  the   results   of
                                                    these    pattern   matches
                                                    against the  rule  inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match  all of the ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match only the  speci-
                                                        fied   include  paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide   the  include
                                                        paths    using    JSON
                                                        Pointer   syntax.  For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"]  . For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force  (IETF) documen-
                                                        tation JavaScript  Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the All  setting,  but
                                                        not both.

                                                        NOTE:
                                                           Don't  use this op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The parts of the  JSON  to
                                                    match  against  using  the
                                                    MatchPattern  .   If   you
                                                    specify  All , WAF matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What  WAF  should do if it
                                                    fails to completely  parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect  the body as plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection to  the  body
                                                      text string.

                                                    o MATCH  -  Treat  the web
                                                      request as matching  the
                                                      rule  statement. WAF ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request as not  matching
                                                      the rule statement.

                                                    If  you don't provide this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up to  the  first  parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the  entire JSON body, but
                                                    might be  forced  to  stop
                                                    for  reasons  such  as in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any  content  whose   root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following  examples as two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. If you  specify  one  or
                                             more  transformations  in  a rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the request component  identified
                                             by  FieldToMatch  , starting from
                                             the lowest priority setting,  be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations  that  are
                                                    defined  for a rule state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est priority  to  highest,
                                                    before    inspecting   the
                                                    transformed  content.  The
                                                    priorities  don't  need to
                                                    be consecutive,  but  they
                                                    must all be different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                          PositionalConstraint -> (string)
                                             The area within the portion of  a
                                             web  request that you want WAF to
                                             search for SearchString  .  Valid
                                             values include the following:
                                                 CONTAINS

                                             The specified part of the web re-
                                             quest must include the  value  of
                                             SearchString  ,  but the location
                                             doesn't matter.
                                                 CONTAINS_WORD

                                             The specified part of the web re-
                                             quest  must  include the value of
                                             SearchString ,  and  SearchString
                                             must  contain  only  alphanumeric
                                             characters  or  underscore  (A-Z,
                                             a-z,  0-9,  or  _).  In addition,
                                             SearchString  must  be  a   word,
                                             which means that both of the fol-
                                             lowing are true:

                                             o SearchString is at  the  begin-
                                               ning  of  the specified part of
                                               the web request or is  preceded
                                               by  a  character  other than an
                                               alphanumeric character  or  un-
                                               derscore  (_). Examples include
                                               the value of a header and ;Bad-
                                               Bot .

                                             o SearchString  is  at the end of
                                               the specified part of  the  web
                                               request  or  is  followed  by a
                                               character  other  than  an  al-
                                               phanumeric  character or under-
                                               score (_), for example, BadBot;
                                               and -BadBot; .
                                                 EXACTLY

                                             The  value  of the specified part
                                             of the web request  must  exactly
                                             match the value of SearchString .
                                                 STARTS_WITH

                                             The  value  of  SearchString must
                                             appear at the  beginning  of  the
                                             specified  part  of  the  web re-
                                             quest.
                                                 ENDS_WITH

                                             The value  of  SearchString  must
                                             appear  at  the end of the speci-
                                             fied part of the web request.

                                      SqliMatchStatement -> (structure)
                                          Attackers sometimes insert malicious
                                          SQL code into web requests in an ef-
                                          fort to extract data from your data-
                                          base. To allow or block web requests
                                          that appear to contain malicious SQL
                                          code,  create one or more SQL injec-
                                          tion match conditions. An SQL injec-
                                          tion  match condition identifies the
                                          part of web requests,  such  as  the
                                          URI  or  the  query string, that you
                                          want WAF to inspect.  Later  in  the
                                          process,  when you create a web ACL,
                                          you  specify  whether  to  allow  or
                                          block  requests  that appear to con-
                                          tain malicious SQL code.

                                          FieldToMatch -> (structure)
                                             The part of a  web  request  that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide  the  name of the header
                                                 to  inspect,   for   example,
                                                 User-Agent  or Referer . This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The   name  of  the  query
                                                    header to inspect.

                                             SingleQueryArgument  ->   (struc-
                                             ture)
                                                 Inspect  a single query argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such as UserName or  SalesRe-
                                                 gion  . The name can be up to
                                                 30 characters long and  isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF   to   inspect,   in  the
                                                 FieldToMatch specification.

                                                 Example  JSON:   "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The name of the query  ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest  that  identifies a re-
                                                 source,  for  example,   /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect   the  query  string.
                                                 This is the  part  of  a  URL
                                                 that  appears after a ? char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect the request  body  as
                                                 plain  text. The request body
                                                 immediately follows  the  re-
                                                 quest  headers.  This  is the
                                                 part of a request  that  con-
                                                 tains   any  additional  data
                                                 that you want to send to your
                                                 web  server  as  the HTTP re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect  the HTTP method. The
                                                 method indicates the type  of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect the request  body  as
                                                 JSON.  The request body imme-
                                                 diately follows  the  request
                                                 headers.  This is the part of
                                                 a request that  contains  any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the  HTTP  request body, such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The patterns to  look  for
                                                    in  the JSON body. WAF in-
                                                    spects  the   results   of
                                                    these    pattern   matches
                                                    against the  rule  inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match  all of the ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match only the  speci-
                                                        fied   include  paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide   the  include
                                                        paths    using    JSON
                                                        Pointer   syntax.  For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"]  . For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force  (IETF) documen-
                                                        tation JavaScript  Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the All  setting,  but
                                                        not both.

                                                        NOTE:
                                                           Don't  use this op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The parts of the  JSON  to
                                                    match  against  using  the
                                                    MatchPattern  .   If   you
                                                    specify  All , WAF matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What  WAF  should do if it
                                                    fails to completely  parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect  the body as plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection to  the  body
                                                      text string.

                                                    o MATCH  -  Treat  the web
                                                      request as matching  the
                                                      rule  statement. WAF ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request as not  matching
                                                      the rule statement.

                                                    If  you don't provide this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up to  the  first  parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the  entire JSON body, but
                                                    might be  forced  to  stop
                                                    for  reasons  such  as in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any  content  whose   root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following  examples as two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. If you  specify  one  or
                                             more  transformations  in  a rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the request component  identified
                                             by  FieldToMatch  , starting from
                                             the lowest priority setting,  be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations  that  are
                                                    defined  for a rule state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est priority  to  highest,
                                                    before    inspecting   the
                                                    transformed  content.  The
                                                    priorities  don't  need to
                                                    be consecutive,  but  they
                                                    must all be different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                      XssMatchStatement -> (structure)
                                          A  rule  statement  that  defines  a
                                          cross-site   scripting  (XSS)  match
                                          search for WAF to apply to  web  re-
                                          quests.  XSS attacks are those where
                                          the attacker uses vulnerabilities in
                                          a benign website as a vehicle to in-
                                          ject malicious  client-site  scripts
                                          into  other legitimate web browsers.
                                          The XSS match statement provides the
                                          location  in  requests that you want
                                          WAF to search and  text  transforma-
                                          tions  to use on the search area be-
                                          fore WAF searches for character  se-
                                          quences  that are likely to be mali-
                                          cious strings.

                                          FieldToMatch -> (structure)
                                             The part of a  web  request  that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide  the  name of the header
                                                 to  inspect,   for   example,
                                                 User-Agent  or Referer . This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The   name  of  the  query
                                                    header to inspect.

                                             SingleQueryArgument  ->   (struc-
                                             ture)
                                                 Inspect  a single query argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such as UserName or  SalesRe-
                                                 gion  . The name can be up to
                                                 30 characters long and  isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF   to   inspect,   in  the
                                                 FieldToMatch specification.

                                                 Example  JSON:   "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The name of the query  ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest  that  identifies a re-
                                                 source,  for  example,   /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect   the  query  string.
                                                 This is the  part  of  a  URL
                                                 that  appears after a ? char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect the request  body  as
                                                 plain  text. The request body
                                                 immediately follows  the  re-
                                                 quest  headers.  This  is the
                                                 part of a request  that  con-
                                                 tains   any  additional  data
                                                 that you want to send to your
                                                 web  server  as  the HTTP re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect  the HTTP method. The
                                                 method indicates the type  of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect the request  body  as
                                                 JSON.  The request body imme-
                                                 diately follows  the  request
                                                 headers.  This is the part of
                                                 a request that  contains  any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the  HTTP  request body, such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The patterns to  look  for
                                                    in  the JSON body. WAF in-
                                                    spects  the   results   of
                                                    these    pattern   matches
                                                    against the  rule  inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match  all of the ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match only the  speci-
                                                        fied   include  paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide   the  include
                                                        paths    using    JSON
                                                        Pointer   syntax.  For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"]  . For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force  (IETF) documen-
                                                        tation JavaScript  Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the All  setting,  but
                                                        not both.

                                                        NOTE:
                                                           Don't  use this op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The parts of the  JSON  to
                                                    match  against  using  the
                                                    MatchPattern  .   If   you
                                                    specify  All , WAF matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What  WAF  should do if it
                                                    fails to completely  parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect  the body as plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection to  the  body
                                                      text string.

                                                    o MATCH  -  Treat  the web
                                                      request as matching  the
                                                      rule  statement. WAF ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request as not  matching
                                                      the rule statement.

                                                    If  you don't provide this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up to  the  first  parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the  entire JSON body, but
                                                    might be  forced  to  stop
                                                    for  reasons  such  as in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any  content  whose   root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following  examples as two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. If you  specify  one  or
                                             more  transformations  in  a rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the request component  identified
                                             by  FieldToMatch  , starting from
                                             the lowest priority setting,  be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations  that  are
                                                    defined  for a rule state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est priority  to  highest,
                                                    before    inspecting   the
                                                    transformed  content.  The
                                                    priorities  don't  need to
                                                    be consecutive,  but  they
                                                    must all be different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                      SizeConstraintStatement -> (structure)
                                          A rule  statement  that  compares  a
                                          number  of bytes against the size of
                                          a request component, using a compar-
                                          ison  operator, such as greater than
                                          (>) or less than (<).  For  example,
                                          you can use a size constraint state-
                                          ment to look for query strings  that
                                          are longer than 100 bytes.

                                          If  you configure WAF to inspect the
                                          request body, WAF inspects only  the
                                          first  8192 bytes (8 KB). If the re-
                                          quest body  for  your  web  requests
                                          never  exceeds  8192  bytes, you can
                                          create a size  constraint  condition
                                          and  block  requests that have a re-
                                          quest body greater than 8192 bytes.

                                          If you choose URI for the  value  of
                                          Part  of  the  request to filter on,
                                          the slash (/) in the URI  counts  as
                                          one  character. For example, the URI
                                          /logo.jpg is nine characters long.

                                          FieldToMatch -> (structure)
                                             The part of a  web  request  that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide  the  name of the header
                                                 to  inspect,   for   example,
                                                 User-Agent  or Referer . This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The   name  of  the  query
                                                    header to inspect.

                                             SingleQueryArgument  ->   (struc-
                                             ture)
                                                 Inspect  a single query argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such as UserName or  SalesRe-
                                                 gion  . The name can be up to
                                                 30 characters long and  isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF   to   inspect,   in  the
                                                 FieldToMatch specification.

                                                 Example  JSON:   "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The name of the query  ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest  that  identifies a re-
                                                 source,  for  example,   /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect   the  query  string.
                                                 This is the  part  of  a  URL
                                                 that  appears after a ? char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect the request  body  as
                                                 plain  text. The request body
                                                 immediately follows  the  re-
                                                 quest  headers.  This  is the
                                                 part of a request  that  con-
                                                 tains   any  additional  data
                                                 that you want to send to your
                                                 web  server  as  the HTTP re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect  the HTTP method. The
                                                 method indicates the type  of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect the request  body  as
                                                 JSON.  The request body imme-
                                                 diately follows  the  request
                                                 headers.  This is the part of
                                                 a request that  contains  any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the  HTTP  request body, such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The patterns to  look  for
                                                    in  the JSON body. WAF in-
                                                    spects  the   results   of
                                                    these    pattern   matches
                                                    against the  rule  inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match  all of the ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match only the  speci-
                                                        fied   include  paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide   the  include
                                                        paths    using    JSON
                                                        Pointer   syntax.  For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"]  . For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force  (IETF) documen-
                                                        tation JavaScript  Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the All  setting,  but
                                                        not both.

                                                        NOTE:
                                                           Don't  use this op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The parts of the  JSON  to
                                                    match  against  using  the
                                                    MatchPattern  .   If   you
                                                    specify  All , WAF matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What  WAF  should do if it
                                                    fails to completely  parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect  the body as plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection to  the  body
                                                      text string.

                                                    o MATCH  -  Treat  the web
                                                      request as matching  the
                                                      rule  statement. WAF ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request as not  matching
                                                      the rule statement.

                                                    If  you don't provide this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up to  the  first  parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the  entire JSON body, but
                                                    might be  forced  to  stop
                                                    for  reasons  such  as in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any  content  whose   root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following  examples as two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          ComparisonOperator -> (string)
                                             The operator to  use  to  compare
                                             the request part to the size set-
                                             ting.

                                          Size -> (long)
                                             The size, in byte, to compare  to
                                             the   request   part,  after  any
                                             transformations.

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. If you  specify  one  or
                                             more  transformations  in  a rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the request component  identified
                                             by  FieldToMatch  , starting from
                                             the lowest priority setting,  be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations  that  are
                                                    defined  for a rule state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est priority  to  highest,
                                                    before    inspecting   the
                                                    transformed  content.  The
                                                    priorities  don't  need to
                                                    be consecutive,  but  they
                                                    must all be different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                      GeoMatchStatement -> (structure)
                                          A rule statement  used  to  identify
                                          web  requests  based  on  country of
                                          origin.

                                          CountryCodes -> (list)
                                             An array of two-character country
                                             codes,  for example, [ "US", "CN"
                                             ] , from the alpha-2 country  ISO
                                             codes  of  the  ISO 3166 interna-
                                             tional standard.

                                             (string)

                                          ForwardedIPConfig -> (structure)
                                             The configuration for  inspecting
                                             IP  addresses  in  an HTTP header
                                             that you specify, instead of  us-
                                             ing  the  IP  address  that's re-
                                             ported by the web request origin.
                                             Commonly,   this  is  the  X-For-
                                             warded-For (XFF) header, but  you
                                             can specify any header name.

                                             NOTE:
                                                 If the specified header isn't
                                                 present in the  request,  WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             HeaderName -> (string)
                                                 The name of the  HTTP  header
                                                 to  use  for  the IP address.
                                                 For  example,  to   use   the
                                                 X-Forwarded-For (XFF) header,
                                                 set this to X-Forwarded-For .

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't  present  in the re-
                                                    quest, WAF  doesn't  apply
                                                    the  rule  to  the web re-
                                                    quest at all.

                                             FallbackBehavior -> (string)
                                                 The match status to assign to
                                                 the  web  request  if the re-
                                                 quest doesn't have a valid IP
                                                 address  in the specified po-
                                                 sition.

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't  present  in the re-
                                                    quest, WAF  doesn't  apply
                                                    the  rule  to  the web re-
                                                    quest at all.

                                                 You can specify the following
                                                 fallback behaviors:

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                      RuleGroupReferenceStatement  ->  (struc-
                                      ture)
                                          A  rule  statement  used  to run the
                                          rules that are defined in  a   Rule-
                                          Group  .  To use this, create a rule
                                          group with your rules, then  provide
                                          the  ARN  of  the rule group in this
                                          statement.

                                          You cannot  nest  a  RuleGroupRefer-
                                          enceStatement  , for example for use
                                          inside a NotStatement or OrStatement
                                          . You can only use a rule group ref-
                                          erence statement at  the  top  level
                                          inside a web ACL.

                                          ARN -> (string)
                                             The Amazon Resource Name (ARN) of
                                             the entity.

                                          ExcludedRules -> (list)
                                             The rules in the referenced  rule
                                             group  whose  actions  are set to
                                             Count . When you exclude a  rule,
                                             WAF  evaluates  it  exactly as it
                                             would if the rule action  setting
                                             were Count . This is a useful op-
                                             tion for testing the rules  in  a
                                             rule  group without modifying how
                                             they handle your web traffic.

                                             (structure)
                                                 Specifies a single rule in  a
                                                 rule  group  whose action you
                                                 want to override to  Count  .
                                                 When  you exclude a rule, WAF
                                                 evaluates it  exactly  as  it
                                                 would if the rule action set-
                                                 ting were Count . This  is  a
                                                 useful option for testing the
                                                 rules in a rule group without
                                                 modifying   how  they  handle
                                                 your web traffic.

                                                 Name -> (string)
                                                    The name of the rule whose
                                                    action  you  want to over-
                                                    ride to Count .

                                      IPSetReferenceStatement -> (structure)
                                          A rule statement used to detect  web
                                          requests  coming  from particular IP
                                          addresses or address ranges. To  use
                                          this,  create  an  IPSet that speci-
                                          fies the addresses you want  to  de-
                                          tect,  then  use the ARN of that set
                                          in this statement. To create  an  IP
                                          set, see  CreateIPSet .

                                          Each  IP  set  rule statement refer-
                                          ences an  IP  set.  You  create  and
                                          maintain the set independent of your
                                          rules. This allows you  to  use  the
                                          single  set  in multiple rules. When
                                          you update the referenced  set,  WAF
                                          automatically updates all rules that
                                          reference it.

                                          ARN -> (string)
                                             The Amazon Resource Name (ARN) of
                                             the   IPSet  that  this statement
                                             references.

                                          IPSetForwardedIPConfig  ->   (struc-
                                          ture)
                                             The  configuration for inspecting
                                             IP addresses in  an  HTTP  header
                                             that  you specify, instead of us-
                                             ing the  IP  address  that's  re-
                                             ported by the web request origin.
                                             Commonly,  this  is  the   X-For-
                                             warded-For  (XFF) header, but you
                                             can specify any header name.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             HeaderName -> (string)
                                                 The  name  of the HTTP header
                                                 to use for  the  IP  address.
                                                 For   example,   to  use  the
                                                 X-Forwarded-For (XFF) header,
                                                 set this to X-Forwarded-For .

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't present in  the  re-
                                                    quest,  WAF  doesn't apply
                                                    the rule to  the  web  re-
                                                    quest at all.

                                             FallbackBehavior -> (string)
                                                 The match status to assign to
                                                 the web request  if  the  re-
                                                 quest doesn't have a valid IP
                                                 address in the specified  po-
                                                 sition.

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't present in  the  re-
                                                    quest,  WAF  doesn't apply
                                                    the rule to  the  web  re-
                                                    quest at all.

                                                 You can specify the following
                                                 fallback behaviors:

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                             Position -> (string)
                                                 The position in the header to
                                                 search for  the  IP  address.
                                                 The header can contain IP ad-
                                                 dresses   of   the   original
                                                 client  and  also of proxies.
                                                 For example, the header value
                                                 could be 10.1.1.1, 127.0.0.0,
                                                 10.10.10.10 where  the  first
                                                 IP   address  identifies  the
                                                 original client and the  rest
                                                 identify proxies that the re-
                                                 quest went through.

                                                 The options for this  setting
                                                 are the following:

                                                 o FIRST  -  Inspect the first
                                                   IP address in the  list  of
                                                   IP addresses in the header.
                                                   This   is    usually    the
                                                   client's original IP.

                                                 o LAST  - Inspect the last IP
                                                   address in the list  of  IP
                                                   addresses in the header.

                                                 o ANY  -  Inspect  all IP ad-
                                                   dresses in the header for a
                                                   match.  If  the header con-
                                                   tains more than 10  IP  ad-
                                                   dresses,  WAF  inspects the
                                                   last 10.

                                      RegexPatternSetReferenceStatement     ->
                                      (structure)
                                          A  rule statement used to search web
                                          request components for matches  with
                                          regular  expressions.  To  use this,
                                          create a  RegexPatternSet that spec-
                                          ifies  the expressions that you want
                                          to detect, then use the ARN of  that
                                          set in this statement. A web request
                                          matches the pattern set rule  state-
                                          ment   if   the   request  component
                                          matches any of the patterns  in  the
                                          set.  To create a regex pattern set,
                                          see  CreateRegexPatternSet .

                                          Each regex pattern set  rule  state-
                                          ment references a regex pattern set.
                                          You create and maintain the set  in-
                                          dependent of your rules. This allows
                                          you to use the single set in  multi-
                                          ple  rules. When you update the ref-
                                          erenced set, WAF  automatically  up-
                                          dates all rules that reference it.

                                          ARN -> (string)
                                             The Amazon Resource Name (ARN) of
                                             the   RegexPatternSet  that  this
                                             statement references.

                                          FieldToMatch -> (structure)
                                             The  part  of  a web request that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide the name of  the  header
                                                 to   inspect,   for  example,
                                                 User-Agent or Referer .  This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The  name  of  the   query
                                                    header to inspect.

                                             SingleQueryArgument   ->  (struc-
                                             ture)
                                                 Inspect a single query  argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such  as UserName or SalesRe-
                                                 gion . The name can be up  to
                                                 30  characters long and isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF  to   inspect,   in   the
                                                 FieldToMatch specification.

                                                 Example   JSON:  "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The  name of the query ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest that identifies  a  re-
                                                 source,   for  example,  /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect  the  query   string.
                                                 This  is  the  part  of a URL
                                                 that appears after a ?  char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect  the  request body as
                                                 plain text. The request  body
                                                 immediately  follows  the re-
                                                 quest headers.  This  is  the
                                                 part  of  a request that con-
                                                 tains  any  additional   data
                                                 that you want to send to your
                                                 web server as  the  HTTP  re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect the HTTP method.  The
                                                 method  indicates the type of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect  the  request body as
                                                 JSON. The request body  imme-
                                                 diately  follows  the request
                                                 headers. This is the part  of
                                                 a  request  that contains any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the HTTP request  body,  such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The  patterns  to look for
                                                    in the JSON body. WAF  in-
                                                    spects   the   results  of
                                                    these   pattern    matches
                                                    against  the  rule inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match all of the  ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match  only the speci-
                                                        fied  include   paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide  the   include
                                                        paths    using    JSON
                                                        Pointer  syntax.   For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"] .  For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force (IETF)  documen-
                                                        tation  JavaScript Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the  All  setting, but
                                                        not both.

                                                        NOTE:
                                                           Don't use this  op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The  parts  of the JSON to
                                                    match  against  using  the
                                                    MatchPattern   .   If  you
                                                    specify All , WAF  matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What WAF should do  if  it
                                                    fails  to completely parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect the body as  plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection  to  the body
                                                      text string.

                                                    o MATCH -  Treat  the  web
                                                      request  as matching the
                                                      rule statement. WAF  ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request  as not matching
                                                      the rule statement.

                                                    If you don't provide  this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up  to  the  first parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the entire JSON body,  but
                                                    might  be  forced  to stop
                                                    for reasons  such  as  in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any   content  whose  root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following examples as  two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.  If  you  specify one or
                                             more transformations  in  a  rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the  request component identified
                                             by FieldToMatch ,  starting  from
                                             the  lowest priority setting, be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web requests in an effort  to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing  order  for   multiple
                                                    transformations  that  are
                                                    defined for a rule  state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est  priority  to highest,
                                                    before   inspecting    the
                                                    transformed  content.  The
                                                    priorities don't  need  to
                                                    be  consecutive,  but they
                                                    must all be different.

                                                 Type -> (string)
                                                    You can specify  the  fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a    Base64   -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode  a  Base64 -en-
                                                        coded string, but  use
                                                        a  forgiving implemen-
                                                        tation  that   ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE    -     Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness of  attackers
                                                        who  inject an operat-
                                                        ing    system     com-
                                                        mand-line  command and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following characters:  /
                                                      (

                                                    o Replace   the  following
                                                      characters with a space:
                                                      , ;

                                                    o Replace  multiple spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters  (A-Z) to lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace  these charac-
                                                        ters  with   a   space
                                                        character     (decimal
                                                        32):

                                                    o \f ,  formfeed,  decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE  -   Decode
                                                        characters  that  were
                                                        encoded using CSS  2.x
                                                        escape    rules   syn-
                                                        data.html#characters .
                                                        This  function uses up
                                                        to two  bytes  in  the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII  characters that
                                                        were encoded using CSS
                                                        encoding  that wouldnt
                                                        typically be  encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of  a  backslash   and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript  for java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI  C   escape   se-
                                                        quences:  \a , \b , \f
                                                        , \n , \r , \t , \v  ,
                                                        \\  ,  \?  , \' , \" ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO  (octal). Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE  - Decode a
                                                        string of  hexadecimal
                                                        characters  into a bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters with  unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs  these opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;    with     a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with  a "less than" sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal  format, (amper-
                                                      sand)#xhhhh; , with  the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal    format,   (amper-
                                                      sand)#nnnn; ,  with  the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript escape  se-
                                                        quences.  If  a  \   u
                                                        HHHH code  is  in  the
                                                        full-width  ASCII code
                                                        range of  FF01-FF5E  ,
                                                        then  the  higher byte
                                                        is used to detect  and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte  is  used and the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE  -   Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash from the data  in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you  don't  want   any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are not at the  begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This  is  the  same as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash  characters   to
                                                        forward slashes.

                                                        REMOVE_NULLS  - Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place each  occurrence
                                                        of  a  C-style comment
                                                        (/* ... */  )  with  a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments  are also re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a standalone  termina-
                                                        tion  of a comment (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS  -   Re-
                                                        place  NULL  bytes  in
                                                        the input  with  space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE  - Decode a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI -  Like
                                                        URL_DECODE  , but with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in    the   full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and  adjust  the lower
                                                        byte. Otherwise,  only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter  sequences to Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives  and false-nega-
                                                        tives for  non-English
                                                        languages.

                                      RateBasedStatement -> (structure)
                                          A rate-based rule tracks the rate of
                                          requests for each originating IP ad-
                                          dress,  and triggers the rule action
                                          when the rate exceeds a  limit  that
                                          you  specify  on  the  number of re-
                                          quests in any  5-minute  time  span.
                                          You  can use this to put a temporary
                                          block on requests from an IP address
                                          that is sending excessive requests.

                                          WAF  tracks and manages web requests
                                          separately for each  instance  of  a
                                          rate-based  rule  that  you use. For
                                          example, if  you  provide  the  same
                                          rate-based  rule settings in two web
                                          ACLs, each of the  two  rule  state-
                                          ments represents a separate instance
                                          of the rate-based rule and gets  its
                                          own  tracking and management by WAF.
                                          If you define a rate-based rule  in-
                                          side a rule group, and then use that
                                          rule group in multiple places,  each
                                          use  creates  a separate instance of
                                          the rate-based rule  that  gets  its
                                          own tracking and management by WAF.

                                          When  the  rule action triggers, WAF
                                          blocks additional requests from  the
                                          IP  address  until  the request rate
                                          falls below the limit.

                                          You  can  optionally  nest   another
                                          statement   inside   the  rate-based
                                          statement, to narrow  the  scope  of
                                          the  rule so that it only counts re-
                                          quests that match the nested  state-
                                          ment.  For  example, based on recent
                                          requests that you have seen from  an
                                          attacker,   you   might   create   a
                                          rate-based rule with  a  nested  AND
                                          rule  statement  that  contains  the
                                          following nested statements:

                                          o An IP match statement with  an  IP
                                            set  that  specified  the  address
                                            192.0.2.44.

                                          o A  string  match  statement   that
                                            searches  in the User-Agent header
                                            for the string BadBot.

                                          In this rate-based  rule,  you  also
                                          define  a rate limit. For this exam-
                                          ple, the rate limit  is  1,000.  Re-
                                          quests  that meet both of the condi-
                                          tions in the statements are counted.
                                          If  the count exceeds 1,000 requests
                                          per five minutes,  the  rule  action
                                          triggers.  Requests that do not meet
                                          both conditions are not counted  to-
                                          wards the rate limit and are not af-
                                          fected by this rule.

                                          You cannot nest a RateBasedStatement
                                          inside  another statement, for exam-
                                          ple   inside   a   NotStatement   or
                                          OrStatement . You can define a Rate-
                                          BasedStatement inside a web ACL  and
                                          inside a rule group.

                                          Limit -> (long)
                                             The   limit   on   requests   per
                                             5-minute  period  for  a   single
                                             originating  IP  address.  If the
                                             statement includes  a  ScopeDown-
                                             Statement , this limit is applied
                                             only to the requests  that  match
                                             the statement.

                                          AggregateKeyType -> (string)
                                             Setting that indicates how to ag-
                                             gregate the request  counts.  The
                                             options are the following:

                                             o IP   -  Aggregate  the  request
                                               counts on the IP  address  from
                                               the web request origin.

                                             o FORWARDED_IP  -  Aggregate  the
                                               request counts on the first  IP
                                               address  in  an HTTP header. If
                                               you  use  this,  configure  the
                                               ForwardedIPConfig  , to specify
                                               the header to use.

                                          ( ... recursive ... )ForwardedIPCon-
                                          fig -> (structure)
                                             The  configuration for inspecting
                                             IP addresses in  an  HTTP  header
                                             that  you specify, instead of us-
                                             ing the  IP  address  that's  re-
                                             ported by the web request origin.
                                             Commonly,  this  is  the   X-For-
                                             warded-For  (XFF) header, but you
                                             can specify any header name.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             This is required if AggregateKey-
                                             Type is set to FORWARDED_IP .

                                             HeaderName -> (string)
                                                 The name of the  HTTP  header
                                                 to  use  for  the IP address.
                                                 For  example,  to   use   the
                                                 X-Forwarded-For (XFF) header,
                                                 set this to X-Forwarded-For .

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't  present  in the re-
                                                    quest, WAF  doesn't  apply
                                                    the  rule  to  the web re-
                                                    quest at all.

                                             FallbackBehavior -> (string)
                                                 The match status to assign to
                                                 the  web  request  if the re-
                                                 quest doesn't have a valid IP
                                                 address  in the specified po-
                                                 sition.

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't  present  in the re-
                                                    quest, WAF  doesn't  apply
                                                    the  rule  to  the web re-
                                                    quest at all.

                                                 You can specify the following
                                                 fallback behaviors:

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                      AndStatement -> (structure)
                                          A logical  rule  statement  used  to
                                          combine  other  rule statements with
                                          AND logic. You provide more than one
                                          Statement within the AndStatement .

                                          Statements -> (list)
                                             The  statements  to  combine with
                                             AND logic. You can use any state-
                                             ments that can be nested.

                                             ( ... recursive ... )

                                      OrStatement -> (structure)
                                          A  logical  rule  statement  used to
                                          combine other rule  statements  with
                                          OR  logic. You provide more than one
                                          Statement within the OrStatement .

                                          Statements -> (list)
                                             The statements to combine with OR
                                             logic. You can use any statements
                                             that can be nested.

                                             ( ... recursive ... )

                                      NotStatement -> (structure)
                                          A logical  rule  statement  used  to
                                          negate  the  results of another rule
                                          statement. You provide  one   State-
                                          ment within the NotStatement .

                                          ( ... recursive ... )

                                      ManagedRuleGroupStatement -> (structure)
                                          A  rule  statement  used  to run the
                                          rules that are defined in a  managed
                                          rule group. To use this, provide the
                                          vendor name and the name of the rule
                                          group in this statement. You can re-
                                          trieve the required names by calling
                                          ListAvailableManagedRuleGroups .

                                          You  cannot nest a ManagedRuleGroup-
                                          Statement , for example for use  in-
                                          side a NotStatement or OrStatement .
                                          It  can  only  be  referenced  as  a
                                          top-level statement within a rule.

                                          VendorName -> (string)
                                             The  name  of  the  managed  rule
                                             group vendor. You use this, along
                                             with  the  rule  group  name,  to
                                             identify the rule group.

                                          Name -> (string)
                                             The  name  of  the  managed  rule
                                             group.  You  use this, along with
                                             the vendor name, to identify  the
                                             rule group.

                                          Version -> (string)
                                             The  version  of the managed rule
                                             group  to  use.  If  you  specify
                                             this,   the  version  setting  is
                                             fixed until you change it. If you
                                             don't  specify this, WAF uses the
                                             vendor's  default  version,   and
                                             then  keeps  the  version  at the
                                             vendor's default when the  vendor
                                             updates  the  managed  rule group
                                             settings.

                                          ExcludedRules -> (list)
                                             The rules in the referenced  rule
                                             group  whose  actions  are set to
                                             Count . When you exclude a  rule,
                                             WAF  evaluates  it  exactly as it
                                             would if the rule action  setting
                                             were Count . This is a useful op-
                                             tion for testing the rules  in  a
                                             rule  group without modifying how
                                             they handle your web traffic.

                                             (structure)
                                                 Specifies a single rule in  a
                                                 rule  group  whose action you
                                                 want to override to  Count  .
                                                 When  you exclude a rule, WAF
                                                 evaluates it  exactly  as  it
                                                 would if the rule action set-
                                                 ting were Count . This  is  a
                                                 useful option for testing the
                                                 rules in a rule group without
                                                 modifying   how  they  handle
                                                 your web traffic.

                                                 Name -> (string)
                                                    The name of the rule whose
                                                    action  you  want to over-
                                                    ride to Count .

                                          ( ... recursive ... )

                                      LabelMatchStatement -> (structure)
                                          A  rule  statement  that  defines  a
                                          string  match  search against labels
                                          that have been added to the web  re-
                                          quest by rules that have already run
                                          in the web ACL.

                                          The label match  statement  provides
                                          the  label  or  namespace  string to
                                          search for.  The  label  string  can
                                          represent a part or all of the fully
                                          qualified label name that  had  been
                                          added  to  the  web  request.  Fully
                                          qualified labels have a prefix,  op-
                                          tional  namespaces,  and label name.
                                          The prefix identifies the rule group
                                          or  web ACL context of the rule that
                                          added the label. If you do not  pro-
                                          vide  the  fully  qualified  name in
                                          your label match  string,  WAF  per-
                                          forms  the  search  for  labels that
                                          were added in the  same  context  as
                                          the label match statement.

                                          Scope -> (string)
                                             Specify whether you want to match
                                             using the label name or just  the
                                             namespace.

                                          Key -> (string)
                                             The  string to match against. The
                                             setting you provide for this  de-
                                             pends  on  the  match statement's
                                             Scope setting:

                                             o If the Scope indicates LABEL  ,
                                               then  this  specification  must
                                               include the name  and  can  in-
                                               clude  any  number of preceding
                                               namespace  specifications   and
                                               prefix   up  to  providing  the
                                               fully qualified label name.

                                             o If the  Scope  indicates  NAME-
                                               SPACE , then this specification
                                               can include any number of  con-
                                               tiguous  namespace strings, and
                                               can include  the  entire  label
                                               namespace  prefix from the rule
                                               group or web ACL where the  la-
                                               bel originates.

                                             Labels  are  case  sensitive  and
                                             components of  a  label  must  be
                                             separated  by  colon, for example
                                             NS1:NS2:name .

                                      RegexMatchStatement -> (structure)
                                          A rule statement used to search  web
                                          request   components   for  a  match
                                          against a single regular expression.

                                          RegexString -> (string)
                                             The string representing the regu-
                                             lar expression.

                                          FieldToMatch -> (structure)
                                             The  part  of  a web request that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide the name of  the  header
                                                 to   inspect,   for  example,
                                                 User-Agent or Referer .  This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The  name  of  the   query
                                                    header to inspect.

                                             SingleQueryArgument   ->  (struc-
                                             ture)
                                                 Inspect a single query  argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such  as UserName or SalesRe-
                                                 gion . The name can be up  to
                                                 30  characters long and isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF  to   inspect,   in   the
                                                 FieldToMatch specification.

                                                 Example   JSON:  "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The  name of the query ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest that identifies  a  re-
                                                 source,   for  example,  /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect  the  query   string.
                                                 This  is  the  part  of a URL
                                                 that appears after a ?  char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect  the  request body as
                                                 plain text. The request  body
                                                 immediately  follows  the re-
                                                 quest headers.  This  is  the
                                                 part  of  a request that con-
                                                 tains  any  additional   data
                                                 that you want to send to your
                                                 web server as  the  HTTP  re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect the HTTP method.  The
                                                 method  indicates the type of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect  the  request body as
                                                 JSON. The request body  imme-
                                                 diately  follows  the request
                                                 headers. This is the part  of
                                                 a  request  that contains any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the HTTP request  body,  such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The  patterns  to look for
                                                    in the JSON body. WAF  in-
                                                    spects   the   results  of
                                                    these   pattern    matches
                                                    against  the  rule inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match all of the  ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match  only the speci-
                                                        fied  include   paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide  the   include
                                                        paths    using    JSON
                                                        Pointer  syntax.   For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"] .  For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force (IETF)  documen-
                                                        tation  JavaScript Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the  All  setting, but
                                                        not both.

                                                        NOTE:
                                                           Don't use this  op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The  parts  of the JSON to
                                                    match  against  using  the
                                                    MatchPattern   .   If  you
                                                    specify All , WAF  matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What WAF should do  if  it
                                                    fails  to completely parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect the body as  plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection  to  the body
                                                      text string.

                                                    o MATCH -  Treat  the  web
                                                      request  as matching the
                                                      rule statement. WAF  ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request  as not matching
                                                      the rule statement.

                                                    If you don't provide  this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up  to  the  first parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the entire JSON body,  but
                                                    might  be  forced  to stop
                                                    for reasons  such  as  in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any   content  whose  root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following examples as  two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.  If  you  specify one or
                                             more transformations  in  a  rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the  request component identified
                                             by FieldToMatch ,  starting  from
                                             the  lowest priority setting, be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web requests in an effort  to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing  order  for   multiple
                                                    transformations  that  are
                                                    defined for a rule  state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est  priority  to highest,
                                                    before   inspecting    the
                                                    transformed  content.  The
                                                    priorities don't  need  to
                                                    be  consecutive,  but they
                                                    must all be different.

                                                 Type -> (string)
                                                    You can specify  the  fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a    Base64   -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode  a  Base64 -en-
                                                        coded string, but  use
                                                        a  forgiving implemen-
                                                        tation  that   ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE    -     Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness of  attackers
                                                        who  inject an operat-
                                                        ing    system     com-
                                                        mand-line  command and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following characters:  /
                                                      (

                                                    o Replace   the  following
                                                      characters with a space:
                                                      , ;

                                                    o Replace  multiple spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters  (A-Z) to lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace  these charac-
                                                        ters  with   a   space
                                                        character     (decimal
                                                        32):

                                                    o \f ,  formfeed,  decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE  -   Decode
                                                        characters  that  were
                                                        encoded using CSS  2.x
                                                        escape    rules   syn-
                                                        data.html#characters .
                                                        This  function uses up
                                                        to two  bytes  in  the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII  characters that
                                                        were encoded using CSS
                                                        encoding  that wouldnt
                                                        typically be  encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of  a  backslash   and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript  for java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI  C   escape   se-
                                                        quences:  \a , \b , \f
                                                        , \n , \r , \t , \v  ,
                                                        \\  ,  \?  , \' , \" ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO  (octal). Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE  - Decode a
                                                        string of  hexadecimal
                                                        characters  into a bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters with  unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs  these opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;    with     a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with  a "less than" sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal  format, (amper-
                                                      sand)#xhhhh; , with  the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal    format,   (amper-
                                                      sand)#nnnn; ,  with  the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript escape  se-
                                                        quences.  If  a  \   u
                                                        HHHH code  is  in  the
                                                        full-width  ASCII code
                                                        range of  FF01-FF5E  ,
                                                        then  the  higher byte
                                                        is used to detect  and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte  is  used and the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE  -   Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash from the data  in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you  don't  want   any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are not at the  begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This  is  the  same as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash  characters   to
                                                        forward slashes.

                                                        REMOVE_NULLS  - Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place each  occurrence
                                                        of  a  C-style comment
                                                        (/* ... */  )  with  a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments  are also re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a standalone  termina-
                                                        tion  of a comment (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS  -   Re-
                                                        place  NULL  bytes  in
                                                        the input  with  space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE  - Decode a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI -  Like
                                                        URL_DECODE  , but with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in    the   full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and  adjust  the lower
                                                        byte. Otherwise,  only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter  sequences to Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives  and false-nega-
                                                        tives for  non-English
                                                        languages.

                            NotStatement -> (structure)
                               A logical rule statement used to negate the re-
                               sults of another rule  statement.  You  provide
                               one  Statement within the NotStatement .

                               Statement -> (structure)
                                   The  statement  to  negate. You can use any
                                   statement that can be nested.

                                   ByteMatchStatement -> (structure)
                                      A rule statement that defines  a  string
                                      match search for WAF to apply to web re-
                                      quests. The byte  match  statement  pro-
                                      vides the bytes to search for, the loca-
                                      tion in requests that you  want  WAF  to
                                      search, and other settings. The bytes to
                                      search for are typically a  string  that
                                      corresponds  with  ASCII  characters. In
                                      the WAF console and the developer guide,
                                      this  is  refered  to  as a string match
                                      statement.

                                      SearchString -> (blob)
                                          A string value that you want WAF  to
                                          search for. WAF searches only in the
                                          part of web requests that you desig-
                                          nate for inspection in  FieldToMatch
                                          . The maximum length of the value is
                                          50 bytes.

                                          Valid values depend on the component
                                          that you specify for  inspection  in
                                          FieldToMatch :

                                          o Method  : The HTTP method that you
                                            want WAF to search for. This indi-
                                            cates the type of operation speci-
                                            fied in the request.

                                          o UriPath : The value that you  want
                                            WAF to search for in the URI path,
                                            for example,  /images/daily-ad.jpg
                                            .

                                          If  SearchString includes alphabetic
                                          characters A-Z and  a-z,  note  that
                                          the value is case sensitive.
                                             If you're using the WAF API

                                          Specify  a base64-encoded version of
                                          the value. The maximum length of the
                                          value before you base64-encode it is
                                          50 bytes.

                                          For example, suppose  the  value  of
                                          Type is HEADER and the value of Data
                                          is  User-Agent  .  If  you  want  to
                                          search the User-Agent header for the
                                          value  BadBot  ,  you  base64-encode
                                          BadBot  using  MIME  base64-encoding
                                          and include the resulting value, Qm-
                                          FkQm90  ,  in  the  value of Search-
                                          String .
                                             If you're using the CLI or one of
                                             the Amazon Web Services SDKs

                                          The  value  that  you  want  WAF  to
                                          search for.  The  SDK  automatically
                                          base64 encodes the value.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.  If  you
                                          specify  one or more transformations
                                          in a rule  statement,  WAF  performs
                                          all  transformations  on the content
                                          of the request component  identified
                                          by  FieldToMatch , starting from the
                                          lowest priority setting, before  in-
                                          specting the content for a match.

                                          (structure)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets  the relative processing
                                                 order for multiple  transfor-
                                                 mations  that are defined for
                                                 a rule  statement.  WAF  pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive, but they  must  all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE -  Decode  a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a Base64 -encoded  string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE  -   Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness  of attackers who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use unusual formatting  to
                                                    disguise  some  or  all of
                                                    the command.

                                                 o Delete the following  char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with   a  space  character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v  , vertical tab, decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE  - Decode char-
                                                    acters that  were  encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This  function  uses up to
                                                    two bytes in the  decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS encoding that  wouldnt
                                                    typically be encoded. It's
                                                    also useful in  countering
                                                    evasion, which is a combi-
                                                    nation of a backslash  and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript    for   java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the  following  ANSI C es-
                                                    cape sequences: \a , \b  ,
                                                    \f  ,  \n , \r , \t , \v ,
                                                    \\ , \? , \' , \"  ,  \xHH
                                                    (hexadecimal),  \0OOO (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE  -   Decode   a
                                                    string    of   hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters with unencoded  char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with a non-breaking  space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces   characters  that
                                                   are represented in hexadec-
                                                   imal     format,    (amper-
                                                   sand)#xhhhh;  ,  with   the
                                                   corresponding characters

                                                 o Replaces   characters  that
                                                   are represented in  decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with   the    corresponding
                                                   characters
                                                    JS_DECODE  -  Decode Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the full-width ASCII  code
                                                    range  of FF01-FF5E , then
                                                    the higher byte is used to
                                                    detect   and   adjust  the
                                                    lower byte. If  not,  only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash  from the data in the
                                                    input. The  computed  hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH   -  Remove
                                                    multiple  slashes,  direc-
                                                    tory  self-references, and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning of the input from  an
                                                    input string.

                                                    NORMALIZE_PATH_WIN  - This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH  , but first con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS  - Remove all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences   are  not  com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination of a comment  (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS   -  Replace
                                                    NULL bytes  in  the  input
                                                    with    space   characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE  -   Decode
                                                    SQL   hex   data.  Example
                                                    (0x414243 )  will  be  de-
                                                    coded to (ABC ).

                                                    URL_DECODE   -   Decode  a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI   -    Like
                                                    URL_DECODE , but with sup-
                                                    port  for   Microsoft-spe-
                                                    cific  %u encoding. If the
                                                    code is in the  full-width
                                                    ASCII    code   range   of
                                                    FF01-FF5E  ,  the   higher
                                                    byte is used to detect and
                                                    adjust  the  lower   byte.
                                                    Otherwise,  only the lower
                                                    byte  is  used   and   the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE  - Convert
                                                    all  UTF-8  character  se-
                                                    quences  to  Unicode. This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives and  false-negatives
                                                    for non-English languages.

                                      PositionalConstraint -> (string)
                                          The area within the portion of a web
                                          request that you want WAF to  search
                                          for  SearchString . Valid values in-
                                          clude the following:
                                             CONTAINS

                                          The specified part of  the  web  re-
                                          quest  must  include  the  value  of
                                          SearchString  ,  but  the   location
                                          doesn't matter.
                                             CONTAINS_WORD

                                          The  specified  part  of the web re-
                                          quest  must  include  the  value  of
                                          SearchString , and SearchString must
                                          contain only alphanumeric characters
                                          or underscore (A-Z, a-z, 0-9, or _).
                                          In addition, SearchString must be  a
                                          word,  which  means that both of the
                                          following are true:

                                          o SearchString is at  the  beginning
                                            of  the  specified part of the web
                                            request or is preceded by a  char-
                                            acter  other  than an alphanumeric
                                            character or underscore (_). Exam-
                                            ples include the value of a header
                                            and ;BadBot .

                                          o SearchString is at the end of  the
                                            specified  part of the web request
                                            or  is  followed  by  a  character
                                            other than an alphanumeric charac-
                                            ter or underscore (_),  for  exam-
                                            ple, BadBot; and -BadBot; .
                                             EXACTLY

                                          The  value  of the specified part of
                                          the web request must  exactly  match
                                          the value of SearchString .
                                             STARTS_WITH

                                          The  value  of SearchString must ap-
                                          pear at the beginning of the  speci-
                                          fied part of the web request.
                                             ENDS_WITH

                                          The  value  of SearchString must ap-
                                          pear at the  end  of  the  specified
                                          part of the web request.

                                   SqliMatchStatement -> (structure)
                                      Attackers sometimes insert malicious SQL
                                      code into web requests in an  effort  to
                                      extract  data from your database. To al-
                                      low or block web requests that appear to
                                      contain  malicious  SQL code, create one
                                      or more SQL injection match  conditions.
                                      An SQL injection match condition identi-
                                      fies the part of web requests,  such  as
                                      the  URI  or  the query string, that you
                                      want  WAF  to  inspect.  Later  in   the
                                      process,  when you create a web ACL, you
                                      specify whether to allow  or  block  re-
                                      quests  that appear to contain malicious
                                      SQL code.

                                      FieldToMatch -> (structure)
                                          The part of a web request  that  you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect a single header.  Provide
                                             the  name  of  the  header to in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example JSON:  "SingleHeader":  {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The  name of the query header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect a single query  argument.
                                             Provide the name of the query ar-
                                             gument to inspect, such as  User-
                                             Name  or  SalesRegion  . The name
                                             can be up to 30  characters  long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web request component for WAF  to
                                             inspect,   in  the   FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The  name  of the query argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that identifies a  resource,  for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the part of a  URL  that  appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text. The  request  body  immedi-
                                             ately  follows  the request head-
                                             ers. This is the part  of  a  re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to  your  web  server as the HTTP
                                             request body, such as data from a
                                             form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect   the  HTTP  method.  The
                                             method indicates the type of  op-
                                             eration  that the request is ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the  part  of a request that con-
                                             tains any  additional  data  that
                                             you  want  to  send  to  your web
                                             server as the HTTP request  body,
                                             such as data from a form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The  patterns  to look for in
                                                 the JSON body.  WAF  inspects
                                                 the  results of these pattern
                                                 matches against the rule  in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See  also  MatchScope   in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this setting  or  the  In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match only  the  specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide the include  paths
                                                    using JSON Pointer syntax.
                                                    For  example,   "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"] . For  in-
                                                    formation  about this syn-
                                                    tax, see the Internet  En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this  setting  or  the All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't use this  option
                                                        to  include all paths.
                                                        Instead, use  the  All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON body.  The  options  are
                                                 the following:

                                                 o EVALUATE_AS_STRING   -  In-
                                                   spect  the  body  as  plain
                                                   text.  WAF applies the text
                                                   transformations and inspec-
                                                   tion  criteria that you de-
                                                   fined for the JSON  inspec-
                                                   tion   to   the  body  text
                                                   string.

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates  the content only up to
                                                 the  first  parsing   failure
                                                 that it encounters.

                                                 WAF  does  its  best to parse
                                                 the  entire  JSON  body,  but
                                                 might  be  forced to stop for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root  node isn't an object or
                                                 an array.

                                                 WAF parses the  JSON  in  the
                                                 following   examples  as  two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                                   XssMatchStatement -> (structure)
                                      A  rule   statement   that   defines   a
                                      cross-site  scripting (XSS) match search
                                      for WAF to apply to  web  requests.  XSS
                                      attacks  are  those  where  the attacker
                                      uses vulnerabilities in a benign website
                                      as   a   vehicle   to  inject  malicious
                                      client-site scripts into  other  legiti-
                                      mate  web browsers. The XSS match state-
                                      ment provides the location  in  requests
                                      that  you  want  WAF  to search and text
                                      transformations to  use  on  the  search
                                      area  before  WAF searches for character
                                      sequences that are likely  to  be  mali-
                                      cious strings.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.  If  you
                                          specify  one or more transformations
                                          in a rule  statement,  WAF  performs
                                          all  transformations  on the content
                                          of the request component  identified
                                          by  FieldToMatch , starting from the
                                          lowest priority setting, before  in-
                                          specting the content for a match.

                                          (structure)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets  the relative processing
                                                 order for multiple  transfor-
                                                 mations  that are defined for
                                                 a rule  statement.  WAF  pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive, but they  must  all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE -  Decode  a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a Base64 -encoded  string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE  -   Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness  of attackers who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use unusual formatting  to
                                                    disguise  some  or  all of
                                                    the command.

                                                 o Delete the following  char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with   a  space  character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v  , vertical tab, decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE  - Decode char-
                                                    acters that  were  encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This  function  uses up to
                                                    two bytes in the  decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS encoding that  wouldnt
                                                    typically be encoded. It's
                                                    also useful in  countering
                                                    evasion, which is a combi-
                                                    nation of a backslash  and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript    for   java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the  following  ANSI C es-
                                                    cape sequences: \a , \b  ,
                                                    \f  ,  \n , \r , \t , \v ,
                                                    \\ , \? , \' , \"  ,  \xHH
                                                    (hexadecimal),  \0OOO (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE  -   Decode   a
                                                    string    of   hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters with unencoded  char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with a non-breaking  space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces   characters  that
                                                   are represented in hexadec-
                                                   imal     format,    (amper-
                                                   sand)#xhhhh;  ,  with   the
                                                   corresponding characters

                                                 o Replaces   characters  that
                                                   are represented in  decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with   the    corresponding
                                                   characters
                                                    JS_DECODE  -  Decode Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the full-width ASCII  code
                                                    range  of FF01-FF5E , then
                                                    the higher byte is used to
                                                    detect   and   adjust  the
                                                    lower byte. If  not,  only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash  from the data in the
                                                    input. The  computed  hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH   -  Remove
                                                    multiple  slashes,  direc-
                                                    tory  self-references, and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning of the input from  an
                                                    input string.

                                                    NORMALIZE_PATH_WIN  - This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH  , but first con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS  - Remove all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences   are  not  com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination of a comment  (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS   -  Replace
                                                    NULL bytes  in  the  input
                                                    with    space   characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE  -   Decode
                                                    SQL   hex   data.  Example
                                                    (0x414243 )  will  be  de-
                                                    coded to (ABC ).

                                                    URL_DECODE   -   Decode  a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI   -    Like
                                                    URL_DECODE , but with sup-
                                                    port  for   Microsoft-spe-
                                                    cific  %u encoding. If the
                                                    code is in the  full-width
                                                    ASCII    code   range   of
                                                    FF01-FF5E  ,  the   higher
                                                    byte is used to detect and
                                                    adjust  the  lower   byte.
                                                    Otherwise,  only the lower
                                                    byte  is  used   and   the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE  - Convert
                                                    all  UTF-8  character  se-
                                                    quences  to  Unicode. This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives and  false-negatives
                                                    for non-English languages.

                                   SizeConstraintStatement -> (structure)
                                      A  rule statement that compares a number
                                      of bytes against the size of  a  request
                                      component,  using a comparison operator,
                                      such as greater than (>)  or  less  than
                                      (<).  For  example,  you  can use a size
                                      constraint statement to look  for  query
                                      strings that are longer than 100 bytes.

                                      If  you configure WAF to inspect the re-
                                      quest body, WAF inspects only the  first
                                      8192  bytes  (8 KB). If the request body
                                      for your web requests never exceeds 8192
                                      bytes,  you can create a size constraint
                                      condition and block requests that have a
                                      request body greater than 8192 bytes.

                                      If  you choose URI for the value of Part
                                      of the request to filter on,  the  slash
                                      (/)  in the URI counts as one character.
                                      For example, the URI /logo.jpg  is  nine
                                      characters long.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      ComparisonOperator -> (string)
                                          The  operator  to use to compare the
                                          request part to the size setting.

                                      Size -> (long)
                                          The size, in byte, to compare to the
                                          request  part, after any transforma-
                                          tions.

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                                   GeoMatchStatement -> (structure)
                                      A rule statement used  to  identify  web
                                      requests based on country of origin.

                                      CountryCodes -> (list)
                                          An  array  of  two-character country
                                          codes, for example, [ "US", "CN" ] ,
                                          from  the  alpha-2 country ISO codes
                                          of the ISO 3166 international  stan-
                                          dard.

                                          (string)

                                      ForwardedIPConfig -> (structure)
                                          The  configuration for inspecting IP
                                          addresses in an HTTP header that you
                                          specify, instead of using the IP ad-
                                          dress that's reported by the web re-
                                          quest  origin. Commonly, this is the
                                          X-Forwarded-For  (XFF)  header,  but
                                          you can specify any header name.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          HeaderName -> (string)
                                             The name of the  HTTP  header  to
                                             use for the IP address. For exam-
                                             ple, to use  the  X-Forwarded-For
                                             (XFF)  header, set this to X-For-
                                             warded-For .

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                          FallbackBehavior -> (string)
                                             The match status to assign to the
                                             web  request   if   the   request
                                             doesn't  have  a valid IP address
                                             in the specified position.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             You  can  specify  the  following
                                             fallback behaviors:

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                   RuleGroupReferenceStatement -> (structure)
                                      A  rule  statement used to run the rules
                                      that are defined in a   RuleGroup  .  To
                                      use  this, create a rule group with your
                                      rules, then provide the ARN of the  rule
                                      group in this statement.

                                      You  cannot  nest a RuleGroupReferenceS-
                                      tatement , for example for use inside  a
                                      NotStatement  or  OrStatement  . You can
                                      only use a rule group  reference  state-
                                      ment at the top level inside a web ACL.

                                      ARN -> (string)
                                          The  Amazon  Resource  Name (ARN) of
                                          the entity.

                                      ExcludedRules -> (list)
                                          The rules  in  the  referenced  rule
                                          group whose actions are set to Count
                                          . When you exclude a rule, WAF eval-
                                          uates  it exactly as it would if the
                                          rule action  setting  were  Count  .
                                          This  is a useful option for testing
                                          the rules in a  rule  group  without
                                          modifying  how  they handle your web
                                          traffic.

                                          (structure)
                                             Specifies a single rule in a rule
                                             group  whose  action  you want to
                                             override to Count . When you  ex-
                                             clude  a  rule,  WAF evaluates it
                                             exactly as it would if  the  rule
                                             action  setting were Count . This
                                             is a useful  option  for  testing
                                             the rules in a rule group without
                                             modifying how  they  handle  your
                                             web traffic.

                                             Name -> (string)
                                                 The  name  of  the rule whose
                                                 action you want  to  override
                                                 to Count .

                                   IPSetReferenceStatement -> (structure)
                                      A  rule statement used to detect web re-
                                      quests coming  from  particular  IP  ad-
                                      dresses  or address ranges. To use this,
                                      create an  IPSet that specifies the  ad-
                                      dresses you want to detect, then use the
                                      ARN of that set in  this  statement.  To
                                      create an IP set, see  CreateIPSet .

                                      Each IP set rule statement references an
                                      IP set. You create and maintain the  set
                                      independent  of  your rules. This allows
                                      you to use the single  set  in  multiple
                                      rules.  When  you  update the referenced
                                      set, WAF automatically updates all rules
                                      that reference it.

                                      ARN -> (string)
                                          The  Amazon  Resource  Name (ARN) of
                                          the  IPSet that this statement  ref-
                                          erences.

                                      IPSetForwardedIPConfig -> (structure)
                                          The  configuration for inspecting IP
                                          addresses in an HTTP header that you
                                          specify, instead of using the IP ad-
                                          dress that's reported by the web re-
                                          quest  origin. Commonly, this is the
                                          X-Forwarded-For  (XFF)  header,  but
                                          you can specify any header name.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          HeaderName -> (string)
                                             The name of the  HTTP  header  to
                                             use for the IP address. For exam-
                                             ple, to use  the  X-Forwarded-For
                                             (XFF)  header, set this to X-For-
                                             warded-For .

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                          FallbackBehavior -> (string)
                                             The match status to assign to the
                                             web  request   if   the   request
                                             doesn't  have  a valid IP address
                                             in the specified position.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             You  can  specify  the  following
                                             fallback behaviors:

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                          Position -> (string)
                                             The  position  in  the  header to
                                             search for the  IP  address.  The
                                             header  can  contain IP addresses
                                             of the original client  and  also
                                             of   proxies.  For  example,  the
                                             header value could  be  10.1.1.1,
                                             127.0.0.0,  10.10.10.10 where the
                                             first IP address  identifies  the
                                             original   client  and  the  rest
                                             identify proxies that the request
                                             went through.

                                             The  options for this setting are
                                             the following:

                                             o FIRST - Inspect  the  first  IP
                                               address  in  the list of IP ad-
                                               dresses in the header. This  is
                                               usually  the  client's original
                                               IP.

                                             o LAST - Inspect the last IP  ad-
                                               dress  in  the  list  of IP ad-
                                               dresses in the header.

                                             o ANY - Inspect all IP  addresses
                                               in  the  header for a match. If
                                               the header contains  more  than
                                               10  IP  addresses, WAF inspects
                                               the last 10.

                                   RegexPatternSetReferenceStatement        ->
                                   (structure)
                                      A  rule statement used to search web re-
                                      quest components for matches with  regu-
                                      lar  expressions.  To use this, create a
                                      RegexPatternSet that specifies  the  ex-
                                      pressions  that you want to detect, then
                                      use the ARN of that set in  this  state-
                                      ment.  A web request matches the pattern
                                      set rule statement if the request compo-
                                      nent  matches any of the patterns in the
                                      set. To create a regex pattern set,  see
                                      CreateRegexPatternSet .

                                      Each  regex  pattern  set rule statement
                                      references a regex pattern set. You cre-
                                      ate  and maintain the set independent of
                                      your rules. This allows you to  use  the
                                      single  set  in multiple rules. When you
                                      update the referenced set, WAF automati-
                                      cally  updates  all rules that reference
                                      it.

                                      ARN -> (string)
                                          The Amazon Resource  Name  (ARN)  of
                                          the    RegexPatternSet   that   this
                                          statement references.

                                      FieldToMatch -> (structure)
                                          The part of a web request  that  you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect a single header.  Provide
                                             the  name  of  the  header to in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example JSON:  "SingleHeader":  {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The  name of the query header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect a single query  argument.
                                             Provide the name of the query ar-
                                             gument to inspect, such as  User-
                                             Name  or  SalesRegion  . The name
                                             can be up to 30  characters  long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web request component for WAF  to
                                             inspect,   in  the   FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The  name  of the query argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that identifies a  resource,  for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the part of a  URL  that  appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text. The  request  body  immedi-
                                             ately  follows  the request head-
                                             ers. This is the part  of  a  re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to  your  web  server as the HTTP
                                             request body, such as data from a
                                             form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect   the  HTTP  method.  The
                                             method indicates the type of  op-
                                             eration  that the request is ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the  part  of a request that con-
                                             tains any  additional  data  that
                                             you  want  to  send  to  your web
                                             server as the HTTP request  body,
                                             such as data from a form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The  patterns  to look for in
                                                 the JSON body.  WAF  inspects
                                                 the  results of these pattern
                                                 matches against the rule  in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See  also  MatchScope   in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this setting  or  the  In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match only  the  specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide the include  paths
                                                    using JSON Pointer syntax.
                                                    For  example,   "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"] . For  in-
                                                    formation  about this syn-
                                                    tax, see the Internet  En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this  setting  or  the All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't use this  option
                                                        to  include all paths.
                                                        Instead, use  the  All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON body.  The  options  are
                                                 the following:

                                                 o EVALUATE_AS_STRING   -  In-
                                                   spect  the  body  as  plain
                                                   text.  WAF applies the text
                                                   transformations and inspec-
                                                   tion  criteria that you de-
                                                   fined for the JSON  inspec-
                                                   tion   to   the  body  text
                                                   string.

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates  the content only up to
                                                 the  first  parsing   failure
                                                 that it encounters.

                                                 WAF  does  its  best to parse
                                                 the  entire  JSON  body,  but
                                                 might  be  forced to stop for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root  node isn't an object or
                                                 an array.

                                                 WAF parses the  JSON  in  the
                                                 following   examples  as  two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                                   RateBasedStatement -> (structure)
                                      A rate-based rule tracks the rate of re-
                                      quests  for each originating IP address,
                                      and triggers the rule  action  when  the
                                      rate exceeds a limit that you specify on
                                      the number of requests in  any  5-minute
                                      time  span.  You  can  use this to put a
                                      temporary block on requests from  an  IP
                                      address  that  is  sending excessive re-
                                      quests.

                                      WAF tracks and manages web requests sep-
                                      arately   for   each   instance   of   a
                                      rate-based rule that you use. For  exam-
                                      ple,  if you provide the same rate-based
                                      rule settings in two web ACLs,  each  of
                                      the  two  rule  statements  represents a
                                      separate instance of the rate-based rule
                                      and gets its own tracking and management
                                      by WAF. If you define a rate-based  rule
                                      inside  a  rule group, and then use that
                                      rule group in multiple places, each  use
                                      creates   a  separate  instance  of  the
                                      rate-based rule that gets its own track-
                                      ing and management by WAF.

                                      When   the  rule  action  triggers,  WAF
                                      blocks additional requests from  the  IP
                                      address until the request rate falls be-
                                      low the limit.

                                      You can optionally nest  another  state-
                                      ment inside the rate-based statement, to
                                      narrow the scope of the rule so that  it
                                      only  counts  requests  that  match  the
                                      nested statement. For example, based  on
                                      recent  requests that you have seen from
                                      an  attacker,   you   might   create   a
                                      rate-based  rule  with a nested AND rule
                                      statement that  contains  the  following
                                      nested statements:

                                      o An  IP  match statement with an IP set
                                        that specified the address 192.0.2.44.

                                      o A string match statement that searches
                                        in   the  User-Agent  header  for  the
                                        string BadBot.

                                      In this rate-based rule, you also define
                                      a rate limit. For this example, the rate
                                      limit is 1,000. Requests that meet  both
                                      of  the conditions in the statements are
                                      counted. If the count exceeds 1,000  re-
                                      quests per five minutes, the rule action
                                      triggers. Requests that do not meet both
                                      conditions  are  not counted towards the
                                      rate limit and are not affected by  this
                                      rule.

                                      You cannot nest a RateBasedStatement in-
                                      side another statement, for example  in-
                                      side a NotStatement or OrStatement . You
                                      can define a RateBasedStatement inside a
                                      web ACL and inside a rule group.

                                      Limit -> (long)
                                          The  limit  on requests per 5-minute
                                          period for a single  originating  IP
                                          address. If the statement includes a
                                          ScopeDownStatement , this  limit  is
                                          applied  only  to  the requests that
                                          match the statement.

                                      AggregateKeyType -> (string)
                                          Setting that indicates how to aggre-
                                          gate the request counts. The options
                                          are the following:

                                          o IP - Aggregate the request  counts
                                            on the IP address from the web re-
                                            quest origin.

                                          o FORWARDED_IP - Aggregate  the  re-
                                            quest  counts  on the first IP ad-
                                            dress in an HTTP  header.  If  you
                                            use   this,   configure  the  For-
                                            wardedIPConfig ,  to  specify  the
                                            header to use.

                                      (  ...  recursive ... )ForwardedIPConfig
                                      -> (structure)
                                          The configuration for inspecting  IP
                                          addresses in an HTTP header that you
                                          specify, instead of using the IP ad-
                                          dress that's reported by the web re-
                                          quest origin. Commonly, this is  the
                                          X-Forwarded-For  (XFF)  header,  but
                                          you can specify any header name.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present   in   the  request,  WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          This is required if AggregateKeyType
                                          is set to FORWARDED_IP .

                                          HeaderName -> (string)
                                             The name of the  HTTP  header  to
                                             use for the IP address. For exam-
                                             ple, to use  the  X-Forwarded-For
                                             (XFF)  header, set this to X-For-
                                             warded-For .

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                          FallbackBehavior -> (string)
                                             The match status to assign to the
                                             web  request   if   the   request
                                             doesn't  have  a valid IP address
                                             in the specified position.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             You  can  specify  the  following
                                             fallback behaviors:

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                   AndStatement -> (structure)
                                      A logical rule statement used to combine
                                      other rule statements  with  AND  logic.
                                      You  provide  more  than  one  Statement
                                      within the AndStatement .

                                      Statements -> (list)
                                          The statements to combine  with  AND
                                          logic.  You  can  use any statements
                                          that can be nested.

                                          ( ... recursive ... )

                                   OrStatement -> (structure)
                                      A logical rule statement used to combine
                                      other rule statements with OR logic. You
                                      provide more than one  Statement  within
                                      the OrStatement .

                                      Statements -> (list)
                                          The  statements  to  combine with OR
                                          logic. You can  use  any  statements
                                          that can be nested.

                                          ( ... recursive ... )

                                   NotStatement -> (structure)
                                      A  logical rule statement used to negate
                                      the results of another  rule  statement.
                                      You  provide  one   Statement within the
                                      NotStatement .

                                      ( ... recursive ... )

                                   ManagedRuleGroupStatement -> (structure)
                                      A rule statement used to run  the  rules
                                      that  are  defined  in  a  managed  rule
                                      group. To use this, provide  the  vendor
                                      name  and  the name of the rule group in
                                      this statement. You can retrieve the re-
                                      quired names by calling  ListAvailableM-
                                      anagedRuleGroups .

                                      You cannot nest a ManagedRuleGroupState-
                                      ment , for example for use inside a Not-
                                      Statement or OrStatement . It  can  only
                                      be  referenced  as a top-level statement
                                      within a rule.

                                      VendorName -> (string)
                                          The name of the managed  rule  group
                                          vendor. You use this, along with the
                                          rule group  name,  to  identify  the
                                          rule group.

                                      Name -> (string)
                                          The  name of the managed rule group.
                                          You use this, along with the  vendor
                                          name, to identify the rule group.

                                      Version -> (string)
                                          The  version  of  the  managed  rule
                                          group to use. If you  specify  this,
                                          the  version  setting is fixed until
                                          you change it. If you don't  specify
                                          this,  WAF uses the vendor's default
                                          version, and then keeps the  version
                                          at  the  vendor's  default  when the
                                          vendor  updates  the  managed   rule
                                          group settings.

                                      ExcludedRules -> (list)
                                          The  rules  in  the  referenced rule
                                          group whose actions are set to Count
                                          . When you exclude a rule, WAF eval-
                                          uates it exactly as it would if  the
                                          rule  action  setting  were  Count .
                                          This is a useful option for  testing
                                          the  rules  in  a rule group without
                                          modifying how they handle  your  web
                                          traffic.

                                          (structure)
                                             Specifies a single rule in a rule
                                             group whose action  you  want  to
                                             override  to Count . When you ex-
                                             clude a rule,  WAF  evaluates  it
                                             exactly  as  it would if the rule
                                             action setting were Count .  This
                                             is  a  useful  option for testing
                                             the rules in a rule group without
                                             modifying  how  they  handle your
                                             web traffic.

                                             Name -> (string)
                                                 The name of  the  rule  whose
                                                 action  you  want to override
                                                 to Count .

                                      ( ... recursive ... )

                                   LabelMatchStatement -> (structure)
                                      A rule statement that defines  a  string
                                      match  search  against  labels that have
                                      been added to the web request  by  rules
                                      that have already run in the web ACL.

                                      The  label  match statement provides the
                                      label or namespace string to search for.
                                      The label string can represent a part or
                                      all of the fully  qualified  label  name
                                      that  had been added to the web request.
                                      Fully qualified labels  have  a  prefix,
                                      optional namespaces, and label name. The
                                      prefix identifies the rule group or  web
                                      ACL  context  of the rule that added the
                                      label. If you do not provide  the  fully
                                      qualified   name  in  your  label  match
                                      string, WAF performs the search for  la-
                                      bels that were added in the same context
                                      as the label match statement.

                                      Scope -> (string)
                                          Specify whether you  want  to  match
                                          using  the  label  name  or just the
                                          namespace.

                                      Key -> (string)
                                          The string  to  match  against.  The
                                          setting you provide for this depends
                                          on the match statement's Scope  set-
                                          ting:

                                          o If  the  Scope  indicates  LABEL ,
                                            then this specification  must  in-
                                            clude the name and can include any
                                            number  of   preceding   namespace
                                            specifications  and  prefix  up to
                                            providing the fully qualified  la-
                                            bel name.

                                          o If the Scope indicates NAMESPACE ,
                                            then this  specification  can  in-
                                            clude  any  number  of  contiguous
                                            namespace strings, and can include
                                            the  entire label namespace prefix
                                            from the rule  group  or  web  ACL
                                            where the label originates.

                                          Labels are case sensitive and compo-
                                          nents of a label must  be  separated
                                          by colon, for example NS1:NS2:name .

                                   RegexMatchStatement -> (structure)
                                      A  rule statement used to search web re-
                                      quest components for a match  against  a
                                      single regular expression.

                                      RegexString -> (string)
                                          The  string representing the regular
                                          expression.

                                      FieldToMatch -> (structure)
                                          The part of a web request  that  you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect a single header.  Provide
                                             the  name  of  the  header to in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example JSON:  "SingleHeader":  {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The  name of the query header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect a single query  argument.
                                             Provide the name of the query ar-
                                             gument to inspect, such as  User-
                                             Name  or  SalesRegion  . The name
                                             can be up to 30  characters  long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web request component for WAF  to
                                             inspect,   in  the   FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The  name  of the query argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that identifies a  resource,  for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the part of a  URL  that  appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text. The  request  body  immedi-
                                             ately  follows  the request head-
                                             ers. This is the part  of  a  re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to  your  web  server as the HTTP
                                             request body, such as data from a
                                             form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect   the  HTTP  method.  The
                                             method indicates the type of  op-
                                             eration  that the request is ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the  part  of a request that con-
                                             tains any  additional  data  that
                                             you  want  to  send  to  your web
                                             server as the HTTP request  body,
                                             such as data from a form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The  patterns  to look for in
                                                 the JSON body.  WAF  inspects
                                                 the  results of these pattern
                                                 matches against the rule  in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See  also  MatchScope   in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this setting  or  the  In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match only  the  specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide the include  paths
                                                    using JSON Pointer syntax.
                                                    For  example,   "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"] . For  in-
                                                    formation  about this syn-
                                                    tax, see the Internet  En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this  setting  or  the All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't use this  option
                                                        to  include all paths.
                                                        Instead, use  the  All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON body.  The  options  are
                                                 the following:

                                                 o EVALUATE_AS_STRING   -  In-
                                                   spect  the  body  as  plain
                                                   text.  WAF applies the text
                                                   transformations and inspec-
                                                   tion  criteria that you de-
                                                   fined for the JSON  inspec-
                                                   tion   to   the  body  text
                                                   string.

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates  the content only up to
                                                 the  first  parsing   failure
                                                 that it encounters.

                                                 WAF  does  its  best to parse
                                                 the  entire  JSON  body,  but
                                                 might  be  forced to stop for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root  node isn't an object or
                                                 an array.

                                                 WAF parses the  JSON  in  the
                                                 following   examples  as  two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                            ManagedRuleGroupStatement -> (structure)
                               A rule statement used to run the rules that are
                               defined  in  a managed rule group. To use this,
                               provide the vendor name and  the  name  of  the
                               rule  group in this statement. You can retrieve
                               the required names by calling   ListAvailableM-
                               anagedRuleGroups .

                               You  cannot  nest a ManagedRuleGroupStatement ,
                               for example for use inside  a  NotStatement  or
                               OrStatement  .  It  can only be referenced as a
                               top-level statement within a rule.

                               VendorName -> (string)
                                   The name of the managed rule group  vendor.
                                   You  use  this,  along  with the rule group
                                   name, to identify the rule group.

                               Name -> (string)
                                   The name of the managed rule group. You use
                                   this,  along with the vendor name, to iden-
                                   tify the rule group.

                               Version -> (string)
                                   The version of the managed  rule  group  to
                                   use.  If you specify this, the version set-
                                   ting is fixed until you change it.  If  you
                                   don't  specify  this, WAF uses the vendor's
                                   default version, and then keeps the version
                                   at the vendor's default when the vendor up-
                                   dates the managed rule group settings.

                               ExcludedRules -> (list)
                                   The rules  in  the  referenced  rule  group
                                   whose  actions  are set to Count . When you
                                   exclude a rule, WAF evaluates it exactly as
                                   it  would  if  the rule action setting were
                                   Count . This is a useful option for testing
                                   the rules in a rule group without modifying
                                   how they handle your web traffic.

                                   (structure)
                                      Specifies a single rule in a rule  group
                                      whose  action  you  want  to override to
                                      Count . When you  exclude  a  rule,  WAF
                                      evaluates  it exactly as it would if the
                                      rule action setting were Count . This is
                                      a useful option for testing the rules in
                                      a rule group without modifying how  they
                                      handle your web traffic.

                                      Name -> (string)
                                          The  name  of  the rule whose action
                                          you want to override to Count .

                               ScopeDownStatement -> (structure)
                                   An optional nested statement  that  narrows
                                   the  scope  of  the  web  requests that are
                                   evaluated by the managed  rule  group.  Re-
                                   quests are only evaluated by the rule group
                                   if they match the scope-down statement. You
                                   can  use  any  nestable   Statement  in the
                                   scope-down  statement,  and  you  can  nest
                                   statements  at  any  level, the same as you
                                   can for a rule statement.

                                   ByteMatchStatement -> (structure)
                                      A rule statement that defines  a  string
                                      match search for WAF to apply to web re-
                                      quests. The byte  match  statement  pro-
                                      vides the bytes to search for, the loca-
                                      tion in requests that you  want  WAF  to
                                      search, and other settings. The bytes to
                                      search for are typically a  string  that
                                      corresponds  with  ASCII  characters. In
                                      the WAF console and the developer guide,
                                      this  is  refered  to  as a string match
                                      statement.

                                      SearchString -> (blob)
                                          A string value that you want WAF  to
                                          search for. WAF searches only in the
                                          part of web requests that you desig-
                                          nate for inspection in  FieldToMatch
                                          . The maximum length of the value is
                                          50 bytes.

                                          Valid values depend on the component
                                          that you specify for  inspection  in
                                          FieldToMatch :

                                          o Method  : The HTTP method that you
                                            want WAF to search for. This indi-
                                            cates the type of operation speci-
                                            fied in the request.

                                          o UriPath : The value that you  want
                                            WAF to search for in the URI path,
                                            for example,  /images/daily-ad.jpg
                                            .

                                          If  SearchString includes alphabetic
                                          characters A-Z and  a-z,  note  that
                                          the value is case sensitive.
                                             If you're using the WAF API

                                          Specify  a base64-encoded version of
                                          the value. The maximum length of the
                                          value before you base64-encode it is
                                          50 bytes.

                                          For example, suppose  the  value  of
                                          Type is HEADER and the value of Data
                                          is  User-Agent  .  If  you  want  to
                                          search the User-Agent header for the
                                          value  BadBot  ,  you  base64-encode
                                          BadBot  using  MIME  base64-encoding
                                          and include the resulting value, Qm-
                                          FkQm90  ,  in  the  value of Search-
                                          String .
                                             If you're using the CLI or one of
                                             the Amazon Web Services SDKs

                                          The  value  that  you  want  WAF  to
                                          search for.  The  SDK  automatically
                                          base64 encodes the value.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.  If  you
                                          specify  one or more transformations
                                          in a rule  statement,  WAF  performs
                                          all  transformations  on the content
                                          of the request component  identified
                                          by  FieldToMatch , starting from the
                                          lowest priority setting, before  in-
                                          specting the content for a match.

                                          (structure)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets  the relative processing
                                                 order for multiple  transfor-
                                                 mations  that are defined for
                                                 a rule  statement.  WAF  pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive, but they  must  all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE -  Decode  a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a Base64 -encoded  string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE  -   Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness  of attackers who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use unusual formatting  to
                                                    disguise  some  or  all of
                                                    the command.

                                                 o Delete the following  char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with   a  space  character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v  , vertical tab, decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE  - Decode char-
                                                    acters that  were  encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This  function  uses up to
                                                    two bytes in the  decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS encoding that  wouldnt
                                                    typically be encoded. It's
                                                    also useful in  countering
                                                    evasion, which is a combi-
                                                    nation of a backslash  and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript    for   java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the  following  ANSI C es-
                                                    cape sequences: \a , \b  ,
                                                    \f  ,  \n , \r , \t , \v ,
                                                    \\ , \? , \' , \"  ,  \xHH
                                                    (hexadecimal),  \0OOO (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE  -   Decode   a
                                                    string    of   hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters with unencoded  char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with a non-breaking  space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces   characters  that
                                                   are represented in hexadec-
                                                   imal     format,    (amper-
                                                   sand)#xhhhh;  ,  with   the
                                                   corresponding characters

                                                 o Replaces   characters  that
                                                   are represented in  decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with   the    corresponding
                                                   characters
                                                    JS_DECODE  -  Decode Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the full-width ASCII  code
                                                    range  of FF01-FF5E , then
                                                    the higher byte is used to
                                                    detect   and   adjust  the
                                                    lower byte. If  not,  only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash  from the data in the
                                                    input. The  computed  hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH   -  Remove
                                                    multiple  slashes,  direc-
                                                    tory  self-references, and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning of the input from  an
                                                    input string.

                                                    NORMALIZE_PATH_WIN  - This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH  , but first con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS  - Remove all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences   are  not  com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination of a comment  (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS   -  Replace
                                                    NULL bytes  in  the  input
                                                    with    space   characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE  -   Decode
                                                    SQL   hex   data.  Example
                                                    (0x414243 )  will  be  de-
                                                    coded to (ABC ).

                                                    URL_DECODE   -   Decode  a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI   -    Like
                                                    URL_DECODE , but with sup-
                                                    port  for   Microsoft-spe-
                                                    cific  %u encoding. If the
                                                    code is in the  full-width
                                                    ASCII    code   range   of
                                                    FF01-FF5E  ,  the   higher
                                                    byte is used to detect and
                                                    adjust  the  lower   byte.
                                                    Otherwise,  only the lower
                                                    byte  is  used   and   the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE  - Convert
                                                    all  UTF-8  character  se-
                                                    quences  to  Unicode. This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives and  false-negatives
                                                    for non-English languages.

                                      PositionalConstraint -> (string)
                                          The area within the portion of a web
                                          request that you want WAF to  search
                                          for  SearchString . Valid values in-
                                          clude the following:
                                             CONTAINS

                                          The specified part of  the  web  re-
                                          quest  must  include  the  value  of
                                          SearchString  ,  but  the   location
                                          doesn't matter.
                                             CONTAINS_WORD

                                          The  specified  part  of the web re-
                                          quest  must  include  the  value  of
                                          SearchString , and SearchString must
                                          contain only alphanumeric characters
                                          or underscore (A-Z, a-z, 0-9, or _).
                                          In addition, SearchString must be  a
                                          word,  which  means that both of the
                                          following are true:

                                          o SearchString is at  the  beginning
                                            of  the  specified part of the web
                                            request or is preceded by a  char-
                                            acter  other  than an alphanumeric
                                            character or underscore (_). Exam-
                                            ples include the value of a header
                                            and ;BadBot .

                                          o SearchString is at the end of  the
                                            specified  part of the web request
                                            or  is  followed  by  a  character
                                            other than an alphanumeric charac-
                                            ter or underscore (_),  for  exam-
                                            ple, BadBot; and -BadBot; .
                                             EXACTLY

                                          The  value  of the specified part of
                                          the web request must  exactly  match
                                          the value of SearchString .
                                             STARTS_WITH

                                          The  value  of SearchString must ap-
                                          pear at the beginning of the  speci-
                                          fied part of the web request.
                                             ENDS_WITH

                                          The  value  of SearchString must ap-
                                          pear at the  end  of  the  specified
                                          part of the web request.

                                   SqliMatchStatement -> (structure)
                                      Attackers sometimes insert malicious SQL
                                      code into web requests in an  effort  to
                                      extract  data from your database. To al-
                                      low or block web requests that appear to
                                      contain  malicious  SQL code, create one
                                      or more SQL injection match  conditions.
                                      An SQL injection match condition identi-
                                      fies the part of web requests,  such  as
                                      the  URI  or  the query string, that you
                                      want  WAF  to  inspect.  Later  in   the
                                      process,  when you create a web ACL, you
                                      specify whether to allow  or  block  re-
                                      quests  that appear to contain malicious
                                      SQL code.

                                      FieldToMatch -> (structure)
                                          The part of a web request  that  you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect a single header.  Provide
                                             the  name  of  the  header to in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example JSON:  "SingleHeader":  {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The  name of the query header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect a single query  argument.
                                             Provide the name of the query ar-
                                             gument to inspect, such as  User-
                                             Name  or  SalesRegion  . The name
                                             can be up to 30  characters  long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web request component for WAF  to
                                             inspect,   in  the   FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The  name  of the query argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that identifies a  resource,  for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the part of a  URL  that  appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text. The  request  body  immedi-
                                             ately  follows  the request head-
                                             ers. This is the part  of  a  re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to  your  web  server as the HTTP
                                             request body, such as data from a
                                             form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect   the  HTTP  method.  The
                                             method indicates the type of  op-
                                             eration  that the request is ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the  part  of a request that con-
                                             tains any  additional  data  that
                                             you  want  to  send  to  your web
                                             server as the HTTP request  body,
                                             such as data from a form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The  patterns  to look for in
                                                 the JSON body.  WAF  inspects
                                                 the  results of these pattern
                                                 matches against the rule  in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See  also  MatchScope   in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this setting  or  the  In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match only  the  specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide the include  paths
                                                    using JSON Pointer syntax.
                                                    For  example,   "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"] . For  in-
                                                    formation  about this syn-
                                                    tax, see the Internet  En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this  setting  or  the All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't use this  option
                                                        to  include all paths.
                                                        Instead, use  the  All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON body.  The  options  are
                                                 the following:

                                                 o EVALUATE_AS_STRING   -  In-
                                                   spect  the  body  as  plain
                                                   text.  WAF applies the text
                                                   transformations and inspec-
                                                   tion  criteria that you de-
                                                   fined for the JSON  inspec-
                                                   tion   to   the  body  text
                                                   string.

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates  the content only up to
                                                 the  first  parsing   failure
                                                 that it encounters.

                                                 WAF  does  its  best to parse
                                                 the  entire  JSON  body,  but
                                                 might  be  forced to stop for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root  node isn't an object or
                                                 an array.

                                                 WAF parses the  JSON  in  the
                                                 following   examples  as  two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                                   XssMatchStatement -> (structure)
                                      A  rule   statement   that   defines   a
                                      cross-site  scripting (XSS) match search
                                      for WAF to apply to  web  requests.  XSS
                                      attacks  are  those  where  the attacker
                                      uses vulnerabilities in a benign website
                                      as   a   vehicle   to  inject  malicious
                                      client-site scripts into  other  legiti-
                                      mate  web browsers. The XSS match state-
                                      ment provides the location  in  requests
                                      that  you  want  WAF  to search and text
                                      transformations to  use  on  the  search
                                      area  before  WAF searches for character
                                      sequences that are likely  to  be  mali-
                                      cious strings.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.  If  you
                                          specify  one or more transformations
                                          in a rule  statement,  WAF  performs
                                          all  transformations  on the content
                                          of the request component  identified
                                          by  FieldToMatch , starting from the
                                          lowest priority setting, before  in-
                                          specting the content for a match.

                                          (structure)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets  the relative processing
                                                 order for multiple  transfor-
                                                 mations  that are defined for
                                                 a rule  statement.  WAF  pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive, but they  must  all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE -  Decode  a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a Base64 -encoded  string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE  -   Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness  of attackers who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use unusual formatting  to
                                                    disguise  some  or  all of
                                                    the command.

                                                 o Delete the following  char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with   a  space  character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v  , vertical tab, decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE  - Decode char-
                                                    acters that  were  encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This  function  uses up to
                                                    two bytes in the  decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS encoding that  wouldnt
                                                    typically be encoded. It's
                                                    also useful in  countering
                                                    evasion, which is a combi-
                                                    nation of a backslash  and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript    for   java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the  following  ANSI C es-
                                                    cape sequences: \a , \b  ,
                                                    \f  ,  \n , \r , \t , \v ,
                                                    \\ , \? , \' , \"  ,  \xHH
                                                    (hexadecimal),  \0OOO (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE  -   Decode   a
                                                    string    of   hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters with unencoded  char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with a non-breaking  space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces   characters  that
                                                   are represented in hexadec-
                                                   imal     format,    (amper-
                                                   sand)#xhhhh;  ,  with   the
                                                   corresponding characters

                                                 o Replaces   characters  that
                                                   are represented in  decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with   the    corresponding
                                                   characters
                                                    JS_DECODE  -  Decode Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the full-width ASCII  code
                                                    range  of FF01-FF5E , then
                                                    the higher byte is used to
                                                    detect   and   adjust  the
                                                    lower byte. If  not,  only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash  from the data in the
                                                    input. The  computed  hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH   -  Remove
                                                    multiple  slashes,  direc-
                                                    tory  self-references, and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning of the input from  an
                                                    input string.

                                                    NORMALIZE_PATH_WIN  - This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH  , but first con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS  - Remove all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences   are  not  com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination of a comment  (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS   -  Replace
                                                    NULL bytes  in  the  input
                                                    with    space   characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE  -   Decode
                                                    SQL   hex   data.  Example
                                                    (0x414243 )  will  be  de-
                                                    coded to (ABC ).

                                                    URL_DECODE   -   Decode  a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI   -    Like
                                                    URL_DECODE , but with sup-
                                                    port  for   Microsoft-spe-
                                                    cific  %u encoding. If the
                                                    code is in the  full-width
                                                    ASCII    code   range   of
                                                    FF01-FF5E  ,  the   higher
                                                    byte is used to detect and
                                                    adjust  the  lower   byte.
                                                    Otherwise,  only the lower
                                                    byte  is  used   and   the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE  - Convert
                                                    all  UTF-8  character  se-
                                                    quences  to  Unicode. This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives and  false-negatives
                                                    for non-English languages.

                                   SizeConstraintStatement -> (structure)
                                      A  rule statement that compares a number
                                      of bytes against the size of  a  request
                                      component,  using a comparison operator,
                                      such as greater than (>)  or  less  than
                                      (<).  For  example,  you  can use a size
                                      constraint statement to look  for  query
                                      strings that are longer than 100 bytes.

                                      If  you configure WAF to inspect the re-
                                      quest body, WAF inspects only the  first
                                      8192  bytes  (8 KB). If the request body
                                      for your web requests never exceeds 8192
                                      bytes,  you can create a size constraint
                                      condition and block requests that have a
                                      request body greater than 8192 bytes.

                                      If  you choose URI for the value of Part
                                      of the request to filter on,  the  slash
                                      (/)  in the URI counts as one character.
                                      For example, the URI /logo.jpg  is  nine
                                      characters long.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      ComparisonOperator -> (string)
                                          The  operator  to use to compare the
                                          request part to the size setting.

                                      Size -> (long)
                                          The size, in byte, to compare to the
                                          request  part, after any transforma-
                                          tions.

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                                   GeoMatchStatement -> (structure)
                                      A rule statement used  to  identify  web
                                      requests based on country of origin.

                                      CountryCodes -> (list)
                                          An  array  of  two-character country
                                          codes, for example, [ "US", "CN" ] ,
                                          from  the  alpha-2 country ISO codes
                                          of the ISO 3166 international  stan-
                                          dard.

                                          (string)

                                      ForwardedIPConfig -> (structure)
                                          The  configuration for inspecting IP
                                          addresses in an HTTP header that you
                                          specify, instead of using the IP ad-
                                          dress that's reported by the web re-
                                          quest  origin. Commonly, this is the
                                          X-Forwarded-For  (XFF)  header,  but
                                          you can specify any header name.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          HeaderName -> (string)
                                             The name of the  HTTP  header  to
                                             use for the IP address. For exam-
                                             ple, to use  the  X-Forwarded-For
                                             (XFF)  header, set this to X-For-
                                             warded-For .

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                          FallbackBehavior -> (string)
                                             The match status to assign to the
                                             web  request   if   the   request
                                             doesn't  have  a valid IP address
                                             in the specified position.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             You  can  specify  the  following
                                             fallback behaviors:

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                   RuleGroupReferenceStatement -> (structure)
                                      A  rule  statement used to run the rules
                                      that are defined in a   RuleGroup  .  To
                                      use  this, create a rule group with your
                                      rules, then provide the ARN of the  rule
                                      group in this statement.

                                      You  cannot  nest a RuleGroupReferenceS-
                                      tatement , for example for use inside  a
                                      NotStatement  or  OrStatement  . You can
                                      only use a rule group  reference  state-
                                      ment at the top level inside a web ACL.

                                      ARN -> (string)
                                          The  Amazon  Resource  Name (ARN) of
                                          the entity.

                                      ExcludedRules -> (list)
                                          The rules  in  the  referenced  rule
                                          group whose actions are set to Count
                                          . When you exclude a rule, WAF eval-
                                          uates  it exactly as it would if the
                                          rule action  setting  were  Count  .
                                          This  is a useful option for testing
                                          the rules in a  rule  group  without
                                          modifying  how  they handle your web
                                          traffic.

                                          (structure)
                                             Specifies a single rule in a rule
                                             group  whose  action  you want to
                                             override to Count . When you  ex-
                                             clude  a  rule,  WAF evaluates it
                                             exactly as it would if  the  rule
                                             action  setting were Count . This
                                             is a useful  option  for  testing
                                             the rules in a rule group without
                                             modifying how  they  handle  your
                                             web traffic.

                                             Name -> (string)
                                                 The  name  of  the rule whose
                                                 action you want  to  override
                                                 to Count .

                                   IPSetReferenceStatement -> (structure)
                                      A  rule statement used to detect web re-
                                      quests coming  from  particular  IP  ad-
                                      dresses  or address ranges. To use this,
                                      create an  IPSet that specifies the  ad-
                                      dresses you want to detect, then use the
                                      ARN of that set in  this  statement.  To
                                      create an IP set, see  CreateIPSet .

                                      Each IP set rule statement references an
                                      IP set. You create and maintain the  set
                                      independent  of  your rules. This allows
                                      you to use the single  set  in  multiple
                                      rules.  When  you  update the referenced
                                      set, WAF automatically updates all rules
                                      that reference it.

                                      ARN -> (string)
                                          The  Amazon  Resource  Name (ARN) of
                                          the  IPSet that this statement  ref-
                                          erences.

                                      IPSetForwardedIPConfig -> (structure)
                                          The  configuration for inspecting IP
                                          addresses in an HTTP header that you
                                          specify, instead of using the IP ad-
                                          dress that's reported by the web re-
                                          quest  origin. Commonly, this is the
                                          X-Forwarded-For  (XFF)  header,  but
                                          you can specify any header name.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          HeaderName -> (string)
                                             The name of the  HTTP  header  to
                                             use for the IP address. For exam-
                                             ple, to use  the  X-Forwarded-For
                                             (XFF)  header, set this to X-For-
                                             warded-For .

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                          FallbackBehavior -> (string)
                                             The match status to assign to the
                                             web  request   if   the   request
                                             doesn't  have  a valid IP address
                                             in the specified position.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             You  can  specify  the  following
                                             fallback behaviors:

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                          Position -> (string)
                                             The  position  in  the  header to
                                             search for the  IP  address.  The
                                             header  can  contain IP addresses
                                             of the original client  and  also
                                             of   proxies.  For  example,  the
                                             header value could  be  10.1.1.1,
                                             127.0.0.0,  10.10.10.10 where the
                                             first IP address  identifies  the
                                             original   client  and  the  rest
                                             identify proxies that the request
                                             went through.

                                             The  options for this setting are
                                             the following:

                                             o FIRST - Inspect  the  first  IP
                                               address  in  the list of IP ad-
                                               dresses in the header. This  is
                                               usually  the  client's original
                                               IP.

                                             o LAST - Inspect the last IP  ad-
                                               dress  in  the  list  of IP ad-
                                               dresses in the header.

                                             o ANY - Inspect all IP  addresses
                                               in  the  header for a match. If
                                               the header contains  more  than
                                               10  IP  addresses, WAF inspects
                                               the last 10.

                                   RegexPatternSetReferenceStatement        ->
                                   (structure)
                                      A  rule statement used to search web re-
                                      quest components for matches with  regu-
                                      lar  expressions.  To use this, create a
                                      RegexPatternSet that specifies  the  ex-
                                      pressions  that you want to detect, then
                                      use the ARN of that set in  this  state-
                                      ment.  A web request matches the pattern
                                      set rule statement if the request compo-
                                      nent  matches any of the patterns in the
                                      set. To create a regex pattern set,  see
                                      CreateRegexPatternSet .

                                      Each  regex  pattern  set rule statement
                                      references a regex pattern set. You cre-
                                      ate  and maintain the set independent of
                                      your rules. This allows you to  use  the
                                      single  set  in multiple rules. When you
                                      update the referenced set, WAF automati-
                                      cally  updates  all rules that reference
                                      it.

                                      ARN -> (string)
                                          The Amazon Resource  Name  (ARN)  of
                                          the    RegexPatternSet   that   this
                                          statement references.

                                      FieldToMatch -> (structure)
                                          The part of a web request  that  you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect a single header.  Provide
                                             the  name  of  the  header to in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example JSON:  "SingleHeader":  {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The  name of the query header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect a single query  argument.
                                             Provide the name of the query ar-
                                             gument to inspect, such as  User-
                                             Name  or  SalesRegion  . The name
                                             can be up to 30  characters  long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web request component for WAF  to
                                             inspect,   in  the   FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The  name  of the query argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that identifies a  resource,  for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the part of a  URL  that  appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text. The  request  body  immedi-
                                             ately  follows  the request head-
                                             ers. This is the part  of  a  re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to  your  web  server as the HTTP
                                             request body, such as data from a
                                             form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect   the  HTTP  method.  The
                                             method indicates the type of  op-
                                             eration  that the request is ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the  part  of a request that con-
                                             tains any  additional  data  that
                                             you  want  to  send  to  your web
                                             server as the HTTP request  body,
                                             such as data from a form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The  patterns  to look for in
                                                 the JSON body.  WAF  inspects
                                                 the  results of these pattern
                                                 matches against the rule  in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See  also  MatchScope   in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this setting  or  the  In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match only  the  specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide the include  paths
                                                    using JSON Pointer syntax.
                                                    For  example,   "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"] . For  in-
                                                    formation  about this syn-
                                                    tax, see the Internet  En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this  setting  or  the All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't use this  option
                                                        to  include all paths.
                                                        Instead, use  the  All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON body.  The  options  are
                                                 the following:

                                                 o EVALUATE_AS_STRING   -  In-
                                                   spect  the  body  as  plain
                                                   text.  WAF applies the text
                                                   transformations and inspec-
                                                   tion  criteria that you de-
                                                   fined for the JSON  inspec-
                                                   tion   to   the  body  text
                                                   string.

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates  the content only up to
                                                 the  first  parsing   failure
                                                 that it encounters.

                                                 WAF  does  its  best to parse
                                                 the  entire  JSON  body,  but
                                                 might  be  forced to stop for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root  node isn't an object or
                                                 an array.

                                                 WAF parses the  JSON  in  the
                                                 following   examples  as  two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                                   RateBasedStatement -> (structure)
                                      A rate-based rule tracks the rate of re-
                                      quests  for each originating IP address,
                                      and triggers the rule  action  when  the
                                      rate exceeds a limit that you specify on
                                      the number of requests in  any  5-minute
                                      time  span.  You  can  use this to put a
                                      temporary block on requests from  an  IP
                                      address  that  is  sending excessive re-
                                      quests.

                                      WAF tracks and manages web requests sep-
                                      arately   for   each   instance   of   a
                                      rate-based rule that you use. For  exam-
                                      ple,  if you provide the same rate-based
                                      rule settings in two web ACLs,  each  of
                                      the  two  rule  statements  represents a
                                      separate instance of the rate-based rule
                                      and gets its own tracking and management
                                      by WAF. If you define a rate-based  rule
                                      inside  a  rule group, and then use that
                                      rule group in multiple places, each  use
                                      creates   a  separate  instance  of  the
                                      rate-based rule that gets its own track-
                                      ing and management by WAF.

                                      When   the  rule  action  triggers,  WAF
                                      blocks additional requests from  the  IP
                                      address until the request rate falls be-
                                      low the limit.

                                      You can optionally nest  another  state-
                                      ment inside the rate-based statement, to
                                      narrow the scope of the rule so that  it
                                      only  counts  requests  that  match  the
                                      nested statement. For example, based  on
                                      recent  requests that you have seen from
                                      an  attacker,   you   might   create   a
                                      rate-based  rule  with a nested AND rule
                                      statement that  contains  the  following
                                      nested statements:

                                      o An  IP  match statement with an IP set
                                        that specified the address 192.0.2.44.

                                      o A string match statement that searches
                                        in   the  User-Agent  header  for  the
                                        string BadBot.

                                      In this rate-based rule, you also define
                                      a rate limit. For this example, the rate
                                      limit is 1,000. Requests that meet  both
                                      of  the conditions in the statements are
                                      counted. If the count exceeds 1,000  re-
                                      quests per five minutes, the rule action
                                      triggers. Requests that do not meet both
                                      conditions  are  not counted towards the
                                      rate limit and are not affected by  this
                                      rule.

                                      You cannot nest a RateBasedStatement in-
                                      side another statement, for example  in-
                                      side a NotStatement or OrStatement . You
                                      can define a RateBasedStatement inside a
                                      web ACL and inside a rule group.

                                      Limit -> (long)
                                          The  limit  on requests per 5-minute
                                          period for a single  originating  IP
                                          address. If the statement includes a
                                          ScopeDownStatement , this  limit  is
                                          applied  only  to  the requests that
                                          match the statement.

                                      AggregateKeyType -> (string)
                                          Setting that indicates how to aggre-
                                          gate the request counts. The options
                                          are the following:

                                          o IP - Aggregate the request  counts
                                            on the IP address from the web re-
                                            quest origin.

                                          o FORWARDED_IP - Aggregate  the  re-
                                            quest  counts  on the first IP ad-
                                            dress in an HTTP  header.  If  you
                                            use   this,   configure  the  For-
                                            wardedIPConfig ,  to  specify  the
                                            header to use.

                                      (  ...  recursive ... )ForwardedIPConfig
                                      -> (structure)
                                          The configuration for inspecting  IP
                                          addresses in an HTTP header that you
                                          specify, instead of using the IP ad-
                                          dress that's reported by the web re-
                                          quest origin. Commonly, this is  the
                                          X-Forwarded-For  (XFF)  header,  but
                                          you can specify any header name.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present   in   the  request,  WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          This is required if AggregateKeyType
                                          is set to FORWARDED_IP .

                                          HeaderName -> (string)
                                             The name of the  HTTP  header  to
                                             use for the IP address. For exam-
                                             ple, to use  the  X-Forwarded-For
                                             (XFF)  header, set this to X-For-
                                             warded-For .

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                          FallbackBehavior -> (string)
                                             The match status to assign to the
                                             web  request   if   the   request
                                             doesn't  have  a valid IP address
                                             in the specified position.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             You  can  specify  the  following
                                             fallback behaviors:

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                   AndStatement -> (structure)
                                      A logical rule statement used to combine
                                      other rule statements  with  AND  logic.
                                      You  provide  more  than  one  Statement
                                      within the AndStatement .

                                      Statements -> (list)
                                          The statements to combine  with  AND
                                          logic.  You  can  use any statements
                                          that can be nested.

                                          ( ... recursive ... )

                                   OrStatement -> (structure)
                                      A logical rule statement used to combine
                                      other rule statements with OR logic. You
                                      provide more than one  Statement  within
                                      the OrStatement .

                                      Statements -> (list)
                                          The  statements  to  combine with OR
                                          logic. You can  use  any  statements
                                          that can be nested.

                                          ( ... recursive ... )

                                   NotStatement -> (structure)
                                      A  logical rule statement used to negate
                                      the results of another  rule  statement.
                                      You  provide  one   Statement within the
                                      NotStatement .

                                      ( ... recursive ... )

                                   ( ... recursive ... )LabelMatchStatement ->
                                   (structure)
                                      A  rule  statement that defines a string
                                      match search against  labels  that  have
                                      been  added  to the web request by rules
                                      that have already run in the web ACL.

                                      The label match statement  provides  the
                                      label or namespace string to search for.
                                      The label string can represent a part or
                                      all  of  the  fully qualified label name
                                      that had been added to the web  request.
                                      Fully  qualified  labels  have a prefix,
                                      optional namespaces, and label name. The
                                      prefix  identifies the rule group or web
                                      ACL context of the rule that  added  the
                                      label.  If  you do not provide the fully
                                      qualified  name  in  your  label   match
                                      string,  WAF performs the search for la-
                                      bels that were added in the same context
                                      as the label match statement.

                                      Scope -> (string)
                                          Specify  whether  you  want to match
                                          using the label  name  or  just  the
                                          namespace.

                                      Key -> (string)
                                          The  string  to  match  against. The
                                          setting you provide for this depends
                                          on  the match statement's Scope set-
                                          ting:

                                          o If the  Scope  indicates  LABEL  ,
                                            then  this  specification must in-
                                            clude the name and can include any
                                            number   of   preceding  namespace
                                            specifications and  prefix  up  to
                                            providing  the fully qualified la-
                                            bel name.

                                          o If the Scope indicates NAMESPACE ,
                                            then  this  specification  can in-
                                            clude  any  number  of  contiguous
                                            namespace strings, and can include
                                            the entire label namespace  prefix
                                            from  the  rule  group  or web ACL
                                            where the label originates.

                                          Labels are case sensitive and compo-
                                          nents  of  a label must be separated
                                          by colon, for example NS1:NS2:name .

                                   RegexMatchStatement -> (structure)
                                      A rule statement used to search web  re-
                                      quest  components  for a match against a
                                      single regular expression.

                                      RegexString -> (string)
                                          The string representing the  regular
                                          expression.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.  If  you
                                          specify  one or more transformations
                                          in a rule  statement,  WAF  performs
                                          all  transformations  on the content
                                          of the request component  identified
                                          by  FieldToMatch , starting from the
                                          lowest priority setting, before  in-
                                          specting the content for a match.

                                          (structure)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets  the relative processing
                                                 order for multiple  transfor-
                                                 mations  that are defined for
                                                 a rule  statement.  WAF  pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive, but they  must  all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE -  Decode  a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a Base64 -encoded  string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE  -   Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness  of attackers who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use unusual formatting  to
                                                    disguise  some  or  all of
                                                    the command.

                                                 o Delete the following  char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with   a  space  character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v  , vertical tab, decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE  - Decode char-
                                                    acters that  were  encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This  function  uses up to
                                                    two bytes in the  decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS encoding that  wouldnt
                                                    typically be encoded. It's
                                                    also useful in  countering
                                                    evasion, which is a combi-
                                                    nation of a backslash  and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript    for   java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the  following  ANSI C es-
                                                    cape sequences: \a , \b  ,
                                                    \f  ,  \n , \r , \t , \v ,
                                                    \\ , \? , \' , \"  ,  \xHH
                                                    (hexadecimal),  \0OOO (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE  -   Decode   a
                                                    string    of   hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters with unencoded  char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with a non-breaking  space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces   characters  that
                                                   are represented in hexadec-
                                                   imal     format,    (amper-
                                                   sand)#xhhhh;  ,  with   the
                                                   corresponding characters

                                                 o Replaces   characters  that
                                                   are represented in  decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with   the    corresponding
                                                   characters
                                                    JS_DECODE  -  Decode Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the full-width ASCII  code
                                                    range  of FF01-FF5E , then
                                                    the higher byte is used to
                                                    detect   and   adjust  the
                                                    lower byte. If  not,  only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash  from the data in the
                                                    input. The  computed  hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH   -  Remove
                                                    multiple  slashes,  direc-
                                                    tory  self-references, and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning of the input from  an
                                                    input string.

                                                    NORMALIZE_PATH_WIN  - This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH  , but first con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS  - Remove all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences   are  not  com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination of a comment  (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS   -  Replace
                                                    NULL bytes  in  the  input
                                                    with    space   characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE  -   Decode
                                                    SQL   hex   data.  Example
                                                    (0x414243 )  will  be  de-
                                                    coded to (ABC ).

                                                    URL_DECODE   -   Decode  a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI   -    Like
                                                    URL_DECODE , but with sup-
                                                    port  for   Microsoft-spe-
                                                    cific  %u encoding. If the
                                                    code is in the  full-width
                                                    ASCII    code   range   of
                                                    FF01-FF5E  ,  the   higher
                                                    byte is used to detect and
                                                    adjust  the  lower   byte.
                                                    Otherwise,  only the lower
                                                    byte  is  used   and   the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE  - Convert
                                                    all  UTF-8  character  se-
                                                    quences  to  Unicode. This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives and  false-negatives
                                                    for non-English languages.

                            LabelMatchStatement -> (structure)
                               A  rule  statement  that defines a string match
                               search against labels that have been  added  to
                               the  web request by rules that have already run
                               in the web ACL.

                               The label match statement provides the label or
                               namespace  string  to  search  for.  The  label
                               string can represent a part or all of the fully
                               qualified label name that had been added to the
                               web request. Fully qualified labels have a pre-
                               fix,  optional  namespaces, and label name. The
                               prefix identifies the rule  group  or  web  ACL
                               context  of  the  rule that added the label. If
                               you do not provide the fully qualified name  in
                               your  label  match  string,  WAF  performs  the
                               search for labels that were added in  the  same
                               context as the label match statement.

                               Scope -> (string)
                                   Specify whether you want to match using the
                                   label name or just the namespace.

                               Key -> (string)
                                   The string to match  against.  The  setting
                                   you  provide  for this depends on the match
                                   statement's Scope setting:

                                   o If the Scope indicates LABEL , then  this
                                     specification  must  include the name and
                                     can include any number of preceding name-
                                     space  specifications  and  prefix  up to
                                     providing the fully qualified label name.

                                   o If the Scope indicates NAMESPACE  ,  then
                                     this specification can include any number
                                     of contiguous namespace strings, and  can
                                     include the entire label namespace prefix
                                     from the rule group or web ACL where  the
                                     label originates.

                                   Labels are case sensitive and components of
                                   a label must be separated by colon, for ex-
                                   ample NS1:NS2:name .

                            RegexMatchStatement -> (structure)
                               A  rule  statement  used  to search web request
                               components for a match against a single regular
                               expression.

                               RegexString -> (string)
                                   The string representing the regular expres-
                                   sion.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to   inspect.  For  more  information,  see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This  is  used  only to indicate the web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of a web request  that  identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. If you specify one or more  transfor-
                                   mations  in  a rule statement, WAF performs
                                   all transformations on the content  of  the
                                   request   component  identified  by  Field-
                                   ToMatch , starting from the lowest priority
                                   setting,  before inspecting the content for
                                   a match.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations  that
                                          are  defined  for  a rule statement.
                                          WAF processes  all  transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent.  The  priorities don't need to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                     RuleGroupReferenceStatement -> (structure)
                        A rule statement used to run the rules  that  are  de-
                        fined  in  a   RuleGroup  . To use this, create a rule
                        group with your rules, then provide  the  ARN  of  the
                        rule group in this statement.

                        You  cannot  nest  a RuleGroupReferenceStatement , for
                        example for use inside a NotStatement or OrStatement .
                        You  can  only use a rule group reference statement at
                        the top level inside a web ACL.

                        ARN -> (string)
                            The Amazon Resource Name (ARN) of the entity.

                        ExcludedRules -> (list)
                            The rules in the referenced rule group  whose  ac-
                            tions  are set to Count . When you exclude a rule,
                            WAF evaluates it exactly as it would if  the  rule
                            action  setting  were Count . This is a useful op-
                            tion for testing the rules in a rule group without
                            modifying how they handle your web traffic.

                            (structure)
                               Specifies  a  single rule in a rule group whose
                               action you want to override to Count . When you
                               exclude  a rule, WAF evaluates it exactly as it
                               would if the rule action setting were  Count  .
                               This  is  a useful option for testing the rules
                               in a rule group without modifying how they han-
                               dle your web traffic.

                               Name -> (string)
                                   The  name of the rule whose action you want
                                   to override to Count .

                 OverrideAction -> (structure)
                     The action to use in the place of the action that results
                     from  the  rule group evaluation. Set the override action
                     to none to leave the result of the rule group alone.  Set
                     it to count to override the result to count only.

                     You  can only use this for rule statements that reference
                     a rule group, like RuleGroupReferenceStatement  and  Man-
                     agedRuleGroupStatement .

                     NOTE:
                        This option is usually set to none. It does not affect
                        how the rules in the rule group are evaluated. If  you
                        want  the  rules  in  the  rule  group  to  only count
                        matches, do not use this  and  instead  exclude  those
                        rules in your rule group reference statement settings.

                     Count -> (structure)
                        Override  the  rule  group  evaluation result to count
                        only.

                        NOTE:
                            This option is usually set to none.  It  does  not
                            affect  how the rules in the rule group are evalu-
                            ated. If you want the rules in the rule  group  to
                            only  count  matches,  do not use this and instead
                            exclude those rules in your rule  group  reference
                            statement settings.

                        CustomRequestHandling -> (structure)
                            Defines custom handling for the web request.

                            For information about customizing web requests and
                            responses, see Customizing web  requests  and  re-
                            sponses in WAF in the WAF Developer Guide .

                            InsertHeaders -> (list)
                               The  HTTP  headers  to insert into the request.
                               Duplicate header names are not allowed.

                               For information about the limits on  count  and
                               size  for custom request and response settings,
                               see WAF quotas in the WAF Developer Guide .

                               (structure)
                                   A custom header for custom request and  re-
                                   sponse handling. This is used in  CustomRe-
                                   sponse and  CustomRequestHandling .

                                   Name -> (string)
                                      The name of the custom header.

                                      For  custom  request  header  insertion,
                                      when WAF inserts the header into the re-
                                      quest, it prefixes this name x-amzn-waf-
                                      ,  to  avoid  confusion with the headers
                                      that are already in the request. For ex-
                                      ample,  for the header name sample , WAF
                                      inserts the header x-amzn-waf-sample .

                                   Value -> (string)
                                      The value of the custom header.

                     None -> (structure)
                        Don't override the rule group evaluation result.  This
                        is the most common setting.

                 VisibilityConfig -> (structure)
                     Defines and enables Amazon CloudWatch metrics and web re-
                     quest sample collection.

                     SampledRequestsEnabled -> (boolean)
                        A boolean indicating whether WAF should store  a  sam-
                        pling  of  the  web requests that match the rules. You
                        can view the sampled requests through the WAF console.

                     CloudWatchMetricsEnabled -> (boolean)
                        A boolean indicating whether the  associated  resource
                        sends  metrics  to  Amazon CloudWatch. For the list of
                        available metrics, see WAF Metrics .

                     MetricName -> (string)
                        A name of the Amazon CloudWatch metric. The  name  can
                        contain  only  the  characters:  A-Z, a-z, 0-9, - (hy-
                        phen), and _ (underscore). The name can be from one to
                        128  characters  long.  It can't contain whitespace or
                        metric names reserved for WAF, for example  "All"  and
                        "Default_Action."

          PostProcessFirewallManagerRuleGroups -> (list)
              The last set of rules for WAF to process in the web ACL. This is
              defined in an Firewall Manager WAF policy and contains only rule
              group  references.  You  can't  alter  these. Any rules and rule
              groups that you define for the web ACL  are  prioritized  before
              these.

              In  the Firewall Manager WAF policy, the Firewall Manager admin-
              istrator can define a set of rule groups to run first in the web
              ACL  and  a set of rule groups to run last. Within each set, the
              administrator prioritizes the rule groups,  to  determine  their
              relative processing order.

              (structure)
                 A  rule group that's defined for an Firewall Manager WAF pol-
                 icy.

                 Name -> (string)
                     The name of the rule group. You cannot change the name of
                     a rule group after you create it.

                 Priority -> (integer)
                     If  you  define  more than one rule group in the first or
                     last Firewall Manager rule groups, WAF evaluates each re-
                     quest against the rule groups in order, starting from the
                     lowest priority setting. The priorities don't need to  be
                     consecutive, but they must all be different.

                 FirewallManagerStatement -> (structure)
                     The  processing  guidance  for  an Firewall Manager rule.
                     This is like a regular rule  Statement , but it can  only
                     contain a rule group reference.

                     ManagedRuleGroupStatement -> (structure)
                        A  rule  statement  used to run the rules that are de-
                        fined in a managed rule group. To  use  this,  provide
                        the vendor name and the name of the rule group in this
                        statement. You can  retrieve  the  required  names  by
                        calling  ListAvailableManagedRuleGroups .

                        You  cannot nest a ManagedRuleGroupStatement , for ex-
                        ample for use inside a NotStatement or  OrStatement  .
                        It  can  only  be  referenced as a top-level statement
                        within a rule.

                        VendorName -> (string)
                            The name of the managed rule group vendor. You use
                            this,  along with the rule group name, to identify
                            the rule group.

                        Name -> (string)
                            The name of the managed rule group. You use  this,
                            along  with  the vendor name, to identify the rule
                            group.

                        Version -> (string)
                            The version of the managed rule group to  use.  If
                            you specify this, the version setting is fixed un-
                            til you change it. If you don't specify this,  WAF
                            uses  the vendor's default version, and then keeps
                            the version at the vendor's default when the  ven-
                            dor updates the managed rule group settings.

                        ExcludedRules -> (list)
                            The  rules  in the referenced rule group whose ac-
                            tions are set to Count . When you exclude a  rule,
                            WAF  evaluates  it exactly as it would if the rule
                            action setting were Count . This is a  useful  op-
                            tion for testing the rules in a rule group without
                            modifying how they handle your web traffic.

                            (structure)
                               Specifies a single rule in a rule  group  whose
                               action you want to override to Count . When you
                               exclude a rule, WAF evaluates it exactly as  it
                               would  if  the rule action setting were Count .
                               This is a useful option for testing  the  rules
                               in a rule group without modifying how they han-
                               dle your web traffic.

                               Name -> (string)
                                   The name of the rule whose action you  want
                                   to override to Count .

                        ScopeDownStatement -> (structure)
                            An  optional  nested  statement  that  narrows the
                            scope of the web requests that  are  evaluated  by
                            the  managed  rule group. Requests are only evalu-
                            ated  by  the  rule  group  if  they   match   the
                            scope-down  statement.  You  can  use any nestable
                            Statement in the scope-down statement, and you can
                            nest  statements at any level, the same as you can
                            for a rule statement.

                            ByteMatchStatement -> (structure)
                               A rule statement that defines  a  string  match
                               search  for  WAF  to apply to web requests. The
                               byte match  statement  provides  the  bytes  to
                               search  for,  the location in requests that you
                               want WAF to search,  and  other  settings.  The
                               bytes to search for are typically a string that
                               corresponds with ASCII characters. In  the  WAF
                               console  and  the developer guide, this is ref-
                               ered to as a string match statement.

                               SearchString -> (blob)
                                   A string value that you want WAF to  search
                                   for.  WAF  searches only in the part of web
                                   requests that you designate for  inspection
                                   in   FieldToMatch  .  The maximum length of
                                   the value is 50 bytes.

                                   Valid values depend on the  component  that
                                   you  specify for inspection in FieldToMatch
                                   :

                                   o Method : The HTTP method  that  you  want
                                     WAF  to  search  for.  This indicates the
                                     type of operation specified  in  the  re-
                                     quest.

                                   o UriPath  : The value that you want WAF to
                                     search for in the URI path, for  example,
                                     /images/daily-ad.jpg .

                                   If SearchString includes alphabetic charac-
                                   ters A-Z and a-z, note that  the  value  is
                                   case sensitive.
                                      If you're using the WAF API

                                   Specify  a  base64-encoded  version  of the
                                   value. The maximum length of the value  be-
                                   fore you base64-encode it is 50 bytes.

                                   For  example,  suppose the value of Type is
                                   HEADER and the value of Data is  User-Agent
                                   .  If  you  want  to  search the User-Agent
                                   header  for  the   value   BadBot   ,   you
                                   base64-encode  BadBot using MIME base64-en-
                                   coding and include the resulting value, Qm-
                                   FkQm90 , in the value of SearchString .
                                      If  you're  using  the CLI or one of the
                                      Amazon Web Services SDKs

                                   The value that you want WAF to search  for.
                                   The  SDK  automatically  base64 encodes the
                                   value.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to   inspect.  For  more  information,  see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This  is  used  only to indicate the web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of a web request  that  identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. If you specify one or more  transfor-
                                   mations  in  a rule statement, WAF performs
                                   all transformations on the content  of  the
                                   request   component  identified  by  Field-
                                   ToMatch , starting from the lowest priority
                                   setting,  before inspecting the content for
                                   a match.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations  that
                                          are  defined  for  a rule statement.
                                          WAF processes  all  transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent.  The  priorities don't need to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                               PositionalConstraint -> (string)
                                   The area within the portion of  a  web  re-
                                   quest  that  you  want  WAF  to  search for
                                   SearchString .  Valid  values  include  the
                                   following:
                                      CONTAINS

                                   The  specified part of the web request must
                                   include the value of SearchString , but the
                                   location doesn't matter.
                                      CONTAINS_WORD

                                   The  specified part of the web request must
                                   include the value  of  SearchString  ,  and
                                   SearchString must contain only alphanumeric
                                   characters or underscore (A-Z, a-z, 0-9, or
                                   _).  In  addition,  SearchString  must be a
                                   word, which means that both of the  follow-
                                   ing are true:

                                   o SearchString  is  at the beginning of the
                                     specified part of the web request  or  is
                                     preceded by a character other than an al-
                                     phanumeric character or  underscore  (_).
                                     Examples  include  the  value of a header
                                     and ;BadBot .

                                   o SearchString is at the end of the  speci-
                                     fied  part  of the web request or is fol-
                                     lowed by a character other  than  an  al-
                                     phanumeric  character  or underscore (_),
                                     for example, BadBot; and -BadBot; .
                                      EXACTLY

                                   The value of the specified part of the  web
                                   request  must  exactly  match  the value of
                                   SearchString .
                                      STARTS_WITH

                                   The value of SearchString  must  appear  at
                                   the  beginning of the specified part of the
                                   web request.
                                      ENDS_WITH

                                   The value of SearchString  must  appear  at
                                   the  end  of  the specified part of the web
                                   request.

                            SqliMatchStatement -> (structure)
                               Attackers sometimes insert malicious  SQL  code
                               into  web requests in an effort to extract data
                               from your database. To allow or block  web  re-
                               quests  that  appear  to  contain malicious SQL
                               code, create one or more  SQL  injection  match
                               conditions.  An  SQL  injection match condition
                               identifies the part of web  requests,  such  as
                               the  URI or the query string, that you want WAF
                               to inspect. Later in the process, when you cre-
                               ate  a web ACL, you specify whether to allow or
                               block requests that appear to contain malicious
                               SQL code.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to  inspect.  For  more  information,   see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect  a  single  header.  Provide the
                                      name of the header to inspect, for exam-
                                      ple,  User-Agent  or Referer . This set-
                                      ting isn't case sensitive.

                                      Example JSON: "SingleHeader": {  "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The  name of the query header to in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the  name  of  the query argument to in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This is used only to  indicate  the  web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example JSON:  "SingleQueryArgument":  {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The  name  of  the query argument to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect the request URI  path.  This  is
                                      the  part  of a web request that identi-
                                      fies  a  resource,  for  example,   /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect  the  query  string. This is the
                                      part of a URL that  appears  after  a  ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect  the request body as plain text.
                                      The request body immediately follows the
                                      request  headers.  This is the part of a
                                      request  that  contains  any  additional
                                      data  that  you want to send to your web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect  the HTTP method. The method in-
                                      dicates the type of operation  that  the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect  the  request  body as JSON. The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest that contains any additional  data
                                      that you want to send to your web server
                                      as the HTTP request body, such  as  data
                                      from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text transformations eliminate some of  the
                                   unusual  formatting  that  attackers use in
                                   web requests in an effort to bypass  detec-
                                   tion.  If you specify one or more transfor-
                                   mations in a rule statement,  WAF  performs
                                   all  transformations  on the content of the
                                   request  component  identified  by   Field-
                                   ToMatch , starting from the lowest priority
                                   setting, before inspecting the content  for
                                   a match.

                                   (structure)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets the relative  processing  order
                                          for  multiple  transformations  that
                                          are defined for  a  rule  statement.
                                          WAF  processes  all transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent. The priorities don't  need  to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                            XssMatchStatement -> (structure)
                               A  rule  statement  that  defines  a cross-site
                               scripting (XSS) match search for WAF  to  apply
                               to  web  requests.  XSS attacks are those where
                               the attacker uses vulnerabilities in  a  benign
                               website   as  a  vehicle  to  inject  malicious
                               client-site scripts into other  legitimate  web
                               browsers.  The XSS match statement provides the
                               location in  requests  that  you  want  WAF  to
                               search  and  text transformations to use on the
                               search area before WAF searches  for  character
                               sequences  that  are  likely  to  be  malicious
                               strings.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to   inspect.  For  more  information,  see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This  is  used  only to indicate the web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of a web request  that  identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. If you specify one or more  transfor-
                                   mations  in  a rule statement, WAF performs
                                   all transformations on the content  of  the
                                   request   component  identified  by  Field-
                                   ToMatch , starting from the lowest priority
                                   setting,  before inspecting the content for
                                   a match.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations  that
                                          are  defined  for  a rule statement.
                                          WAF processes  all  transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent.  The  priorities don't need to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                            SizeConstraintStatement -> (structure)
                               A rule statement  that  compares  a  number  of
                               bytes  against the size of a request component,
                               using a comparison operator,  such  as  greater
                               than (>) or less than (<). For example, you can
                               use a size constraint  statement  to  look  for
                               query strings that are longer than 100 bytes.

                               If  you  configure  WAF  to inspect the request
                               body, WAF inspects only the first 8192 bytes (8
                               KB).  If the request body for your web requests
                               never exceeds 8192 bytes, you can create a size
                               constraint  condition  and  block requests that
                               have a request body greater than 8192 bytes.

                               If you choose URI for the value of Part of  the
                               request  to filter on, the slash (/) in the URI
                               counts as one character. For example,  the  URI
                               /logo.jpg is nine characters long.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to  inspect.  For  more  information,   see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect  a  single  header.  Provide the
                                      name of the header to inspect, for exam-
                                      ple,  User-Agent  or Referer . This set-
                                      ting isn't case sensitive.

                                      Example JSON: "SingleHeader": {  "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The  name of the query header to in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the  name  of  the query argument to in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This is used only to  indicate  the  web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example JSON:  "SingleQueryArgument":  {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The  name  of  the query argument to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect the request URI  path.  This  is
                                      the  part  of a web request that identi-
                                      fies  a  resource,  for  example,   /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect  the  query  string. This is the
                                      part of a URL that  appears  after  a  ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect  the request body as plain text.
                                      The request body immediately follows the
                                      request  headers.  This is the part of a
                                      request  that  contains  any  additional
                                      data  that  you want to send to your web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect  the HTTP method. The method in-
                                      dicates the type of operation  that  the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect  the  request  body as JSON. The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest that contains any additional  data
                                      that you want to send to your web server
                                      as the HTTP request body, such  as  data
                                      from a form.

                                      Note  that  only  the  first  8 KB (8192
                                      bytes) of the request body are forwarded
                                      to  WAF for inspection by the underlying
                                      host service. If you don't need  to  in-
                                      spect  more than 8 KB, you can guarantee
                                      that you don't allow additional bytes in
                                      by  combining  a statement that inspects
                                      the body of the  web  request,  such  as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement , with  a   SizeCon-
                                      straintStatement  that  enforces an 8 KB
                                      size limit on the body of  the  request.
                                      WAF  doesn't  support inspecting the en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body. WAF inspects  the  results  of
                                          these  pattern  matches  against the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match all of  the  elements.  See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting or  the  IncludedPaths  set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match  only the specified include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide  the  include paths using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting  or the All setting, but not
                                             both.

                                             NOTE:
                                                 Don't use this option to  in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against  using the MatchPattern . If
                                          you  specify  All  ,   WAF   matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What  WAF  should  do if it fails to
                                          completely parse the JSON body.  The
                                          options are the following:

                                          o EVALUATE_AS_STRING  -  Inspect the
                                            body as plain  text.  WAF  applies
                                            the  text  transformations and in-
                                            spection criteria that you defined
                                            for  the  JSON  inspection  to the
                                            body text string.

                                          o MATCH - Treat the web  request  as
                                            matching  the  rule statement. WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH  -  Treat the web request
                                            as not matching  the  rule  state-
                                            ment.

                                          If  you  don't provide this setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF does its best to parse  the  en-
                                          tire  JSON body, but might be forced
                                          to stop for reasons such as  invalid
                                          characters,  duplicate keys, trunca-
                                          tion, and  any  content  whose  root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples as  two  valid  key,  value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               ComparisonOperator -> (string)
                                   The operator to use to compare the  request
                                   part to the size setting.

                               Size -> (long)
                                   The  size,  in  byte, to compare to the re-
                                   quest part, after any transformations.

                               TextTransformations -> (list)
                                   Text transformations eliminate some of  the
                                   unusual  formatting  that  attackers use in
                                   web requests in an effort to bypass  detec-
                                   tion.  If you specify one or more transfor-
                                   mations in a rule statement,  WAF  performs
                                   all  transformations  on the content of the
                                   request  component  identified  by   Field-
                                   ToMatch , starting from the lowest priority
                                   setting, before inspecting the content  for
                                   a match.

                                   (structure)
                                      Text  transformations  eliminate some of
                                      the unusual  formatting  that  attackers
                                      use  in web requests in an effort to by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets the relative  processing  order
                                          for  multiple  transformations  that
                                          are defined for  a  rule  statement.
                                          WAF  processes  all transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent. The priorities don't  need  to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE  -  Decode a Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT  -   Decode   a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores   characters   that  aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who  inject  an  operating system
                                             command-line command and use  un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace the  following  characters
                                            with a space: , ;

                                          o Replace  multiple  spaces with one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE   -  Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places multiple spaces  with  one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that were encoded using  CSS  2.x
                                             escape rules syndata.html#charac-
                                             ters . This function uses  up  to
                                             two   bytes   in   the   decoding
                                             process, so it can  help  to  un-
                                             cover  ASCII characters that were
                                             encoded using CSS  encoding  that
                                             wouldnt   typically  be  encoded.
                                             It's also  useful  in  countering
                                             evasion,  which  is a combination
                                             of a backslash and  non-hexadeci-
                                             mal   characters.   For  example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following   ANSI   C  escape  se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t  ,  \v  ,  \\ , \? , \' , \" ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE - Decode a  string  of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE   -    Replace
                                             HTML-encoded  characters with un-
                                             encoded   characters.    HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces (ampersand)nbsp;  with  a
                                            non-breaking space, decimal 160

                                          o Replaces   (ampersand)lt;  with  a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces characters that are  rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces  characters that are rep-
                                            resented in decimal  format,  (am-
                                            persand)#nnnn;  ,  with the corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape  sequences.  If a \  u  HHHH
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E , then
                                             the higher byte is used to detect
                                             and  adjust  the  lower  byte. If
                                             not, only the lower byte is  used
                                             and  the  higher  byte is zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE   -  Convert  uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5 - Calculate an MD5 hash  from
                                             the  data  in the input. The com-
                                             puted hash is  in  a  raw  binary
                                             form.

                                             NONE  - Specify NONE if you don't
                                             want any text transformations.

                                             NORMALIZE_PATH - Remove  multiple
                                             slashes,   directory  self-refer-
                                             ences, and directory  back-refer-
                                             ences  that are not at the begin-
                                             ning of the input from  an  input
                                             string.

                                             NORMALIZE_PATH_WIN  - This is the
                                             same  as  NORMALIZE_PATH  ,   but
                                             first  converts backslash charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS -  Remove  all  NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS  -  Replace each
                                             occurrence of a  C-style  comment
                                             (/* ... */ ) with a single space.
                                             Multiple consecutive  occurrences
                                             are  not compressed. Unterminated
                                             comments are also replaced with a
                                             space  (ASCII  0x20).  However, a
                                             standalone termination of a  com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS   -   Replace  NULL
                                             bytes in  the  input  with  space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE  -  Decode SQL hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI - Like  URL_DECODE
                                             ,  but  with  support  for Micro-
                                             soft-specific %u encoding. If the
                                             code  is  in the full-width ASCII
                                             code range  of  FF01-FF5E  ,  the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only  the  lower byte is used and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE  -  Convert   all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion,  and minimizing false-posi-
                                             tives  and  false-negatives   for
                                             non-English languages.

                            GeoMatchStatement -> (structure)
                               A  rule statement used to identify web requests
                               based on country of origin.

                               CountryCodes -> (list)
                                   An array of  two-character  country  codes,
                                   for  example, [ "US", "CN" ] , from the al-
                                   pha-2 country ISO codes of the ISO 3166 in-
                                   ternational standard.

                                   (string)

                               ForwardedIPConfig -> (structure)
                                   The  configuration  for  inspecting  IP ad-
                                   dresses in an HTTP header that you specify,
                                   instead  of using the IP address that's re-
                                   ported by the web request origin. Commonly,
                                   this  is  the X-Forwarded-For (XFF) header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the  request, WAF doesn't apply the rule
                                      to the web request at all.

                                   HeaderName -> (string)
                                      The name of the HTTP header to  use  for
                                      the  IP address. For example, to use the
                                      X-Forwarded-For (XFF) header,  set  this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The match status to assign  to  the  web
                                      request  if  the  request doesn't have a
                                      valid IP address in the specified  posi-
                                      tion.

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                      You can specify the  following  fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching the rule statement.  WAF  ap-
                                        plies the rule action to the request.

                                      o NO_MATCH  -  Treat  the web request as
                                        not matching the rule statement.

                            RuleGroupReferenceStatement -> (structure)
                               A rule statement used to run the rules that are
                               defined in a  RuleGroup . To use this, create a
                               rule group with your rules,  then  provide  the
                               ARN of the rule group in this statement.

                               You cannot nest a RuleGroupReferenceStatement ,
                               for example for use inside  a  NotStatement  or
                               OrStatement  .  You  can  only use a rule group
                               reference statement at the top level  inside  a
                               web ACL.

                               ARN -> (string)
                                   The  Amazon  Resource Name (ARN) of the en-
                                   tity.

                               ExcludedRules -> (list)
                                   The rules  in  the  referenced  rule  group
                                   whose  actions  are set to Count . When you
                                   exclude a rule, WAF evaluates it exactly as
                                   it  would  if  the rule action setting were
                                   Count . This is a useful option for testing
                                   the rules in a rule group without modifying
                                   how they handle your web traffic.

                                   (structure)
                                      Specifies a single rule in a rule  group
                                      whose  action  you  want  to override to
                                      Count . When you  exclude  a  rule,  WAF
                                      evaluates  it exactly as it would if the
                                      rule action setting were Count . This is
                                      a useful option for testing the rules in
                                      a rule group without modifying how  they
                                      handle your web traffic.

                                      Name -> (string)
                                          The  name  of  the rule whose action
                                          you want to override to Count .

                            IPSetReferenceStatement -> (structure)
                               A rule statement used to  detect  web  requests
                               coming  from particular IP addresses or address
                               ranges. To use  this,  create  an   IPSet  that
                               specifies  the  addresses  you  want to detect,
                               then use the ARN of that set in this statement.
                               To create an IP set, see  CreateIPSet .

                               Each  IP  set  rule  statement references an IP
                               set. You create and maintain the  set  indepen-
                               dent  of your rules. This allows you to use the
                               single set in multiple rules. When  you  update
                               the  referenced  set, WAF automatically updates
                               all rules that reference it.

                               ARN -> (string)
                                   The  Amazon  Resource  Name  (ARN)  of  the
                                   IPSet that this statement references.

                               IPSetForwardedIPConfig -> (structure)
                                   The  configuration  for  inspecting  IP ad-
                                   dresses in an HTTP header that you specify,
                                   instead  of using the IP address that's re-
                                   ported by the web request origin. Commonly,
                                   this  is  the X-Forwarded-For (XFF) header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the  request, WAF doesn't apply the rule
                                      to the web request at all.

                                   HeaderName -> (string)
                                      The name of the HTTP header to  use  for
                                      the  IP address. For example, to use the
                                      X-Forwarded-For (XFF) header,  set  this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The match status to assign  to  the  web
                                      request  if  the  request doesn't have a
                                      valid IP address in the specified  posi-
                                      tion.

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                      You can specify the  following  fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching the rule statement.  WAF  ap-
                                        plies the rule action to the request.

                                      o NO_MATCH  -  Treat  the web request as
                                        not matching the rule statement.

                                   Position -> (string)
                                      The position in the header to search for
                                      the  IP  address. The header can contain
                                      IP addresses of the original client  and
                                      also of proxies. For example, the header
                                      value  could  be  10.1.1.1,   127.0.0.0,
                                      10.10.10.10  where  the first IP address
                                      identifies the original client  and  the
                                      rest  identify  proxies that the request
                                      went through.

                                      The options for  this  setting  are  the
                                      following:

                                      o FIRST  -  Inspect the first IP address
                                        in the list of  IP  addresses  in  the
                                        header.  This  is usually the client's
                                        original IP.

                                      o LAST - Inspect the last IP address  in
                                        the   list  of  IP  addresses  in  the
                                        header.

                                      o ANY - Inspect all IP addresses in  the
                                        header for a match. If the header con-
                                        tains more than 10 IP  addresses,  WAF
                                        inspects the last 10.

                            RegexPatternSetReferenceStatement -> (structure)
                               A  rule  statement  used  to search web request
                               components for  matches  with  regular  expres-
                               sions.  To  use this, create a  RegexPatternSet
                               that specifies the expressions that you want to
                               detect,  then  use  the ARN of that set in this
                               statement. A web request  matches  the  pattern
                               set  rule  statement  if  the request component
                               matches any of the patterns in the set. To cre-
                               ate  a  regex pattern set, see  CreateRegexPat-
                               ternSet .

                               Each regex pattern set  rule  statement  refer-
                               ences a regex pattern set. You create and main-
                               tain the set independent of  your  rules.  This
                               allows  you  to  use the single set in multiple
                               rules. When you update the referenced set,  WAF
                               automatically  updates all rules that reference
                               it.

                               ARN -> (string)
                                   The Amazon Resource Name (ARN) of the  Reg-
                                   exPatternSet  that  this  statement  refer-
                                   ences.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to   inspect.  For  more  information,  see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This  is  used  only to indicate the web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of a web request  that  identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. If you specify one or more  transfor-
                                   mations  in  a rule statement, WAF performs
                                   all transformations on the content  of  the
                                   request   component  identified  by  Field-
                                   ToMatch , starting from the lowest priority
                                   setting,  before inspecting the content for
                                   a match.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations  that
                                          are  defined  for  a rule statement.
                                          WAF processes  all  transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent.  The  priorities don't need to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                            RateBasedStatement -> (structure)
                               A rate-based rule tracks the rate  of  requests
                               for  each  originating IP address, and triggers
                               the rule action when the rate exceeds  a  limit
                               that  you  specify on the number of requests in
                               any 5-minute time span. You can use this to put
                               a  temporary  block  on requests from an IP ad-
                               dress that is sending excessive requests.

                               WAF tracks and manages web requests  separately
                               for each instance of a rate-based rule that you
                               use. For  example,  if  you  provide  the  same
                               rate-based  rule settings in two web ACLs, each
                               of the two rule statements represents  a  sepa-
                               rate  instance  of the rate-based rule and gets
                               its own tracking and management by WAF. If  you
                               define  a  rate-based rule inside a rule group,
                               and  then  use  that  rule  group  in  multiple
                               places, each use creates a separate instance of
                               the rate-based rule that gets its own  tracking
                               and management by WAF.

                               When the rule action triggers, WAF blocks addi-
                               tional requests from the IP address  until  the
                               request rate falls below the limit.

                               You  can  optionally nest another statement in-
                               side the rate-based statement,  to  narrow  the
                               scope  of  the  rule so that it only counts re-
                               quests that match the nested statement. For ex-
                               ample,  based  on recent requests that you have
                               seen from  an  attacker,  you  might  create  a
                               rate-based  rule  with a nested AND rule state-
                               ment that contains the following nested  state-
                               ments:

                               o An  IP  match  statement  with an IP set that
                                 specified the address 192.0.2.44.

                               o A string match statement that searches in the
                                 User-Agent header for the string BadBot.

                               In this rate-based rule, you also define a rate
                               limit. For this  example,  the  rate  limit  is
                               1,000.  Requests  that  meet both of the condi-
                               tions in the statements  are  counted.  If  the
                               count  exceeds 1,000 requests per five minutes,
                               the rule action triggers. Requests that do  not
                               meet  both  conditions  are not counted towards
                               the rate limit and are  not  affected  by  this
                               rule.

                               You cannot nest a RateBasedStatement inside an-
                               other statement, for example inside a NotState-
                               ment  or  OrStatement  . You can define a Rate-
                               BasedStatement inside a web ACL  and  inside  a
                               rule group.

                               Limit -> (long)
                                   The  limit  on requests per 5-minute period
                                   for a single originating IP address. If the
                                   statement  includes  a ScopeDownStatement ,
                                   this limit is applied only to the  requests
                                   that match the statement.

                               AggregateKeyType -> (string)
                                   Setting that indicates how to aggregate the
                                   request counts. The options are the follow-
                                   ing:

                                   o IP  - Aggregate the request counts on the
                                     IP address from the web request origin.

                                   o FORWARDED_IP  -  Aggregate  the   request
                                     counts on the first IP address in an HTTP
                                     header. If you use  this,  configure  the
                                     ForwardedIPConfig , to specify the header
                                     to use.

                               ScopeDownStatement -> (structure)
                                   An optional nested statement  that  narrows
                                   the  scope  of  the  web  requests that are
                                   evaluated by the rate-based statement.  Re-
                                   quests  are  only tracked by the rate-based
                                   statement  if  they  match  the  scope-down
                                   statement. You can use any nestable  State-
                                   ment in the scope-down statement,  and  you
                                   can  nest statements at any level, the same
                                   as you can for a rule statement.

                                   ByteMatchStatement -> (structure)
                                      A rule statement that defines  a  string
                                      match search for WAF to apply to web re-
                                      quests. The byte  match  statement  pro-
                                      vides the bytes to search for, the loca-
                                      tion in requests that you  want  WAF  to
                                      search, and other settings. The bytes to
                                      search for are typically a  string  that
                                      corresponds  with  ASCII  characters. In
                                      the WAF console and the developer guide,
                                      this  is  refered  to  as a string match
                                      statement.

                                      SearchString -> (blob)
                                          A string value that you want WAF  to
                                          search for. WAF searches only in the
                                          part of web requests that you desig-
                                          nate for inspection in  FieldToMatch
                                          . The maximum length of the value is
                                          50 bytes.

                                          Valid values depend on the component
                                          that you specify for  inspection  in
                                          FieldToMatch :

                                          o Method  : The HTTP method that you
                                            want WAF to search for. This indi-
                                            cates the type of operation speci-
                                            fied in the request.

                                          o UriPath : The value that you  want
                                            WAF to search for in the URI path,
                                            for example,  /images/daily-ad.jpg
                                            .

                                          If  SearchString includes alphabetic
                                          characters A-Z and  a-z,  note  that
                                          the value is case sensitive.
                                             If you're using the WAF API

                                          Specify  a base64-encoded version of
                                          the value. The maximum length of the
                                          value before you base64-encode it is
                                          50 bytes.

                                          For example, suppose  the  value  of
                                          Type is HEADER and the value of Data
                                          is  User-Agent  .  If  you  want  to
                                          search the User-Agent header for the
                                          value  BadBot  ,  you  base64-encode
                                          BadBot  using  MIME  base64-encoding
                                          and include the resulting value, Qm-
                                          FkQm90  ,  in  the  value of Search-
                                          String .
                                             If you're using the CLI or one of
                                             the Amazon Web Services SDKs

                                          The  value  that  you  want  WAF  to
                                          search for.  The  SDK  automatically
                                          base64 encodes the value.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.  If  you
                                          specify  one or more transformations
                                          in a rule  statement,  WAF  performs
                                          all  transformations  on the content
                                          of the request component  identified
                                          by  FieldToMatch , starting from the
                                          lowest priority setting, before  in-
                                          specting the content for a match.

                                          (structure)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets  the relative processing
                                                 order for multiple  transfor-
                                                 mations  that are defined for
                                                 a rule  statement.  WAF  pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive, but they  must  all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE -  Decode  a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a Base64 -encoded  string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE  -   Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness  of attackers who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use unusual formatting  to
                                                    disguise  some  or  all of
                                                    the command.

                                                 o Delete the following  char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with   a  space  character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v  , vertical tab, decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE  - Decode char-
                                                    acters that  were  encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This  function  uses up to
                                                    two bytes in the  decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS encoding that  wouldnt
                                                    typically be encoded. It's
                                                    also useful in  countering
                                                    evasion, which is a combi-
                                                    nation of a backslash  and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript    for   java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the  following  ANSI C es-
                                                    cape sequences: \a , \b  ,
                                                    \f  ,  \n , \r , \t , \v ,
                                                    \\ , \? , \' , \"  ,  \xHH
                                                    (hexadecimal),  \0OOO (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE  -   Decode   a
                                                    string    of   hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters with unencoded  char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with a non-breaking  space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces   characters  that
                                                   are represented in hexadec-
                                                   imal     format,    (amper-
                                                   sand)#xhhhh;  ,  with   the
                                                   corresponding characters

                                                 o Replaces   characters  that
                                                   are represented in  decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with   the    corresponding
                                                   characters
                                                    JS_DECODE  -  Decode Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the full-width ASCII  code
                                                    range  of FF01-FF5E , then
                                                    the higher byte is used to
                                                    detect   and   adjust  the
                                                    lower byte. If  not,  only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash  from the data in the
                                                    input. The  computed  hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH   -  Remove
                                                    multiple  slashes,  direc-
                                                    tory  self-references, and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning of the input from  an
                                                    input string.

                                                    NORMALIZE_PATH_WIN  - This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH  , but first con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS  - Remove all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences   are  not  com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination of a comment  (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS   -  Replace
                                                    NULL bytes  in  the  input
                                                    with    space   characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE  -   Decode
                                                    SQL   hex   data.  Example
                                                    (0x414243 )  will  be  de-
                                                    coded to (ABC ).

                                                    URL_DECODE   -   Decode  a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI   -    Like
                                                    URL_DECODE , but with sup-
                                                    port  for   Microsoft-spe-
                                                    cific  %u encoding. If the
                                                    code is in the  full-width
                                                    ASCII    code   range   of
                                                    FF01-FF5E  ,  the   higher
                                                    byte is used to detect and
                                                    adjust  the  lower   byte.
                                                    Otherwise,  only the lower
                                                    byte  is  used   and   the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE  - Convert
                                                    all  UTF-8  character  se-
                                                    quences  to  Unicode. This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives and  false-negatives
                                                    for non-English languages.

                                      PositionalConstraint -> (string)
                                          The area within the portion of a web
                                          request that you want WAF to  search
                                          for  SearchString . Valid values in-
                                          clude the following:
                                             CONTAINS

                                          The specified part of  the  web  re-
                                          quest  must  include  the  value  of
                                          SearchString  ,  but  the   location
                                          doesn't matter.
                                             CONTAINS_WORD

                                          The  specified  part  of the web re-
                                          quest  must  include  the  value  of
                                          SearchString , and SearchString must
                                          contain only alphanumeric characters
                                          or underscore (A-Z, a-z, 0-9, or _).
                                          In addition, SearchString must be  a
                                          word,  which  means that both of the
                                          following are true:

                                          o SearchString is at  the  beginning
                                            of  the  specified part of the web
                                            request or is preceded by a  char-
                                            acter  other  than an alphanumeric
                                            character or underscore (_). Exam-
                                            ples include the value of a header
                                            and ;BadBot .

                                          o SearchString is at the end of  the
                                            specified  part of the web request
                                            or  is  followed  by  a  character
                                            other than an alphanumeric charac-
                                            ter or underscore (_),  for  exam-
                                            ple, BadBot; and -BadBot; .
                                             EXACTLY

                                          The  value  of the specified part of
                                          the web request must  exactly  match
                                          the value of SearchString .
                                             STARTS_WITH

                                          The  value  of SearchString must ap-
                                          pear at the beginning of the  speci-
                                          fied part of the web request.
                                             ENDS_WITH

                                          The  value  of SearchString must ap-
                                          pear at the  end  of  the  specified
                                          part of the web request.

                                   SqliMatchStatement -> (structure)
                                      Attackers sometimes insert malicious SQL
                                      code into web requests in an  effort  to
                                      extract  data from your database. To al-
                                      low or block web requests that appear to
                                      contain  malicious  SQL code, create one
                                      or more SQL injection match  conditions.
                                      An SQL injection match condition identi-
                                      fies the part of web requests,  such  as
                                      the  URI  or  the query string, that you
                                      want  WAF  to  inspect.  Later  in   the
                                      process,  when you create a web ACL, you
                                      specify whether to allow  or  block  re-
                                      quests  that appear to contain malicious
                                      SQL code.

                                      FieldToMatch -> (structure)
                                          The part of a web request  that  you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect a single header.  Provide
                                             the  name  of  the  header to in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example JSON:  "SingleHeader":  {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The  name of the query header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect a single query  argument.
                                             Provide the name of the query ar-
                                             gument to inspect, such as  User-
                                             Name  or  SalesRegion  . The name
                                             can be up to 30  characters  long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web request component for WAF  to
                                             inspect,   in  the   FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The  name  of the query argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that identifies a  resource,  for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the part of a  URL  that  appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text. The  request  body  immedi-
                                             ately  follows  the request head-
                                             ers. This is the part  of  a  re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to  your  web  server as the HTTP
                                             request body, such as data from a
                                             form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect   the  HTTP  method.  The
                                             method indicates the type of  op-
                                             eration  that the request is ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the  part  of a request that con-
                                             tains any  additional  data  that
                                             you  want  to  send  to  your web
                                             server as the HTTP request  body,
                                             such as data from a form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The  patterns  to look for in
                                                 the JSON body.  WAF  inspects
                                                 the  results of these pattern
                                                 matches against the rule  in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See  also  MatchScope   in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this setting  or  the  In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match only  the  specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide the include  paths
                                                    using JSON Pointer syntax.
                                                    For  example,   "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"] . For  in-
                                                    formation  about this syn-
                                                    tax, see the Internet  En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this  setting  or  the All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't use this  option
                                                        to  include all paths.
                                                        Instead, use  the  All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON body.  The  options  are
                                                 the following:

                                                 o EVALUATE_AS_STRING   -  In-
                                                   spect  the  body  as  plain
                                                   text.  WAF applies the text
                                                   transformations and inspec-
                                                   tion  criteria that you de-
                                                   fined for the JSON  inspec-
                                                   tion   to   the  body  text
                                                   string.

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates  the content only up to
                                                 the  first  parsing   failure
                                                 that it encounters.

                                                 WAF  does  its  best to parse
                                                 the  entire  JSON  body,  but
                                                 might  be  forced to stop for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root  node isn't an object or
                                                 an array.

                                                 WAF parses the  JSON  in  the
                                                 following   examples  as  two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                                   XssMatchStatement -> (structure)
                                      A  rule   statement   that   defines   a
                                      cross-site  scripting (XSS) match search
                                      for WAF to apply to  web  requests.  XSS
                                      attacks  are  those  where  the attacker
                                      uses vulnerabilities in a benign website
                                      as   a   vehicle   to  inject  malicious
                                      client-site scripts into  other  legiti-
                                      mate  web browsers. The XSS match state-
                                      ment provides the location  in  requests
                                      that  you  want  WAF  to search and text
                                      transformations to  use  on  the  search
                                      area  before  WAF searches for character
                                      sequences that are likely  to  be  mali-
                                      cious strings.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.  If  you
                                          specify  one or more transformations
                                          in a rule  statement,  WAF  performs
                                          all  transformations  on the content
                                          of the request component  identified
                                          by  FieldToMatch , starting from the
                                          lowest priority setting, before  in-
                                          specting the content for a match.

                                          (structure)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets  the relative processing
                                                 order for multiple  transfor-
                                                 mations  that are defined for
                                                 a rule  statement.  WAF  pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive, but they  must  all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE -  Decode  a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a Base64 -encoded  string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE  -   Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness  of attackers who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use unusual formatting  to
                                                    disguise  some  or  all of
                                                    the command.

                                                 o Delete the following  char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with   a  space  character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v  , vertical tab, decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE  - Decode char-
                                                    acters that  were  encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This  function  uses up to
                                                    two bytes in the  decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS encoding that  wouldnt
                                                    typically be encoded. It's
                                                    also useful in  countering
                                                    evasion, which is a combi-
                                                    nation of a backslash  and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript    for   java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the  following  ANSI C es-
                                                    cape sequences: \a , \b  ,
                                                    \f  ,  \n , \r , \t , \v ,
                                                    \\ , \? , \' , \"  ,  \xHH
                                                    (hexadecimal),  \0OOO (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE  -   Decode   a
                                                    string    of   hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters with unencoded  char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with a non-breaking  space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces   characters  that
                                                   are represented in hexadec-
                                                   imal     format,    (amper-
                                                   sand)#xhhhh;  ,  with   the
                                                   corresponding characters

                                                 o Replaces   characters  that
                                                   are represented in  decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with   the    corresponding
                                                   characters
                                                    JS_DECODE  -  Decode Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the full-width ASCII  code
                                                    range  of FF01-FF5E , then
                                                    the higher byte is used to
                                                    detect   and   adjust  the
                                                    lower byte. If  not,  only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash  from the data in the
                                                    input. The  computed  hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH   -  Remove
                                                    multiple  slashes,  direc-
                                                    tory  self-references, and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning of the input from  an
                                                    input string.

                                                    NORMALIZE_PATH_WIN  - This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH  , but first con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS  - Remove all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences   are  not  com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination of a comment  (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS   -  Replace
                                                    NULL bytes  in  the  input
                                                    with    space   characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE  -   Decode
                                                    SQL   hex   data.  Example
                                                    (0x414243 )  will  be  de-
                                                    coded to (ABC ).

                                                    URL_DECODE   -   Decode  a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI   -    Like
                                                    URL_DECODE , but with sup-
                                                    port  for   Microsoft-spe-
                                                    cific  %u encoding. If the
                                                    code is in the  full-width
                                                    ASCII    code   range   of
                                                    FF01-FF5E  ,  the   higher
                                                    byte is used to detect and
                                                    adjust  the  lower   byte.
                                                    Otherwise,  only the lower
                                                    byte  is  used   and   the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE  - Convert
                                                    all  UTF-8  character  se-
                                                    quences  to  Unicode. This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives and  false-negatives
                                                    for non-English languages.

                                   SizeConstraintStatement -> (structure)
                                      A  rule statement that compares a number
                                      of bytes against the size of  a  request
                                      component,  using a comparison operator,
                                      such as greater than (>)  or  less  than
                                      (<).  For  example,  you  can use a size
                                      constraint statement to look  for  query
                                      strings that are longer than 100 bytes.

                                      If  you configure WAF to inspect the re-
                                      quest body, WAF inspects only the  first
                                      8192  bytes  (8 KB). If the request body
                                      for your web requests never exceeds 8192
                                      bytes,  you can create a size constraint
                                      condition and block requests that have a
                                      request body greater than 8192 bytes.

                                      If  you choose URI for the value of Part
                                      of the request to filter on,  the  slash
                                      (/)  in the URI counts as one character.
                                      For example, the URI /logo.jpg  is  nine
                                      characters long.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      ComparisonOperator -> (string)
                                          The  operator  to use to compare the
                                          request part to the size setting.

                                      Size -> (long)
                                          The size, in byte, to compare to the
                                          request  part, after any transforma-
                                          tions.

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                                   GeoMatchStatement -> (structure)
                                      A rule statement used  to  identify  web
                                      requests based on country of origin.

                                      CountryCodes -> (list)
                                          An  array  of  two-character country
                                          codes, for example, [ "US", "CN" ] ,
                                          from  the  alpha-2 country ISO codes
                                          of the ISO 3166 international  stan-
                                          dard.

                                          (string)

                                      ForwardedIPConfig -> (structure)
                                          The  configuration for inspecting IP
                                          addresses in an HTTP header that you
                                          specify, instead of using the IP ad-
                                          dress that's reported by the web re-
                                          quest  origin. Commonly, this is the
                                          X-Forwarded-For  (XFF)  header,  but
                                          you can specify any header name.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          HeaderName -> (string)
                                             The name of the  HTTP  header  to
                                             use for the IP address. For exam-
                                             ple, to use  the  X-Forwarded-For
                                             (XFF)  header, set this to X-For-
                                             warded-For .

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                          FallbackBehavior -> (string)
                                             The match status to assign to the
                                             web  request   if   the   request
                                             doesn't  have  a valid IP address
                                             in the specified position.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             You  can  specify  the  following
                                             fallback behaviors:

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                   RuleGroupReferenceStatement -> (structure)
                                      A  rule  statement used to run the rules
                                      that are defined in a   RuleGroup  .  To
                                      use  this, create a rule group with your
                                      rules, then provide the ARN of the  rule
                                      group in this statement.

                                      You  cannot  nest a RuleGroupReferenceS-
                                      tatement , for example for use inside  a
                                      NotStatement  or  OrStatement  . You can
                                      only use a rule group  reference  state-
                                      ment at the top level inside a web ACL.

                                      ARN -> (string)
                                          The  Amazon  Resource  Name (ARN) of
                                          the entity.

                                      ExcludedRules -> (list)
                                          The rules  in  the  referenced  rule
                                          group whose actions are set to Count
                                          . When you exclude a rule, WAF eval-
                                          uates  it exactly as it would if the
                                          rule action  setting  were  Count  .
                                          This  is a useful option for testing
                                          the rules in a  rule  group  without
                                          modifying  how  they handle your web
                                          traffic.

                                          (structure)
                                             Specifies a single rule in a rule
                                             group  whose  action  you want to
                                             override to Count . When you  ex-
                                             clude  a  rule,  WAF evaluates it
                                             exactly as it would if  the  rule
                                             action  setting were Count . This
                                             is a useful  option  for  testing
                                             the rules in a rule group without
                                             modifying how  they  handle  your
                                             web traffic.

                                             Name -> (string)
                                                 The  name  of  the rule whose
                                                 action you want  to  override
                                                 to Count .

                                   IPSetReferenceStatement -> (structure)
                                      A  rule statement used to detect web re-
                                      quests coming  from  particular  IP  ad-
                                      dresses  or address ranges. To use this,
                                      create an  IPSet that specifies the  ad-
                                      dresses you want to detect, then use the
                                      ARN of that set in  this  statement.  To
                                      create an IP set, see  CreateIPSet .

                                      Each IP set rule statement references an
                                      IP set. You create and maintain the  set
                                      independent  of  your rules. This allows
                                      you to use the single  set  in  multiple
                                      rules.  When  you  update the referenced
                                      set, WAF automatically updates all rules
                                      that reference it.

                                      ARN -> (string)
                                          The  Amazon  Resource  Name (ARN) of
                                          the  IPSet that this statement  ref-
                                          erences.

                                      IPSetForwardedIPConfig -> (structure)
                                          The  configuration for inspecting IP
                                          addresses in an HTTP header that you
                                          specify, instead of using the IP ad-
                                          dress that's reported by the web re-
                                          quest  origin. Commonly, this is the
                                          X-Forwarded-For  (XFF)  header,  but
                                          you can specify any header name.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          HeaderName -> (string)
                                             The name of the  HTTP  header  to
                                             use for the IP address. For exam-
                                             ple, to use  the  X-Forwarded-For
                                             (XFF)  header, set this to X-For-
                                             warded-For .

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                          FallbackBehavior -> (string)
                                             The match status to assign to the
                                             web  request   if   the   request
                                             doesn't  have  a valid IP address
                                             in the specified position.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             You  can  specify  the  following
                                             fallback behaviors:

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                          Position -> (string)
                                             The  position  in  the  header to
                                             search for the  IP  address.  The
                                             header  can  contain IP addresses
                                             of the original client  and  also
                                             of   proxies.  For  example,  the
                                             header value could  be  10.1.1.1,
                                             127.0.0.0,  10.10.10.10 where the
                                             first IP address  identifies  the
                                             original   client  and  the  rest
                                             identify proxies that the request
                                             went through.

                                             The  options for this setting are
                                             the following:

                                             o FIRST - Inspect  the  first  IP
                                               address  in  the list of IP ad-
                                               dresses in the header. This  is
                                               usually  the  client's original
                                               IP.

                                             o LAST - Inspect the last IP  ad-
                                               dress  in  the  list  of IP ad-
                                               dresses in the header.

                                             o ANY - Inspect all IP  addresses
                                               in  the  header for a match. If
                                               the header contains  more  than
                                               10  IP  addresses, WAF inspects
                                               the last 10.

                                   RegexPatternSetReferenceStatement        ->
                                   (structure)
                                      A  rule statement used to search web re-
                                      quest components for matches with  regu-
                                      lar  expressions.  To use this, create a
                                      RegexPatternSet that specifies  the  ex-
                                      pressions  that you want to detect, then
                                      use the ARN of that set in  this  state-
                                      ment.  A web request matches the pattern
                                      set rule statement if the request compo-
                                      nent  matches any of the patterns in the
                                      set. To create a regex pattern set,  see
                                      CreateRegexPatternSet .

                                      Each  regex  pattern  set rule statement
                                      references a regex pattern set. You cre-
                                      ate  and maintain the set independent of
                                      your rules. This allows you to  use  the
                                      single  set  in multiple rules. When you
                                      update the referenced set, WAF automati-
                                      cally  updates  all rules that reference
                                      it.

                                      ARN -> (string)
                                          The Amazon Resource  Name  (ARN)  of
                                          the    RegexPatternSet   that   this
                                          statement references.

                                      FieldToMatch -> (structure)
                                          The part of a web request  that  you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect a single header.  Provide
                                             the  name  of  the  header to in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example JSON:  "SingleHeader":  {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The  name of the query header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect a single query  argument.
                                             Provide the name of the query ar-
                                             gument to inspect, such as  User-
                                             Name  or  SalesRegion  . The name
                                             can be up to 30  characters  long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web request component for WAF  to
                                             inspect,   in  the   FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The  name  of the query argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that identifies a  resource,  for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the part of a  URL  that  appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text. The  request  body  immedi-
                                             ately  follows  the request head-
                                             ers. This is the part  of  a  re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to  your  web  server as the HTTP
                                             request body, such as data from a
                                             form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect   the  HTTP  method.  The
                                             method indicates the type of  op-
                                             eration  that the request is ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the  part  of a request that con-
                                             tains any  additional  data  that
                                             you  want  to  send  to  your web
                                             server as the HTTP request  body,
                                             such as data from a form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The  patterns  to look for in
                                                 the JSON body.  WAF  inspects
                                                 the  results of these pattern
                                                 matches against the rule  in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See  also  MatchScope   in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this setting  or  the  In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match only  the  specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide the include  paths
                                                    using JSON Pointer syntax.
                                                    For  example,   "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"] . For  in-
                                                    formation  about this syn-
                                                    tax, see the Internet  En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this  setting  or  the All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't use this  option
                                                        to  include all paths.
                                                        Instead, use  the  All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON body.  The  options  are
                                                 the following:

                                                 o EVALUATE_AS_STRING   -  In-
                                                   spect  the  body  as  plain
                                                   text.  WAF applies the text
                                                   transformations and inspec-
                                                   tion  criteria that you de-
                                                   fined for the JSON  inspec-
                                                   tion   to   the  body  text
                                                   string.

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates  the content only up to
                                                 the  first  parsing   failure
                                                 that it encounters.

                                                 WAF  does  its  best to parse
                                                 the  entire  JSON  body,  but
                                                 might  be  forced to stop for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root  node isn't an object or
                                                 an array.

                                                 WAF parses the  JSON  in  the
                                                 following   examples  as  two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                                   RateBasedStatement -> (structure)
                                      A rate-based rule tracks the rate of re-
                                      quests  for each originating IP address,
                                      and triggers the rule  action  when  the
                                      rate exceeds a limit that you specify on
                                      the number of requests in  any  5-minute
                                      time  span.  You  can  use this to put a
                                      temporary block on requests from  an  IP
                                      address  that  is  sending excessive re-
                                      quests.

                                      WAF tracks and manages web requests sep-
                                      arately   for   each   instance   of   a
                                      rate-based rule that you use. For  exam-
                                      ple,  if you provide the same rate-based
                                      rule settings in two web ACLs,  each  of
                                      the  two  rule  statements  represents a
                                      separate instance of the rate-based rule
                                      and gets its own tracking and management
                                      by WAF. If you define a rate-based  rule
                                      inside  a  rule group, and then use that
                                      rule group in multiple places, each  use
                                      creates   a  separate  instance  of  the
                                      rate-based rule that gets its own track-
                                      ing and management by WAF.

                                      When   the  rule  action  triggers,  WAF
                                      blocks additional requests from  the  IP
                                      address until the request rate falls be-
                                      low the limit.

                                      You can optionally nest  another  state-
                                      ment inside the rate-based statement, to
                                      narrow the scope of the rule so that  it
                                      only  counts  requests  that  match  the
                                      nested statement. For example, based  on
                                      recent  requests that you have seen from
                                      an  attacker,   you   might   create   a
                                      rate-based  rule  with a nested AND rule
                                      statement that  contains  the  following
                                      nested statements:

                                      o An  IP  match statement with an IP set
                                        that specified the address 192.0.2.44.

                                      o A string match statement that searches
                                        in   the  User-Agent  header  for  the
                                        string BadBot.

                                      In this rate-based rule, you also define
                                      a rate limit. For this example, the rate
                                      limit is 1,000. Requests that meet  both
                                      of  the conditions in the statements are
                                      counted. If the count exceeds 1,000  re-
                                      quests per five minutes, the rule action
                                      triggers. Requests that do not meet both
                                      conditions  are  not counted towards the
                                      rate limit and are not affected by  this
                                      rule.

                                      You cannot nest a RateBasedStatement in-
                                      side another statement, for example  in-
                                      side a NotStatement or OrStatement . You
                                      can define a RateBasedStatement inside a
                                      web ACL and inside a rule group.

                                      Limit -> (long)
                                          The  limit  on requests per 5-minute
                                          period for a single  originating  IP
                                          address. If the statement includes a
                                          ScopeDownStatement , this  limit  is
                                          applied  only  to  the requests that
                                          match the statement.

                                      AggregateKeyType -> (string)
                                          Setting that indicates how to aggre-
                                          gate the request counts. The options
                                          are the following:

                                          o IP - Aggregate the request  counts
                                            on the IP address from the web re-
                                            quest origin.

                                          o FORWARDED_IP - Aggregate  the  re-
                                            quest  counts  on the first IP ad-
                                            dress in an HTTP  header.  If  you
                                            use   this,   configure  the  For-
                                            wardedIPConfig ,  to  specify  the
                                            header to use.

                                      (  ...  recursive ... )ForwardedIPConfig
                                      -> (structure)
                                          The configuration for inspecting  IP
                                          addresses in an HTTP header that you
                                          specify, instead of using the IP ad-
                                          dress that's reported by the web re-
                                          quest origin. Commonly, this is  the
                                          X-Forwarded-For  (XFF)  header,  but
                                          you can specify any header name.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present   in   the  request,  WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          This is required if AggregateKeyType
                                          is set to FORWARDED_IP .

                                          HeaderName -> (string)
                                             The name of the  HTTP  header  to
                                             use for the IP address. For exam-
                                             ple, to use  the  X-Forwarded-For
                                             (XFF)  header, set this to X-For-
                                             warded-For .

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                          FallbackBehavior -> (string)
                                             The match status to assign to the
                                             web  request   if   the   request
                                             doesn't  have  a valid IP address
                                             in the specified position.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             You  can  specify  the  following
                                             fallback behaviors:

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                   AndStatement -> (structure)
                                      A logical rule statement used to combine
                                      other rule statements  with  AND  logic.
                                      You  provide  more  than  one  Statement
                                      within the AndStatement .

                                      Statements -> (list)
                                          The statements to combine  with  AND
                                          logic.  You  can  use any statements
                                          that can be nested.

                                          ( ... recursive ... )

                                   OrStatement -> (structure)
                                      A logical rule statement used to combine
                                      other rule statements with OR logic. You
                                      provide more than one  Statement  within
                                      the OrStatement .

                                      Statements -> (list)
                                          The  statements  to  combine with OR
                                          logic. You can  use  any  statements
                                          that can be nested.

                                          ( ... recursive ... )

                                   NotStatement -> (structure)
                                      A  logical rule statement used to negate
                                      the results of another  rule  statement.
                                      You  provide  one   Statement within the
                                      NotStatement .

                                      ( ... recursive ... )

                                   ManagedRuleGroupStatement -> (structure)
                                      A rule statement used to run  the  rules
                                      that  are  defined  in  a  managed  rule
                                      group. To use this, provide  the  vendor
                                      name  and  the name of the rule group in
                                      this statement. You can retrieve the re-
                                      quired names by calling  ListAvailableM-
                                      anagedRuleGroups .

                                      You cannot nest a ManagedRuleGroupState-
                                      ment , for example for use inside a Not-
                                      Statement or OrStatement . It  can  only
                                      be  referenced  as a top-level statement
                                      within a rule.

                                      VendorName -> (string)
                                          The name of the managed  rule  group
                                          vendor. You use this, along with the
                                          rule group  name,  to  identify  the
                                          rule group.

                                      Name -> (string)
                                          The  name of the managed rule group.
                                          You use this, along with the  vendor
                                          name, to identify the rule group.

                                      Version -> (string)
                                          The  version  of  the  managed  rule
                                          group to use. If you  specify  this,
                                          the  version  setting is fixed until
                                          you change it. If you don't  specify
                                          this,  WAF uses the vendor's default
                                          version, and then keeps the  version
                                          at  the  vendor's  default  when the
                                          vendor  updates  the  managed   rule
                                          group settings.

                                      ExcludedRules -> (list)
                                          The  rules  in  the  referenced rule
                                          group whose actions are set to Count
                                          . When you exclude a rule, WAF eval-
                                          uates it exactly as it would if  the
                                          rule  action  setting  were  Count .
                                          This is a useful option for  testing
                                          the  rules  in  a rule group without
                                          modifying how they handle  your  web
                                          traffic.

                                          (structure)
                                             Specifies a single rule in a rule
                                             group whose action  you  want  to
                                             override  to Count . When you ex-
                                             clude a rule,  WAF  evaluates  it
                                             exactly  as  it would if the rule
                                             action setting were Count .  This
                                             is  a  useful  option for testing
                                             the rules in a rule group without
                                             modifying  how  they  handle your
                                             web traffic.

                                             Name -> (string)
                                                 The name of  the  rule  whose
                                                 action  you  want to override
                                                 to Count .

                                      ( ... recursive ... )

                                   LabelMatchStatement -> (structure)
                                      A rule statement that defines  a  string
                                      match  search  against  labels that have
                                      been added to the web request  by  rules
                                      that have already run in the web ACL.

                                      The  label  match statement provides the
                                      label or namespace string to search for.
                                      The label string can represent a part or
                                      all of the fully  qualified  label  name
                                      that  had been added to the web request.
                                      Fully qualified labels  have  a  prefix,
                                      optional namespaces, and label name. The
                                      prefix identifies the rule group or  web
                                      ACL  context  of the rule that added the
                                      label. If you do not provide  the  fully
                                      qualified   name  in  your  label  match
                                      string, WAF performs the search for  la-
                                      bels that were added in the same context
                                      as the label match statement.

                                      Scope -> (string)
                                          Specify whether you  want  to  match
                                          using  the  label  name  or just the
                                          namespace.

                                      Key -> (string)
                                          The string  to  match  against.  The
                                          setting you provide for this depends
                                          on the match statement's Scope  set-
                                          ting:

                                          o If  the  Scope  indicates  LABEL ,
                                            then this specification  must  in-
                                            clude the name and can include any
                                            number  of   preceding   namespace
                                            specifications  and  prefix  up to
                                            providing the fully qualified  la-
                                            bel name.

                                          o If the Scope indicates NAMESPACE ,
                                            then this  specification  can  in-
                                            clude  any  number  of  contiguous
                                            namespace strings, and can include
                                            the  entire label namespace prefix
                                            from the rule  group  or  web  ACL
                                            where the label originates.

                                          Labels are case sensitive and compo-
                                          nents of a label must  be  separated
                                          by colon, for example NS1:NS2:name .

                                   RegexMatchStatement -> (structure)
                                      A  rule statement used to search web re-
                                      quest components for a match  against  a
                                      single regular expression.

                                      RegexString -> (string)
                                          The  string representing the regular
                                          expression.

                                      FieldToMatch -> (structure)
                                          The part of a web request  that  you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect a single header.  Provide
                                             the  name  of  the  header to in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example JSON:  "SingleHeader":  {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The  name of the query header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect a single query  argument.
                                             Provide the name of the query ar-
                                             gument to inspect, such as  User-
                                             Name  or  SalesRegion  . The name
                                             can be up to 30  characters  long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web request component for WAF  to
                                             inspect,   in  the   FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The  name  of the query argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that identifies a  resource,  for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the part of a  URL  that  appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text. The  request  body  immedi-
                                             ately  follows  the request head-
                                             ers. This is the part  of  a  re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to  your  web  server as the HTTP
                                             request body, such as data from a
                                             form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect   the  HTTP  method.  The
                                             method indicates the type of  op-
                                             eration  that the request is ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the  part  of a request that con-
                                             tains any  additional  data  that
                                             you  want  to  send  to  your web
                                             server as the HTTP request  body,
                                             such as data from a form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The  patterns  to look for in
                                                 the JSON body.  WAF  inspects
                                                 the  results of these pattern
                                                 matches against the rule  in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See  also  MatchScope   in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this setting  or  the  In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match only  the  specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide the include  paths
                                                    using JSON Pointer syntax.
                                                    For  example,   "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"] . For  in-
                                                    formation  about this syn-
                                                    tax, see the Internet  En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this  setting  or  the All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't use this  option
                                                        to  include all paths.
                                                        Instead, use  the  All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON body.  The  options  are
                                                 the following:

                                                 o EVALUATE_AS_STRING   -  In-
                                                   spect  the  body  as  plain
                                                   text.  WAF applies the text
                                                   transformations and inspec-
                                                   tion  criteria that you de-
                                                   fined for the JSON  inspec-
                                                   tion   to   the  body  text
                                                   string.

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates  the content only up to
                                                 the  first  parsing   failure
                                                 that it encounters.

                                                 WAF  does  its  best to parse
                                                 the  entire  JSON  body,  but
                                                 might  be  forced to stop for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root  node isn't an object or
                                                 an array.

                                                 WAF parses the  JSON  in  the
                                                 following   examples  as  two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                               ForwardedIPConfig -> (structure)
                                   The configuration  for  inspecting  IP  ad-
                                   dresses in an HTTP header that you specify,
                                   instead of using the IP address that's  re-
                                   ported by the web request origin. Commonly,
                                   this is the X-Forwarded-For  (XFF)  header,
                                   but you can specify any header name.

                                   NOTE:
                                      If the specified header isn't present in
                                      the request, WAF doesn't apply the  rule
                                      to the web request at all.

                                   This is required if AggregateKeyType is set
                                   to FORWARDED_IP .

                                   HeaderName -> (string)
                                      The name of the HTTP header to  use  for
                                      the  IP address. For example, to use the
                                      X-Forwarded-For (XFF) header,  set  this
                                      to X-Forwarded-For .

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                   FallbackBehavior -> (string)
                                      The match status to assign  to  the  web
                                      request  if  the  request doesn't have a
                                      valid IP address in the specified  posi-
                                      tion.

                                      NOTE:
                                          If   the   specified   header  isn't
                                          present in the request, WAF  doesn't
                                          apply the rule to the web request at
                                          all.

                                      You can specify the  following  fallback
                                      behaviors:

                                      o MATCH  -  Treat  the  web  request  as
                                        matching the rule statement.  WAF  ap-
                                        plies the rule action to the request.

                                      o NO_MATCH  -  Treat  the web request as
                                        not matching the rule statement.

                            AndStatement -> (structure)
                               A logical rule statement used to combine  other
                               rule  statements  with  AND  logic. You provide
                               more than one  Statement within  the  AndState-
                               ment .

                               Statements -> (list)
                                   The  statements  to combine with AND logic.
                                   You can use  any  statements  that  can  be
                                   nested.

                                   (structure)
                                      The  processing  guidance  for a  Rule ,
                                      used by WAF to determine whether  a  web
                                      request matches the rule.

                                      ByteMatchStatement -> (structure)
                                          A  rule  statement  that  defines  a
                                          string match search for WAF to apply
                                          to  web  requests.  The  byte  match
                                          statement  provides  the  bytes   to
                                          search for, the location in requests
                                          that you want  WAF  to  search,  and
                                          other  settings. The bytes to search
                                          for are typically a string that cor-
                                          responds  with  ASCII characters. In
                                          the WAF console  and  the  developer
                                          guide,  this  is  refered  to  as  a
                                          string match statement.

                                          SearchString -> (blob)
                                             A string value that you want  WAF
                                             to  search for. WAF searches only
                                             in the part of web requests  that
                                             you  designate  for inspection in
                                             FieldToMatch . The maximum length
                                             of the value is 50 bytes.

                                             Valid values depend on the compo-
                                             nent that you specify for inspec-
                                             tion in FieldToMatch :

                                             o Method  :  The HTTP method that
                                               you want  WAF  to  search  for.
                                               This  indicates the type of op-
                                               eration specified  in  the  re-
                                               quest.

                                             o UriPath  :  The  value that you
                                               want WAF to search for  in  the
                                               URI  path,  for  example,  /im-
                                               ages/daily-ad.jpg .

                                             If SearchString  includes  alpha-
                                             betic  characters  A-Z  and  a-z,
                                             note that the value is case  sen-
                                             sitive.
                                                 If you're using the WAF API

                                             Specify  a base64-encoded version
                                             of the value. The maximum  length
                                             of    the    value   before   you
                                             base64-encode it is 50 bytes.

                                             For example, suppose the value of
                                             Type  is  HEADER and the value of
                                             Data is User-Agent . If you  want
                                             to  search  the User-Agent header
                                             for  the  value  BadBot   ,   you
                                             base64-encode  BadBot  using MIME
                                             base64-encoding and  include  the
                                             resulting  value,  QmFkQm90  , in
                                             the value of SearchString .
                                                 If you're using  the  CLI  or
                                                 one  of  the  Amazon Web Ser-
                                                 vices SDKs

                                             The value that you  want  WAF  to
                                             search for. The SDK automatically
                                             base64 encodes the value.

                                          FieldToMatch -> (structure)
                                             The part of a  web  request  that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide  the  name of the header
                                                 to  inspect,   for   example,
                                                 User-Agent  or Referer . This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The   name  of  the  query
                                                    header to inspect.

                                             SingleQueryArgument  ->   (struc-
                                             ture)
                                                 Inspect  a single query argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such as UserName or  SalesRe-
                                                 gion  . The name can be up to
                                                 30 characters long and  isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF   to   inspect,   in  the
                                                 FieldToMatch specification.

                                                 Example  JSON:   "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The name of the query  ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest  that  identifies a re-
                                                 source,  for  example,   /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect   the  query  string.
                                                 This is the  part  of  a  URL
                                                 that  appears after a ? char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect the request  body  as
                                                 plain  text. The request body
                                                 immediately follows  the  re-
                                                 quest  headers.  This  is the
                                                 part of a request  that  con-
                                                 tains   any  additional  data
                                                 that you want to send to your
                                                 web  server  as  the HTTP re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect  the HTTP method. The
                                                 method indicates the type  of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect the request  body  as
                                                 JSON.  The request body imme-
                                                 diately follows  the  request
                                                 headers.  This is the part of
                                                 a request that  contains  any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the  HTTP  request body, such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The patterns to  look  for
                                                    in  the JSON body. WAF in-
                                                    spects  the   results   of
                                                    these    pattern   matches
                                                    against the  rule  inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match  all of the ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match only the  speci-
                                                        fied   include  paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide   the  include
                                                        paths    using    JSON
                                                        Pointer   syntax.  For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"]  . For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force  (IETF) documen-
                                                        tation JavaScript  Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the All  setting,  but
                                                        not both.

                                                        NOTE:
                                                           Don't  use this op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The parts of the  JSON  to
                                                    match  against  using  the
                                                    MatchPattern  .   If   you
                                                    specify  All , WAF matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What  WAF  should do if it
                                                    fails to completely  parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect  the body as plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection to  the  body
                                                      text string.

                                                    o MATCH  -  Treat  the web
                                                      request as matching  the
                                                      rule  statement. WAF ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request as not  matching
                                                      the rule statement.

                                                    If  you don't provide this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up to  the  first  parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the  entire JSON body, but
                                                    might be  forced  to  stop
                                                    for  reasons  such  as in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any  content  whose   root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following  examples as two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. If you  specify  one  or
                                             more  transformations  in  a rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the request component  identified
                                             by  FieldToMatch  , starting from
                                             the lowest priority setting,  be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations  that  are
                                                    defined  for a rule state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est priority  to  highest,
                                                    before    inspecting   the
                                                    transformed  content.  The
                                                    priorities  don't  need to
                                                    be consecutive,  but  they
                                                    must all be different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                          PositionalConstraint -> (string)
                                             The area within the portion of  a
                                             web  request that you want WAF to
                                             search for SearchString  .  Valid
                                             values include the following:
                                                 CONTAINS

                                             The specified part of the web re-
                                             quest must include the  value  of
                                             SearchString  ,  but the location
                                             doesn't matter.
                                                 CONTAINS_WORD

                                             The specified part of the web re-
                                             quest  must  include the value of
                                             SearchString ,  and  SearchString
                                             must  contain  only  alphanumeric
                                             characters  or  underscore  (A-Z,
                                             a-z,  0-9,  or  _).  In addition,
                                             SearchString  must  be  a   word,
                                             which means that both of the fol-
                                             lowing are true:

                                             o SearchString is at  the  begin-
                                               ning  of  the specified part of
                                               the web request or is  preceded
                                               by  a  character  other than an
                                               alphanumeric character  or  un-
                                               derscore  (_). Examples include
                                               the value of a header and ;Bad-
                                               Bot .

                                             o SearchString  is  at the end of
                                               the specified part of  the  web
                                               request  or  is  followed  by a
                                               character  other  than  an  al-
                                               phanumeric  character or under-
                                               score (_), for example, BadBot;
                                               and -BadBot; .
                                                 EXACTLY

                                             The  value  of the specified part
                                             of the web request  must  exactly
                                             match the value of SearchString .
                                                 STARTS_WITH

                                             The  value  of  SearchString must
                                             appear at the  beginning  of  the
                                             specified  part  of  the  web re-
                                             quest.
                                                 ENDS_WITH

                                             The value  of  SearchString  must
                                             appear  at  the end of the speci-
                                             fied part of the web request.

                                      SqliMatchStatement -> (structure)
                                          Attackers sometimes insert malicious
                                          SQL code into web requests in an ef-
                                          fort to extract data from your data-
                                          base. To allow or block web requests
                                          that appear to contain malicious SQL
                                          code,  create one or more SQL injec-
                                          tion match conditions. An SQL injec-
                                          tion  match condition identifies the
                                          part of web requests,  such  as  the
                                          URI  or  the  query string, that you
                                          want WAF to inspect.  Later  in  the
                                          process,  when you create a web ACL,
                                          you  specify  whether  to  allow  or
                                          block  requests  that appear to con-
                                          tain malicious SQL code.

                                          FieldToMatch -> (structure)
                                             The part of a  web  request  that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide  the  name of the header
                                                 to  inspect,   for   example,
                                                 User-Agent  or Referer . This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The   name  of  the  query
                                                    header to inspect.

                                             SingleQueryArgument  ->   (struc-
                                             ture)
                                                 Inspect  a single query argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such as UserName or  SalesRe-
                                                 gion  . The name can be up to
                                                 30 characters long and  isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF   to   inspect,   in  the
                                                 FieldToMatch specification.

                                                 Example  JSON:   "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The name of the query  ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest  that  identifies a re-
                                                 source,  for  example,   /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect   the  query  string.
                                                 This is the  part  of  a  URL
                                                 that  appears after a ? char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect the request  body  as
                                                 plain  text. The request body
                                                 immediately follows  the  re-
                                                 quest  headers.  This  is the
                                                 part of a request  that  con-
                                                 tains   any  additional  data
                                                 that you want to send to your
                                                 web  server  as  the HTTP re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect  the HTTP method. The
                                                 method indicates the type  of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect the request  body  as
                                                 JSON.  The request body imme-
                                                 diately follows  the  request
                                                 headers.  This is the part of
                                                 a request that  contains  any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the  HTTP  request body, such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The patterns to  look  for
                                                    in  the JSON body. WAF in-
                                                    spects  the   results   of
                                                    these    pattern   matches
                                                    against the  rule  inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match  all of the ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match only the  speci-
                                                        fied   include  paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide   the  include
                                                        paths    using    JSON
                                                        Pointer   syntax.  For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"]  . For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force  (IETF) documen-
                                                        tation JavaScript  Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the All  setting,  but
                                                        not both.

                                                        NOTE:
                                                           Don't  use this op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The parts of the  JSON  to
                                                    match  against  using  the
                                                    MatchPattern  .   If   you
                                                    specify  All , WAF matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What  WAF  should do if it
                                                    fails to completely  parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect  the body as plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection to  the  body
                                                      text string.

                                                    o MATCH  -  Treat  the web
                                                      request as matching  the
                                                      rule  statement. WAF ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request as not  matching
                                                      the rule statement.

                                                    If  you don't provide this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up to  the  first  parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the  entire JSON body, but
                                                    might be  forced  to  stop
                                                    for  reasons  such  as in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any  content  whose   root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following  examples as two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. If you  specify  one  or
                                             more  transformations  in  a rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the request component  identified
                                             by  FieldToMatch  , starting from
                                             the lowest priority setting,  be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations  that  are
                                                    defined  for a rule state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est priority  to  highest,
                                                    before    inspecting   the
                                                    transformed  content.  The
                                                    priorities  don't  need to
                                                    be consecutive,  but  they
                                                    must all be different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                      XssMatchStatement -> (structure)
                                          A  rule  statement  that  defines  a
                                          cross-site   scripting  (XSS)  match
                                          search for WAF to apply to  web  re-
                                          quests.  XSS attacks are those where
                                          the attacker uses vulnerabilities in
                                          a benign website as a vehicle to in-
                                          ject malicious  client-site  scripts
                                          into  other legitimate web browsers.
                                          The XSS match statement provides the
                                          location  in  requests that you want
                                          WAF to search and  text  transforma-
                                          tions  to use on the search area be-
                                          fore WAF searches for character  se-
                                          quences  that are likely to be mali-
                                          cious strings.

                                          FieldToMatch -> (structure)
                                             The part of a  web  request  that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide  the  name of the header
                                                 to  inspect,   for   example,
                                                 User-Agent  or Referer . This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The   name  of  the  query
                                                    header to inspect.

                                             SingleQueryArgument  ->   (struc-
                                             ture)
                                                 Inspect  a single query argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such as UserName or  SalesRe-
                                                 gion  . The name can be up to
                                                 30 characters long and  isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF   to   inspect,   in  the
                                                 FieldToMatch specification.

                                                 Example  JSON:   "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The name of the query  ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest  that  identifies a re-
                                                 source,  for  example,   /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect   the  query  string.
                                                 This is the  part  of  a  URL
                                                 that  appears after a ? char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect the request  body  as
                                                 plain  text. The request body
                                                 immediately follows  the  re-
                                                 quest  headers.  This  is the
                                                 part of a request  that  con-
                                                 tains   any  additional  data
                                                 that you want to send to your
                                                 web  server  as  the HTTP re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect  the HTTP method. The
                                                 method indicates the type  of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect the request  body  as
                                                 JSON.  The request body imme-
                                                 diately follows  the  request
                                                 headers.  This is the part of
                                                 a request that  contains  any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the  HTTP  request body, such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The patterns to  look  for
                                                    in  the JSON body. WAF in-
                                                    spects  the   results   of
                                                    these    pattern   matches
                                                    against the  rule  inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match  all of the ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match only the  speci-
                                                        fied   include  paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide   the  include
                                                        paths    using    JSON
                                                        Pointer   syntax.  For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"]  . For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force  (IETF) documen-
                                                        tation JavaScript  Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the All  setting,  but
                                                        not both.

                                                        NOTE:
                                                           Don't  use this op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The parts of the  JSON  to
                                                    match  against  using  the
                                                    MatchPattern  .   If   you
                                                    specify  All , WAF matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What  WAF  should do if it
                                                    fails to completely  parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect  the body as plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection to  the  body
                                                      text string.

                                                    o MATCH  -  Treat  the web
                                                      request as matching  the
                                                      rule  statement. WAF ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request as not  matching
                                                      the rule statement.

                                                    If  you don't provide this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up to  the  first  parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the  entire JSON body, but
                                                    might be  forced  to  stop
                                                    for  reasons  such  as in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any  content  whose   root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following  examples as two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. If you  specify  one  or
                                             more  transformations  in  a rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the request component  identified
                                             by  FieldToMatch  , starting from
                                             the lowest priority setting,  be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations  that  are
                                                    defined  for a rule state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est priority  to  highest,
                                                    before    inspecting   the
                                                    transformed  content.  The
                                                    priorities  don't  need to
                                                    be consecutive,  but  they
                                                    must all be different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                      SizeConstraintStatement -> (structure)
                                          A rule  statement  that  compares  a
                                          number  of bytes against the size of
                                          a request component, using a compar-
                                          ison  operator, such as greater than
                                          (>) or less than (<).  For  example,
                                          you can use a size constraint state-
                                          ment to look for query strings  that
                                          are longer than 100 bytes.

                                          If  you configure WAF to inspect the
                                          request body, WAF inspects only  the
                                          first  8192 bytes (8 KB). If the re-
                                          quest body  for  your  web  requests
                                          never  exceeds  8192  bytes, you can
                                          create a size  constraint  condition
                                          and  block  requests that have a re-
                                          quest body greater than 8192 bytes.

                                          If you choose URI for the  value  of
                                          Part  of  the  request to filter on,
                                          the slash (/) in the URI  counts  as
                                          one  character. For example, the URI
                                          /logo.jpg is nine characters long.

                                          FieldToMatch -> (structure)
                                             The part of a  web  request  that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide  the  name of the header
                                                 to  inspect,   for   example,
                                                 User-Agent  or Referer . This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The   name  of  the  query
                                                    header to inspect.

                                             SingleQueryArgument  ->   (struc-
                                             ture)
                                                 Inspect  a single query argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such as UserName or  SalesRe-
                                                 gion  . The name can be up to
                                                 30 characters long and  isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF   to   inspect,   in  the
                                                 FieldToMatch specification.

                                                 Example  JSON:   "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The name of the query  ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest  that  identifies a re-
                                                 source,  for  example,   /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect   the  query  string.
                                                 This is the  part  of  a  URL
                                                 that  appears after a ? char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect the request  body  as
                                                 plain  text. The request body
                                                 immediately follows  the  re-
                                                 quest  headers.  This  is the
                                                 part of a request  that  con-
                                                 tains   any  additional  data
                                                 that you want to send to your
                                                 web  server  as  the HTTP re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect  the HTTP method. The
                                                 method indicates the type  of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect the request  body  as
                                                 JSON.  The request body imme-
                                                 diately follows  the  request
                                                 headers.  This is the part of
                                                 a request that  contains  any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the  HTTP  request body, such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The patterns to  look  for
                                                    in  the JSON body. WAF in-
                                                    spects  the   results   of
                                                    these    pattern   matches
                                                    against the  rule  inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match  all of the ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match only the  speci-
                                                        fied   include  paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide   the  include
                                                        paths    using    JSON
                                                        Pointer   syntax.  For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"]  . For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force  (IETF) documen-
                                                        tation JavaScript  Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the All  setting,  but
                                                        not both.

                                                        NOTE:
                                                           Don't  use this op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The parts of the  JSON  to
                                                    match  against  using  the
                                                    MatchPattern  .   If   you
                                                    specify  All , WAF matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What  WAF  should do if it
                                                    fails to completely  parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect  the body as plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection to  the  body
                                                      text string.

                                                    o MATCH  -  Treat  the web
                                                      request as matching  the
                                                      rule  statement. WAF ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request as not  matching
                                                      the rule statement.

                                                    If  you don't provide this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up to  the  first  parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the  entire JSON body, but
                                                    might be  forced  to  stop
                                                    for  reasons  such  as in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any  content  whose   root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following  examples as two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          ComparisonOperator -> (string)
                                             The operator to  use  to  compare
                                             the request part to the size set-
                                             ting.

                                          Size -> (long)
                                             The size, in byte, to compare  to
                                             the   request   part,  after  any
                                             transformations.

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. If you  specify  one  or
                                             more  transformations  in  a rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the request component  identified
                                             by  FieldToMatch  , starting from
                                             the lowest priority setting,  be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations  that  are
                                                    defined  for a rule state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est priority  to  highest,
                                                    before    inspecting   the
                                                    transformed  content.  The
                                                    priorities  don't  need to
                                                    be consecutive,  but  they
                                                    must all be different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                      GeoMatchStatement -> (structure)
                                          A rule statement  used  to  identify
                                          web  requests  based  on  country of
                                          origin.

                                          CountryCodes -> (list)
                                             An array of two-character country
                                             codes,  for example, [ "US", "CN"
                                             ] , from the alpha-2 country  ISO
                                             codes  of  the  ISO 3166 interna-
                                             tional standard.

                                             (string)

                                          ForwardedIPConfig -> (structure)
                                             The configuration for  inspecting
                                             IP  addresses  in  an HTTP header
                                             that you specify, instead of  us-
                                             ing  the  IP  address  that's re-
                                             ported by the web request origin.
                                             Commonly,   this  is  the  X-For-
                                             warded-For (XFF) header, but  you
                                             can specify any header name.

                                             NOTE:
                                                 If the specified header isn't
                                                 present in the  request,  WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             HeaderName -> (string)
                                                 The name of the  HTTP  header
                                                 to  use  for  the IP address.
                                                 For  example,  to   use   the
                                                 X-Forwarded-For (XFF) header,
                                                 set this to X-Forwarded-For .

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't  present  in the re-
                                                    quest, WAF  doesn't  apply
                                                    the  rule  to  the web re-
                                                    quest at all.

                                             FallbackBehavior -> (string)
                                                 The match status to assign to
                                                 the  web  request  if the re-
                                                 quest doesn't have a valid IP
                                                 address  in the specified po-
                                                 sition.

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't  present  in the re-
                                                    quest, WAF  doesn't  apply
                                                    the  rule  to  the web re-
                                                    quest at all.

                                                 You can specify the following
                                                 fallback behaviors:

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                      RuleGroupReferenceStatement  ->  (struc-
                                      ture)
                                          A  rule  statement  used  to run the
                                          rules that are defined in  a   Rule-
                                          Group  .  To use this, create a rule
                                          group with your rules, then  provide
                                          the  ARN  of  the rule group in this
                                          statement.

                                          You cannot  nest  a  RuleGroupRefer-
                                          enceStatement  , for example for use
                                          inside a NotStatement or OrStatement
                                          . You can only use a rule group ref-
                                          erence statement at  the  top  level
                                          inside a web ACL.

                                          ARN -> (string)
                                             The Amazon Resource Name (ARN) of
                                             the entity.

                                          ExcludedRules -> (list)
                                             The rules in the referenced  rule
                                             group  whose  actions  are set to
                                             Count . When you exclude a  rule,
                                             WAF  evaluates  it  exactly as it
                                             would if the rule action  setting
                                             were Count . This is a useful op-
                                             tion for testing the rules  in  a
                                             rule  group without modifying how
                                             they handle your web traffic.

                                             (structure)
                                                 Specifies a single rule in  a
                                                 rule  group  whose action you
                                                 want to override to  Count  .
                                                 When  you exclude a rule, WAF
                                                 evaluates it  exactly  as  it
                                                 would if the rule action set-
                                                 ting were Count . This  is  a
                                                 useful option for testing the
                                                 rules in a rule group without
                                                 modifying   how  they  handle
                                                 your web traffic.

                                                 Name -> (string)
                                                    The name of the rule whose
                                                    action  you  want to over-
                                                    ride to Count .

                                      IPSetReferenceStatement -> (structure)
                                          A rule statement used to detect  web
                                          requests  coming  from particular IP
                                          addresses or address ranges. To  use
                                          this,  create  an  IPSet that speci-
                                          fies the addresses you want  to  de-
                                          tect,  then  use the ARN of that set
                                          in this statement. To create  an  IP
                                          set, see  CreateIPSet .

                                          Each  IP  set  rule statement refer-
                                          ences an  IP  set.  You  create  and
                                          maintain the set independent of your
                                          rules. This allows you  to  use  the
                                          single  set  in multiple rules. When
                                          you update the referenced  set,  WAF
                                          automatically updates all rules that
                                          reference it.

                                          ARN -> (string)
                                             The Amazon Resource Name (ARN) of
                                             the   IPSet  that  this statement
                                             references.

                                          IPSetForwardedIPConfig  ->   (struc-
                                          ture)
                                             The  configuration for inspecting
                                             IP addresses in  an  HTTP  header
                                             that  you specify, instead of us-
                                             ing the  IP  address  that's  re-
                                             ported by the web request origin.
                                             Commonly,  this  is  the   X-For-
                                             warded-For  (XFF) header, but you
                                             can specify any header name.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             HeaderName -> (string)
                                                 The  name  of the HTTP header
                                                 to use for  the  IP  address.
                                                 For   example,   to  use  the
                                                 X-Forwarded-For (XFF) header,
                                                 set this to X-Forwarded-For .

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't present in  the  re-
                                                    quest,  WAF  doesn't apply
                                                    the rule to  the  web  re-
                                                    quest at all.

                                             FallbackBehavior -> (string)
                                                 The match status to assign to
                                                 the web request  if  the  re-
                                                 quest doesn't have a valid IP
                                                 address in the specified  po-
                                                 sition.

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't present in  the  re-
                                                    quest,  WAF  doesn't apply
                                                    the rule to  the  web  re-
                                                    quest at all.

                                                 You can specify the following
                                                 fallback behaviors:

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                             Position -> (string)
                                                 The position in the header to
                                                 search for  the  IP  address.
                                                 The header can contain IP ad-
                                                 dresses   of   the   original
                                                 client  and  also of proxies.
                                                 For example, the header value
                                                 could be 10.1.1.1, 127.0.0.0,
                                                 10.10.10.10 where  the  first
                                                 IP   address  identifies  the
                                                 original client and the  rest
                                                 identify proxies that the re-
                                                 quest went through.

                                                 The options for this  setting
                                                 are the following:

                                                 o FIRST  -  Inspect the first
                                                   IP address in the  list  of
                                                   IP addresses in the header.
                                                   This   is    usually    the
                                                   client's original IP.

                                                 o LAST  - Inspect the last IP
                                                   address in the list  of  IP
                                                   addresses in the header.

                                                 o ANY  -  Inspect  all IP ad-
                                                   dresses in the header for a
                                                   match.  If  the header con-
                                                   tains more than 10  IP  ad-
                                                   dresses,  WAF  inspects the
                                                   last 10.

                                      RegexPatternSetReferenceStatement     ->
                                      (structure)
                                          A  rule statement used to search web
                                          request components for matches  with
                                          regular  expressions.  To  use this,
                                          create a  RegexPatternSet that spec-
                                          ifies  the expressions that you want
                                          to detect, then use the ARN of  that
                                          set in this statement. A web request
                                          matches the pattern set rule  state-
                                          ment   if   the   request  component
                                          matches any of the patterns  in  the
                                          set.  To create a regex pattern set,
                                          see  CreateRegexPatternSet .

                                          Each regex pattern set  rule  state-
                                          ment references a regex pattern set.
                                          You create and maintain the set  in-
                                          dependent of your rules. This allows
                                          you to use the single set in  multi-
                                          ple  rules. When you update the ref-
                                          erenced set, WAF  automatically  up-
                                          dates all rules that reference it.

                                          ARN -> (string)
                                             The Amazon Resource Name (ARN) of
                                             the   RegexPatternSet  that  this
                                             statement references.

                                          FieldToMatch -> (structure)
                                             The  part  of  a web request that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide the name of  the  header
                                                 to   inspect,   for  example,
                                                 User-Agent or Referer .  This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The  name  of  the   query
                                                    header to inspect.

                                             SingleQueryArgument   ->  (struc-
                                             ture)
                                                 Inspect a single query  argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such  as UserName or SalesRe-
                                                 gion . The name can be up  to
                                                 30  characters long and isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF  to   inspect,   in   the
                                                 FieldToMatch specification.

                                                 Example   JSON:  "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The  name of the query ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest that identifies  a  re-
                                                 source,   for  example,  /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect  the  query   string.
                                                 This  is  the  part  of a URL
                                                 that appears after a ?  char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect  the  request body as
                                                 plain text. The request  body
                                                 immediately  follows  the re-
                                                 quest headers.  This  is  the
                                                 part  of  a request that con-
                                                 tains  any  additional   data
                                                 that you want to send to your
                                                 web server as  the  HTTP  re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect the HTTP method.  The
                                                 method  indicates the type of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect  the  request body as
                                                 JSON. The request body  imme-
                                                 diately  follows  the request
                                                 headers. This is the part  of
                                                 a  request  that contains any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the HTTP request  body,  such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The  patterns  to look for
                                                    in the JSON body. WAF  in-
                                                    spects   the   results  of
                                                    these   pattern    matches
                                                    against  the  rule inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match all of the  ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match  only the speci-
                                                        fied  include   paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide  the   include
                                                        paths    using    JSON
                                                        Pointer  syntax.   For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"] .  For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force (IETF)  documen-
                                                        tation  JavaScript Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the  All  setting, but
                                                        not both.

                                                        NOTE:
                                                           Don't use this  op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The  parts  of the JSON to
                                                    match  against  using  the
                                                    MatchPattern   .   If  you
                                                    specify All , WAF  matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What WAF should do  if  it
                                                    fails  to completely parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect the body as  plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection  to  the body
                                                      text string.

                                                    o MATCH -  Treat  the  web
                                                      request  as matching the
                                                      rule statement. WAF  ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request  as not matching
                                                      the rule statement.

                                                    If you don't provide  this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up  to  the  first parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the entire JSON body,  but
                                                    might  be  forced  to stop
                                                    for reasons  such  as  in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any   content  whose  root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following examples as  two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.  If  you  specify one or
                                             more transformations  in  a  rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the  request component identified
                                             by FieldToMatch ,  starting  from
                                             the  lowest priority setting, be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web requests in an effort  to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing  order  for   multiple
                                                    transformations  that  are
                                                    defined for a rule  state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est  priority  to highest,
                                                    before   inspecting    the
                                                    transformed  content.  The
                                                    priorities don't  need  to
                                                    be  consecutive,  but they
                                                    must all be different.

                                                 Type -> (string)
                                                    You can specify  the  fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a    Base64   -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode  a  Base64 -en-
                                                        coded string, but  use
                                                        a  forgiving implemen-
                                                        tation  that   ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE    -     Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness of  attackers
                                                        who  inject an operat-
                                                        ing    system     com-
                                                        mand-line  command and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following characters:  /
                                                      (

                                                    o Replace   the  following
                                                      characters with a space:
                                                      , ;

                                                    o Replace  multiple spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters  (A-Z) to lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace  these charac-
                                                        ters  with   a   space
                                                        character     (decimal
                                                        32):

                                                    o \f ,  formfeed,  decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE  -   Decode
                                                        characters  that  were
                                                        encoded using CSS  2.x
                                                        escape    rules   syn-
                                                        data.html#characters .
                                                        This  function uses up
                                                        to two  bytes  in  the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII  characters that
                                                        were encoded using CSS
                                                        encoding  that wouldnt
                                                        typically be  encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of  a  backslash   and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript  for java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI  C   escape   se-
                                                        quences:  \a , \b , \f
                                                        , \n , \r , \t , \v  ,
                                                        \\  ,  \?  , \' , \" ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO  (octal). Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE  - Decode a
                                                        string of  hexadecimal
                                                        characters  into a bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters with  unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs  these opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;    with     a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with  a "less than" sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal  format, (amper-
                                                      sand)#xhhhh; , with  the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal    format,   (amper-
                                                      sand)#nnnn; ,  with  the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript escape  se-
                                                        quences.  If  a  \   u
                                                        HHHH code  is  in  the
                                                        full-width  ASCII code
                                                        range of  FF01-FF5E  ,
                                                        then  the  higher byte
                                                        is used to detect  and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte  is  used and the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE  -   Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash from the data  in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you  don't  want   any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are not at the  begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This  is  the  same as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash  characters   to
                                                        forward slashes.

                                                        REMOVE_NULLS  - Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place each  occurrence
                                                        of  a  C-style comment
                                                        (/* ... */  )  with  a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments  are also re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a standalone  termina-
                                                        tion  of a comment (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS  -   Re-
                                                        place  NULL  bytes  in
                                                        the input  with  space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE  - Decode a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI -  Like
                                                        URL_DECODE  , but with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in    the   full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and  adjust  the lower
                                                        byte. Otherwise,  only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter  sequences to Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives  and false-nega-
                                                        tives for  non-English
                                                        languages.

                                      RateBasedStatement -> (structure)
                                          A rate-based rule tracks the rate of
                                          requests for each originating IP ad-
                                          dress,  and triggers the rule action
                                          when the rate exceeds a  limit  that
                                          you  specify  on  the  number of re-
                                          quests in any  5-minute  time  span.
                                          You  can use this to put a temporary
                                          block on requests from an IP address
                                          that is sending excessive requests.

                                          WAF  tracks and manages web requests
                                          separately for each  instance  of  a
                                          rate-based  rule  that  you use. For
                                          example, if  you  provide  the  same
                                          rate-based  rule settings in two web
                                          ACLs, each of the  two  rule  state-
                                          ments represents a separate instance
                                          of the rate-based rule and gets  its
                                          own  tracking and management by WAF.
                                          If you define a rate-based rule  in-
                                          side a rule group, and then use that
                                          rule group in multiple places,  each
                                          use  creates  a separate instance of
                                          the rate-based rule  that  gets  its
                                          own tracking and management by WAF.

                                          When  the  rule action triggers, WAF
                                          blocks additional requests from  the
                                          IP  address  until  the request rate
                                          falls below the limit.

                                          You  can  optionally  nest   another
                                          statement   inside   the  rate-based
                                          statement, to narrow  the  scope  of
                                          the  rule so that it only counts re-
                                          quests that match the nested  state-
                                          ment.  For  example, based on recent
                                          requests that you have seen from  an
                                          attacker,   you   might   create   a
                                          rate-based rule with  a  nested  AND
                                          rule  statement  that  contains  the
                                          following nested statements:

                                          o An IP match statement with  an  IP
                                            set  that  specified  the  address
                                            192.0.2.44.

                                          o A  string  match  statement   that
                                            searches  in the User-Agent header
                                            for the string BadBot.

                                          In this rate-based  rule,  you  also
                                          define  a rate limit. For this exam-
                                          ple, the rate limit  is  1,000.  Re-
                                          quests  that meet both of the condi-
                                          tions in the statements are counted.
                                          If  the count exceeds 1,000 requests
                                          per five minutes,  the  rule  action
                                          triggers.  Requests that do not meet
                                          both conditions are not counted  to-
                                          wards the rate limit and are not af-
                                          fected by this rule.

                                          You cannot nest a RateBasedStatement
                                          inside  another statement, for exam-
                                          ple   inside   a   NotStatement   or
                                          OrStatement . You can define a Rate-
                                          BasedStatement inside a web ACL  and
                                          inside a rule group.

                                          Limit -> (long)
                                             The   limit   on   requests   per
                                             5-minute  period  for  a   single
                                             originating  IP  address.  If the
                                             statement includes  a  ScopeDown-
                                             Statement , this limit is applied
                                             only to the requests  that  match
                                             the statement.

                                          AggregateKeyType -> (string)
                                             Setting that indicates how to ag-
                                             gregate the request  counts.  The
                                             options are the following:

                                             o IP   -  Aggregate  the  request
                                               counts on the IP  address  from
                                               the web request origin.

                                             o FORWARDED_IP  -  Aggregate  the
                                               request counts on the first  IP
                                               address  in  an HTTP header. If
                                               you  use  this,  configure  the
                                               ForwardedIPConfig  , to specify
                                               the header to use.

                                          ( ... recursive ... )ForwardedIPCon-
                                          fig -> (structure)
                                             The  configuration for inspecting
                                             IP addresses in  an  HTTP  header
                                             that  you specify, instead of us-
                                             ing the  IP  address  that's  re-
                                             ported by the web request origin.
                                             Commonly,  this  is  the   X-For-
                                             warded-For  (XFF) header, but you
                                             can specify any header name.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             This is required if AggregateKey-
                                             Type is set to FORWARDED_IP .

                                             HeaderName -> (string)
                                                 The name of the  HTTP  header
                                                 to  use  for  the IP address.
                                                 For  example,  to   use   the
                                                 X-Forwarded-For (XFF) header,
                                                 set this to X-Forwarded-For .

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't  present  in the re-
                                                    quest, WAF  doesn't  apply
                                                    the  rule  to  the web re-
                                                    quest at all.

                                             FallbackBehavior -> (string)
                                                 The match status to assign to
                                                 the  web  request  if the re-
                                                 quest doesn't have a valid IP
                                                 address  in the specified po-
                                                 sition.

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't  present  in the re-
                                                    quest, WAF  doesn't  apply
                                                    the  rule  to  the web re-
                                                    quest at all.

                                                 You can specify the following
                                                 fallback behaviors:

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                      AndStatement -> (structure)
                                          A logical  rule  statement  used  to
                                          combine  other  rule statements with
                                          AND logic. You provide more than one
                                          Statement within the AndStatement .

                                          Statements -> (list)
                                             The  statements  to  combine with
                                             AND logic. You can use any state-
                                             ments that can be nested.

                                             ( ... recursive ... )

                                      OrStatement -> (structure)
                                          A  logical  rule  statement  used to
                                          combine other rule  statements  with
                                          OR  logic. You provide more than one
                                          Statement within the OrStatement .

                                          Statements -> (list)
                                             The statements to combine with OR
                                             logic. You can use any statements
                                             that can be nested.

                                             ( ... recursive ... )

                                      NotStatement -> (structure)
                                          A logical  rule  statement  used  to
                                          negate  the  results of another rule
                                          statement. You provide  one   State-
                                          ment within the NotStatement .

                                          ( ... recursive ... )

                                      ManagedRuleGroupStatement -> (structure)
                                          A  rule  statement  used  to run the
                                          rules that are defined in a  managed
                                          rule group. To use this, provide the
                                          vendor name and the name of the rule
                                          group in this statement. You can re-
                                          trieve the required names by calling
                                          ListAvailableManagedRuleGroups .

                                          You  cannot nest a ManagedRuleGroup-
                                          Statement , for example for use  in-
                                          side a NotStatement or OrStatement .
                                          It  can  only  be  referenced  as  a
                                          top-level statement within a rule.

                                          VendorName -> (string)
                                             The  name  of  the  managed  rule
                                             group vendor. You use this, along
                                             with  the  rule  group  name,  to
                                             identify the rule group.

                                          Name -> (string)
                                             The  name  of  the  managed  rule
                                             group.  You  use this, along with
                                             the vendor name, to identify  the
                                             rule group.

                                          Version -> (string)
                                             The  version  of the managed rule
                                             group  to  use.  If  you  specify
                                             this,   the  version  setting  is
                                             fixed until you change it. If you
                                             don't  specify this, WAF uses the
                                             vendor's  default  version,   and
                                             then  keeps  the  version  at the
                                             vendor's default when the  vendor
                                             updates  the  managed  rule group
                                             settings.

                                          ExcludedRules -> (list)
                                             The rules in the referenced  rule
                                             group  whose  actions  are set to
                                             Count . When you exclude a  rule,
                                             WAF  evaluates  it  exactly as it
                                             would if the rule action  setting
                                             were Count . This is a useful op-
                                             tion for testing the rules  in  a
                                             rule  group without modifying how
                                             they handle your web traffic.

                                             (structure)
                                                 Specifies a single rule in  a
                                                 rule  group  whose action you
                                                 want to override to  Count  .
                                                 When  you exclude a rule, WAF
                                                 evaluates it  exactly  as  it
                                                 would if the rule action set-
                                                 ting were Count . This  is  a
                                                 useful option for testing the
                                                 rules in a rule group without
                                                 modifying   how  they  handle
                                                 your web traffic.

                                                 Name -> (string)
                                                    The name of the rule whose
                                                    action  you  want to over-
                                                    ride to Count .

                                          ( ... recursive ... )

                                      LabelMatchStatement -> (structure)
                                          A  rule  statement  that  defines  a
                                          string  match  search against labels
                                          that have been added to the web  re-
                                          quest by rules that have already run
                                          in the web ACL.

                                          The label match  statement  provides
                                          the  label  or  namespace  string to
                                          search for.  The  label  string  can
                                          represent a part or all of the fully
                                          qualified label name that  had  been
                                          added  to  the  web  request.  Fully
                                          qualified labels have a prefix,  op-
                                          tional  namespaces,  and label name.
                                          The prefix identifies the rule group
                                          or  web ACL context of the rule that
                                          added the label. If you do not  pro-
                                          vide  the  fully  qualified  name in
                                          your label match  string,  WAF  per-
                                          forms  the  search  for  labels that
                                          were added in the  same  context  as
                                          the label match statement.

                                          Scope -> (string)
                                             Specify whether you want to match
                                             using the label name or just  the
                                             namespace.

                                          Key -> (string)
                                             The  string to match against. The
                                             setting you provide for this  de-
                                             pends  on  the  match statement's
                                             Scope setting:

                                             o If the Scope indicates LABEL  ,
                                               then  this  specification  must
                                               include the name  and  can  in-
                                               clude  any  number of preceding
                                               namespace  specifications   and
                                               prefix   up  to  providing  the
                                               fully qualified label name.

                                             o If the  Scope  indicates  NAME-
                                               SPACE , then this specification
                                               can include any number of  con-
                                               tiguous  namespace strings, and
                                               can include  the  entire  label
                                               namespace  prefix from the rule
                                               group or web ACL where the  la-
                                               bel originates.

                                             Labels  are  case  sensitive  and
                                             components of  a  label  must  be
                                             separated  by  colon, for example
                                             NS1:NS2:name .

                                      RegexMatchStatement -> (structure)
                                          A rule statement used to search  web
                                          request   components   for  a  match
                                          against a single regular expression.

                                          RegexString -> (string)
                                             The string representing the regu-
                                             lar expression.

                                          FieldToMatch -> (structure)
                                             The  part  of  a web request that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide the name of  the  header
                                                 to   inspect,   for  example,
                                                 User-Agent or Referer .  This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The  name  of  the   query
                                                    header to inspect.

                                             SingleQueryArgument   ->  (struc-
                                             ture)
                                                 Inspect a single query  argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such  as UserName or SalesRe-
                                                 gion . The name can be up  to
                                                 30  characters long and isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF  to   inspect,   in   the
                                                 FieldToMatch specification.

                                                 Example   JSON:  "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The  name of the query ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest that identifies  a  re-
                                                 source,   for  example,  /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect  the  query   string.
                                                 This  is  the  part  of a URL
                                                 that appears after a ?  char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect  the  request body as
                                                 plain text. The request  body
                                                 immediately  follows  the re-
                                                 quest headers.  This  is  the
                                                 part  of  a request that con-
                                                 tains  any  additional   data
                                                 that you want to send to your
                                                 web server as  the  HTTP  re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect the HTTP method.  The
                                                 method  indicates the type of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect  the  request body as
                                                 JSON. The request body  imme-
                                                 diately  follows  the request
                                                 headers. This is the part  of
                                                 a  request  that contains any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the HTTP request  body,  such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The  patterns  to look for
                                                    in the JSON body. WAF  in-
                                                    spects   the   results  of
                                                    these   pattern    matches
                                                    against  the  rule inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match all of the  ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match  only the speci-
                                                        fied  include   paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide  the   include
                                                        paths    using    JSON
                                                        Pointer  syntax.   For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"] .  For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force (IETF)  documen-
                                                        tation  JavaScript Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the  All  setting, but
                                                        not both.

                                                        NOTE:
                                                           Don't use this  op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The  parts  of the JSON to
                                                    match  against  using  the
                                                    MatchPattern   .   If  you
                                                    specify All , WAF  matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What WAF should do  if  it
                                                    fails  to completely parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect the body as  plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection  to  the body
                                                      text string.

                                                    o MATCH -  Treat  the  web
                                                      request  as matching the
                                                      rule statement. WAF  ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request  as not matching
                                                      the rule statement.

                                                    If you don't provide  this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up  to  the  first parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the entire JSON body,  but
                                                    might  be  forced  to stop
                                                    for reasons  such  as  in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any   content  whose  root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following examples as  two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.  If  you  specify one or
                                             more transformations  in  a  rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the  request component identified
                                             by FieldToMatch ,  starting  from
                                             the  lowest priority setting, be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web requests in an effort  to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing  order  for   multiple
                                                    transformations  that  are
                                                    defined for a rule  state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est  priority  to highest,
                                                    before   inspecting    the
                                                    transformed  content.  The
                                                    priorities don't  need  to
                                                    be  consecutive,  but they
                                                    must all be different.

                                                 Type -> (string)
                                                    You can specify  the  fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a    Base64   -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode  a  Base64 -en-
                                                        coded string, but  use
                                                        a  forgiving implemen-
                                                        tation  that   ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE    -     Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness of  attackers
                                                        who  inject an operat-
                                                        ing    system     com-
                                                        mand-line  command and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following characters:  /
                                                      (

                                                    o Replace   the  following
                                                      characters with a space:
                                                      , ;

                                                    o Replace  multiple spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters  (A-Z) to lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace  these charac-
                                                        ters  with   a   space
                                                        character     (decimal
                                                        32):

                                                    o \f ,  formfeed,  decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE  -   Decode
                                                        characters  that  were
                                                        encoded using CSS  2.x
                                                        escape    rules   syn-
                                                        data.html#characters .
                                                        This  function uses up
                                                        to two  bytes  in  the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII  characters that
                                                        were encoded using CSS
                                                        encoding  that wouldnt
                                                        typically be  encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of  a  backslash   and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript  for java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI  C   escape   se-
                                                        quences:  \a , \b , \f
                                                        , \n , \r , \t , \v  ,
                                                        \\  ,  \?  , \' , \" ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO  (octal). Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE  - Decode a
                                                        string of  hexadecimal
                                                        characters  into a bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters with  unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs  these opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;    with     a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with  a "less than" sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal  format, (amper-
                                                      sand)#xhhhh; , with  the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal    format,   (amper-
                                                      sand)#nnnn; ,  with  the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript escape  se-
                                                        quences.  If  a  \   u
                                                        HHHH code  is  in  the
                                                        full-width  ASCII code
                                                        range of  FF01-FF5E  ,
                                                        then  the  higher byte
                                                        is used to detect  and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte  is  used and the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE  -   Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash from the data  in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you  don't  want   any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are not at the  begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This  is  the  same as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash  characters   to
                                                        forward slashes.

                                                        REMOVE_NULLS  - Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place each  occurrence
                                                        of  a  C-style comment
                                                        (/* ... */  )  with  a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments  are also re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a standalone  termina-
                                                        tion  of a comment (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS  -   Re-
                                                        place  NULL  bytes  in
                                                        the input  with  space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE  - Decode a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI -  Like
                                                        URL_DECODE  , but with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in    the   full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and  adjust  the lower
                                                        byte. Otherwise,  only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter  sequences to Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives  and false-nega-
                                                        tives for  non-English
                                                        languages.

                            OrStatement -> (structure)
                               A  logical rule statement used to combine other
                               rule statements with OR logic. You provide more
                               than one  Statement within the OrStatement .

                               Statements -> (list)
                                   The  statements  to  combine with OR logic.
                                   You can use  any  statements  that  can  be
                                   nested.

                                   (structure)
                                      The  processing  guidance  for a  Rule ,
                                      used by WAF to determine whether  a  web
                                      request matches the rule.

                                      ByteMatchStatement -> (structure)
                                          A  rule  statement  that  defines  a
                                          string match search for WAF to apply
                                          to  web  requests.  The  byte  match
                                          statement  provides  the  bytes   to
                                          search for, the location in requests
                                          that you want  WAF  to  search,  and
                                          other  settings. The bytes to search
                                          for are typically a string that cor-
                                          responds  with  ASCII characters. In
                                          the WAF console  and  the  developer
                                          guide,  this  is  refered  to  as  a
                                          string match statement.

                                          SearchString -> (blob)
                                             A string value that you want  WAF
                                             to  search for. WAF searches only
                                             in the part of web requests  that
                                             you  designate  for inspection in
                                             FieldToMatch . The maximum length
                                             of the value is 50 bytes.

                                             Valid values depend on the compo-
                                             nent that you specify for inspec-
                                             tion in FieldToMatch :

                                             o Method  :  The HTTP method that
                                               you want  WAF  to  search  for.
                                               This  indicates the type of op-
                                               eration specified  in  the  re-
                                               quest.

                                             o UriPath  :  The  value that you
                                               want WAF to search for  in  the
                                               URI  path,  for  example,  /im-
                                               ages/daily-ad.jpg .

                                             If SearchString  includes  alpha-
                                             betic  characters  A-Z  and  a-z,
                                             note that the value is case  sen-
                                             sitive.
                                                 If you're using the WAF API

                                             Specify  a base64-encoded version
                                             of the value. The maximum  length
                                             of    the    value   before   you
                                             base64-encode it is 50 bytes.

                                             For example, suppose the value of
                                             Type  is  HEADER and the value of
                                             Data is User-Agent . If you  want
                                             to  search  the User-Agent header
                                             for  the  value  BadBot   ,   you
                                             base64-encode  BadBot  using MIME
                                             base64-encoding and  include  the
                                             resulting  value,  QmFkQm90  , in
                                             the value of SearchString .
                                                 If you're using  the  CLI  or
                                                 one  of  the  Amazon Web Ser-
                                                 vices SDKs

                                             The value that you  want  WAF  to
                                             search for. The SDK automatically
                                             base64 encodes the value.

                                          FieldToMatch -> (structure)
                                             The part of a  web  request  that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide  the  name of the header
                                                 to  inspect,   for   example,
                                                 User-Agent  or Referer . This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The   name  of  the  query
                                                    header to inspect.

                                             SingleQueryArgument  ->   (struc-
                                             ture)
                                                 Inspect  a single query argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such as UserName or  SalesRe-
                                                 gion  . The name can be up to
                                                 30 characters long and  isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF   to   inspect,   in  the
                                                 FieldToMatch specification.

                                                 Example  JSON:   "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The name of the query  ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest  that  identifies a re-
                                                 source,  for  example,   /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect   the  query  string.
                                                 This is the  part  of  a  URL
                                                 that  appears after a ? char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect the request  body  as
                                                 plain  text. The request body
                                                 immediately follows  the  re-
                                                 quest  headers.  This  is the
                                                 part of a request  that  con-
                                                 tains   any  additional  data
                                                 that you want to send to your
                                                 web  server  as  the HTTP re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect  the HTTP method. The
                                                 method indicates the type  of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect the request  body  as
                                                 JSON.  The request body imme-
                                                 diately follows  the  request
                                                 headers.  This is the part of
                                                 a request that  contains  any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the  HTTP  request body, such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The patterns to  look  for
                                                    in  the JSON body. WAF in-
                                                    spects  the   results   of
                                                    these    pattern   matches
                                                    against the  rule  inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match  all of the ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match only the  speci-
                                                        fied   include  paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide   the  include
                                                        paths    using    JSON
                                                        Pointer   syntax.  For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"]  . For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force  (IETF) documen-
                                                        tation JavaScript  Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the All  setting,  but
                                                        not both.

                                                        NOTE:
                                                           Don't  use this op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The parts of the  JSON  to
                                                    match  against  using  the
                                                    MatchPattern  .   If   you
                                                    specify  All , WAF matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What  WAF  should do if it
                                                    fails to completely  parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect  the body as plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection to  the  body
                                                      text string.

                                                    o MATCH  -  Treat  the web
                                                      request as matching  the
                                                      rule  statement. WAF ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request as not  matching
                                                      the rule statement.

                                                    If  you don't provide this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up to  the  first  parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the  entire JSON body, but
                                                    might be  forced  to  stop
                                                    for  reasons  such  as in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any  content  whose   root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following  examples as two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. If you  specify  one  or
                                             more  transformations  in  a rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the request component  identified
                                             by  FieldToMatch  , starting from
                                             the lowest priority setting,  be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations  that  are
                                                    defined  for a rule state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est priority  to  highest,
                                                    before    inspecting   the
                                                    transformed  content.  The
                                                    priorities  don't  need to
                                                    be consecutive,  but  they
                                                    must all be different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                          PositionalConstraint -> (string)
                                             The area within the portion of  a
                                             web  request that you want WAF to
                                             search for SearchString  .  Valid
                                             values include the following:
                                                 CONTAINS

                                             The specified part of the web re-
                                             quest must include the  value  of
                                             SearchString  ,  but the location
                                             doesn't matter.
                                                 CONTAINS_WORD

                                             The specified part of the web re-
                                             quest  must  include the value of
                                             SearchString ,  and  SearchString
                                             must  contain  only  alphanumeric
                                             characters  or  underscore  (A-Z,
                                             a-z,  0-9,  or  _).  In addition,
                                             SearchString  must  be  a   word,
                                             which means that both of the fol-
                                             lowing are true:

                                             o SearchString is at  the  begin-
                                               ning  of  the specified part of
                                               the web request or is  preceded
                                               by  a  character  other than an
                                               alphanumeric character  or  un-
                                               derscore  (_). Examples include
                                               the value of a header and ;Bad-
                                               Bot .

                                             o SearchString  is  at the end of
                                               the specified part of  the  web
                                               request  or  is  followed  by a
                                               character  other  than  an  al-
                                               phanumeric  character or under-
                                               score (_), for example, BadBot;
                                               and -BadBot; .
                                                 EXACTLY

                                             The  value  of the specified part
                                             of the web request  must  exactly
                                             match the value of SearchString .
                                                 STARTS_WITH

                                             The  value  of  SearchString must
                                             appear at the  beginning  of  the
                                             specified  part  of  the  web re-
                                             quest.
                                                 ENDS_WITH

                                             The value  of  SearchString  must
                                             appear  at  the end of the speci-
                                             fied part of the web request.

                                      SqliMatchStatement -> (structure)
                                          Attackers sometimes insert malicious
                                          SQL code into web requests in an ef-
                                          fort to extract data from your data-
                                          base. To allow or block web requests
                                          that appear to contain malicious SQL
                                          code,  create one or more SQL injec-
                                          tion match conditions. An SQL injec-
                                          tion  match condition identifies the
                                          part of web requests,  such  as  the
                                          URI  or  the  query string, that you
                                          want WAF to inspect.  Later  in  the
                                          process,  when you create a web ACL,
                                          you  specify  whether  to  allow  or
                                          block  requests  that appear to con-
                                          tain malicious SQL code.

                                          FieldToMatch -> (structure)
                                             The part of a  web  request  that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide  the  name of the header
                                                 to  inspect,   for   example,
                                                 User-Agent  or Referer . This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The   name  of  the  query
                                                    header to inspect.

                                             SingleQueryArgument  ->   (struc-
                                             ture)
                                                 Inspect  a single query argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such as UserName or  SalesRe-
                                                 gion  . The name can be up to
                                                 30 characters long and  isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF   to   inspect,   in  the
                                                 FieldToMatch specification.

                                                 Example  JSON:   "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The name of the query  ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest  that  identifies a re-
                                                 source,  for  example,   /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect   the  query  string.
                                                 This is the  part  of  a  URL
                                                 that  appears after a ? char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect the request  body  as
                                                 plain  text. The request body
                                                 immediately follows  the  re-
                                                 quest  headers.  This  is the
                                                 part of a request  that  con-
                                                 tains   any  additional  data
                                                 that you want to send to your
                                                 web  server  as  the HTTP re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect  the HTTP method. The
                                                 method indicates the type  of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect the request  body  as
                                                 JSON.  The request body imme-
                                                 diately follows  the  request
                                                 headers.  This is the part of
                                                 a request that  contains  any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the  HTTP  request body, such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The patterns to  look  for
                                                    in  the JSON body. WAF in-
                                                    spects  the   results   of
                                                    these    pattern   matches
                                                    against the  rule  inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match  all of the ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match only the  speci-
                                                        fied   include  paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide   the  include
                                                        paths    using    JSON
                                                        Pointer   syntax.  For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"]  . For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force  (IETF) documen-
                                                        tation JavaScript  Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the All  setting,  but
                                                        not both.

                                                        NOTE:
                                                           Don't  use this op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The parts of the  JSON  to
                                                    match  against  using  the
                                                    MatchPattern  .   If   you
                                                    specify  All , WAF matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What  WAF  should do if it
                                                    fails to completely  parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect  the body as plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection to  the  body
                                                      text string.

                                                    o MATCH  -  Treat  the web
                                                      request as matching  the
                                                      rule  statement. WAF ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request as not  matching
                                                      the rule statement.

                                                    If  you don't provide this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up to  the  first  parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the  entire JSON body, but
                                                    might be  forced  to  stop
                                                    for  reasons  such  as in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any  content  whose   root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following  examples as two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. If you  specify  one  or
                                             more  transformations  in  a rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the request component  identified
                                             by  FieldToMatch  , starting from
                                             the lowest priority setting,  be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations  that  are
                                                    defined  for a rule state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est priority  to  highest,
                                                    before    inspecting   the
                                                    transformed  content.  The
                                                    priorities  don't  need to
                                                    be consecutive,  but  they
                                                    must all be different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                      XssMatchStatement -> (structure)
                                          A  rule  statement  that  defines  a
                                          cross-site   scripting  (XSS)  match
                                          search for WAF to apply to  web  re-
                                          quests.  XSS attacks are those where
                                          the attacker uses vulnerabilities in
                                          a benign website as a vehicle to in-
                                          ject malicious  client-site  scripts
                                          into  other legitimate web browsers.
                                          The XSS match statement provides the
                                          location  in  requests that you want
                                          WAF to search and  text  transforma-
                                          tions  to use on the search area be-
                                          fore WAF searches for character  se-
                                          quences  that are likely to be mali-
                                          cious strings.

                                          FieldToMatch -> (structure)
                                             The part of a  web  request  that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide  the  name of the header
                                                 to  inspect,   for   example,
                                                 User-Agent  or Referer . This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The   name  of  the  query
                                                    header to inspect.

                                             SingleQueryArgument  ->   (struc-
                                             ture)
                                                 Inspect  a single query argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such as UserName or  SalesRe-
                                                 gion  . The name can be up to
                                                 30 characters long and  isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF   to   inspect,   in  the
                                                 FieldToMatch specification.

                                                 Example  JSON:   "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The name of the query  ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest  that  identifies a re-
                                                 source,  for  example,   /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect   the  query  string.
                                                 This is the  part  of  a  URL
                                                 that  appears after a ? char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect the request  body  as
                                                 plain  text. The request body
                                                 immediately follows  the  re-
                                                 quest  headers.  This  is the
                                                 part of a request  that  con-
                                                 tains   any  additional  data
                                                 that you want to send to your
                                                 web  server  as  the HTTP re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect  the HTTP method. The
                                                 method indicates the type  of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect the request  body  as
                                                 JSON.  The request body imme-
                                                 diately follows  the  request
                                                 headers.  This is the part of
                                                 a request that  contains  any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the  HTTP  request body, such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The patterns to  look  for
                                                    in  the JSON body. WAF in-
                                                    spects  the   results   of
                                                    these    pattern   matches
                                                    against the  rule  inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match  all of the ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match only the  speci-
                                                        fied   include  paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide   the  include
                                                        paths    using    JSON
                                                        Pointer   syntax.  For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"]  . For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force  (IETF) documen-
                                                        tation JavaScript  Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the All  setting,  but
                                                        not both.

                                                        NOTE:
                                                           Don't  use this op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The parts of the  JSON  to
                                                    match  against  using  the
                                                    MatchPattern  .   If   you
                                                    specify  All , WAF matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What  WAF  should do if it
                                                    fails to completely  parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect  the body as plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection to  the  body
                                                      text string.

                                                    o MATCH  -  Treat  the web
                                                      request as matching  the
                                                      rule  statement. WAF ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request as not  matching
                                                      the rule statement.

                                                    If  you don't provide this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up to  the  first  parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the  entire JSON body, but
                                                    might be  forced  to  stop
                                                    for  reasons  such  as in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any  content  whose   root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following  examples as two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. If you  specify  one  or
                                             more  transformations  in  a rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the request component  identified
                                             by  FieldToMatch  , starting from
                                             the lowest priority setting,  be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations  that  are
                                                    defined  for a rule state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est priority  to  highest,
                                                    before    inspecting   the
                                                    transformed  content.  The
                                                    priorities  don't  need to
                                                    be consecutive,  but  they
                                                    must all be different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                      SizeConstraintStatement -> (structure)
                                          A rule  statement  that  compares  a
                                          number  of bytes against the size of
                                          a request component, using a compar-
                                          ison  operator, such as greater than
                                          (>) or less than (<).  For  example,
                                          you can use a size constraint state-
                                          ment to look for query strings  that
                                          are longer than 100 bytes.

                                          If  you configure WAF to inspect the
                                          request body, WAF inspects only  the
                                          first  8192 bytes (8 KB). If the re-
                                          quest body  for  your  web  requests
                                          never  exceeds  8192  bytes, you can
                                          create a size  constraint  condition
                                          and  block  requests that have a re-
                                          quest body greater than 8192 bytes.

                                          If you choose URI for the  value  of
                                          Part  of  the  request to filter on,
                                          the slash (/) in the URI  counts  as
                                          one  character. For example, the URI
                                          /logo.jpg is nine characters long.

                                          FieldToMatch -> (structure)
                                             The part of a  web  request  that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide  the  name of the header
                                                 to  inspect,   for   example,
                                                 User-Agent  or Referer . This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The   name  of  the  query
                                                    header to inspect.

                                             SingleQueryArgument  ->   (struc-
                                             ture)
                                                 Inspect  a single query argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such as UserName or  SalesRe-
                                                 gion  . The name can be up to
                                                 30 characters long and  isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF   to   inspect,   in  the
                                                 FieldToMatch specification.

                                                 Example  JSON:   "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The name of the query  ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest  that  identifies a re-
                                                 source,  for  example,   /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect   the  query  string.
                                                 This is the  part  of  a  URL
                                                 that  appears after a ? char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect the request  body  as
                                                 plain  text. The request body
                                                 immediately follows  the  re-
                                                 quest  headers.  This  is the
                                                 part of a request  that  con-
                                                 tains   any  additional  data
                                                 that you want to send to your
                                                 web  server  as  the HTTP re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect  the HTTP method. The
                                                 method indicates the type  of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect the request  body  as
                                                 JSON.  The request body imme-
                                                 diately follows  the  request
                                                 headers.  This is the part of
                                                 a request that  contains  any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the  HTTP  request body, such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The patterns to  look  for
                                                    in  the JSON body. WAF in-
                                                    spects  the   results   of
                                                    these    pattern   matches
                                                    against the  rule  inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match  all of the ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match only the  speci-
                                                        fied   include  paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide   the  include
                                                        paths    using    JSON
                                                        Pointer   syntax.  For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"]  . For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force  (IETF) documen-
                                                        tation JavaScript  Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the All  setting,  but
                                                        not both.

                                                        NOTE:
                                                           Don't  use this op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The parts of the  JSON  to
                                                    match  against  using  the
                                                    MatchPattern  .   If   you
                                                    specify  All , WAF matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What  WAF  should do if it
                                                    fails to completely  parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect  the body as plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection to  the  body
                                                      text string.

                                                    o MATCH  -  Treat  the web
                                                      request as matching  the
                                                      rule  statement. WAF ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request as not  matching
                                                      the rule statement.

                                                    If  you don't provide this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up to  the  first  parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the  entire JSON body, but
                                                    might be  forced  to  stop
                                                    for  reasons  such  as in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any  content  whose   root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following  examples as two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          ComparisonOperator -> (string)
                                             The operator to  use  to  compare
                                             the request part to the size set-
                                             ting.

                                          Size -> (long)
                                             The size, in byte, to compare  to
                                             the   request   part,  after  any
                                             transformations.

                                          TextTransformations -> (list)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection. If you  specify  one  or
                                             more  transformations  in  a rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the request component  identified
                                             by  FieldToMatch  , starting from
                                             the lowest priority setting,  be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web  requests in an effort to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing   order  for  multiple
                                                    transformations  that  are
                                                    defined  for a rule state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est priority  to  highest,
                                                    before    inspecting   the
                                                    transformed  content.  The
                                                    priorities  don't  need to
                                                    be consecutive,  but  they
                                                    must all be different.

                                                 Type -> (string)
                                                    You  can  specify the fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a   Base64    -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode a  Base64  -en-
                                                        coded  string, but use
                                                        a forgiving  implemen-
                                                        tation   that  ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE     -    Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness  of attackers
                                                        who inject an  operat-
                                                        ing     system    com-
                                                        mand-line command  and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following  characters: /
                                                      (

                                                    o Replace  the   following
                                                      characters with a space:
                                                      , ;

                                                    o Replace multiple  spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters (A-Z) to  lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace these  charac-
                                                        ters   with   a  space
                                                        character     (decimal
                                                        32):

                                                    o \f  ,  formfeed, decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE   -  Decode
                                                        characters  that  were
                                                        encoded  using CSS 2.x
                                                        escape   rules    syn-
                                                        data.html#characters .
                                                        This function uses  up
                                                        to  two  bytes  in the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII characters  that
                                                        were encoded using CSS
                                                        encoding that  wouldnt
                                                        typically  be encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of   a  backslash  and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript for  java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI   C   escape  se-
                                                        quences: \a , \b ,  \f
                                                        ,  \n , \r , \t , \v ,
                                                        \\ , \? , \'  ,  \"  ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO (octal).  Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE - Decode  a
                                                        string  of hexadecimal
                                                        characters into a  bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters  with unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs these  opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;     with    a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with a "less than"  sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal format,  (amper-
                                                      sand)#xhhhh;  , with the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal   format,    (amper-
                                                      sand)#nnnn;  ,  with the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript  escape se-
                                                        quences.  If  a  \   u
                                                        HHHH  code  is  in the
                                                        full-width ASCII  code
                                                        range  of  FF01-FF5E ,
                                                        then the  higher  byte
                                                        is  used to detect and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte is used  and  the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE   -  Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash  from the data in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you   don't  want  any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are  not at the begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This is  the  same  as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash   characters  to
                                                        forward slashes.

                                                        REMOVE_NULLS -  Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place  each occurrence
                                                        of a  C-style  comment
                                                        (/*  ...  */  ) with a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments are also  re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a  standalone termina-
                                                        tion of a comment  (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS   -  Re-
                                                        place  NULL  bytes  in
                                                        the  input  with space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE - Decode  a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI  - Like
                                                        URL_DECODE , but  with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in   the    full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and adjust  the  lower
                                                        byte.  Otherwise, only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter sequences to  Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives and  false-nega-
                                                        tives  for non-English
                                                        languages.

                                      GeoMatchStatement -> (structure)
                                          A rule statement  used  to  identify
                                          web  requests  based  on  country of
                                          origin.

                                          CountryCodes -> (list)
                                             An array of two-character country
                                             codes,  for example, [ "US", "CN"
                                             ] , from the alpha-2 country  ISO
                                             codes  of  the  ISO 3166 interna-
                                             tional standard.

                                             (string)

                                          ForwardedIPConfig -> (structure)
                                             The configuration for  inspecting
                                             IP  addresses  in  an HTTP header
                                             that you specify, instead of  us-
                                             ing  the  IP  address  that's re-
                                             ported by the web request origin.
                                             Commonly,   this  is  the  X-For-
                                             warded-For (XFF) header, but  you
                                             can specify any header name.

                                             NOTE:
                                                 If the specified header isn't
                                                 present in the  request,  WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             HeaderName -> (string)
                                                 The name of the  HTTP  header
                                                 to  use  for  the IP address.
                                                 For  example,  to   use   the
                                                 X-Forwarded-For (XFF) header,
                                                 set this to X-Forwarded-For .

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't  present  in the re-
                                                    quest, WAF  doesn't  apply
                                                    the  rule  to  the web re-
                                                    quest at all.

                                             FallbackBehavior -> (string)
                                                 The match status to assign to
                                                 the  web  request  if the re-
                                                 quest doesn't have a valid IP
                                                 address  in the specified po-
                                                 sition.

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't  present  in the re-
                                                    quest, WAF  doesn't  apply
                                                    the  rule  to  the web re-
                                                    quest at all.

                                                 You can specify the following
                                                 fallback behaviors:

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                      RuleGroupReferenceStatement  ->  (struc-
                                      ture)
                                          A  rule  statement  used  to run the
                                          rules that are defined in  a   Rule-
                                          Group  .  To use this, create a rule
                                          group with your rules, then  provide
                                          the  ARN  of  the rule group in this
                                          statement.

                                          You cannot  nest  a  RuleGroupRefer-
                                          enceStatement  , for example for use
                                          inside a NotStatement or OrStatement
                                          . You can only use a rule group ref-
                                          erence statement at  the  top  level
                                          inside a web ACL.

                                          ARN -> (string)
                                             The Amazon Resource Name (ARN) of
                                             the entity.

                                          ExcludedRules -> (list)
                                             The rules in the referenced  rule
                                             group  whose  actions  are set to
                                             Count . When you exclude a  rule,
                                             WAF  evaluates  it  exactly as it
                                             would if the rule action  setting
                                             were Count . This is a useful op-
                                             tion for testing the rules  in  a
                                             rule  group without modifying how
                                             they handle your web traffic.

                                             (structure)
                                                 Specifies a single rule in  a
                                                 rule  group  whose action you
                                                 want to override to  Count  .
                                                 When  you exclude a rule, WAF
                                                 evaluates it  exactly  as  it
                                                 would if the rule action set-
                                                 ting were Count . This  is  a
                                                 useful option for testing the
                                                 rules in a rule group without
                                                 modifying   how  they  handle
                                                 your web traffic.

                                                 Name -> (string)
                                                    The name of the rule whose
                                                    action  you  want to over-
                                                    ride to Count .

                                      IPSetReferenceStatement -> (structure)
                                          A rule statement used to detect  web
                                          requests  coming  from particular IP
                                          addresses or address ranges. To  use
                                          this,  create  an  IPSet that speci-
                                          fies the addresses you want  to  de-
                                          tect,  then  use the ARN of that set
                                          in this statement. To create  an  IP
                                          set, see  CreateIPSet .

                                          Each  IP  set  rule statement refer-
                                          ences an  IP  set.  You  create  and
                                          maintain the set independent of your
                                          rules. This allows you  to  use  the
                                          single  set  in multiple rules. When
                                          you update the referenced  set,  WAF
                                          automatically updates all rules that
                                          reference it.

                                          ARN -> (string)
                                             The Amazon Resource Name (ARN) of
                                             the   IPSet  that  this statement
                                             references.

                                          IPSetForwardedIPConfig  ->   (struc-
                                          ture)
                                             The  configuration for inspecting
                                             IP addresses in  an  HTTP  header
                                             that  you specify, instead of us-
                                             ing the  IP  address  that's  re-
                                             ported by the web request origin.
                                             Commonly,  this  is  the   X-For-
                                             warded-For  (XFF) header, but you
                                             can specify any header name.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             HeaderName -> (string)
                                                 The  name  of the HTTP header
                                                 to use for  the  IP  address.
                                                 For   example,   to  use  the
                                                 X-Forwarded-For (XFF) header,
                                                 set this to X-Forwarded-For .

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't present in  the  re-
                                                    quest,  WAF  doesn't apply
                                                    the rule to  the  web  re-
                                                    quest at all.

                                             FallbackBehavior -> (string)
                                                 The match status to assign to
                                                 the web request  if  the  re-
                                                 quest doesn't have a valid IP
                                                 address in the specified  po-
                                                 sition.

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't present in  the  re-
                                                    quest,  WAF  doesn't apply
                                                    the rule to  the  web  re-
                                                    quest at all.

                                                 You can specify the following
                                                 fallback behaviors:

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                             Position -> (string)
                                                 The position in the header to
                                                 search for  the  IP  address.
                                                 The header can contain IP ad-
                                                 dresses   of   the   original
                                                 client  and  also of proxies.
                                                 For example, the header value
                                                 could be 10.1.1.1, 127.0.0.0,
                                                 10.10.10.10 where  the  first
                                                 IP   address  identifies  the
                                                 original client and the  rest
                                                 identify proxies that the re-
                                                 quest went through.

                                                 The options for this  setting
                                                 are the following:

                                                 o FIRST  -  Inspect the first
                                                   IP address in the  list  of
                                                   IP addresses in the header.
                                                   This   is    usually    the
                                                   client's original IP.

                                                 o LAST  - Inspect the last IP
                                                   address in the list  of  IP
                                                   addresses in the header.

                                                 o ANY  -  Inspect  all IP ad-
                                                   dresses in the header for a
                                                   match.  If  the header con-
                                                   tains more than 10  IP  ad-
                                                   dresses,  WAF  inspects the
                                                   last 10.

                                      RegexPatternSetReferenceStatement     ->
                                      (structure)
                                          A  rule statement used to search web
                                          request components for matches  with
                                          regular  expressions.  To  use this,
                                          create a  RegexPatternSet that spec-
                                          ifies  the expressions that you want
                                          to detect, then use the ARN of  that
                                          set in this statement. A web request
                                          matches the pattern set rule  state-
                                          ment   if   the   request  component
                                          matches any of the patterns  in  the
                                          set.  To create a regex pattern set,
                                          see  CreateRegexPatternSet .

                                          Each regex pattern set  rule  state-
                                          ment references a regex pattern set.
                                          You create and maintain the set  in-
                                          dependent of your rules. This allows
                                          you to use the single set in  multi-
                                          ple  rules. When you update the ref-
                                          erenced set, WAF  automatically  up-
                                          dates all rules that reference it.

                                          ARN -> (string)
                                             The Amazon Resource Name (ARN) of
                                             the   RegexPatternSet  that  this
                                             statement references.

                                          FieldToMatch -> (structure)
                                             The  part  of  a web request that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide the name of  the  header
                                                 to   inspect,   for  example,
                                                 User-Agent or Referer .  This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The  name  of  the   query
                                                    header to inspect.

                                             SingleQueryArgument   ->  (struc-
                                             ture)
                                                 Inspect a single query  argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such  as UserName or SalesRe-
                                                 gion . The name can be up  to
                                                 30  characters long and isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF  to   inspect,   in   the
                                                 FieldToMatch specification.

                                                 Example   JSON:  "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The  name of the query ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest that identifies  a  re-
                                                 source,   for  example,  /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect  the  query   string.
                                                 This  is  the  part  of a URL
                                                 that appears after a ?  char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect  the  request body as
                                                 plain text. The request  body
                                                 immediately  follows  the re-
                                                 quest headers.  This  is  the
                                                 part  of  a request that con-
                                                 tains  any  additional   data
                                                 that you want to send to your
                                                 web server as  the  HTTP  re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect the HTTP method.  The
                                                 method  indicates the type of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect  the  request body as
                                                 JSON. The request body  imme-
                                                 diately  follows  the request
                                                 headers. This is the part  of
                                                 a  request  that contains any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the HTTP request  body,  such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The  patterns  to look for
                                                    in the JSON body. WAF  in-
                                                    spects   the   results  of
                                                    these   pattern    matches
                                                    against  the  rule inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match all of the  ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match  only the speci-
                                                        fied  include   paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide  the   include
                                                        paths    using    JSON
                                                        Pointer  syntax.   For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"] .  For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force (IETF)  documen-
                                                        tation  JavaScript Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the  All  setting, but
                                                        not both.

                                                        NOTE:
                                                           Don't use this  op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The  parts  of the JSON to
                                                    match  against  using  the
                                                    MatchPattern   .   If  you
                                                    specify All , WAF  matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What WAF should do  if  it
                                                    fails  to completely parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect the body as  plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection  to  the body
                                                      text string.

                                                    o MATCH -  Treat  the  web
                                                      request  as matching the
                                                      rule statement. WAF  ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request  as not matching
                                                      the rule statement.

                                                    If you don't provide  this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up  to  the  first parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the entire JSON body,  but
                                                    might  be  forced  to stop
                                                    for reasons  such  as  in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any   content  whose  root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following examples as  two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.  If  you  specify one or
                                             more transformations  in  a  rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the  request component identified
                                             by FieldToMatch ,  starting  from
                                             the  lowest priority setting, be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web requests in an effort  to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing  order  for   multiple
                                                    transformations  that  are
                                                    defined for a rule  state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est  priority  to highest,
                                                    before   inspecting    the
                                                    transformed  content.  The
                                                    priorities don't  need  to
                                                    be  consecutive,  but they
                                                    must all be different.

                                                 Type -> (string)
                                                    You can specify  the  fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a    Base64   -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode  a  Base64 -en-
                                                        coded string, but  use
                                                        a  forgiving implemen-
                                                        tation  that   ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE    -     Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness of  attackers
                                                        who  inject an operat-
                                                        ing    system     com-
                                                        mand-line  command and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following characters:  /
                                                      (

                                                    o Replace   the  following
                                                      characters with a space:
                                                      , ;

                                                    o Replace  multiple spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters  (A-Z) to lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace  these charac-
                                                        ters  with   a   space
                                                        character     (decimal
                                                        32):

                                                    o \f ,  formfeed,  decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE  -   Decode
                                                        characters  that  were
                                                        encoded using CSS  2.x
                                                        escape    rules   syn-
                                                        data.html#characters .
                                                        This  function uses up
                                                        to two  bytes  in  the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII  characters that
                                                        were encoded using CSS
                                                        encoding  that wouldnt
                                                        typically be  encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of  a  backslash   and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript  for java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI  C   escape   se-
                                                        quences:  \a , \b , \f
                                                        , \n , \r , \t , \v  ,
                                                        \\  ,  \?  , \' , \" ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO  (octal). Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE  - Decode a
                                                        string of  hexadecimal
                                                        characters  into a bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters with  unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs  these opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;    with     a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with  a "less than" sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal  format, (amper-
                                                      sand)#xhhhh; , with  the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal    format,   (amper-
                                                      sand)#nnnn; ,  with  the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript escape  se-
                                                        quences.  If  a  \   u
                                                        HHHH code  is  in  the
                                                        full-width  ASCII code
                                                        range of  FF01-FF5E  ,
                                                        then  the  higher byte
                                                        is used to detect  and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte  is  used and the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE  -   Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash from the data  in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you  don't  want   any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are not at the  begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This  is  the  same as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash  characters   to
                                                        forward slashes.

                                                        REMOVE_NULLS  - Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place each  occurrence
                                                        of  a  C-style comment
                                                        (/* ... */  )  with  a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments  are also re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a standalone  termina-
                                                        tion  of a comment (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS  -   Re-
                                                        place  NULL  bytes  in
                                                        the input  with  space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE  - Decode a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI -  Like
                                                        URL_DECODE  , but with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in    the   full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and  adjust  the lower
                                                        byte. Otherwise,  only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter  sequences to Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives  and false-nega-
                                                        tives for  non-English
                                                        languages.

                                      RateBasedStatement -> (structure)
                                          A rate-based rule tracks the rate of
                                          requests for each originating IP ad-
                                          dress,  and triggers the rule action
                                          when the rate exceeds a  limit  that
                                          you  specify  on  the  number of re-
                                          quests in any  5-minute  time  span.
                                          You  can use this to put a temporary
                                          block on requests from an IP address
                                          that is sending excessive requests.

                                          WAF  tracks and manages web requests
                                          separately for each  instance  of  a
                                          rate-based  rule  that  you use. For
                                          example, if  you  provide  the  same
                                          rate-based  rule settings in two web
                                          ACLs, each of the  two  rule  state-
                                          ments represents a separate instance
                                          of the rate-based rule and gets  its
                                          own  tracking and management by WAF.
                                          If you define a rate-based rule  in-
                                          side a rule group, and then use that
                                          rule group in multiple places,  each
                                          use  creates  a separate instance of
                                          the rate-based rule  that  gets  its
                                          own tracking and management by WAF.

                                          When  the  rule action triggers, WAF
                                          blocks additional requests from  the
                                          IP  address  until  the request rate
                                          falls below the limit.

                                          You  can  optionally  nest   another
                                          statement   inside   the  rate-based
                                          statement, to narrow  the  scope  of
                                          the  rule so that it only counts re-
                                          quests that match the nested  state-
                                          ment.  For  example, based on recent
                                          requests that you have seen from  an
                                          attacker,   you   might   create   a
                                          rate-based rule with  a  nested  AND
                                          rule  statement  that  contains  the
                                          following nested statements:

                                          o An IP match statement with  an  IP
                                            set  that  specified  the  address
                                            192.0.2.44.

                                          o A  string  match  statement   that
                                            searches  in the User-Agent header
                                            for the string BadBot.

                                          In this rate-based  rule,  you  also
                                          define  a rate limit. For this exam-
                                          ple, the rate limit  is  1,000.  Re-
                                          quests  that meet both of the condi-
                                          tions in the statements are counted.
                                          If  the count exceeds 1,000 requests
                                          per five minutes,  the  rule  action
                                          triggers.  Requests that do not meet
                                          both conditions are not counted  to-
                                          wards the rate limit and are not af-
                                          fected by this rule.

                                          You cannot nest a RateBasedStatement
                                          inside  another statement, for exam-
                                          ple   inside   a   NotStatement   or
                                          OrStatement . You can define a Rate-
                                          BasedStatement inside a web ACL  and
                                          inside a rule group.

                                          Limit -> (long)
                                             The   limit   on   requests   per
                                             5-minute  period  for  a   single
                                             originating  IP  address.  If the
                                             statement includes  a  ScopeDown-
                                             Statement , this limit is applied
                                             only to the requests  that  match
                                             the statement.

                                          AggregateKeyType -> (string)
                                             Setting that indicates how to ag-
                                             gregate the request  counts.  The
                                             options are the following:

                                             o IP   -  Aggregate  the  request
                                               counts on the IP  address  from
                                               the web request origin.

                                             o FORWARDED_IP  -  Aggregate  the
                                               request counts on the first  IP
                                               address  in  an HTTP header. If
                                               you  use  this,  configure  the
                                               ForwardedIPConfig  , to specify
                                               the header to use.

                                          ( ... recursive ... )ForwardedIPCon-
                                          fig -> (structure)
                                             The  configuration for inspecting
                                             IP addresses in  an  HTTP  header
                                             that  you specify, instead of us-
                                             ing the  IP  address  that's  re-
                                             ported by the web request origin.
                                             Commonly,  this  is  the   X-For-
                                             warded-For  (XFF) header, but you
                                             can specify any header name.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             This is required if AggregateKey-
                                             Type is set to FORWARDED_IP .

                                             HeaderName -> (string)
                                                 The name of the  HTTP  header
                                                 to  use  for  the IP address.
                                                 For  example,  to   use   the
                                                 X-Forwarded-For (XFF) header,
                                                 set this to X-Forwarded-For .

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't  present  in the re-
                                                    quest, WAF  doesn't  apply
                                                    the  rule  to  the web re-
                                                    quest at all.

                                             FallbackBehavior -> (string)
                                                 The match status to assign to
                                                 the  web  request  if the re-
                                                 quest doesn't have a valid IP
                                                 address  in the specified po-
                                                 sition.

                                                 NOTE:
                                                    If  the  specified  header
                                                    isn't  present  in the re-
                                                    quest, WAF  doesn't  apply
                                                    the  rule  to  the web re-
                                                    quest at all.

                                                 You can specify the following
                                                 fallback behaviors:

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                      AndStatement -> (structure)
                                          A logical  rule  statement  used  to
                                          combine  other  rule statements with
                                          AND logic. You provide more than one
                                          Statement within the AndStatement .

                                          Statements -> (list)
                                             The  statements  to  combine with
                                             AND logic. You can use any state-
                                             ments that can be nested.

                                             ( ... recursive ... )

                                      OrStatement -> (structure)
                                          A  logical  rule  statement  used to
                                          combine other rule  statements  with
                                          OR  logic. You provide more than one
                                          Statement within the OrStatement .

                                          Statements -> (list)
                                             The statements to combine with OR
                                             logic. You can use any statements
                                             that can be nested.

                                             ( ... recursive ... )

                                      NotStatement -> (structure)
                                          A logical  rule  statement  used  to
                                          negate  the  results of another rule
                                          statement. You provide  one   State-
                                          ment within the NotStatement .

                                          ( ... recursive ... )

                                      ManagedRuleGroupStatement -> (structure)
                                          A  rule  statement  used  to run the
                                          rules that are defined in a  managed
                                          rule group. To use this, provide the
                                          vendor name and the name of the rule
                                          group in this statement. You can re-
                                          trieve the required names by calling
                                          ListAvailableManagedRuleGroups .

                                          You  cannot nest a ManagedRuleGroup-
                                          Statement , for example for use  in-
                                          side a NotStatement or OrStatement .
                                          It  can  only  be  referenced  as  a
                                          top-level statement within a rule.

                                          VendorName -> (string)
                                             The  name  of  the  managed  rule
                                             group vendor. You use this, along
                                             with  the  rule  group  name,  to
                                             identify the rule group.

                                          Name -> (string)
                                             The  name  of  the  managed  rule
                                             group.  You  use this, along with
                                             the vendor name, to identify  the
                                             rule group.

                                          Version -> (string)
                                             The  version  of the managed rule
                                             group  to  use.  If  you  specify
                                             this,   the  version  setting  is
                                             fixed until you change it. If you
                                             don't  specify this, WAF uses the
                                             vendor's  default  version,   and
                                             then  keeps  the  version  at the
                                             vendor's default when the  vendor
                                             updates  the  managed  rule group
                                             settings.

                                          ExcludedRules -> (list)
                                             The rules in the referenced  rule
                                             group  whose  actions  are set to
                                             Count . When you exclude a  rule,
                                             WAF  evaluates  it  exactly as it
                                             would if the rule action  setting
                                             were Count . This is a useful op-
                                             tion for testing the rules  in  a
                                             rule  group without modifying how
                                             they handle your web traffic.

                                             (structure)
                                                 Specifies a single rule in  a
                                                 rule  group  whose action you
                                                 want to override to  Count  .
                                                 When  you exclude a rule, WAF
                                                 evaluates it  exactly  as  it
                                                 would if the rule action set-
                                                 ting were Count . This  is  a
                                                 useful option for testing the
                                                 rules in a rule group without
                                                 modifying   how  they  handle
                                                 your web traffic.

                                                 Name -> (string)
                                                    The name of the rule whose
                                                    action  you  want to over-
                                                    ride to Count .

                                          ( ... recursive ... )

                                      LabelMatchStatement -> (structure)
                                          A  rule  statement  that  defines  a
                                          string  match  search against labels
                                          that have been added to the web  re-
                                          quest by rules that have already run
                                          in the web ACL.

                                          The label match  statement  provides
                                          the  label  or  namespace  string to
                                          search for.  The  label  string  can
                                          represent a part or all of the fully
                                          qualified label name that  had  been
                                          added  to  the  web  request.  Fully
                                          qualified labels have a prefix,  op-
                                          tional  namespaces,  and label name.
                                          The prefix identifies the rule group
                                          or  web ACL context of the rule that
                                          added the label. If you do not  pro-
                                          vide  the  fully  qualified  name in
                                          your label match  string,  WAF  per-
                                          forms  the  search  for  labels that
                                          were added in the  same  context  as
                                          the label match statement.

                                          Scope -> (string)
                                             Specify whether you want to match
                                             using the label name or just  the
                                             namespace.

                                          Key -> (string)
                                             The  string to match against. The
                                             setting you provide for this  de-
                                             pends  on  the  match statement's
                                             Scope setting:

                                             o If the Scope indicates LABEL  ,
                                               then  this  specification  must
                                               include the name  and  can  in-
                                               clude  any  number of preceding
                                               namespace  specifications   and
                                               prefix   up  to  providing  the
                                               fully qualified label name.

                                             o If the  Scope  indicates  NAME-
                                               SPACE , then this specification
                                               can include any number of  con-
                                               tiguous  namespace strings, and
                                               can include  the  entire  label
                                               namespace  prefix from the rule
                                               group or web ACL where the  la-
                                               bel originates.

                                             Labels  are  case  sensitive  and
                                             components of  a  label  must  be
                                             separated  by  colon, for example
                                             NS1:NS2:name .

                                      RegexMatchStatement -> (structure)
                                          A rule statement used to search  web
                                          request   components   for  a  match
                                          against a single regular expression.

                                          RegexString -> (string)
                                             The string representing the regu-
                                             lar expression.

                                          FieldToMatch -> (structure)
                                             The  part  of  a web request that
                                             you want WAF to inspect. For more
                                             information, see  FieldToMatch .

                                             SingleHeader -> (structure)
                                                 Inspect a single header. Pro-
                                                 vide the name of  the  header
                                                 to   inspect,   for  example,
                                                 User-Agent or Referer .  This
                                                 setting isn't case sensitive.

                                                 Example JSON: "SingleHeader":
                                                 { "Name": "haystack" }

                                                 Name -> (string)
                                                    The  name  of  the   query
                                                    header to inspect.

                                             SingleQueryArgument   ->  (struc-
                                             ture)
                                                 Inspect a single query  argu-
                                                 ment. Provide the name of the
                                                 query  argument  to  inspect,
                                                 such  as UserName or SalesRe-
                                                 gion . The name can be up  to
                                                 30  characters long and isn't
                                                 case sensitive.

                                                 This is used only to indicate
                                                 the web request component for
                                                 WAF  to   inspect,   in   the
                                                 FieldToMatch specification.

                                                 Example   JSON:  "SingleQuer-
                                                 yArgument":     {     "Name":
                                                 "myArgument" }

                                                 Name -> (string)
                                                    The  name of the query ar-
                                                    gument to inspect.

                                             AllQueryArguments -> (structure)
                                                 Inspect all query arguments.

                                             UriPath -> (structure)
                                                 Inspect the request URI path.
                                                 This is the part of a web re-
                                                 quest that identifies  a  re-
                                                 source,   for  example,  /im-
                                                 ages/daily-ad.jpg .

                                             QueryString -> (structure)
                                                 Inspect  the  query   string.
                                                 This  is  the  part  of a URL
                                                 that appears after a ?  char-
                                                 acter, if any.

                                             Body -> (structure)
                                                 Inspect  the  request body as
                                                 plain text. The request  body
                                                 immediately  follows  the re-
                                                 quest headers.  This  is  the
                                                 part  of  a request that con-
                                                 tains  any  additional   data
                                                 that you want to send to your
                                                 web server as  the  HTTP  re-
                                                 quest body, such as data from
                                                 a form.

                                                 Note that only the first 8 KB
                                                 (8192  bytes)  of the request
                                                 body are forwarded to WAF for
                                                 inspection  by the underlying
                                                 host service.  If  you  don't
                                                 need  to  inspect more than 8
                                                 KB, you  can  guarantee  that
                                                 you  don't  allow  additional
                                                 bytes  in  by   combining   a
                                                 statement  that  inspects the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement  ,  with a  SizeCon-
                                                 straintStatement   that   en-
                                                 forces  an 8 KB size limit on
                                                 the body of the request.  WAF
                                                 doesn't   support  inspecting
                                                 the entire  contents  of  web
                                                 requests  whose bodies exceed
                                                 the 8 KB limit.

                                             Method -> (structure)
                                                 Inspect the HTTP method.  The
                                                 method  indicates the type of
                                                 operation that the request is
                                                 asking the origin to perform.

                                             JsonBody -> (structure)
                                                 Inspect  the  request body as
                                                 JSON. The request body  imme-
                                                 diately  follows  the request
                                                 headers. This is the part  of
                                                 a  request  that contains any
                                                 additional data that you want
                                                 to send to your web server as
                                                 the HTTP request  body,  such
                                                 as data from a form.

                                                 Note that only the first 8 KB
                                                 (8192 bytes) of  the  request
                                                 body are forwarded to WAF for
                                                 inspection by the  underlying
                                                 host  service.  If  you don't
                                                 need to inspect more  than  8
                                                 KB,  you  can  guarantee that
                                                 you  don't  allow  additional
                                                 bytes   in   by  combining  a
                                                 statement that  inspects  the
                                                 body of the web request, such
                                                 as    ByteMatchStatement   or
                                                 RegexPatternSetReferenceS-
                                                 tatement , with  a   SizeCon-
                                                 straintStatement   that   en-
                                                 forces an 8 KB size limit  on
                                                 the  body of the request. WAF
                                                 doesn't  support   inspecting
                                                 the  entire  contents  of web
                                                 requests whose bodies  exceed
                                                 the 8 KB limit.

                                                 MatchPattern -> (structure)
                                                    The  patterns  to look for
                                                    in the JSON body. WAF  in-
                                                    spects   the   results  of
                                                    these   pattern    matches
                                                    against  the  rule inspec-
                                                    tion criteria.

                                                    All -> (structure)
                                                        Match all of the  ele-
                                                        ments. See also Match-
                                                        Scope in  JsonBody .

                                                        You must  specify  ei-
                                                        ther  this  setting or
                                                        the IncludedPaths set-
                                                        ting, but not both.

                                                    IncludedPaths -> (list)
                                                        Match  only the speci-
                                                        fied  include   paths.
                                                        See also MatchScope in
                                                        JsonBody .

                                                        Provide  the   include
                                                        paths    using    JSON
                                                        Pointer  syntax.   For
                                                        example,    "Included-
                                                        Paths":
                                                        ["/dogs/0/name",
                                                        "/dogs/1/name"] .  For
                                                        information about this
                                                        syntax, see the Inter-
                                                        net  Engineering  Task
                                                        Force (IETF)  documen-
                                                        tation  JavaScript Ob-
                                                        ject  Notation  (JSON)
                                                        Pointer .

                                                        You  must  specify ei-
                                                        ther this  setting  or
                                                        the  All  setting, but
                                                        not both.

                                                        NOTE:
                                                           Don't use this  op-
                                                           tion to include all
                                                           paths. Instead, use
                                                           the All setting.

                                                        (string)

                                                 MatchScope -> (string)
                                                    The  parts  of the JSON to
                                                    match  against  using  the
                                                    MatchPattern   .   If  you
                                                    specify All , WAF  matches
                                                    against keys and values.

                                                 InvalidFallbackBehavior    ->
                                                 (string)
                                                    What WAF should do  if  it
                                                    fails  to completely parse
                                                    the JSON body. The options
                                                    are the following:

                                                    o EVALUATE_AS_STRING - In-
                                                      spect the body as  plain
                                                      text.  WAF  applies  the
                                                      text transformations and
                                                      inspection criteria that
                                                      you defined for the JSON
                                                      inspection  to  the body
                                                      text string.

                                                    o MATCH -  Treat  the  web
                                                      request  as matching the
                                                      rule statement. WAF  ap-
                                                      plies the rule action to
                                                      the request.

                                                    o NO_MATCH - Treat the web
                                                      request  as not matching
                                                      the rule statement.

                                                    If you don't provide  this
                                                    setting,  WAF  parses  and
                                                    evaluates the content only
                                                    up  to  the  first parsing
                                                    failure  that  it  encoun-
                                                    ters.

                                                    WAF does its best to parse
                                                    the entire JSON body,  but
                                                    might  be  forced  to stop
                                                    for reasons  such  as  in-
                                                    valid  characters,  dupli-
                                                    cate keys, truncation, and
                                                    any   content  whose  root
                                                    node isn't an object or an
                                                    array.

                                                    WAF parses the JSON in the
                                                    following examples as  two
                                                    valid key, value pairs:

                                                    o Missing           comma:
                                                      {"key1":"value1""key2":"value2"}

                                                    o Missing           colon:
                                                      {"key1":"value1","key2""value2"}

                                                    o Extra            colons:
                                                      {"key1"::"value1","key2""value2"}

                                          TextTransformations -> (list)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.  If  you  specify one or
                                             more transformations  in  a  rule
                                             statement,   WAF   performs   all
                                             transformations on the content of
                                             the  request component identified
                                             by FieldToMatch ,  starting  from
                                             the  lowest priority setting, be-
                                             fore inspecting the content for a
                                             match.

                                             (structure)
                                                 Text  transformations  elimi-
                                                 nate some of the unusual for-
                                                 matting that attackers use in
                                                 web requests in an effort  to
                                                 bypass detection.

                                                 Priority -> (integer)
                                                    Sets the relative process-
                                                    ing  order  for   multiple
                                                    transformations  that  are
                                                    defined for a rule  state-
                                                    ment.  WAF  processes  all
                                                    transformations, from low-
                                                    est  priority  to highest,
                                                    before   inspecting    the
                                                    transformed  content.  The
                                                    priorities don't  need  to
                                                    be  consecutive,  but they
                                                    must all be different.

                                                 Type -> (string)
                                                    You can specify  the  fol-
                                                    lowing      transformation
                                                    types:
                                                        BASE64_DECODE - Decode
                                                        a    Base64   -encoded
                                                        string.

                                                        BASE64_DECODE_EXT    -
                                                        Decode  a  Base64 -en-
                                                        coded string, but  use
                                                        a  forgiving implemen-
                                                        tation  that   ignores
                                                        characters that aren't
                                                        valid.

                                                        CMD_LINE    -     Com-
                                                        mand-line  transforma-
                                                        tions. These are help-
                                                        ful in reducing effec-
                                                        tiveness of  attackers
                                                        who  inject an operat-
                                                        ing    system     com-
                                                        mand-line  command and
                                                        use unusual formatting
                                                        to  disguise  some  or
                                                        all of the command.

                                                    o Delete   the   following
                                                      characters: \ " ' ^

                                                    o Delete spaces before the
                                                      following characters:  /
                                                      (

                                                    o Replace   the  following
                                                      characters with a space:
                                                      , ;

                                                    o Replace  multiple spaces
                                                      with one space

                                                    o Convert  uppercase  let-
                                                      ters  (A-Z) to lowercase
                                                      (a-z)
                                                        COMPRESS_WHITE_SPACE -
                                                        Replace  these charac-
                                                        ters  with   a   space
                                                        character     (decimal
                                                        32):

                                                    o \f ,  formfeed,  decimal
                                                      12

                                                    o \t , tab, decimal 9

                                                    o \n , newline, decimal 10

                                                    o \r  ,  carriage  return,
                                                      decimal 13

                                                    o \v , vertical tab, deci-
                                                      mal 11

                                                    o Non-breaking space, dec-
                                                      imal 160
                                                        COMPRESS_WHITE_SPACE
                                                        also replaces multiple
                                                        spaces with one space.

                                                        CSS_DECODE  -   Decode
                                                        characters  that  were
                                                        encoded using CSS  2.x
                                                        escape    rules   syn-
                                                        data.html#characters .
                                                        This  function uses up
                                                        to two  bytes  in  the
                                                        decoding  process,  so
                                                        it can help to uncover
                                                        ASCII  characters that
                                                        were encoded using CSS
                                                        encoding  that wouldnt
                                                        typically be  encoded.
                                                        It's  also  useful  in
                                                        countering    evasion,
                                                        which is a combination
                                                        of  a  backslash   and
                                                        non-hexadecimal  char-
                                                        acters.  For  example,
                                                        ja\vascript  for java-
                                                        script.

                                                        ESCAPE_SEQ_DECODE    -
                                                        Decode  the  following
                                                        ANSI  C   escape   se-
                                                        quences:  \a , \b , \f
                                                        , \n , \r , \t , \v  ,
                                                        \\  ,  \?  , \' , \" ,
                                                        \xHH    (hexadecimal),
                                                        \0OOO  (octal). Encod-
                                                        ings that aren't valid
                                                        remain in the output.

                                                        HEX_DECODE  - Decode a
                                                        string of  hexadecimal
                                                        characters  into a bi-
                                                        nary.

                                                        HTML_ENTITY_DECODE   -
                                                        Replace   HTML-encoded
                                                        characters with  unen-
                                                        coded      characters.
                                                        HTML_ENTITY_DECODE
                                                        performs  these opera-
                                                        tions:

                                                    o Replaces         (amper-
                                                      sand)quot; with "

                                                    o Replaces         (amper-
                                                      sand)nbsp;    with     a
                                                      non-breaking space, dec-
                                                      imal 160

                                                    o Replaces  (ampersand)lt;
                                                      with  a "less than" sym-
                                                      bol

                                                    o Replaces  (ampersand)gt;
                                                      with >

                                                    o Replaces characters that
                                                      are represented in hexa-
                                                      decimal  format, (amper-
                                                      sand)#xhhhh; , with  the
                                                      corresponding characters

                                                    o Replaces characters that
                                                      are represented in deci-
                                                      mal    format,   (amper-
                                                      sand)#nnnn; ,  with  the
                                                      corresponding characters
                                                        JS_DECODE   -   Decode
                                                        JavaScript escape  se-
                                                        quences.  If  a  \   u
                                                        HHHH code  is  in  the
                                                        full-width  ASCII code
                                                        range of  FF01-FF5E  ,
                                                        then  the  higher byte
                                                        is used to detect  and
                                                        adjust the lower byte.
                                                        If not, only the lower
                                                        byte  is  used and the
                                                        higher byte is zeroed,
                                                        causing   a   possible
                                                        loss of information.

                                                        LOWERCASE  -   Convert
                                                        uppercase      letters
                                                        (A-Z)   to   lowercase
                                                        (a-z).

                                                        MD5 - Calculate an MD5
                                                        hash from the data  in
                                                        the  input.  The  com-
                                                        puted hash is in a raw
                                                        binary form.

                                                        NONE - Specify NONE if
                                                        you  don't  want   any
                                                        text transformations.

                                                        NORMALIZE_PATH  -  Re-
                                                        move multiple slashes,
                                                        directory  self-refer-
                                                        ences,  and  directory
                                                        back-references   that
                                                        are not at the  begin-
                                                        ning of the input from
                                                        an input string.

                                                        NORMALIZE_PATH_WIN   -
                                                        This  is  the  same as
                                                        NORMALIZE_PATH  ,  but
                                                        first  converts  back-
                                                        slash  characters   to
                                                        forward slashes.

                                                        REMOVE_NULLS  - Remove
                                                        all  NULL  bytes  from
                                                        the input.

                                                        REPLACE_COMMENTS - Re-
                                                        place each  occurrence
                                                        of  a  C-style comment
                                                        (/* ... */  )  with  a
                                                        single space. Multiple
                                                        consecutive     occur-
                                                        rences  are  not  com-
                                                        pressed.  Unterminated
                                                        comments  are also re-
                                                        placed  with  a  space
                                                        (ASCII 0x20). However,
                                                        a standalone  termina-
                                                        tion  of a comment (*/
                                                        ) is not acted upon.

                                                        REPLACE_NULLS  -   Re-
                                                        place  NULL  bytes  in
                                                        the input  with  space
                                                        characters (ASCII 0x20
                                                        ).

                                                        SQL_HEX_DECODE  -  De-
                                                        code SQL hex data. Ex-
                                                        ample (0x414243 ) will
                                                        be decoded to (ABC ).

                                                        URL_DECODE  - Decode a
                                                        URL-encoded value.

                                                        URL_DECODE_UNI -  Like
                                                        URL_DECODE  , but with
                                                        support   for   Micro-
                                                        soft-specific  %u  en-
                                                        coding. If the code is
                                                        in    the   full-width
                                                        ASCII  code  range  of
                                                        FF01-FF5E , the higher
                                                        byte is used to detect
                                                        and  adjust  the lower
                                                        byte. Otherwise,  only
                                                        the lower byte is used
                                                        and the higher byte is
                                                        zeroed.

                                                        UTF8_TO_UNICODE - Con-
                                                        vert all UTF-8 charac-
                                                        ter  sequences to Uni-
                                                        code. This helps input
                                                        normalization,     and
                                                        minimizing false-posi-
                                                        tives  and false-nega-
                                                        tives for  non-English
                                                        languages.

                            NotStatement -> (structure)
                               A logical rule statement used to negate the re-
                               sults of another rule  statement.  You  provide
                               one  Statement within the NotStatement .

                               Statement -> (structure)
                                   The  statement  to  negate. You can use any
                                   statement that can be nested.

                                   ByteMatchStatement -> (structure)
                                      A rule statement that defines  a  string
                                      match search for WAF to apply to web re-
                                      quests. The byte  match  statement  pro-
                                      vides the bytes to search for, the loca-
                                      tion in requests that you  want  WAF  to
                                      search, and other settings. The bytes to
                                      search for are typically a  string  that
                                      corresponds  with  ASCII  characters. In
                                      the WAF console and the developer guide,
                                      this  is  refered  to  as a string match
                                      statement.

                                      SearchString -> (blob)
                                          A string value that you want WAF  to
                                          search for. WAF searches only in the
                                          part of web requests that you desig-
                                          nate for inspection in  FieldToMatch
                                          . The maximum length of the value is
                                          50 bytes.

                                          Valid values depend on the component
                                          that you specify for  inspection  in
                                          FieldToMatch :

                                          o Method  : The HTTP method that you
                                            want WAF to search for. This indi-
                                            cates the type of operation speci-
                                            fied in the request.

                                          o UriPath : The value that you  want
                                            WAF to search for in the URI path,
                                            for example,  /images/daily-ad.jpg
                                            .

                                          If  SearchString includes alphabetic
                                          characters A-Z and  a-z,  note  that
                                          the value is case sensitive.
                                             If you're using the WAF API

                                          Specify  a base64-encoded version of
                                          the value. The maximum length of the
                                          value before you base64-encode it is
                                          50 bytes.

                                          For example, suppose  the  value  of
                                          Type is HEADER and the value of Data
                                          is  User-Agent  .  If  you  want  to
                                          search the User-Agent header for the
                                          value  BadBot  ,  you  base64-encode
                                          BadBot  using  MIME  base64-encoding
                                          and include the resulting value, Qm-
                                          FkQm90  ,  in  the  value of Search-
                                          String .
                                             If you're using the CLI or one of
                                             the Amazon Web Services SDKs

                                          The  value  that  you  want  WAF  to
                                          search for.  The  SDK  automatically
                                          base64 encodes the value.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.  If  you
                                          specify  one or more transformations
                                          in a rule  statement,  WAF  performs
                                          all  transformations  on the content
                                          of the request component  identified
                                          by  FieldToMatch , starting from the
                                          lowest priority setting, before  in-
                                          specting the content for a match.

                                          (structure)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets  the relative processing
                                                 order for multiple  transfor-
                                                 mations  that are defined for
                                                 a rule  statement.  WAF  pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive, but they  must  all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE -  Decode  a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a Base64 -encoded  string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE  -   Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness  of attackers who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use unusual formatting  to
                                                    disguise  some  or  all of
                                                    the command.

                                                 o Delete the following  char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with   a  space  character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v  , vertical tab, decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE  - Decode char-
                                                    acters that  were  encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This  function  uses up to
                                                    two bytes in the  decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS encoding that  wouldnt
                                                    typically be encoded. It's
                                                    also useful in  countering
                                                    evasion, which is a combi-
                                                    nation of a backslash  and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript    for   java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the  following  ANSI C es-
                                                    cape sequences: \a , \b  ,
                                                    \f  ,  \n , \r , \t , \v ,
                                                    \\ , \? , \' , \"  ,  \xHH
                                                    (hexadecimal),  \0OOO (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE  -   Decode   a
                                                    string    of   hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters with unencoded  char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with a non-breaking  space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces   characters  that
                                                   are represented in hexadec-
                                                   imal     format,    (amper-
                                                   sand)#xhhhh;  ,  with   the
                                                   corresponding characters

                                                 o Replaces   characters  that
                                                   are represented in  decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with   the    corresponding
                                                   characters
                                                    JS_DECODE  -  Decode Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the full-width ASCII  code
                                                    range  of FF01-FF5E , then
                                                    the higher byte is used to
                                                    detect   and   adjust  the
                                                    lower byte. If  not,  only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash  from the data in the
                                                    input. The  computed  hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH   -  Remove
                                                    multiple  slashes,  direc-
                                                    tory  self-references, and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning of the input from  an
                                                    input string.

                                                    NORMALIZE_PATH_WIN  - This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH  , but first con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS  - Remove all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences   are  not  com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination of a comment  (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS   -  Replace
                                                    NULL bytes  in  the  input
                                                    with    space   characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE  -   Decode
                                                    SQL   hex   data.  Example
                                                    (0x414243 )  will  be  de-
                                                    coded to (ABC ).

                                                    URL_DECODE   -   Decode  a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI   -    Like
                                                    URL_DECODE , but with sup-
                                                    port  for   Microsoft-spe-
                                                    cific  %u encoding. If the
                                                    code is in the  full-width
                                                    ASCII    code   range   of
                                                    FF01-FF5E  ,  the   higher
                                                    byte is used to detect and
                                                    adjust  the  lower   byte.
                                                    Otherwise,  only the lower
                                                    byte  is  used   and   the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE  - Convert
                                                    all  UTF-8  character  se-
                                                    quences  to  Unicode. This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives and  false-negatives
                                                    for non-English languages.

                                      PositionalConstraint -> (string)
                                          The area within the portion of a web
                                          request that you want WAF to  search
                                          for  SearchString . Valid values in-
                                          clude the following:
                                             CONTAINS

                                          The specified part of  the  web  re-
                                          quest  must  include  the  value  of
                                          SearchString  ,  but  the   location
                                          doesn't matter.
                                             CONTAINS_WORD

                                          The  specified  part  of the web re-
                                          quest  must  include  the  value  of
                                          SearchString , and SearchString must
                                          contain only alphanumeric characters
                                          or underscore (A-Z, a-z, 0-9, or _).
                                          In addition, SearchString must be  a
                                          word,  which  means that both of the
                                          following are true:

                                          o SearchString is at  the  beginning
                                            of  the  specified part of the web
                                            request or is preceded by a  char-
                                            acter  other  than an alphanumeric
                                            character or underscore (_). Exam-
                                            ples include the value of a header
                                            and ;BadBot .

                                          o SearchString is at the end of  the
                                            specified  part of the web request
                                            or  is  followed  by  a  character
                                            other than an alphanumeric charac-
                                            ter or underscore (_),  for  exam-
                                            ple, BadBot; and -BadBot; .
                                             EXACTLY

                                          The  value  of the specified part of
                                          the web request must  exactly  match
                                          the value of SearchString .
                                             STARTS_WITH

                                          The  value  of SearchString must ap-
                                          pear at the beginning of the  speci-
                                          fied part of the web request.
                                             ENDS_WITH

                                          The  value  of SearchString must ap-
                                          pear at the  end  of  the  specified
                                          part of the web request.

                                   SqliMatchStatement -> (structure)
                                      Attackers sometimes insert malicious SQL
                                      code into web requests in an  effort  to
                                      extract  data from your database. To al-
                                      low or block web requests that appear to
                                      contain  malicious  SQL code, create one
                                      or more SQL injection match  conditions.
                                      An SQL injection match condition identi-
                                      fies the part of web requests,  such  as
                                      the  URI  or  the query string, that you
                                      want  WAF  to  inspect.  Later  in   the
                                      process,  when you create a web ACL, you
                                      specify whether to allow  or  block  re-
                                      quests  that appear to contain malicious
                                      SQL code.

                                      FieldToMatch -> (structure)
                                          The part of a web request  that  you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect a single header.  Provide
                                             the  name  of  the  header to in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example JSON:  "SingleHeader":  {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The  name of the query header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect a single query  argument.
                                             Provide the name of the query ar-
                                             gument to inspect, such as  User-
                                             Name  or  SalesRegion  . The name
                                             can be up to 30  characters  long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web request component for WAF  to
                                             inspect,   in  the   FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The  name  of the query argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that identifies a  resource,  for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the part of a  URL  that  appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text. The  request  body  immedi-
                                             ately  follows  the request head-
                                             ers. This is the part  of  a  re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to  your  web  server as the HTTP
                                             request body, such as data from a
                                             form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect   the  HTTP  method.  The
                                             method indicates the type of  op-
                                             eration  that the request is ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the  part  of a request that con-
                                             tains any  additional  data  that
                                             you  want  to  send  to  your web
                                             server as the HTTP request  body,
                                             such as data from a form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The  patterns  to look for in
                                                 the JSON body.  WAF  inspects
                                                 the  results of these pattern
                                                 matches against the rule  in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See  also  MatchScope   in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this setting  or  the  In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match only  the  specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide the include  paths
                                                    using JSON Pointer syntax.
                                                    For  example,   "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"] . For  in-
                                                    formation  about this syn-
                                                    tax, see the Internet  En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this  setting  or  the All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't use this  option
                                                        to  include all paths.
                                                        Instead, use  the  All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON body.  The  options  are
                                                 the following:

                                                 o EVALUATE_AS_STRING   -  In-
                                                   spect  the  body  as  plain
                                                   text.  WAF applies the text
                                                   transformations and inspec-
                                                   tion  criteria that you de-
                                                   fined for the JSON  inspec-
                                                   tion   to   the  body  text
                                                   string.

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates  the content only up to
                                                 the  first  parsing   failure
                                                 that it encounters.

                                                 WAF  does  its  best to parse
                                                 the  entire  JSON  body,  but
                                                 might  be  forced to stop for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root  node isn't an object or
                                                 an array.

                                                 WAF parses the  JSON  in  the
                                                 following   examples  as  two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                                   XssMatchStatement -> (structure)
                                      A  rule   statement   that   defines   a
                                      cross-site  scripting (XSS) match search
                                      for WAF to apply to  web  requests.  XSS
                                      attacks  are  those  where  the attacker
                                      uses vulnerabilities in a benign website
                                      as   a   vehicle   to  inject  malicious
                                      client-site scripts into  other  legiti-
                                      mate  web browsers. The XSS match state-
                                      ment provides the location  in  requests
                                      that  you  want  WAF  to search and text
                                      transformations to  use  on  the  search
                                      area  before  WAF searches for character
                                      sequences that are likely  to  be  mali-
                                      cious strings.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.  If  you
                                          specify  one or more transformations
                                          in a rule  statement,  WAF  performs
                                          all  transformations  on the content
                                          of the request component  identified
                                          by  FieldToMatch , starting from the
                                          lowest priority setting, before  in-
                                          specting the content for a match.

                                          (structure)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets  the relative processing
                                                 order for multiple  transfor-
                                                 mations  that are defined for
                                                 a rule  statement.  WAF  pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive, but they  must  all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE -  Decode  a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a Base64 -encoded  string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE  -   Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness  of attackers who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use unusual formatting  to
                                                    disguise  some  or  all of
                                                    the command.

                                                 o Delete the following  char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with   a  space  character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v  , vertical tab, decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE  - Decode char-
                                                    acters that  were  encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This  function  uses up to
                                                    two bytes in the  decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS encoding that  wouldnt
                                                    typically be encoded. It's
                                                    also useful in  countering
                                                    evasion, which is a combi-
                                                    nation of a backslash  and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript    for   java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the  following  ANSI C es-
                                                    cape sequences: \a , \b  ,
                                                    \f  ,  \n , \r , \t , \v ,
                                                    \\ , \? , \' , \"  ,  \xHH
                                                    (hexadecimal),  \0OOO (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE  -   Decode   a
                                                    string    of   hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters with unencoded  char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with a non-breaking  space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces   characters  that
                                                   are represented in hexadec-
                                                   imal     format,    (amper-
                                                   sand)#xhhhh;  ,  with   the
                                                   corresponding characters

                                                 o Replaces   characters  that
                                                   are represented in  decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with   the    corresponding
                                                   characters
                                                    JS_DECODE  -  Decode Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the full-width ASCII  code
                                                    range  of FF01-FF5E , then
                                                    the higher byte is used to
                                                    detect   and   adjust  the
                                                    lower byte. If  not,  only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash  from the data in the
                                                    input. The  computed  hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH   -  Remove
                                                    multiple  slashes,  direc-
                                                    tory  self-references, and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning of the input from  an
                                                    input string.

                                                    NORMALIZE_PATH_WIN  - This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH  , but first con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS  - Remove all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences   are  not  com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination of a comment  (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS   -  Replace
                                                    NULL bytes  in  the  input
                                                    with    space   characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE  -   Decode
                                                    SQL   hex   data.  Example
                                                    (0x414243 )  will  be  de-
                                                    coded to (ABC ).

                                                    URL_DECODE   -   Decode  a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI   -    Like
                                                    URL_DECODE , but with sup-
                                                    port  for   Microsoft-spe-
                                                    cific  %u encoding. If the
                                                    code is in the  full-width
                                                    ASCII    code   range   of
                                                    FF01-FF5E  ,  the   higher
                                                    byte is used to detect and
                                                    adjust  the  lower   byte.
                                                    Otherwise,  only the lower
                                                    byte  is  used   and   the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE  - Convert
                                                    all  UTF-8  character  se-
                                                    quences  to  Unicode. This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives and  false-negatives
                                                    for non-English languages.

                                   SizeConstraintStatement -> (structure)
                                      A  rule statement that compares a number
                                      of bytes against the size of  a  request
                                      component,  using a comparison operator,
                                      such as greater than (>)  or  less  than
                                      (<).  For  example,  you  can use a size
                                      constraint statement to look  for  query
                                      strings that are longer than 100 bytes.

                                      If  you configure WAF to inspect the re-
                                      quest body, WAF inspects only the  first
                                      8192  bytes  (8 KB). If the request body
                                      for your web requests never exceeds 8192
                                      bytes,  you can create a size constraint
                                      condition and block requests that have a
                                      request body greater than 8192 bytes.

                                      If  you choose URI for the value of Part
                                      of the request to filter on,  the  slash
                                      (/)  in the URI counts as one character.
                                      For example, the URI /logo.jpg  is  nine
                                      characters long.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      ComparisonOperator -> (string)
                                          The  operator  to use to compare the
                                          request part to the size setting.

                                      Size -> (long)
                                          The size, in byte, to compare to the
                                          request  part, after any transforma-
                                          tions.

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                                   GeoMatchStatement -> (structure)
                                      A rule statement used  to  identify  web
                                      requests based on country of origin.

                                      CountryCodes -> (list)
                                          An  array  of  two-character country
                                          codes, for example, [ "US", "CN" ] ,
                                          from  the  alpha-2 country ISO codes
                                          of the ISO 3166 international  stan-
                                          dard.

                                          (string)

                                      ForwardedIPConfig -> (structure)
                                          The  configuration for inspecting IP
                                          addresses in an HTTP header that you
                                          specify, instead of using the IP ad-
                                          dress that's reported by the web re-
                                          quest  origin. Commonly, this is the
                                          X-Forwarded-For  (XFF)  header,  but
                                          you can specify any header name.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          HeaderName -> (string)
                                             The name of the  HTTP  header  to
                                             use for the IP address. For exam-
                                             ple, to use  the  X-Forwarded-For
                                             (XFF)  header, set this to X-For-
                                             warded-For .

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                          FallbackBehavior -> (string)
                                             The match status to assign to the
                                             web  request   if   the   request
                                             doesn't  have  a valid IP address
                                             in the specified position.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             You  can  specify  the  following
                                             fallback behaviors:

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                   RuleGroupReferenceStatement -> (structure)
                                      A  rule  statement used to run the rules
                                      that are defined in a   RuleGroup  .  To
                                      use  this, create a rule group with your
                                      rules, then provide the ARN of the  rule
                                      group in this statement.

                                      You  cannot  nest a RuleGroupReferenceS-
                                      tatement , for example for use inside  a
                                      NotStatement  or  OrStatement  . You can
                                      only use a rule group  reference  state-
                                      ment at the top level inside a web ACL.

                                      ARN -> (string)
                                          The  Amazon  Resource  Name (ARN) of
                                          the entity.

                                      ExcludedRules -> (list)
                                          The rules  in  the  referenced  rule
                                          group whose actions are set to Count
                                          . When you exclude a rule, WAF eval-
                                          uates  it exactly as it would if the
                                          rule action  setting  were  Count  .
                                          This  is a useful option for testing
                                          the rules in a  rule  group  without
                                          modifying  how  they handle your web
                                          traffic.

                                          (structure)
                                             Specifies a single rule in a rule
                                             group  whose  action  you want to
                                             override to Count . When you  ex-
                                             clude  a  rule,  WAF evaluates it
                                             exactly as it would if  the  rule
                                             action  setting were Count . This
                                             is a useful  option  for  testing
                                             the rules in a rule group without
                                             modifying how  they  handle  your
                                             web traffic.

                                             Name -> (string)
                                                 The  name  of  the rule whose
                                                 action you want  to  override
                                                 to Count .

                                   IPSetReferenceStatement -> (structure)
                                      A  rule statement used to detect web re-
                                      quests coming  from  particular  IP  ad-
                                      dresses  or address ranges. To use this,
                                      create an  IPSet that specifies the  ad-
                                      dresses you want to detect, then use the
                                      ARN of that set in  this  statement.  To
                                      create an IP set, see  CreateIPSet .

                                      Each IP set rule statement references an
                                      IP set. You create and maintain the  set
                                      independent  of  your rules. This allows
                                      you to use the single  set  in  multiple
                                      rules.  When  you  update the referenced
                                      set, WAF automatically updates all rules
                                      that reference it.

                                      ARN -> (string)
                                          The  Amazon  Resource  Name (ARN) of
                                          the  IPSet that this statement  ref-
                                          erences.

                                      IPSetForwardedIPConfig -> (structure)
                                          The  configuration for inspecting IP
                                          addresses in an HTTP header that you
                                          specify, instead of using the IP ad-
                                          dress that's reported by the web re-
                                          quest  origin. Commonly, this is the
                                          X-Forwarded-For  (XFF)  header,  but
                                          you can specify any header name.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          HeaderName -> (string)
                                             The name of the  HTTP  header  to
                                             use for the IP address. For exam-
                                             ple, to use  the  X-Forwarded-For
                                             (XFF)  header, set this to X-For-
                                             warded-For .

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                          FallbackBehavior -> (string)
                                             The match status to assign to the
                                             web  request   if   the   request
                                             doesn't  have  a valid IP address
                                             in the specified position.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             You  can  specify  the  following
                                             fallback behaviors:

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                          Position -> (string)
                                             The  position  in  the  header to
                                             search for the  IP  address.  The
                                             header  can  contain IP addresses
                                             of the original client  and  also
                                             of   proxies.  For  example,  the
                                             header value could  be  10.1.1.1,
                                             127.0.0.0,  10.10.10.10 where the
                                             first IP address  identifies  the
                                             original   client  and  the  rest
                                             identify proxies that the request
                                             went through.

                                             The  options for this setting are
                                             the following:

                                             o FIRST - Inspect  the  first  IP
                                               address  in  the list of IP ad-
                                               dresses in the header. This  is
                                               usually  the  client's original
                                               IP.

                                             o LAST - Inspect the last IP  ad-
                                               dress  in  the  list  of IP ad-
                                               dresses in the header.

                                             o ANY - Inspect all IP  addresses
                                               in  the  header for a match. If
                                               the header contains  more  than
                                               10  IP  addresses, WAF inspects
                                               the last 10.

                                   RegexPatternSetReferenceStatement        ->
                                   (structure)
                                      A  rule statement used to search web re-
                                      quest components for matches with  regu-
                                      lar  expressions.  To use this, create a
                                      RegexPatternSet that specifies  the  ex-
                                      pressions  that you want to detect, then
                                      use the ARN of that set in  this  state-
                                      ment.  A web request matches the pattern
                                      set rule statement if the request compo-
                                      nent  matches any of the patterns in the
                                      set. To create a regex pattern set,  see
                                      CreateRegexPatternSet .

                                      Each  regex  pattern  set rule statement
                                      references a regex pattern set. You cre-
                                      ate  and maintain the set independent of
                                      your rules. This allows you to  use  the
                                      single  set  in multiple rules. When you
                                      update the referenced set, WAF automati-
                                      cally  updates  all rules that reference
                                      it.

                                      ARN -> (string)
                                          The Amazon Resource  Name  (ARN)  of
                                          the    RegexPatternSet   that   this
                                          statement references.

                                      FieldToMatch -> (structure)
                                          The part of a web request  that  you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect a single header.  Provide
                                             the  name  of  the  header to in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example JSON:  "SingleHeader":  {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The  name of the query header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect a single query  argument.
                                             Provide the name of the query ar-
                                             gument to inspect, such as  User-
                                             Name  or  SalesRegion  . The name
                                             can be up to 30  characters  long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web request component for WAF  to
                                             inspect,   in  the   FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The  name  of the query argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that identifies a  resource,  for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the part of a  URL  that  appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text. The  request  body  immedi-
                                             ately  follows  the request head-
                                             ers. This is the part  of  a  re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to  your  web  server as the HTTP
                                             request body, such as data from a
                                             form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect   the  HTTP  method.  The
                                             method indicates the type of  op-
                                             eration  that the request is ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the  part  of a request that con-
                                             tains any  additional  data  that
                                             you  want  to  send  to  your web
                                             server as the HTTP request  body,
                                             such as data from a form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The  patterns  to look for in
                                                 the JSON body.  WAF  inspects
                                                 the  results of these pattern
                                                 matches against the rule  in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See  also  MatchScope   in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this setting  or  the  In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match only  the  specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide the include  paths
                                                    using JSON Pointer syntax.
                                                    For  example,   "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"] . For  in-
                                                    formation  about this syn-
                                                    tax, see the Internet  En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this  setting  or  the All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't use this  option
                                                        to  include all paths.
                                                        Instead, use  the  All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON body.  The  options  are
                                                 the following:

                                                 o EVALUATE_AS_STRING   -  In-
                                                   spect  the  body  as  plain
                                                   text.  WAF applies the text
                                                   transformations and inspec-
                                                   tion  criteria that you de-
                                                   fined for the JSON  inspec-
                                                   tion   to   the  body  text
                                                   string.

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates  the content only up to
                                                 the  first  parsing   failure
                                                 that it encounters.

                                                 WAF  does  its  best to parse
                                                 the  entire  JSON  body,  but
                                                 might  be  forced to stop for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root  node isn't an object or
                                                 an array.

                                                 WAF parses the  JSON  in  the
                                                 following   examples  as  two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                                   RateBasedStatement -> (structure)
                                      A rate-based rule tracks the rate of re-
                                      quests  for each originating IP address,
                                      and triggers the rule  action  when  the
                                      rate exceeds a limit that you specify on
                                      the number of requests in  any  5-minute
                                      time  span.  You  can  use this to put a
                                      temporary block on requests from  an  IP
                                      address  that  is  sending excessive re-
                                      quests.

                                      WAF tracks and manages web requests sep-
                                      arately   for   each   instance   of   a
                                      rate-based rule that you use. For  exam-
                                      ple,  if you provide the same rate-based
                                      rule settings in two web ACLs,  each  of
                                      the  two  rule  statements  represents a
                                      separate instance of the rate-based rule
                                      and gets its own tracking and management
                                      by WAF. If you define a rate-based  rule
                                      inside  a  rule group, and then use that
                                      rule group in multiple places, each  use
                                      creates   a  separate  instance  of  the
                                      rate-based rule that gets its own track-
                                      ing and management by WAF.

                                      When   the  rule  action  triggers,  WAF
                                      blocks additional requests from  the  IP
                                      address until the request rate falls be-
                                      low the limit.

                                      You can optionally nest  another  state-
                                      ment inside the rate-based statement, to
                                      narrow the scope of the rule so that  it
                                      only  counts  requests  that  match  the
                                      nested statement. For example, based  on
                                      recent  requests that you have seen from
                                      an  attacker,   you   might   create   a
                                      rate-based  rule  with a nested AND rule
                                      statement that  contains  the  following
                                      nested statements:

                                      o An  IP  match statement with an IP set
                                        that specified the address 192.0.2.44.

                                      o A string match statement that searches
                                        in   the  User-Agent  header  for  the
                                        string BadBot.

                                      In this rate-based rule, you also define
                                      a rate limit. For this example, the rate
                                      limit is 1,000. Requests that meet  both
                                      of  the conditions in the statements are
                                      counted. If the count exceeds 1,000  re-
                                      quests per five minutes, the rule action
                                      triggers. Requests that do not meet both
                                      conditions  are  not counted towards the
                                      rate limit and are not affected by  this
                                      rule.

                                      You cannot nest a RateBasedStatement in-
                                      side another statement, for example  in-
                                      side a NotStatement or OrStatement . You
                                      can define a RateBasedStatement inside a
                                      web ACL and inside a rule group.

                                      Limit -> (long)
                                          The  limit  on requests per 5-minute
                                          period for a single  originating  IP
                                          address. If the statement includes a
                                          ScopeDownStatement , this  limit  is
                                          applied  only  to  the requests that
                                          match the statement.

                                      AggregateKeyType -> (string)
                                          Setting that indicates how to aggre-
                                          gate the request counts. The options
                                          are the following:

                                          o IP - Aggregate the request  counts
                                            on the IP address from the web re-
                                            quest origin.

                                          o FORWARDED_IP - Aggregate  the  re-
                                            quest  counts  on the first IP ad-
                                            dress in an HTTP  header.  If  you
                                            use   this,   configure  the  For-
                                            wardedIPConfig ,  to  specify  the
                                            header to use.

                                      (  ...  recursive ... )ForwardedIPConfig
                                      -> (structure)
                                          The configuration for inspecting  IP
                                          addresses in an HTTP header that you
                                          specify, instead of using the IP ad-
                                          dress that's reported by the web re-
                                          quest origin. Commonly, this is  the
                                          X-Forwarded-For  (XFF)  header,  but
                                          you can specify any header name.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present   in   the  request,  WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          This is required if AggregateKeyType
                                          is set to FORWARDED_IP .

                                          HeaderName -> (string)
                                             The name of the  HTTP  header  to
                                             use for the IP address. For exam-
                                             ple, to use  the  X-Forwarded-For
                                             (XFF)  header, set this to X-For-
                                             warded-For .

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                          FallbackBehavior -> (string)
                                             The match status to assign to the
                                             web  request   if   the   request
                                             doesn't  have  a valid IP address
                                             in the specified position.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             You  can  specify  the  following
                                             fallback behaviors:

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                   AndStatement -> (structure)
                                      A logical rule statement used to combine
                                      other rule statements  with  AND  logic.
                                      You  provide  more  than  one  Statement
                                      within the AndStatement .

                                      Statements -> (list)
                                          The statements to combine  with  AND
                                          logic.  You  can  use any statements
                                          that can be nested.

                                          ( ... recursive ... )

                                   OrStatement -> (structure)
                                      A logical rule statement used to combine
                                      other rule statements with OR logic. You
                                      provide more than one  Statement  within
                                      the OrStatement .

                                      Statements -> (list)
                                          The  statements  to  combine with OR
                                          logic. You can  use  any  statements
                                          that can be nested.

                                          ( ... recursive ... )

                                   NotStatement -> (structure)
                                      A  logical rule statement used to negate
                                      the results of another  rule  statement.
                                      You  provide  one   Statement within the
                                      NotStatement .

                                      ( ... recursive ... )

                                   ManagedRuleGroupStatement -> (structure)
                                      A rule statement used to run  the  rules
                                      that  are  defined  in  a  managed  rule
                                      group. To use this, provide  the  vendor
                                      name  and  the name of the rule group in
                                      this statement. You can retrieve the re-
                                      quired names by calling  ListAvailableM-
                                      anagedRuleGroups .

                                      You cannot nest a ManagedRuleGroupState-
                                      ment , for example for use inside a Not-
                                      Statement or OrStatement . It  can  only
                                      be  referenced  as a top-level statement
                                      within a rule.

                                      VendorName -> (string)
                                          The name of the managed  rule  group
                                          vendor. You use this, along with the
                                          rule group  name,  to  identify  the
                                          rule group.

                                      Name -> (string)
                                          The  name of the managed rule group.
                                          You use this, along with the  vendor
                                          name, to identify the rule group.

                                      Version -> (string)
                                          The  version  of  the  managed  rule
                                          group to use. If you  specify  this,
                                          the  version  setting is fixed until
                                          you change it. If you don't  specify
                                          this,  WAF uses the vendor's default
                                          version, and then keeps the  version
                                          at  the  vendor's  default  when the
                                          vendor  updates  the  managed   rule
                                          group settings.

                                      ExcludedRules -> (list)
                                          The  rules  in  the  referenced rule
                                          group whose actions are set to Count
                                          . When you exclude a rule, WAF eval-
                                          uates it exactly as it would if  the
                                          rule  action  setting  were  Count .
                                          This is a useful option for  testing
                                          the  rules  in  a rule group without
                                          modifying how they handle  your  web
                                          traffic.

                                          (structure)
                                             Specifies a single rule in a rule
                                             group whose action  you  want  to
                                             override  to Count . When you ex-
                                             clude a rule,  WAF  evaluates  it
                                             exactly  as  it would if the rule
                                             action setting were Count .  This
                                             is  a  useful  option for testing
                                             the rules in a rule group without
                                             modifying  how  they  handle your
                                             web traffic.

                                             Name -> (string)
                                                 The name of  the  rule  whose
                                                 action  you  want to override
                                                 to Count .

                                      ( ... recursive ... )

                                   LabelMatchStatement -> (structure)
                                      A rule statement that defines  a  string
                                      match  search  against  labels that have
                                      been added to the web request  by  rules
                                      that have already run in the web ACL.

                                      The  label  match statement provides the
                                      label or namespace string to search for.
                                      The label string can represent a part or
                                      all of the fully  qualified  label  name
                                      that  had been added to the web request.
                                      Fully qualified labels  have  a  prefix,
                                      optional namespaces, and label name. The
                                      prefix identifies the rule group or  web
                                      ACL  context  of the rule that added the
                                      label. If you do not provide  the  fully
                                      qualified   name  in  your  label  match
                                      string, WAF performs the search for  la-
                                      bels that were added in the same context
                                      as the label match statement.

                                      Scope -> (string)
                                          Specify whether you  want  to  match
                                          using  the  label  name  or just the
                                          namespace.

                                      Key -> (string)
                                          The string  to  match  against.  The
                                          setting you provide for this depends
                                          on the match statement's Scope  set-
                                          ting:

                                          o If  the  Scope  indicates  LABEL ,
                                            then this specification  must  in-
                                            clude the name and can include any
                                            number  of   preceding   namespace
                                            specifications  and  prefix  up to
                                            providing the fully qualified  la-
                                            bel name.

                                          o If the Scope indicates NAMESPACE ,
                                            then this  specification  can  in-
                                            clude  any  number  of  contiguous
                                            namespace strings, and can include
                                            the  entire label namespace prefix
                                            from the rule  group  or  web  ACL
                                            where the label originates.

                                          Labels are case sensitive and compo-
                                          nents of a label must  be  separated
                                          by colon, for example NS1:NS2:name .

                                   RegexMatchStatement -> (structure)
                                      A  rule statement used to search web re-
                                      quest components for a match  against  a
                                      single regular expression.

                                      RegexString -> (string)
                                          The  string representing the regular
                                          expression.

                                      FieldToMatch -> (structure)
                                          The part of a web request  that  you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect a single header.  Provide
                                             the  name  of  the  header to in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example JSON:  "SingleHeader":  {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The  name of the query header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect a single query  argument.
                                             Provide the name of the query ar-
                                             gument to inspect, such as  User-
                                             Name  or  SalesRegion  . The name
                                             can be up to 30  characters  long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web request component for WAF  to
                                             inspect,   in  the   FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The  name  of the query argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that identifies a  resource,  for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the part of a  URL  that  appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text. The  request  body  immedi-
                                             ately  follows  the request head-
                                             ers. This is the part  of  a  re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to  your  web  server as the HTTP
                                             request body, such as data from a
                                             form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect   the  HTTP  method.  The
                                             method indicates the type of  op-
                                             eration  that the request is ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the  part  of a request that con-
                                             tains any  additional  data  that
                                             you  want  to  send  to  your web
                                             server as the HTTP request  body,
                                             such as data from a form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The  patterns  to look for in
                                                 the JSON body.  WAF  inspects
                                                 the  results of these pattern
                                                 matches against the rule  in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See  also  MatchScope   in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this setting  or  the  In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match only  the  specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide the include  paths
                                                    using JSON Pointer syntax.
                                                    For  example,   "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"] . For  in-
                                                    formation  about this syn-
                                                    tax, see the Internet  En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this  setting  or  the All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't use this  option
                                                        to  include all paths.
                                                        Instead, use  the  All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON body.  The  options  are
                                                 the following:

                                                 o EVALUATE_AS_STRING   -  In-
                                                   spect  the  body  as  plain
                                                   text.  WAF applies the text
                                                   transformations and inspec-
                                                   tion  criteria that you de-
                                                   fined for the JSON  inspec-
                                                   tion   to   the  body  text
                                                   string.

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates  the content only up to
                                                 the  first  parsing   failure
                                                 that it encounters.

                                                 WAF  does  its  best to parse
                                                 the  entire  JSON  body,  but
                                                 might  be  forced to stop for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root  node isn't an object or
                                                 an array.

                                                 WAF parses the  JSON  in  the
                                                 following   examples  as  two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                            ManagedRuleGroupStatement -> (structure)
                               A rule statement used to run the rules that are
                               defined  in  a managed rule group. To use this,
                               provide the vendor name and  the  name  of  the
                               rule  group in this statement. You can retrieve
                               the required names by calling   ListAvailableM-
                               anagedRuleGroups .

                               You  cannot  nest a ManagedRuleGroupStatement ,
                               for example for use inside  a  NotStatement  or
                               OrStatement  .  It  can only be referenced as a
                               top-level statement within a rule.

                               VendorName -> (string)
                                   The name of the managed rule group  vendor.
                                   You  use  this,  along  with the rule group
                                   name, to identify the rule group.

                               Name -> (string)
                                   The name of the managed rule group. You use
                                   this,  along with the vendor name, to iden-
                                   tify the rule group.

                               Version -> (string)
                                   The version of the managed  rule  group  to
                                   use.  If you specify this, the version set-
                                   ting is fixed until you change it.  If  you
                                   don't  specify  this, WAF uses the vendor's
                                   default version, and then keeps the version
                                   at the vendor's default when the vendor up-
                                   dates the managed rule group settings.

                               ExcludedRules -> (list)
                                   The rules  in  the  referenced  rule  group
                                   whose  actions  are set to Count . When you
                                   exclude a rule, WAF evaluates it exactly as
                                   it  would  if  the rule action setting were
                                   Count . This is a useful option for testing
                                   the rules in a rule group without modifying
                                   how they handle your web traffic.

                                   (structure)
                                      Specifies a single rule in a rule  group
                                      whose  action  you  want  to override to
                                      Count . When you  exclude  a  rule,  WAF
                                      evaluates  it exactly as it would if the
                                      rule action setting were Count . This is
                                      a useful option for testing the rules in
                                      a rule group without modifying how  they
                                      handle your web traffic.

                                      Name -> (string)
                                          The  name  of  the rule whose action
                                          you want to override to Count .

                               ScopeDownStatement -> (structure)
                                   An optional nested statement  that  narrows
                                   the  scope  of  the  web  requests that are
                                   evaluated by the managed  rule  group.  Re-
                                   quests are only evaluated by the rule group
                                   if they match the scope-down statement. You
                                   can  use  any  nestable   Statement  in the
                                   scope-down  statement,  and  you  can  nest
                                   statements  at  any  level, the same as you
                                   can for a rule statement.

                                   ByteMatchStatement -> (structure)
                                      A rule statement that defines  a  string
                                      match search for WAF to apply to web re-
                                      quests. The byte  match  statement  pro-
                                      vides the bytes to search for, the loca-
                                      tion in requests that you  want  WAF  to
                                      search, and other settings. The bytes to
                                      search for are typically a  string  that
                                      corresponds  with  ASCII  characters. In
                                      the WAF console and the developer guide,
                                      this  is  refered  to  as a string match
                                      statement.

                                      SearchString -> (blob)
                                          A string value that you want WAF  to
                                          search for. WAF searches only in the
                                          part of web requests that you desig-
                                          nate for inspection in  FieldToMatch
                                          . The maximum length of the value is
                                          50 bytes.

                                          Valid values depend on the component
                                          that you specify for  inspection  in
                                          FieldToMatch :

                                          o Method  : The HTTP method that you
                                            want WAF to search for. This indi-
                                            cates the type of operation speci-
                                            fied in the request.

                                          o UriPath : The value that you  want
                                            WAF to search for in the URI path,
                                            for example,  /images/daily-ad.jpg
                                            .

                                          If  SearchString includes alphabetic
                                          characters A-Z and  a-z,  note  that
                                          the value is case sensitive.
                                             If you're using the WAF API

                                          Specify  a base64-encoded version of
                                          the value. The maximum length of the
                                          value before you base64-encode it is
                                          50 bytes.

                                          For example, suppose  the  value  of
                                          Type is HEADER and the value of Data
                                          is  User-Agent  .  If  you  want  to
                                          search the User-Agent header for the
                                          value  BadBot  ,  you  base64-encode
                                          BadBot  using  MIME  base64-encoding
                                          and include the resulting value, Qm-
                                          FkQm90  ,  in  the  value of Search-
                                          String .
                                             If you're using the CLI or one of
                                             the Amazon Web Services SDKs

                                          The  value  that  you  want  WAF  to
                                          search for.  The  SDK  automatically
                                          base64 encodes the value.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.  If  you
                                          specify  one or more transformations
                                          in a rule  statement,  WAF  performs
                                          all  transformations  on the content
                                          of the request component  identified
                                          by  FieldToMatch , starting from the
                                          lowest priority setting, before  in-
                                          specting the content for a match.

                                          (structure)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets  the relative processing
                                                 order for multiple  transfor-
                                                 mations  that are defined for
                                                 a rule  statement.  WAF  pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive, but they  must  all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE -  Decode  a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a Base64 -encoded  string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE  -   Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness  of attackers who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use unusual formatting  to
                                                    disguise  some  or  all of
                                                    the command.

                                                 o Delete the following  char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with   a  space  character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v  , vertical tab, decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE  - Decode char-
                                                    acters that  were  encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This  function  uses up to
                                                    two bytes in the  decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS encoding that  wouldnt
                                                    typically be encoded. It's
                                                    also useful in  countering
                                                    evasion, which is a combi-
                                                    nation of a backslash  and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript    for   java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the  following  ANSI C es-
                                                    cape sequences: \a , \b  ,
                                                    \f  ,  \n , \r , \t , \v ,
                                                    \\ , \? , \' , \"  ,  \xHH
                                                    (hexadecimal),  \0OOO (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE  -   Decode   a
                                                    string    of   hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters with unencoded  char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with a non-breaking  space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces   characters  that
                                                   are represented in hexadec-
                                                   imal     format,    (amper-
                                                   sand)#xhhhh;  ,  with   the
                                                   corresponding characters

                                                 o Replaces   characters  that
                                                   are represented in  decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with   the    corresponding
                                                   characters
                                                    JS_DECODE  -  Decode Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the full-width ASCII  code
                                                    range  of FF01-FF5E , then
                                                    the higher byte is used to
                                                    detect   and   adjust  the
                                                    lower byte. If  not,  only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash  from the data in the
                                                    input. The  computed  hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH   -  Remove
                                                    multiple  slashes,  direc-
                                                    tory  self-references, and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning of the input from  an
                                                    input string.

                                                    NORMALIZE_PATH_WIN  - This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH  , but first con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS  - Remove all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences   are  not  com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination of a comment  (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS   -  Replace
                                                    NULL bytes  in  the  input
                                                    with    space   characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE  -   Decode
                                                    SQL   hex   data.  Example
                                                    (0x414243 )  will  be  de-
                                                    coded to (ABC ).

                                                    URL_DECODE   -   Decode  a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI   -    Like
                                                    URL_DECODE , but with sup-
                                                    port  for   Microsoft-spe-
                                                    cific  %u encoding. If the
                                                    code is in the  full-width
                                                    ASCII    code   range   of
                                                    FF01-FF5E  ,  the   higher
                                                    byte is used to detect and
                                                    adjust  the  lower   byte.
                                                    Otherwise,  only the lower
                                                    byte  is  used   and   the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE  - Convert
                                                    all  UTF-8  character  se-
                                                    quences  to  Unicode. This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives and  false-negatives
                                                    for non-English languages.

                                      PositionalConstraint -> (string)
                                          The area within the portion of a web
                                          request that you want WAF to  search
                                          for  SearchString . Valid values in-
                                          clude the following:
                                             CONTAINS

                                          The specified part of  the  web  re-
                                          quest  must  include  the  value  of
                                          SearchString  ,  but  the   location
                                          doesn't matter.
                                             CONTAINS_WORD

                                          The  specified  part  of the web re-
                                          quest  must  include  the  value  of
                                          SearchString , and SearchString must
                                          contain only alphanumeric characters
                                          or underscore (A-Z, a-z, 0-9, or _).
                                          In addition, SearchString must be  a
                                          word,  which  means that both of the
                                          following are true:

                                          o SearchString is at  the  beginning
                                            of  the  specified part of the web
                                            request or is preceded by a  char-
                                            acter  other  than an alphanumeric
                                            character or underscore (_). Exam-
                                            ples include the value of a header
                                            and ;BadBot .

                                          o SearchString is at the end of  the
                                            specified  part of the web request
                                            or  is  followed  by  a  character
                                            other than an alphanumeric charac-
                                            ter or underscore (_),  for  exam-
                                            ple, BadBot; and -BadBot; .
                                             EXACTLY

                                          The  value  of the specified part of
                                          the web request must  exactly  match
                                          the value of SearchString .
                                             STARTS_WITH

                                          The  value  of SearchString must ap-
                                          pear at the beginning of the  speci-
                                          fied part of the web request.
                                             ENDS_WITH

                                          The  value  of SearchString must ap-
                                          pear at the  end  of  the  specified
                                          part of the web request.

                                   SqliMatchStatement -> (structure)
                                      Attackers sometimes insert malicious SQL
                                      code into web requests in an  effort  to
                                      extract  data from your database. To al-
                                      low or block web requests that appear to
                                      contain  malicious  SQL code, create one
                                      or more SQL injection match  conditions.
                                      An SQL injection match condition identi-
                                      fies the part of web requests,  such  as
                                      the  URI  or  the query string, that you
                                      want  WAF  to  inspect.  Later  in   the
                                      process,  when you create a web ACL, you
                                      specify whether to allow  or  block  re-
                                      quests  that appear to contain malicious
                                      SQL code.

                                      FieldToMatch -> (structure)
                                          The part of a web request  that  you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect a single header.  Provide
                                             the  name  of  the  header to in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example JSON:  "SingleHeader":  {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The  name of the query header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect a single query  argument.
                                             Provide the name of the query ar-
                                             gument to inspect, such as  User-
                                             Name  or  SalesRegion  . The name
                                             can be up to 30  characters  long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web request component for WAF  to
                                             inspect,   in  the   FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The  name  of the query argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that identifies a  resource,  for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the part of a  URL  that  appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text. The  request  body  immedi-
                                             ately  follows  the request head-
                                             ers. This is the part  of  a  re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to  your  web  server as the HTTP
                                             request body, such as data from a
                                             form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect   the  HTTP  method.  The
                                             method indicates the type of  op-
                                             eration  that the request is ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the  part  of a request that con-
                                             tains any  additional  data  that
                                             you  want  to  send  to  your web
                                             server as the HTTP request  body,
                                             such as data from a form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The  patterns  to look for in
                                                 the JSON body.  WAF  inspects
                                                 the  results of these pattern
                                                 matches against the rule  in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See  also  MatchScope   in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this setting  or  the  In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match only  the  specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide the include  paths
                                                    using JSON Pointer syntax.
                                                    For  example,   "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"] . For  in-
                                                    formation  about this syn-
                                                    tax, see the Internet  En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this  setting  or  the All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't use this  option
                                                        to  include all paths.
                                                        Instead, use  the  All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON body.  The  options  are
                                                 the following:

                                                 o EVALUATE_AS_STRING   -  In-
                                                   spect  the  body  as  plain
                                                   text.  WAF applies the text
                                                   transformations and inspec-
                                                   tion  criteria that you de-
                                                   fined for the JSON  inspec-
                                                   tion   to   the  body  text
                                                   string.

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates  the content only up to
                                                 the  first  parsing   failure
                                                 that it encounters.

                                                 WAF  does  its  best to parse
                                                 the  entire  JSON  body,  but
                                                 might  be  forced to stop for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root  node isn't an object or
                                                 an array.

                                                 WAF parses the  JSON  in  the
                                                 following   examples  as  two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                                   XssMatchStatement -> (structure)
                                      A  rule   statement   that   defines   a
                                      cross-site  scripting (XSS) match search
                                      for WAF to apply to  web  requests.  XSS
                                      attacks  are  those  where  the attacker
                                      uses vulnerabilities in a benign website
                                      as   a   vehicle   to  inject  malicious
                                      client-site scripts into  other  legiti-
                                      mate  web browsers. The XSS match state-
                                      ment provides the location  in  requests
                                      that  you  want  WAF  to search and text
                                      transformations to  use  on  the  search
                                      area  before  WAF searches for character
                                      sequences that are likely  to  be  mali-
                                      cious strings.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.  If  you
                                          specify  one or more transformations
                                          in a rule  statement,  WAF  performs
                                          all  transformations  on the content
                                          of the request component  identified
                                          by  FieldToMatch , starting from the
                                          lowest priority setting, before  in-
                                          specting the content for a match.

                                          (structure)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets  the relative processing
                                                 order for multiple  transfor-
                                                 mations  that are defined for
                                                 a rule  statement.  WAF  pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive, but they  must  all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE -  Decode  a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a Base64 -encoded  string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE  -   Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness  of attackers who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use unusual formatting  to
                                                    disguise  some  or  all of
                                                    the command.

                                                 o Delete the following  char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with   a  space  character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v  , vertical tab, decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE  - Decode char-
                                                    acters that  were  encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This  function  uses up to
                                                    two bytes in the  decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS encoding that  wouldnt
                                                    typically be encoded. It's
                                                    also useful in  countering
                                                    evasion, which is a combi-
                                                    nation of a backslash  and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript    for   java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the  following  ANSI C es-
                                                    cape sequences: \a , \b  ,
                                                    \f  ,  \n , \r , \t , \v ,
                                                    \\ , \? , \' , \"  ,  \xHH
                                                    (hexadecimal),  \0OOO (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE  -   Decode   a
                                                    string    of   hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters with unencoded  char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with a non-breaking  space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces   characters  that
                                                   are represented in hexadec-
                                                   imal     format,    (amper-
                                                   sand)#xhhhh;  ,  with   the
                                                   corresponding characters

                                                 o Replaces   characters  that
                                                   are represented in  decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with   the    corresponding
                                                   characters
                                                    JS_DECODE  -  Decode Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the full-width ASCII  code
                                                    range  of FF01-FF5E , then
                                                    the higher byte is used to
                                                    detect   and   adjust  the
                                                    lower byte. If  not,  only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash  from the data in the
                                                    input. The  computed  hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH   -  Remove
                                                    multiple  slashes,  direc-
                                                    tory  self-references, and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning of the input from  an
                                                    input string.

                                                    NORMALIZE_PATH_WIN  - This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH  , but first con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS  - Remove all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences   are  not  com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination of a comment  (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS   -  Replace
                                                    NULL bytes  in  the  input
                                                    with    space   characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE  -   Decode
                                                    SQL   hex   data.  Example
                                                    (0x414243 )  will  be  de-
                                                    coded to (ABC ).

                                                    URL_DECODE   -   Decode  a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI   -    Like
                                                    URL_DECODE , but with sup-
                                                    port  for   Microsoft-spe-
                                                    cific  %u encoding. If the
                                                    code is in the  full-width
                                                    ASCII    code   range   of
                                                    FF01-FF5E  ,  the   higher
                                                    byte is used to detect and
                                                    adjust  the  lower   byte.
                                                    Otherwise,  only the lower
                                                    byte  is  used   and   the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE  - Convert
                                                    all  UTF-8  character  se-
                                                    quences  to  Unicode. This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives and  false-negatives
                                                    for non-English languages.

                                   SizeConstraintStatement -> (structure)
                                      A  rule statement that compares a number
                                      of bytes against the size of  a  request
                                      component,  using a comparison operator,
                                      such as greater than (>)  or  less  than
                                      (<).  For  example,  you  can use a size
                                      constraint statement to look  for  query
                                      strings that are longer than 100 bytes.

                                      If  you configure WAF to inspect the re-
                                      quest body, WAF inspects only the  first
                                      8192  bytes  (8 KB). If the request body
                                      for your web requests never exceeds 8192
                                      bytes,  you can create a size constraint
                                      condition and block requests that have a
                                      request body greater than 8192 bytes.

                                      If  you choose URI for the value of Part
                                      of the request to filter on,  the  slash
                                      (/)  in the URI counts as one character.
                                      For example, the URI /logo.jpg  is  nine
                                      characters long.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      ComparisonOperator -> (string)
                                          The  operator  to use to compare the
                                          request part to the size setting.

                                      Size -> (long)
                                          The size, in byte, to compare to the
                                          request  part, after any transforma-
                                          tions.

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                                   GeoMatchStatement -> (structure)
                                      A rule statement used  to  identify  web
                                      requests based on country of origin.

                                      CountryCodes -> (list)
                                          An  array  of  two-character country
                                          codes, for example, [ "US", "CN" ] ,
                                          from  the  alpha-2 country ISO codes
                                          of the ISO 3166 international  stan-
                                          dard.

                                          (string)

                                      ForwardedIPConfig -> (structure)
                                          The  configuration for inspecting IP
                                          addresses in an HTTP header that you
                                          specify, instead of using the IP ad-
                                          dress that's reported by the web re-
                                          quest  origin. Commonly, this is the
                                          X-Forwarded-For  (XFF)  header,  but
                                          you can specify any header name.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          HeaderName -> (string)
                                             The name of the  HTTP  header  to
                                             use for the IP address. For exam-
                                             ple, to use  the  X-Forwarded-For
                                             (XFF)  header, set this to X-For-
                                             warded-For .

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                          FallbackBehavior -> (string)
                                             The match status to assign to the
                                             web  request   if   the   request
                                             doesn't  have  a valid IP address
                                             in the specified position.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             You  can  specify  the  following
                                             fallback behaviors:

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                   RuleGroupReferenceStatement -> (structure)
                                      A  rule  statement used to run the rules
                                      that are defined in a   RuleGroup  .  To
                                      use  this, create a rule group with your
                                      rules, then provide the ARN of the  rule
                                      group in this statement.

                                      You  cannot  nest a RuleGroupReferenceS-
                                      tatement , for example for use inside  a
                                      NotStatement  or  OrStatement  . You can
                                      only use a rule group  reference  state-
                                      ment at the top level inside a web ACL.

                                      ARN -> (string)
                                          The  Amazon  Resource  Name (ARN) of
                                          the entity.

                                      ExcludedRules -> (list)
                                          The rules  in  the  referenced  rule
                                          group whose actions are set to Count
                                          . When you exclude a rule, WAF eval-
                                          uates  it exactly as it would if the
                                          rule action  setting  were  Count  .
                                          This  is a useful option for testing
                                          the rules in a  rule  group  without
                                          modifying  how  they handle your web
                                          traffic.

                                          (structure)
                                             Specifies a single rule in a rule
                                             group  whose  action  you want to
                                             override to Count . When you  ex-
                                             clude  a  rule,  WAF evaluates it
                                             exactly as it would if  the  rule
                                             action  setting were Count . This
                                             is a useful  option  for  testing
                                             the rules in a rule group without
                                             modifying how  they  handle  your
                                             web traffic.

                                             Name -> (string)
                                                 The  name  of  the rule whose
                                                 action you want  to  override
                                                 to Count .

                                   IPSetReferenceStatement -> (structure)
                                      A  rule statement used to detect web re-
                                      quests coming  from  particular  IP  ad-
                                      dresses  or address ranges. To use this,
                                      create an  IPSet that specifies the  ad-
                                      dresses you want to detect, then use the
                                      ARN of that set in  this  statement.  To
                                      create an IP set, see  CreateIPSet .

                                      Each IP set rule statement references an
                                      IP set. You create and maintain the  set
                                      independent  of  your rules. This allows
                                      you to use the single  set  in  multiple
                                      rules.  When  you  update the referenced
                                      set, WAF automatically updates all rules
                                      that reference it.

                                      ARN -> (string)
                                          The  Amazon  Resource  Name (ARN) of
                                          the  IPSet that this statement  ref-
                                          erences.

                                      IPSetForwardedIPConfig -> (structure)
                                          The  configuration for inspecting IP
                                          addresses in an HTTP header that you
                                          specify, instead of using the IP ad-
                                          dress that's reported by the web re-
                                          quest  origin. Commonly, this is the
                                          X-Forwarded-For  (XFF)  header,  but
                                          you can specify any header name.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present  in  the   request,   WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          HeaderName -> (string)
                                             The name of the  HTTP  header  to
                                             use for the IP address. For exam-
                                             ple, to use  the  X-Forwarded-For
                                             (XFF)  header, set this to X-For-
                                             warded-For .

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                          FallbackBehavior -> (string)
                                             The match status to assign to the
                                             web  request   if   the   request
                                             doesn't  have  a valid IP address
                                             in the specified position.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             You  can  specify  the  following
                                             fallback behaviors:

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                          Position -> (string)
                                             The  position  in  the  header to
                                             search for the  IP  address.  The
                                             header  can  contain IP addresses
                                             of the original client  and  also
                                             of   proxies.  For  example,  the
                                             header value could  be  10.1.1.1,
                                             127.0.0.0,  10.10.10.10 where the
                                             first IP address  identifies  the
                                             original   client  and  the  rest
                                             identify proxies that the request
                                             went through.

                                             The  options for this setting are
                                             the following:

                                             o FIRST - Inspect  the  first  IP
                                               address  in  the list of IP ad-
                                               dresses in the header. This  is
                                               usually  the  client's original
                                               IP.

                                             o LAST - Inspect the last IP  ad-
                                               dress  in  the  list  of IP ad-
                                               dresses in the header.

                                             o ANY - Inspect all IP  addresses
                                               in  the  header for a match. If
                                               the header contains  more  than
                                               10  IP  addresses, WAF inspects
                                               the last 10.

                                   RegexPatternSetReferenceStatement        ->
                                   (structure)
                                      A  rule statement used to search web re-
                                      quest components for matches with  regu-
                                      lar  expressions.  To use this, create a
                                      RegexPatternSet that specifies  the  ex-
                                      pressions  that you want to detect, then
                                      use the ARN of that set in  this  state-
                                      ment.  A web request matches the pattern
                                      set rule statement if the request compo-
                                      nent  matches any of the patterns in the
                                      set. To create a regex pattern set,  see
                                      CreateRegexPatternSet .

                                      Each  regex  pattern  set rule statement
                                      references a regex pattern set. You cre-
                                      ate  and maintain the set independent of
                                      your rules. This allows you to  use  the
                                      single  set  in multiple rules. When you
                                      update the referenced set, WAF automati-
                                      cally  updates  all rules that reference
                                      it.

                                      ARN -> (string)
                                          The Amazon Resource  Name  (ARN)  of
                                          the    RegexPatternSet   that   this
                                          statement references.

                                      FieldToMatch -> (structure)
                                          The part of a web request  that  you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect a single header.  Provide
                                             the  name  of  the  header to in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example JSON:  "SingleHeader":  {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The  name of the query header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect a single query  argument.
                                             Provide the name of the query ar-
                                             gument to inspect, such as  User-
                                             Name  or  SalesRegion  . The name
                                             can be up to 30  characters  long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web request component for WAF  to
                                             inspect,   in  the   FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The  name  of the query argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that identifies a  resource,  for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the part of a  URL  that  appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text. The  request  body  immedi-
                                             ately  follows  the request head-
                                             ers. This is the part  of  a  re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to  your  web  server as the HTTP
                                             request body, such as data from a
                                             form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect   the  HTTP  method.  The
                                             method indicates the type of  op-
                                             eration  that the request is ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the  part  of a request that con-
                                             tains any  additional  data  that
                                             you  want  to  send  to  your web
                                             server as the HTTP request  body,
                                             such as data from a form.

                                             Note  that  only  the  first 8 KB
                                             (8192 bytes) of the request  body
                                             are  forwarded to WAF for inspec-
                                             tion by the underlying host  ser-
                                             vice.  If  you  don't need to in-
                                             spect more than  8  KB,  you  can
                                             guarantee  that  you  don't allow
                                             additional bytes in by  combining
                                             a  statement  that  inspects  the
                                             body of the web request, such  as
                                             ByteMatchStatement  or  RegexPat-
                                             ternSetReferenceStatement ,  with
                                             a   SizeConstraintStatement  that
                                             enforces an 8 KB  size  limit  on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire  contents  of web requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The  patterns  to look for in
                                                 the JSON body.  WAF  inspects
                                                 the  results of these pattern
                                                 matches against the rule  in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See  also  MatchScope   in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this setting  or  the  In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match only  the  specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide the include  paths
                                                    using JSON Pointer syntax.
                                                    For  example,   "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"] . For  in-
                                                    formation  about this syn-
                                                    tax, see the Internet  En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this  setting  or  the All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't use this  option
                                                        to  include all paths.
                                                        Instead, use  the  All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON body.  The  options  are
                                                 the following:

                                                 o EVALUATE_AS_STRING   -  In-
                                                   spect  the  body  as  plain
                                                   text.  WAF applies the text
                                                   transformations and inspec-
                                                   tion  criteria that you de-
                                                   fined for the JSON  inspec-
                                                   tion   to   the  body  text
                                                   string.

                                                 o MATCH - Treat the  web  re-
                                                   quest  as matching the rule
                                                   statement. WAF applies  the
                                                   rule action to the request.

                                                 o NO_MATCH  -  Treat  the web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates  the content only up to
                                                 the  first  parsing   failure
                                                 that it encounters.

                                                 WAF  does  its  best to parse
                                                 the  entire  JSON  body,  but
                                                 might  be  forced to stop for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root  node isn't an object or
                                                 an array.

                                                 WAF parses the  JSON  in  the
                                                 following   examples  as  two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text transformations eliminate  some
                                          of  the  unusual formatting that at-
                                          tackers use in web  requests  in  an
                                          effort  to  bypass detection. If you
                                          specify one or more  transformations
                                          in  a  rule  statement, WAF performs
                                          all transformations on  the  content
                                          of  the request component identified
                                          by FieldToMatch , starting from  the
                                          lowest  priority setting, before in-
                                          specting the content for a match.

                                          (structure)
                                             Text  transformations   eliminate
                                             some  of  the  unusual formatting
                                             that attackers  use  in  web  re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets the relative  processing
                                                 order  for multiple transfor-
                                                 mations that are defined  for
                                                 a  rule  statement.  WAF pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive,  but  they must all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE  -  Decode a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a  Base64 -encoded string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE   -  Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness of attackers  who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use  unusual formatting to
                                                    disguise some  or  all  of
                                                    the command.

                                                 o Delete  the following char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with  a  space   character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v , vertical tab,  decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE - Decode  char-
                                                    acters  that  were encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This function uses  up  to
                                                    two  bytes in the decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS  encoding that wouldnt
                                                    typically be encoded. It's
                                                    also  useful in countering
                                                    evasion, which is a combi-
                                                    nation  of a backslash and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript   for    java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the following ANSI  C  es-
                                                    cape  sequences: \a , \b ,
                                                    \f , \n , \r , \t ,  \v  ,
                                                    \\  ,  \? , \' , \" , \xHH
                                                    (hexadecimal), \0OOO  (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE   -   Decode  a
                                                    string   of    hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters  with unencoded char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with  a non-breaking space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces  characters   that
                                                   are represented in hexadec-
                                                   imal    format,     (amper-
                                                   sand)#xhhhh;   ,  with  the
                                                   corresponding characters

                                                 o Replaces  characters   that
                                                   are  represented in decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with    the   corresponding
                                                   characters
                                                    JS_DECODE -  Decode  Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the  full-width ASCII code
                                                    range of FF01-FF5E ,  then
                                                    the higher byte is used to
                                                    detect  and   adjust   the
                                                    lower  byte.  If not, only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash from the data in  the
                                                    input.  The  computed hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH  -   Remove
                                                    multiple  slashes,  direc-
                                                    tory self-references,  and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning  of the input from an
                                                    input string.

                                                    NORMALIZE_PATH_WIN -  This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH , but first  con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS - Remove  all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences  are  not   com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination  of a comment (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS  -   Replace
                                                    NULL  bytes  in  the input
                                                    with   space    characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE   -  Decode
                                                    SQL  hex   data.   Example
                                                    (0x414243  )  will  be de-
                                                    coded to (ABC ).

                                                    URL_DECODE  -   Decode   a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI    -   Like
                                                    URL_DECODE , but with sup-
                                                    port   for  Microsoft-spe-
                                                    cific %u encoding. If  the
                                                    code  is in the full-width
                                                    ASCII   code   range    of
                                                    FF01-FF5E   ,  the  higher
                                                    byte is used to detect and
                                                    adjust   the  lower  byte.
                                                    Otherwise, only the  lower
                                                    byte   is   used  and  the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE -  Convert
                                                    all  UTF-8  character  se-
                                                    quences to  Unicode.  This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives  and false-negatives
                                                    for non-English languages.

                                   RateBasedStatement -> (structure)
                                      A rate-based rule tracks the rate of re-
                                      quests  for each originating IP address,
                                      and triggers the rule  action  when  the
                                      rate exceeds a limit that you specify on
                                      the number of requests in  any  5-minute
                                      time  span.  You  can  use this to put a
                                      temporary block on requests from  an  IP
                                      address  that  is  sending excessive re-
                                      quests.

                                      WAF tracks and manages web requests sep-
                                      arately   for   each   instance   of   a
                                      rate-based rule that you use. For  exam-
                                      ple,  if you provide the same rate-based
                                      rule settings in two web ACLs,  each  of
                                      the  two  rule  statements  represents a
                                      separate instance of the rate-based rule
                                      and gets its own tracking and management
                                      by WAF. If you define a rate-based  rule
                                      inside  a  rule group, and then use that
                                      rule group in multiple places, each  use
                                      creates   a  separate  instance  of  the
                                      rate-based rule that gets its own track-
                                      ing and management by WAF.

                                      When   the  rule  action  triggers,  WAF
                                      blocks additional requests from  the  IP
                                      address until the request rate falls be-
                                      low the limit.

                                      You can optionally nest  another  state-
                                      ment inside the rate-based statement, to
                                      narrow the scope of the rule so that  it
                                      only  counts  requests  that  match  the
                                      nested statement. For example, based  on
                                      recent  requests that you have seen from
                                      an  attacker,   you   might   create   a
                                      rate-based  rule  with a nested AND rule
                                      statement that  contains  the  following
                                      nested statements:

                                      o An  IP  match statement with an IP set
                                        that specified the address 192.0.2.44.

                                      o A string match statement that searches
                                        in   the  User-Agent  header  for  the
                                        string BadBot.

                                      In this rate-based rule, you also define
                                      a rate limit. For this example, the rate
                                      limit is 1,000. Requests that meet  both
                                      of  the conditions in the statements are
                                      counted. If the count exceeds 1,000  re-
                                      quests per five minutes, the rule action
                                      triggers. Requests that do not meet both
                                      conditions  are  not counted towards the
                                      rate limit and are not affected by  this
                                      rule.

                                      You cannot nest a RateBasedStatement in-
                                      side another statement, for example  in-
                                      side a NotStatement or OrStatement . You
                                      can define a RateBasedStatement inside a
                                      web ACL and inside a rule group.

                                      Limit -> (long)
                                          The  limit  on requests per 5-minute
                                          period for a single  originating  IP
                                          address. If the statement includes a
                                          ScopeDownStatement , this  limit  is
                                          applied  only  to  the requests that
                                          match the statement.

                                      AggregateKeyType -> (string)
                                          Setting that indicates how to aggre-
                                          gate the request counts. The options
                                          are the following:

                                          o IP - Aggregate the request  counts
                                            on the IP address from the web re-
                                            quest origin.

                                          o FORWARDED_IP - Aggregate  the  re-
                                            quest  counts  on the first IP ad-
                                            dress in an HTTP  header.  If  you
                                            use   this,   configure  the  For-
                                            wardedIPConfig ,  to  specify  the
                                            header to use.

                                      (  ...  recursive ... )ForwardedIPConfig
                                      -> (structure)
                                          The configuration for inspecting  IP
                                          addresses in an HTTP header that you
                                          specify, instead of using the IP ad-
                                          dress that's reported by the web re-
                                          quest origin. Commonly, this is  the
                                          X-Forwarded-For  (XFF)  header,  but
                                          you can specify any header name.

                                          NOTE:
                                             If  the  specified  header  isn't
                                             present   in   the  request,  WAF
                                             doesn't apply the rule to the web
                                             request at all.

                                          This is required if AggregateKeyType
                                          is set to FORWARDED_IP .

                                          HeaderName -> (string)
                                             The name of the  HTTP  header  to
                                             use for the IP address. For exam-
                                             ple, to use  the  X-Forwarded-For
                                             (XFF)  header, set this to X-For-
                                             warded-For .

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                          FallbackBehavior -> (string)
                                             The match status to assign to the
                                             web  request   if   the   request
                                             doesn't  have  a valid IP address
                                             in the specified position.

                                             NOTE:
                                                 If the specified header isn't
                                                 present  in  the request, WAF
                                                 doesn't apply the rule to the
                                                 web request at all.

                                             You  can  specify  the  following
                                             fallback behaviors:

                                             o MATCH - Treat the  web  request
                                               as matching the rule statement.
                                               WAF applies the rule action  to
                                               the request.

                                             o NO_MATCH  -  Treat  the web re-
                                               quest as not matching the  rule
                                               statement.

                                   AndStatement -> (structure)
                                      A logical rule statement used to combine
                                      other rule statements  with  AND  logic.
                                      You  provide  more  than  one  Statement
                                      within the AndStatement .

                                      Statements -> (list)
                                          The statements to combine  with  AND
                                          logic.  You  can  use any statements
                                          that can be nested.

                                          ( ... recursive ... )

                                   OrStatement -> (structure)
                                      A logical rule statement used to combine
                                      other rule statements with OR logic. You
                                      provide more than one  Statement  within
                                      the OrStatement .

                                      Statements -> (list)
                                          The  statements  to  combine with OR
                                          logic. You can  use  any  statements
                                          that can be nested.

                                          ( ... recursive ... )

                                   NotStatement -> (structure)
                                      A  logical rule statement used to negate
                                      the results of another  rule  statement.
                                      You  provide  one   Statement within the
                                      NotStatement .

                                      ( ... recursive ... )

                                   ( ... recursive ... )LabelMatchStatement ->
                                   (structure)
                                      A  rule  statement that defines a string
                                      match search against  labels  that  have
                                      been  added  to the web request by rules
                                      that have already run in the web ACL.

                                      The label match statement  provides  the
                                      label or namespace string to search for.
                                      The label string can represent a part or
                                      all  of  the  fully qualified label name
                                      that had been added to the web  request.
                                      Fully  qualified  labels  have a prefix,
                                      optional namespaces, and label name. The
                                      prefix  identifies the rule group or web
                                      ACL context of the rule that  added  the
                                      label.  If  you do not provide the fully
                                      qualified  name  in  your  label   match
                                      string,  WAF performs the search for la-
                                      bels that were added in the same context
                                      as the label match statement.

                                      Scope -> (string)
                                          Specify  whether  you  want to match
                                          using the label  name  or  just  the
                                          namespace.

                                      Key -> (string)
                                          The  string  to  match  against. The
                                          setting you provide for this depends
                                          on  the match statement's Scope set-
                                          ting:

                                          o If the  Scope  indicates  LABEL  ,
                                            then  this  specification must in-
                                            clude the name and can include any
                                            number   of   preceding  namespace
                                            specifications and  prefix  up  to
                                            providing  the fully qualified la-
                                            bel name.

                                          o If the Scope indicates NAMESPACE ,
                                            then  this  specification  can in-
                                            clude  any  number  of  contiguous
                                            namespace strings, and can include
                                            the entire label namespace  prefix
                                            from  the  rule  group  or web ACL
                                            where the label originates.

                                          Labels are case sensitive and compo-
                                          nents  of  a label must be separated
                                          by colon, for example NS1:NS2:name .

                                   RegexMatchStatement -> (structure)
                                      A rule statement used to search web  re-
                                      quest  components  for a match against a
                                      single regular expression.

                                      RegexString -> (string)
                                          The string representing the  regular
                                          expression.

                                      FieldToMatch -> (structure)
                                          The  part  of a web request that you
                                          want WAF to inspect. For more infor-
                                          mation, see  FieldToMatch .

                                          SingleHeader -> (structure)
                                             Inspect  a single header. Provide
                                             the name of  the  header  to  in-
                                             spect, for example, User-Agent or
                                             Referer . This setting isn't case
                                             sensitive.

                                             Example  JSON:  "SingleHeader": {
                                             "Name": "haystack" }

                                             Name -> (string)
                                                 The name of the query  header
                                                 to inspect.

                                          SingleQueryArgument -> (structure)
                                             Inspect  a single query argument.
                                             Provide the name of the query ar-
                                             gument  to inspect, such as User-
                                             Name or SalesRegion  .  The  name
                                             can  be  up to 30 characters long
                                             and isn't case sensitive.

                                             This is used only to indicate the
                                             web  request component for WAF to
                                             inspect,  in  the    FieldToMatch
                                             specification.

                                             Example  JSON:  "SingleQueryArgu-
                                             ment": { "Name": "myArgument" }

                                             Name -> (string)
                                                 The name of the  query  argu-
                                                 ment to inspect.

                                          AllQueryArguments -> (structure)
                                             Inspect all query arguments.

                                          UriPath -> (structure)
                                             Inspect  the  request  URI  path.
                                             This is the part of a web request
                                             that  identifies  a resource, for
                                             example, /images/daily-ad.jpg .

                                          QueryString -> (structure)
                                             Inspect the query string. This is
                                             the  part  of  a URL that appears
                                             after a ? character, if any.

                                          Body -> (structure)
                                             Inspect the request body as plain
                                             text.  The  request  body immedi-
                                             ately follows the  request  head-
                                             ers.  This  is  the part of a re-
                                             quest  that  contains  any  addi-
                                             tional data that you want to send
                                             to your web server  as  the  HTTP
                                             request body, such as data from a
                                             form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                          Method -> (structure)
                                             Inspect  the  HTTP  method.   The
                                             method  indicates the type of op-
                                             eration that the request is  ask-
                                             ing the origin to perform.

                                          JsonBody -> (structure)
                                             Inspect the request body as JSON.
                                             The request body immediately fol-
                                             lows the request headers. This is
                                             the part of a request  that  con-
                                             tains  any  additional  data that
                                             you want  to  send  to  your  web
                                             server  as the HTTP request body,
                                             such as data from a form.

                                             Note that only  the  first  8  KB
                                             (8192  bytes) of the request body
                                             are forwarded to WAF for  inspec-
                                             tion  by the underlying host ser-
                                             vice. If you don't  need  to  in-
                                             spect  more  than  8  KB, you can
                                             guarantee that  you  don't  allow
                                             additional  bytes in by combining
                                             a  statement  that  inspects  the
                                             body  of the web request, such as
                                             ByteMatchStatement or   RegexPat-
                                             ternSetReferenceStatement  , with
                                             a   SizeConstraintStatement  that
                                             enforces  an  8  KB size limit on
                                             the  body  of  the  request.  WAF
                                             doesn't  support  inspecting  the
                                             entire contents of  web  requests
                                             whose  bodies  exceed  the  8  KB
                                             limit.

                                             MatchPattern -> (structure)
                                                 The patterns to look  for  in
                                                 the  JSON  body. WAF inspects
                                                 the results of these  pattern
                                                 matches  against the rule in-
                                                 spection criteria.

                                                 All -> (structure)
                                                    Match all of the elements.
                                                    See   also  MatchScope  in
                                                    JsonBody .

                                                    You  must  specify  either
                                                    this  setting  or  the In-
                                                    cludedPaths  setting,  but
                                                    not both.

                                                 IncludedPaths -> (list)
                                                    Match  only  the specified
                                                    include  paths.  See  also
                                                    MatchScope in  JsonBody .

                                                    Provide  the include paths
                                                    using JSON Pointer syntax.
                                                    For   example,  "Included-
                                                    Paths":   ["/dogs/0/name",
                                                    "/dogs/1/name"]  . For in-
                                                    formation about this  syn-
                                                    tax,  see the Internet En-
                                                    gineering    Task    Force
                                                    (IETF)       documentation
                                                    JavaScript Object Notation
                                                    (JSON) Pointer .

                                                    You  must  specify  either
                                                    this setting  or  the  All
                                                    setting, but not both.

                                                    NOTE:
                                                        Don't  use this option
                                                        to include all  paths.
                                                        Instead,  use  the All
                                                        setting.

                                                    (string)

                                             MatchScope -> (string)
                                                 The  parts  of  the  JSON  to
                                                 match   against   using   the
                                                 MatchPattern . If you specify
                                                 All  ,  WAF  matches  against
                                                 keys and values.

                                             InvalidFallbackBehavior        ->
                                             (string)
                                                 What  WAF  should  do  if  it
                                                 fails to completely parse the
                                                 JSON  body.  The  options are
                                                 the following:

                                                 o EVALUATE_AS_STRING  -   In-
                                                   spect  the  body  as  plain
                                                   text. WAF applies the  text
                                                   transformations and inspec-
                                                   tion criteria that you  de-
                                                   fined  for the JSON inspec-
                                                   tion  to  the   body   text
                                                   string.

                                                 o MATCH  -  Treat the web re-
                                                   quest as matching the  rule
                                                   statement.  WAF applies the
                                                   rule action to the request.

                                                 o NO_MATCH -  Treat  the  web
                                                   request as not matching the
                                                   rule statement.

                                                 If  you  don't  provide  this
                                                 setting, WAF parses and eval-
                                                 uates the content only up  to
                                                 the   first  parsing  failure
                                                 that it encounters.

                                                 WAF does its  best  to  parse
                                                 the  entire  JSON  body,  but
                                                 might be forced to  stop  for
                                                 reasons such as invalid char-
                                                 acters, duplicate keys, trun-
                                                 cation, and any content whose
                                                 root node isn't an object  or
                                                 an array.

                                                 WAF  parses  the  JSON in the
                                                 following  examples  as   two
                                                 valid key, value pairs:

                                                 o Missing              comma:
                                                   {"key1":"value1""key2":"value2"}

                                                 o Missing              colon:
                                                   {"key1":"value1","key2""value2"}

                                                 o Extra               colons:
                                                   {"key1"::"value1","key2""value2"}

                                      TextTransformations -> (list)
                                          Text  transformations eliminate some
                                          of the unusual formatting  that  at-
                                          tackers  use  in  web requests in an
                                          effort to bypass detection.  If  you
                                          specify  one or more transformations
                                          in a rule  statement,  WAF  performs
                                          all  transformations  on the content
                                          of the request component  identified
                                          by  FieldToMatch , starting from the
                                          lowest priority setting, before  in-
                                          specting the content for a match.

                                          (structure)
                                             Text   transformations  eliminate
                                             some of  the  unusual  formatting
                                             that  attackers  use  in  web re-
                                             quests in an effort to bypass de-
                                             tection.

                                             Priority -> (integer)
                                                 Sets  the relative processing
                                                 order for multiple  transfor-
                                                 mations  that are defined for
                                                 a rule  statement.  WAF  pro-
                                                 cesses  all  transformations,
                                                 from lowest priority to high-
                                                 est,  before  inspecting  the
                                                 transformed content. The pri-
                                                 orities don't need to be con-
                                                 secutive, but they  must  all
                                                 be different.

                                             Type -> (string)
                                                 You can specify the following
                                                 transformation types:
                                                    BASE64_DECODE -  Decode  a
                                                    Base64 -encoded string.

                                                    BASE64_DECODE_EXT - Decode
                                                    a Base64 -encoded  string,
                                                    but use a forgiving imple-
                                                    mentation   that   ignores
                                                    characters   that   aren't
                                                    valid.

                                                    CMD_LINE  -   Command-line
                                                    transformations. These are
                                                    helpful in reducing effec-
                                                    tiveness  of attackers who
                                                    inject an operating system
                                                    command-line  command  and
                                                    use unusual formatting  to
                                                    disguise  some  or  all of
                                                    the command.

                                                 o Delete the following  char-
                                                   acters: \ " ' ^

                                                 o Delete  spaces  before  the
                                                   following characters: / (

                                                 o Replace the following char-
                                                   acters with a space: , ;

                                                 o Replace   multiple   spaces
                                                   with one space

                                                 o Convert  uppercase  letters
                                                   (A-Z) to lowercase (a-z)
                                                    COMPRESS_WHITE_SPACE - Re-
                                                    place   these   characters
                                                    with   a  space  character
                                                    (decimal 32):

                                                 o \f , formfeed, decimal 12

                                                 o \t , tab, decimal 9

                                                 o \n , newline, decimal 10

                                                 o \r , carriage return, deci-
                                                   mal 13

                                                 o \v  , vertical tab, decimal
                                                   11

                                                 o Non-breaking space, decimal
                                                   160
                                                    COMPRESS_WHITE_SPACE  also
                                                    replaces  multiple  spaces
                                                    with one space.

                                                    CSS_DECODE  - Decode char-
                                                    acters that  were  encoded
                                                    using CSS 2.x escape rules
                                                    syndata.html#characters  .
                                                    This  function  uses up to
                                                    two bytes in the  decoding
                                                    process, so it can help to
                                                    uncover  ASCII  characters
                                                    that  were  encoded  using
                                                    CSS encoding that  wouldnt
                                                    typically be encoded. It's
                                                    also useful in  countering
                                                    evasion, which is a combi-
                                                    nation of a backslash  and
                                                    non-hexadecimal    charac-
                                                    ters.     For     example,
                                                    ja\vascript    for   java-
                                                    script.

                                                    ESCAPE_SEQ_DECODE - Decode
                                                    the  following  ANSI C es-
                                                    cape sequences: \a , \b  ,
                                                    \f  ,  \n , \r , \t , \v ,
                                                    \\ , \? , \' , \"  ,  \xHH
                                                    (hexadecimal),  \0OOO (oc-
                                                    tal).    Encodings    that
                                                    aren't valid remain in the
                                                    output.

                                                    HEX_DECODE  -   Decode   a
                                                    string    of   hexadecimal
                                                    characters into a binary.

                                                    HTML_ENTITY_DECODE  -  Re-
                                                    place HTML-encoded charac-
                                                    ters with unencoded  char-
                                                    acters. HTML_ENTITY_DECODE
                                                    performs these operations:

                                                 o Replaces   (ampersand)quot;
                                                   with "

                                                 o Replaces   (ampersand)nbsp;
                                                   with a non-breaking  space,
                                                   decimal 160

                                                 o Replaces     (ampersand)lt;
                                                   with a "less than" symbol

                                                 o Replaces     (ampersand)gt;
                                                   with >

                                                 o Replaces   characters  that
                                                   are represented in hexadec-
                                                   imal     format,    (amper-
                                                   sand)#xhhhh;  ,  with   the
                                                   corresponding characters

                                                 o Replaces   characters  that
                                                   are represented in  decimal
                                                   format, (ampersand)#nnnn; ,
                                                   with   the    corresponding
                                                   characters
                                                    JS_DECODE  -  Decode Java-
                                                    Script  escape  sequences.
                                                    If a \  u  HHHH code is in
                                                    the full-width ASCII  code
                                                    range  of FF01-FF5E , then
                                                    the higher byte is used to
                                                    detect   and   adjust  the
                                                    lower byte. If  not,  only
                                                    the lower byte is used and
                                                    the higher byte is zeroed,
                                                    causing a possible loss of
                                                    information.

                                                    LOWERCASE - Convert upper-
                                                    case letters (A-Z) to low-
                                                    ercase (a-z).

                                                    MD5  -  Calculate  an  MD5
                                                    hash  from the data in the
                                                    input. The  computed  hash
                                                    is in a raw binary form.

                                                    NONE - Specify NONE if you
                                                    don't want any text trans-
                                                    formations.

                                                    NORMALIZE_PATH   -  Remove
                                                    multiple  slashes,  direc-
                                                    tory  self-references, and
                                                    directory  back-references
                                                    that are not at the begin-
                                                    ning of the input from  an
                                                    input string.

                                                    NORMALIZE_PATH_WIN  - This
                                                    is  the  same  as  NORMAL-
                                                    IZE_PATH  , but first con-
                                                    verts backslash characters
                                                    to forward slashes.

                                                    REMOVE_NULLS  - Remove all
                                                    NULL bytes from the input.

                                                    REPLACE_COMMENTS - Replace
                                                    each   occurrence   of   a
                                                    C-style comment (/* ... */
                                                    )  with  a  single  space.
                                                    Multiple  consecutive  oc-
                                                    currences   are  not  com-
                                                    pressed. Unterminated com-
                                                    ments  are  also  replaced
                                                    with a space (ASCII 0x20).
                                                    However, a standalone ter-
                                                    mination of a comment  (*/
                                                    ) is not acted upon.

                                                    REPLACE_NULLS   -  Replace
                                                    NULL bytes  in  the  input
                                                    with    space   characters
                                                    (ASCII 0x20 ).

                                                    SQL_HEX_DECODE  -   Decode
                                                    SQL   hex   data.  Example
                                                    (0x414243 )  will  be  de-
                                                    coded to (ABC ).

                                                    URL_DECODE   -   Decode  a
                                                    URL-encoded value.

                                                    URL_DECODE_UNI   -    Like
                                                    URL_DECODE , but with sup-
                                                    port  for   Microsoft-spe-
                                                    cific  %u encoding. If the
                                                    code is in the  full-width
                                                    ASCII    code   range   of
                                                    FF01-FF5E  ,  the   higher
                                                    byte is used to detect and
                                                    adjust  the  lower   byte.
                                                    Otherwise,  only the lower
                                                    byte  is  used   and   the
                                                    higher byte is zeroed.

                                                    UTF8_TO_UNICODE  - Convert
                                                    all  UTF-8  character  se-
                                                    quences  to  Unicode. This
                                                    helps input normalization,
                                                    and minimizing false-posi-
                                                    tives and  false-negatives
                                                    for non-English languages.

                            LabelMatchStatement -> (structure)
                               A  rule  statement  that defines a string match
                               search against labels that have been  added  to
                               the  web request by rules that have already run
                               in the web ACL.

                               The label match statement provides the label or
                               namespace  string  to  search  for.  The  label
                               string can represent a part or all of the fully
                               qualified label name that had been added to the
                               web request. Fully qualified labels have a pre-
                               fix,  optional  namespaces, and label name. The
                               prefix identifies the rule  group  or  web  ACL
                               context  of  the  rule that added the label. If
                               you do not provide the fully qualified name  in
                               your  label  match  string,  WAF  performs  the
                               search for labels that were added in  the  same
                               context as the label match statement.

                               Scope -> (string)
                                   Specify whether you want to match using the
                                   label name or just the namespace.

                               Key -> (string)
                                   The string to match  against.  The  setting
                                   you  provide  for this depends on the match
                                   statement's Scope setting:

                                   o If the Scope indicates LABEL , then  this
                                     specification  must  include the name and
                                     can include any number of preceding name-
                                     space  specifications  and  prefix  up to
                                     providing the fully qualified label name.

                                   o If the Scope indicates NAMESPACE  ,  then
                                     this specification can include any number
                                     of contiguous namespace strings, and  can
                                     include the entire label namespace prefix
                                     from the rule group or web ACL where  the
                                     label originates.

                                   Labels are case sensitive and components of
                                   a label must be separated by colon, for ex-
                                   ample NS1:NS2:name .

                            RegexMatchStatement -> (structure)
                               A  rule  statement  used  to search web request
                               components for a match against a single regular
                               expression.

                               RegexString -> (string)
                                   The string representing the regular expres-
                                   sion.

                               FieldToMatch -> (structure)
                                   The part of a web request that you want WAF
                                   to   inspect.  For  more  information,  see
                                   FieldToMatch .

                                   SingleHeader -> (structure)
                                      Inspect a  single  header.  Provide  the
                                      name of the header to inspect, for exam-
                                      ple, User-Agent or Referer .  This  set-
                                      ting isn't case sensitive.

                                      Example  JSON: "SingleHeader": { "Name":
                                      "haystack" }

                                      Name -> (string)
                                          The name of the query header to  in-
                                          spect.

                                   SingleQueryArgument -> (structure)
                                      Inspect a single query argument. Provide
                                      the name of the query  argument  to  in-
                                      spect, such as UserName or SalesRegion .
                                      The name can be up to 30 characters long
                                      and isn't case sensitive.

                                      This  is  used  only to indicate the web
                                      request component for WAF to inspect, in
                                      the  FieldToMatch specification.

                                      Example  JSON:  "SingleQueryArgument": {
                                      "Name": "myArgument" }

                                      Name -> (string)
                                          The name of the  query  argument  to
                                          inspect.

                                   AllQueryArguments -> (structure)
                                      Inspect all query arguments.

                                   UriPath -> (structure)
                                      Inspect  the  request  URI path. This is
                                      the part of a web request  that  identi-
                                      fies   a  resource,  for  example,  /im-
                                      ages/daily-ad.jpg .

                                   QueryString -> (structure)
                                      Inspect the query string.  This  is  the
                                      part  of  a  URL  that appears after a ?
                                      character, if any.

                                   Body -> (structure)
                                      Inspect the request body as plain  text.
                                      The request body immediately follows the
                                      request headers. This is the part  of  a
                                      request  that  contains  any  additional
                                      data that you want to send to  your  web
                                      server as the HTTP request body, such as
                                      data from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                   Method -> (structure)
                                      Inspect the HTTP method. The method  in-
                                      dicates  the  type of operation that the
                                      request is asking the origin to perform.

                                   JsonBody -> (structure)
                                      Inspect the request body  as  JSON.  The
                                      request body immediately follows the re-
                                      quest headers. This is the part of a re-
                                      quest  that contains any additional data
                                      that you want to send to your web server
                                      as  the  HTTP request body, such as data
                                      from a form.

                                      Note that only  the  first  8  KB  (8192
                                      bytes) of the request body are forwarded
                                      to WAF for inspection by the  underlying
                                      host  service.  If you don't need to in-
                                      spect more than 8 KB, you can  guarantee
                                      that you don't allow additional bytes in
                                      by combining a statement  that  inspects
                                      the  body  of  the  web request, such as
                                      ByteMatchStatement  or   RegexPatternSe-
                                      tReferenceStatement  ,  with a  SizeCon-
                                      straintStatement that enforces an  8  KB
                                      size  limit  on the body of the request.
                                      WAF doesn't support inspecting  the  en-
                                      tire contents of web requests whose bod-
                                      ies exceed the 8 KB limit.

                                      MatchPattern -> (structure)
                                          The patterns to look for in the JSON
                                          body.  WAF  inspects  the results of
                                          these pattern  matches  against  the
                                          rule inspection criteria.

                                          All -> (structure)
                                             Match  all  of  the elements. See
                                             also MatchScope in  JsonBody .

                                             You must specify either this set-
                                             ting  or  the  IncludedPaths set-
                                             ting, but not both.

                                          IncludedPaths -> (list)
                                             Match only the specified  include
                                             paths.  See  also  MatchScope  in
                                             JsonBody .

                                             Provide the include  paths  using
                                             JSON Pointer syntax. For example,
                                             "IncludedPaths": ["/dogs/0/name",
                                             "/dogs/1/name"] . For information
                                             about this syntax, see the Inter-
                                             net Engineering Task Force (IETF)
                                             documentation  JavaScript  Object
                                             Notation (JSON) Pointer .

                                             You must specify either this set-
                                             ting or the All setting, but  not
                                             both.

                                             NOTE:
                                                 Don't  use this option to in-
                                                 clude all paths. Instead, use
                                                 the All setting.

                                             (string)

                                      MatchScope -> (string)
                                          The  parts  of  the  JSON  to  match
                                          against using the MatchPattern .  If
                                          you   specify   All  ,  WAF  matches
                                          against keys and values.

                                      InvalidFallbackBehavior -> (string)
                                          What WAF should do if  it  fails  to
                                          completely  parse the JSON body. The
                                          options are the following:

                                          o EVALUATE_AS_STRING -  Inspect  the
                                            body  as  plain  text. WAF applies
                                            the text transformations  and  in-
                                            spection criteria that you defined
                                            for the  JSON  inspection  to  the
                                            body text string.

                                          o MATCH  -  Treat the web request as
                                            matching the rule  statement.  WAF
                                            applies the rule action to the re-
                                            quest.

                                          o NO_MATCH - Treat the  web  request
                                            as  not  matching  the rule state-
                                            ment.

                                          If you don't provide  this  setting,
                                          WAF parses and evaluates the content
                                          only up to the first parsing failure
                                          that it encounters.

                                          WAF  does  its best to parse the en-
                                          tire JSON body, but might be  forced
                                          to  stop for reasons such as invalid
                                          characters, duplicate keys,  trunca-
                                          tion,  and  any  content  whose root
                                          node isn't an object or an array.

                                          WAF parses the JSON in the following
                                          examples  as  two  valid  key, value
                                          pairs:

                                          o Missing                     comma:
                                            {"key1":"value1""key2":"value2"}

                                          o Missing                     colon:
                                            {"key1":"value1","key2""value2"}

                                          o Extra                      colons:
                                            {"key1"::"value1","key2""value2"}

                               TextTransformations -> (list)
                                   Text  transformations eliminate some of the
                                   unusual formatting that  attackers  use  in
                                   web  requests in an effort to bypass detec-
                                   tion. If you specify one or more  transfor-
                                   mations  in  a rule statement, WAF performs
                                   all transformations on the content  of  the
                                   request   component  identified  by  Field-
                                   ToMatch , starting from the lowest priority
                                   setting,  before inspecting the content for
                                   a match.

                                   (structure)
                                      Text transformations eliminate  some  of
                                      the  unusual  formatting  that attackers
                                      use in web requests in an effort to  by-
                                      pass detection.

                                      Priority -> (integer)
                                          Sets  the  relative processing order
                                          for  multiple  transformations  that
                                          are  defined  for  a rule statement.
                                          WAF processes  all  transformations,
                                          from lowest priority to highest, be-
                                          fore inspecting the transformed con-
                                          tent.  The  priorities don't need to
                                          be consecutive, but they must all be
                                          different.

                                      Type -> (string)
                                          You can specify the following trans-
                                          formation types:
                                             BASE64_DECODE - Decode  a  Base64
                                             -encoded string.

                                             BASE64_DECODE_EXT   -   Decode  a
                                             Base64 -encoded string, but use a
                                             forgiving implementation that ig-
                                             nores  characters   that   aren't
                                             valid.

                                             CMD_LINE - Command-line transfor-
                                             mations. These are helpful in re-
                                             ducing effectiveness of attackers
                                             who inject  an  operating  system
                                             command-line  command and use un-
                                             usual formatting to disguise some
                                             or all of the command.

                                          o Delete the following characters: \
                                            " ' ^

                                          o Delete spaces before the following
                                            characters: / (

                                          o Replace  the  following characters
                                            with a space: , ;

                                          o Replace multiple spaces  with  one
                                            space

                                          o Convert uppercase letters (A-Z) to
                                            lowercase (a-z)
                                             COMPRESS_WHITE_SPACE  -   Replace
                                             these  characters  with  a  space
                                             character (decimal 32):

                                          o \f , formfeed, decimal 12

                                          o \t , tab, decimal 9

                                          o \n , newline, decimal 10

                                          o \r , carriage return, decimal 13

                                          o \v , vertical tab, decimal 11

                                          o Non-breaking space, decimal 160
                                             COMPRESS_WHITE_SPACE   also   re-
                                             places  multiple  spaces with one
                                             space.

                                             CSS_DECODE  -  Decode  characters
                                             that  were  encoded using CSS 2.x
                                             escape rules syndata.html#charac-
                                             ters  .  This function uses up to
                                             two   bytes   in   the   decoding
                                             process,  so  it  can help to un-
                                             cover ASCII characters that  were
                                             encoded  using  CSS encoding that
                                             wouldnt  typically  be   encoded.
                                             It's  also  useful  in countering
                                             evasion, which is  a  combination
                                             of  a backslash and non-hexadeci-
                                             mal  characters.   For   example,
                                             ja\vascript for javascript.

                                             ESCAPE_SEQ_DECODE  -  Decode  the
                                             following  ANSI  C   escape   se-
                                             quences: \a , \b , \f , \n , \r ,
                                             \t , \v , \\ , \? ,  \'  ,  \"  ,
                                             \xHH  (hexadecimal),  \0OOO  (oc-
                                             tal). Encodings that aren't valid
                                             remain in the output.

                                             HEX_DECODE  -  Decode a string of
                                             hexadecimal characters into a bi-
                                             nary.

                                             HTML_ENTITY_DECODE    -   Replace
                                             HTML-encoded characters with  un-
                                             encoded    characters.   HTML_EN-
                                             TITY_DECODE performs these opera-
                                             tions:

                                          o Replaces (ampersand)quot; with "

                                          o Replaces  (ampersand)nbsp;  with a
                                            non-breaking space, decimal 160

                                          o Replaces  (ampersand)lt;  with   a
                                            "less than" symbol

                                          o Replaces (ampersand)gt; with >

                                          o Replaces  characters that are rep-
                                            resented  in  hexadecimal  format,
                                            (ampersand)#xhhhh; , with the cor-
                                            responding characters

                                          o Replaces characters that are  rep-
                                            resented  in  decimal format, (am-
                                            persand)#nnnn; , with  the  corre-
                                            sponding characters
                                             JS_DECODE - Decode JavaScript es-
                                             cape sequences. If a \   u   HHHH
                                             code  is  in the full-width ASCII
                                             code range of  FF01-FF5E  ,  then
                                             the higher byte is used to detect
                                             and adjust  the  lower  byte.  If
                                             not,  only the lower byte is used
                                             and the higher  byte  is  zeroed,
                                             causing a possible loss of infor-
                                             mation.

                                             LOWERCASE  -  Convert   uppercase
                                             letters (A-Z) to lowercase (a-z).

                                             MD5  - Calculate an MD5 hash from
                                             the data in the input.  The  com-
                                             puted  hash  is  in  a raw binary
                                             form.

                                             NONE - Specify NONE if you  don't
                                             want any text transformations.

                                             NORMALIZE_PATH  - Remove multiple
                                             slashes,  directory   self-refer-
                                             ences,  and directory back-refer-
                                             ences that are not at the  begin-
                                             ning  of  the input from an input
                                             string.

                                             NORMALIZE_PATH_WIN - This is  the
                                             same   as  NORMALIZE_PATH  ,  but
                                             first converts backslash  charac-
                                             ters to forward slashes.

                                             REMOVE_NULLS  -  Remove  all NULL
                                             bytes from the input.

                                             REPLACE_COMMENTS -  Replace  each
                                             occurrence  of  a C-style comment
                                             (/* ... */ ) with a single space.
                                             Multiple  consecutive occurrences
                                             are not compressed.  Unterminated
                                             comments are also replaced with a
                                             space (ASCII  0x20).  However,  a
                                             standalone  termination of a com-
                                             ment (*/ ) is not acted upon.

                                             REPLACE_NULLS  -   Replace   NULL
                                             bytes  in  the  input  with space
                                             characters (ASCII 0x20 ).

                                             SQL_HEX_DECODE - Decode  SQL  hex
                                             data. Example (0x414243 ) will be
                                             decoded to (ABC ).

                                             URL_DECODE - Decode a URL-encoded
                                             value.

                                             URL_DECODE_UNI  - Like URL_DECODE
                                             , but  with  support  for  Micro-
                                             soft-specific %u encoding. If the
                                             code is in the  full-width  ASCII
                                             code  range  of  FF01-FF5E  , the
                                             higher byte is used to detect and
                                             adjust the lower byte. Otherwise,
                                             only the lower byte is  used  and
                                             the higher byte is zeroed.

                                             UTF8_TO_UNICODE   -  Convert  all
                                             UTF-8 character sequences to Uni-
                                             code. This helps input normaliza-
                                             tion, and minimizing  false-posi-
                                             tives   and  false-negatives  for
                                             non-English languages.

                     RuleGroupReferenceStatement -> (structure)
                        A rule statement used to run the rules  that  are  de-
                        fined  in  a   RuleGroup  . To use this, create a rule
                        group with your rules, then provide  the  ARN  of  the
                        rule group in this statement.

                        You  cannot  nest  a RuleGroupReferenceStatement , for
                        example for use inside a NotStatement or OrStatement .
                        You  can  only use a rule group reference statement at
                        the top level inside a web ACL.

                        ARN -> (string)
                            The Amazon Resource Name (ARN) of the entity.

                        ExcludedRules -> (list)
                            The rules in the referenced rule group  whose  ac-
                            tions  are set to Count . When you exclude a rule,
                            WAF evaluates it exactly as it would if  the  rule
                            action  setting  were Count . This is a useful op-
                            tion for testing the rules in a rule group without
                            modifying how they handle your web traffic.

                            (structure)
                               Specifies  a  single rule in a rule group whose
                               action you want to override to Count . When you
                               exclude  a rule, WAF evaluates it exactly as it
                               would if the rule action setting were  Count  .
                               This  is  a useful option for testing the rules
                               in a rule group without modifying how they han-
                               dle your web traffic.

                               Name -> (string)
                                   The  name of the rule whose action you want
                                   to override to Count .

                 OverrideAction -> (structure)
                     The action to use in the place of the action that results
                     from  the  rule group evaluation. Set the override action
                     to none to leave the result of the rule group alone.  Set
                     it to count to override the result to count only.

                     You  can only use this for rule statements that reference
                     a rule group, like RuleGroupReferenceStatement  and  Man-
                     agedRuleGroupStatement .

                     NOTE:
                        This option is usually set to none. It does not affect
                        how the rules in the rule group are evaluated. If  you
                        want  the  rules  in  the  rule  group  to  only count
                        matches, do not use this  and  instead  exclude  those
                        rules in your rule group reference statement settings.

                     Count -> (structure)
                        Override  the  rule  group  evaluation result to count
                        only.

                        NOTE:
                            This option is usually set to none.  It  does  not
                            affect  how the rules in the rule group are evalu-
                            ated. If you want the rules in the rule  group  to
                            only  count  matches,  do not use this and instead
                            exclude those rules in your rule  group  reference
                            statement settings.

                        CustomRequestHandling -> (structure)
                            Defines custom handling for the web request.

                            For information about customizing web requests and
                            responses, see Customizing web  requests  and  re-
                            sponses in WAF in the WAF Developer Guide .

                            InsertHeaders -> (list)
                               The  HTTP  headers  to insert into the request.
                               Duplicate header names are not allowed.

                               For information about the limits on  count  and
                               size  for custom request and response settings,
                               see WAF quotas in the WAF Developer Guide .

                               (structure)
                                   A custom header for custom request and  re-
                                   sponse handling. This is used in  CustomRe-
                                   sponse and  CustomRequestHandling .

                                   Name -> (string)
                                      The name of the custom header.

                                      For  custom  request  header  insertion,
                                      when WAF inserts the header into the re-
                                      quest, it prefixes this name x-amzn-waf-
                                      ,  to  avoid  confusion with the headers
                                      that are already in the request. For ex-
                                      ample,  for the header name sample , WAF
                                      inserts the header x-amzn-waf-sample .

                                   Value -> (string)
                                      The value of the custom header.

                     None -> (structure)
                        Don't override the rule group evaluation result.  This
                        is the most common setting.

                 VisibilityConfig -> (structure)
                     Defines and enables Amazon CloudWatch metrics and web re-
                     quest sample collection.

                     SampledRequestsEnabled -> (boolean)
                        A boolean indicating whether WAF should store  a  sam-
                        pling  of  the  web requests that match the rules. You
                        can view the sampled requests through the WAF console.

                     CloudWatchMetricsEnabled -> (boolean)
                        A boolean indicating whether the  associated  resource
                        sends  metrics  to  Amazon CloudWatch. For the list of
                        available metrics, see WAF Metrics .

                     MetricName -> (string)
                        A name of the Amazon CloudWatch metric. The  name  can
                        contain  only  the  characters:  A-Z, a-z, 0-9, - (hy-
                        phen), and _ (underscore). The name can be from one to
                        128  characters  long.  It can't contain whitespace or
                        metric names reserved for WAF, for example  "All"  and
                        "Default_Action."

          ManagedByFirewallManager -> (boolean)
              Indicates  whether  this web ACL is managed by Firewall Manager.
              If true, then only Firewall Manager can delete the  web  ACL  or
              any Firewall Manager rule groups in the web ACL.

          LabelNamespace -> (string)
              The label namespace prefix for this web ACL. All labels added by
              rules in this web ACL have this prefix.

              o The syntax for the label namespace prefix for a web ACL is the
                following:   awswaf:<account ID>:webacl:<web ACL name>:

              o When  a  rule with a label matches a web request, WAF adds the
                fully qualified label to the request. A fully qualified  label
                is  made  up of the label namespace from the rule group or web
                ACL where the rule is defined and the  label  from  the  rule,
                separated by a colon:   <label namespace>:<label from rule>

          CustomResponseBodies -> (map)
              A  map of custom response keys and content bodies. When you cre-
              ate a rule with a block action, you can send a  custom  response
              to  the  web request. You define these for the web ACL, and then
              use them in the rules and default actions that you define in the
              web ACL.

              For  information  about  customizing web requests and responses,
              see Customizing web requests and responses in WAF in the WAF De-
              veloper Guide .

              For  information  about  the limits on count and size for custom
              request and response settings, see WAF quotas in the WAF  Devel-
              oper Guide .

              key -> (string)

              value -> (structure)
                 The  response  body  to use in a custom response to a web re-
                 quest. This is referenced by key from   CustomResponse   Cus-
                 tomResponseBodyKey .

                 ContentType -> (string)
                     The  type of content in the payload that you are defining
                     in the Content string.

                 Content -> (string)
                     The payload of the custom response.

                     You can use JSON escape strings in JSON  content.  To  do
                     this,  you  must  specify JSON content in the ContentType
                     setting.

                     For information about the limits on count  and  size  for
                     custom  request  and response settings, see WAF quotas in
                     the WAF Developer Guide .

          CaptchaConfig -> (structure)
              Specifies how WAF should handle CAPTCHA  evaluations  for  rules
              that  don't  have their own CaptchaConfig settings. If you don't
              specify this, WAF uses its default settings for CaptchaConfig .

              ImmunityTimeProperty -> (structure)
                 Determines how long a CAPTCHA token remains valid  after  the
                 client successfully solves a CAPTCHA puzzle.

                 ImmunityTime -> (long)
                     The  amount  of time, in seconds, that a CAPTCHA token is
                     valid. The default setting is 300.

       LockToken -> (string)
          A token used for optimistic locking. WAF returns a token to your get
          and  list  requests,  to mark the state of the entity at the time of
          the request. To make changes to the entity associated with  the  to-
          ken,  you  provide  the token to operations like update and delete .
          WAF uses the token to ensure that no changes have been made  to  the
          entity  since  you last retrieved it. If a change has been made, the
          update fails with a WAFOptimisticLockException .  If  this  happens,
          perform  another get , and use the new token returned by that opera-
          tion.



                                                                 GET-WEB-ACL()
